/*
 suggest.js 2.0.1
 Copyright (c) 2011 Rakuten.Inc
 Date : 2011-02-16 10:21:59
*/
(function(){if(typeof jQuery!="undefined"){jQuery.noConflict();var e=jQuery,h=function(){};h.prototype={resultArray:[],backup:"",lastInput:"",respInput:null,sggstSelectNum:-1,usingChar:"",mouseInput:null,mouseState:0,mouseMove:0,mouseOver:0,enterFlag:1,keyCode:null,currentFontSize:null,maxIndex:0,index:-1,clickEnableFlag:1,IeVersion:0,viewEvent:null,ajaxEvent:null,suggestDivPos:null,onoff:1,onoffInitFlag:0,onElem:null,offElem:null,decisionFlag:0,scVal:0,submitWay:0,blackList:["iphone","ipod","ipad",
"android"],onOffBlackList:[],spaceRegExp:RegExp("^[\\s"+unescape("\u3000")+"]+"),preInit:function(){this.suggestDivPos=this.input.parent();return true},postInit:function(){},checkBoolNum:function(a){if(typeof a!="undefined"&&a.length!=0&&(a==0||a==1))return a;return""},escapeHtml:function(a){return e("<div/>").text(a).html()},initFailure:function(){rsuggest.input.attr("autocomplete","")},createSuggestDiv:function(){this.suggest=e("<div />").attr("id","suggest").hide().appendTo(this.suggestDivPos);for(var a=
e("<div />").append(e("<div />").attr("class",this.cssNoSelect).append(e("<span />").attr("class",this.cssKeyword))),d="",c=0,b=this.count;c<b;c++)d+=a.html();this.suggest.append(d);this.suggest.delegate("."+this.cssKeyword,"mouseup",function(f){var g=e(this).text();if(!(f.which!=1||rsuggest.mouseInput!=g||rsuggest.clickEnableFlag==0)){rsuggest.mouseState=2;rsuggest.input.blur();rsuggest.input.val(g);rsuggest.sggstSelectNum=rsuggest.index;rsuggest.usingChar=g;rsuggest.clickEnableFlag=0;rsuggest.decisionFlag=
1;rsuggest.submitWay=2;setTimeout(function(){rsuggest.button.click()},10);rsuggest.eventStop()}});this.suggest.delegate("."+this.cssKeyword,"mousedown",function(f){if(f.which!=1)rsuggest.input.blur();else{rsuggest.mouseInput=e(this).text();rsuggest.mouseState=1;return false}});this.suggest.delegate("."+this.cssKeyword,"mouseover",function(){rsuggest.over(e(this).text())});this.suggest.delegate("."+this.cssKeyword,"mouseout",function(){rsuggest.mouseState=0});this.suggest.delegate("."+this.cssKeyword,
"mousemove",function(){rsuggest.mouseMove=1});this.remarks=e("<div />").attr("class",this.cssRemarks).append(e("<div />").attr("class",this.cssRemarksBox).append(e("<div />").attr("class",this.cssComment).append(e("<div />").attr("class",this.cssBetaImg))))},preSearch:function(){return true},search:function(){if(this.preSearch())if(this.onoffInitFlag!=0){var a=this.input.val();if(a==null||a.replace(this.spaceRegExp,"").length==0||a.match(this.spaceRegExp)!=null){this.usingChar="";this.sggstSelectNum=
-1;this.hide()}else if(a!=this.lastInput){this.backup=this.lastInput=a;clearTimeout(this.ajaxEvent);this.ajaxEvent=setTimeout(function(){var d=rsuggest.lastInput.replace(rsuggest.spaceRegExp,"");if(d.length!=0){var c=rsuggest.config.attr(rsuggest.configCollection);if(c.length!=0){if(typeof rsuggest.resultArray[c]=="undefined")rsuggest.resultArray[c]=[];if(typeof rsuggest.resultArray[c][d]=="undefined")try{var b=rsuggest.baseUrl+"/"+rsuggest.searchCommand+"?"+rsuggest.paramCollection+"="+c+"&"+rsuggest.paramReqid+
"="+rsuggest.sggstReqid+"&"+rsuggest.paramSuggestid+"="+rsuggest.suggestId+"&"+rsuggest.paramInput+"="+encodeURIComponent(d)+"&"+rsuggest.paramEncoding+"="+rsuggest.encoding;if(rsuggest.exParam.length!=0)b+="&"+rsuggest.exParam;rsuggest.read(b)}catch(f){}else rsuggest.show(rsuggest.resultArray[c][d],d,c)}}},10);this.postSearch()}}},postSearch:function(){},read:function(a){try{var d=this.lastInput,c=this.encoding,b=this.config.attr(this.configCollection);e.ajax({url:a,cache:true,timeout:1E4,dataType:"jsonp",
scriptCharset:c,jsonp:rsuggest.paramCallback,success:function(g){rsuggest.show(g,d,b)}})}catch(f){}},eventStart:function(){clearInterval(this.viewEvent);this.clickEnableFlag=true;this.decisionFlag=false;this.viewEvent=setInterval(function(){rsuggest.nowFontSize=e("html").css("font-size");if(rsuggest.currentFontSize!=rsuggest.nowFontSize){rsuggest.currentFontSize=rsuggest.nowFontSize;rsuggest.resize()}rsuggest.controlOnElem();rsuggest.search()},100)},eventStop:function(){clearInterval(this.viewEvent);
setTimeout(function(){rsuggest.hide()},200)},preShow:function(){return true},show:function(a,d,c){var b=this;if(!b.preShow())return false;if(typeof a.result=="undefined"||typeof a.status=="undefined"||a.status!=0){b.maxIndex=0;b.hide()}else{if(c.length!=0&&typeof b.resultArray[c][d]=="undefined")b.resultArray[c][d]=a;if(b.lastInput.replace(b.spaceRegExp,"")==d){var f=a.result.length;if(f==0){b.maxIndex=0;b.hide()}else{if(f>b.count)f=b.count;b.maxIndex=f;b.suggest.children("."+b.cssRemarks).remove();
b.index=-1;b.respInput=b.lastInput;b.suggest.children("."+b.cssSelect).attr("class",b.cssNoSelect).end().children("."+b.cssNoSelect).each(function(g,i){if(g<f){var j=a.result[g][0],k=rsuggest.respInput.toLowerCase();if(j.indexOf(k)==0){var l="<strong>"+b.escapeHtml(k)+"</strong>";l+=b.escapeHtml(j.replace(k,""));e(i).show().children("."+rsuggest.cssKeyword).html(l)}else e(i).show().children("."+rsuggest.cssKeyword).text(j)}else e(i).hide()});b.suggest.append(b.remarks);b.mouseMove=0;setTimeout(function(){rsuggest.mouseMove=
1},100);b.onoff==1&&b.suggest.show();b.postShow()}}}},postShow:function(){},hide:function(a){if(a&&this.lastInput.length!=0){this.input.val(this.backup);this.sggstSelectNum=-1;this.usingChar=""}this.lastInput=this.input.val();this.suggest.hide()},select:function(a){var d=this.suggest.children("."+this.cssSelect).attr("class",this.cssNoSelect).end().children("."+this.cssNoSelect).eq(this.index);this.index!=-1&&d.attr("class",this.cssSelect);if(a){a="";if(this.index<=-1||this.index>=this.maxIndex){a=
this.backup;this.usingChar="";this.sggstSelectNum=-1}else{this.usingChar=a=d.children("."+this.cssKeyword).text();this.sggstSelectNum=this.index}this.input.val(a);this.lastInput=a}},up:function(){if(!(this.maxIndex==0||this.lastInput.length==0||this.config.attr(this.configCollection).length==0)){if(this.index<=-1)this.index=this.maxIndex;if(this.suggest.is(":visible")){this.index--;this.select(1)}else if(this.respInput==this.lastInput&&this.onoff==1){this.select();this.suggest.show()}}},down:function(){if(!(this.maxIndex==
0||this.lastInput.length==0||this.config.attr(this.configCollection).length==0)){if(this.index>=this.maxIndex)this.index=-1;if(this.suggest.is(":visible")){this.index++;this.select(1)}else if(this.respInput==this.lastInput&&this.onoff==1){this.select();this.suggest.show()}}},over:function(a){var d=-1;this.suggest.children("."+this.cssSelect).attr("class",this.cssNoSelect).end().children("."+this.cssNoSelect).each(function(b,f){if(a==e(f).text()){d=b;return false}});var c=this.keywordReplaceOnMouseover==
1&&this.mouseMove==1;if(c){this.mouseOver=1;this.input.blur();this.input.focus()}this.index=d;this.select(c);setTimeout(function(){rsuggest.mouseOver=0},50)},preJump:function(){return true},jump:function(){if(this.preJump()){var a=this.isUse();this.scVal=this.decisionFlag==1?a:0;this.sendSubmitLog(a)}},sendSubmitLog:function(a){var d=this.config.attr(this.configCollection);if(d.length!=0){var c=this.input.val().replace(this.spaceRegExp,"");a=this.baseUrl+"/"+this.submitLogCommand+"?"+this.paramSuggestid+
"="+this.suggestId+"&"+this.paramCollection+"="+d+"&"+this.paramReqid+"="+this.sggstReqid+"&"+this.paramSuggestOnOff+"="+this.onoff+"&"+this.paramSelectNum+"="+this.sggstSelectNum+"&"+this.paramSelect+"="+this.usingChar+"&"+this.paramSuggestUse+"="+a+"&"+this.paramSubmitWay+"="+this.submitWay+"&"+this.paramInput+"="+encodeURIComponent(c);if(this.sendFormParam==1)a+="&"+this.paramFormParam+"="+encodeURIComponent(this.form.serialize());if(this.exParam.length!=0)a+="&"+this.paramExParam+"="+encodeURIComponent(this.exParam);
this.read(a)}},isUse:function(){return this.usingChar.length!=0&&this.input.val().indexOf(this.usingChar)==0?1:0},judge:function(){for(var a=this,d=navigator.userAgent.toLowerCase(),c=0;c<a.blackList.length;c++){var b=a.blackList[c];if(b.length!=0){b=RegExp("("+b+")");if(b.exec(d)!=null)return-1}}if(a.addBlackList.length!=0){var f=a.addBlackList.split(",");for(c=0;c<f.length;c++){b=f[c];if(b.length!=0)if(d.indexOf(b)!=-1)return-1}}if(e.browser.msie){a=this;c=e.browser.version;if(c>5&&c<7)a.IeVersion=
6;else if(c>6&&c<8)a.IeVersion=7}if(a.IeVersion==6)rsuggest.onoffEnable=0;for(c=0;c<a.onOffBlackList.length;c++){b=a.onOffBlackList[c];if(b.length!=0){b=RegExp("("+b+")");if(b.exec(d)!=null){rsuggest.onoffEnable=0;break}}}return a.IeVersion},preResize:function(){return true},resize:function(){if(this.preResize()){var a=this.getTextPos(),d;if(this.IeVersion==7){a=this.getIe7TextPos(a);d=a.top;a=a.left}else{d=a.top;a=a.left}var c=Math.ceil(this.input.outerHeight());this.suggest.css({top:d+c,left:a});
this.changeSuggestWidth();this.postResize()}},postResize:function(){},getTextPos:function(){return this.input.position()},getIe7TextPos:function(a){var d=[],c=document.body,b=c.getBoundingClientRect(),f=(b.right-b.left)/c.offsetWidth;d.top=Math.ceil(a.top/((b.bottom-b.top)/c.offsetHeight));d.left=Math.ceil(a.left/f);return d},changeSuggestWidth:function(){var a=this.input.outerWidth(),d=this.suggest.outerWidth();if(a!=d){this.suggest.css({width:a});d=this.suggest.find("."+this.cssKeyword);d.css({width:a-
parseInt(d.css("paddingLeft"))-parseInt(d.css("paddingRight"))})}},onoffReady:function(){if(this.onoffEnable==1){this.createOnElm();this.createOffElm();this.checkCookie()}else this.setInitOnoffNum(1)},checkCookie:function(){e.ajax({type:"GET",url:this.baseUrl+"/"+this.cookieCommand+"?"+this.paramGroupId+"="+this.groupId+"&"+this.paramCookieMethod+"="+this.paramCookieCheck,dataType:"jsonp",timeout:500,jsonp:rsuggest.paramCallback,success:function(a){a=a.result;if(typeof a!="undefined"&&(a==0||a==1))rsuggest.setInitOnoffNum(a==
0?1:0)}});setTimeout(function(){rsuggest.setInitOnoffNum(1)},1E3)},setInitOnoffNum:function(a){if(this.onoffInitFlag!=1){this.onoff=a;this.onoffInitFlag=1;this.displayOnoff()}},createOnElm:function(){this.onElem=e("<div />").hide().attr({"class":this.cssOn,title:voidToolTips}).click(function(){rsuggest.setOnoffNum(1);rsuggest.input.focus();setTimeout(function(){rsuggest.lastInput=""},120)});this.input.after(this.onElem)},createOffElm:function(){this.offElem=e("<div />").attr({"class":this.cssOff,
title:this.hideToolTips}).append(e("<span />").attr("class",this.cssOffImage));this.remarks.children().append(this.offElem);this.suggest.delegate("."+this.cssOff,"mousedown",function(a){if(a.which!=1)rsuggest.input.blur();else{rsuggest.mouseState=1;rsuggest.setOnoffNum(0);rsuggest.input.blur();return false}});this.suggest.delegate("."+this.cssOff,"mouseout",function(){rsuggest.mouseState=0})},setOnoffNum:function(a){this.onoff=a;this.setCookie(a);this.displayOnoff()},setCookie:function(a){e.ajax({type:"GET",
url:this.baseUrl+"/"+this.cookieCommand+"?"+this.paramGroupId+"="+this.groupId+"&"+this.paramCookieMethod+"="+(a==1?this.paramCookieDelete:this.paramCookieAdd),dataType:"jsonp",timeout:500,jsonp:rsuggest.paramCallback,success:function(){}})},displayOnoff:function(){if(this.onoffEnable==1)if(this.onoff==1){this.onElem.hide();this.resize();this.input.attr("autocomplete","off")}else{this.resize();this.input.attr("autocomplete","");this.controlOnElem();rsuggest.suggest.hide()}},controlOnElem:function(){if(!(this.onoffEnable!=
1||this.onoff!=0||this.byteNumToHideOpenSggst==0))if(this.isByteLengthOver(this.input.val(),this.byteNumToHideOpenSggst)==1)this.onElem.hide();else this.onElem.is(":visible")||this.onElem.show()},isSuggestUse:function(){return typeof this.scVal!="undefined"&&this.scVal==1},isByteLengthOver:function(a,d){if(a===undefined)return 0;var c=0,b="",f=a.length,g;for(g=0;g<f;g++){b=escape(a.charAt(g));c+=b.length<4&&!/%[0|1|8-9|A-F]\w|%7F/.test(b)?1:2;if(c>d)return 1}return 0}};typeof RSuggestHook!=="undefined"&&
e.extend(h.prototype,RSuggestHook.prototype);rsuggest=new h;rsuggest.config=e("#sggstConfig");rsuggest.input=e("#"+rsuggest.config.attr("input"));rsuggest.input.attr("autocomplete","off");e(document).ready(function(){rsuggest.preInit()||rsuggest.initFailure();rsuggest.form=e("#"+rsuggest.config.attr("form"));rsuggest.baseUrl=rsuggest.config.attr("baseUrl")||"";rsuggest.button=e("#"+rsuggest.config.attr("button"));rsuggest.suggestId=rsuggest.config.attr("suggestId")||"";rsuggest.encoding=rsuggest.config.attr("encoding")||
"";rsuggest.exParam=rsuggest.config.attr("exParam")||"";rsuggest.groupId=rsuggest.config.attr("groupId")||"";rsuggest.sendFormParam=rsuggest.checkBoolNum(rsuggest.config.attr("sendFormParam"))||1;rsuggest.onoffEnable=rsuggest.checkBoolNum(rsuggest.config.attr("onoff"))||1;rsuggest.keywordReplaceOnMouseover=rsuggest.checkBoolNum(rsuggest.config.attr("keywordReplaceOnMouseover"))||0;rsuggest.hookRequired=rsuggest.checkBoolNum(rsuggest.config.attr("hookRequired"))||0;rsuggest.addBlackList=rsuggest.config.attr("uaBlackList")||
"";var a=rsuggest.config.attr("byteNumToHideOpenSggst")||0;rsuggest.byteNumToHideOpenSggst=isNaN(a)||parseInt(a)<1?0:a;rsuggest.nowFontSize=e("html").css("font-size");rsuggest.hideToolTips=rsuggest.config.attr("hideToolTips")||"";voidToolTips=rsuggest.config.attr(voidToolTips")||"";if(rsuggest.input.length==0||rsuggest.form.length==0||rsuggest.baseUrl.length==0||rsuggest.button.length==0||rsuggest.suggestId.length==0||rsuggest.encoding.length==0||rsuggest.groupId.length==0||rsuggest.sendFormParam.length==
0||rsuggest.onoffEnable.length==0||rsuggest.keywordReplaceOnMouseover.length==0||rsuggest.hookRequired.length==0||rsuggest.judge()==-1||rsuggest.input.parent(".sggstInputWrap").length!=1||rsuggest.hookRequired==1&&typeof RSuggestHook=="undefined"){try{rsuggest.initFailure()}catch(d){}return false}rsuggest.count=10;rsuggest.cssSelect="sggstSelect";rsuggest.cssNoSelect="sggstNoselect";rsuggest.cssKeyword="sggstKeyword";rsuggest.cssOnoff="sggstOnoff";rsuggest.cssOffImage="sggstHideimg";rsuggest.cssOnImage=
"sggstOpenimg";rsuggest.cssRemarks="sggstComment";rsuggest.cssRemarksBox="sggstCommentbox";rsuggest.cssComment="sggstBetabtn01";rsuggest.cssBetaImg="betaimg";rsuggest.cssOff="sggstBetabtn02";rsuggest.cssOn=voidSuggest";rsuggest.configCollection="col";rsuggest.paramInput="q";rsuggest.paramCollection="cl";rsuggest.paramSuggestid="sid";rsuggest.paramSuggestUse="su";rsuggest.paramSelectNum="sn";rsuggest.paramSuggestOnOff="so";rsuggest.paramFormParam="fp";rsuggest.paramReqid="rid";rsuggest.sggstReqid=
Math.floor(Math.random()*1E10);rsuggest.paramEncoding="oe";rsuggest.paramSelect="ss";rsuggest.sggstSelect="";rsuggest.searchCommand="suggest";rsuggest.submitLogCommand="submit";rsuggest.cookieCommand="conf";rsuggest.paramGroupId="gi";rsuggest.paramCookieMethod="mt";rsuggest.paramCookieCheck="c";rsuggest.paramCookieAdd="a";rsuggest.paramCookieDelete="d";rsuggest.paramSubmitWay="sw";rsuggest.paramCallback="cb";rsuggest.paramExParam="ex";rsuggest.createSuggestDiv();rsuggest.onoffReady();rsuggest.resize();
e(window).resize(function(){rsuggest.resize()});rsuggest.input.keydown(function(c){rsuggest.enterFlag=0;rsuggest.keyCode=c.keyCode;switch(c.keyCode){case 40:rsuggest.down();break;case 38:rsuggest.up();break;case 9:rsuggest.hide()}}).keypress(function(c){rsuggest.keyCode=c.keyCode;rsuggest.enterFlag=1;switch(c.keyCode){case 27:rsuggest.keyCode==27&&rsuggest.hide(true);return false;case 13:if(rsuggest.keyCode==13&&rsuggest.enterFlag==1&&rsuggest.clickEnableFlag==1){rsuggest.clickEnableFlag=0;rsuggest.decisionFlag=
1;rsuggest.submitWay=1;setTimeout(function(){rsuggest.button.click()},10);rsuggest.eventStop()}return false}}).keyup(function(c){switch(c.keyCode){case 27:rsuggest.keyCode==27&&rsuggest.hide(true);return false;case 13:if(rsuggest.keyCode==13&&rsuggest.enterFlag==1&&rsuggest.clickEnableFlag==1){rsuggest.clickEnableFlag=0;rsuggest.decisionFlag=1;rsuggest.submitWay=1;setTimeout(function(){rsuggest.button.click()},10);rsuggest.eventStop()}return false}}).focus(function(){rsuggest.lastInput=rsuggest.input.val();
if(rsuggest.mouseOver==0)rsuggest.backup=rsuggest.input.val();rsuggest.eventStart()}).blur(function(){if(rsuggest.mouseState==0&&rsuggest.mouseOver==0)rsuggest.eventStop();else if(rsuggest.mouseState==1||rsuggest.mouseOver==1)rsuggest.input.focus();rsuggest.mouseState=0}).mouseover(function(){if(rsuggest.keywordReplaceOnMouseover==1&&rsuggest.suggest.is(":visible")&&rsuggest.index!=-1&&rsuggest.backup.length!=0&&rsuggest.lastInput==rsuggest.input.val()){rsuggest.input.val(rsuggest.backup);rsuggest.sggstSelectNum=
-1;rsuggest.usingChar=""}}).attr("maxlength",2048);rsuggest.button.click(function(){try{rsuggest.jump()}catch(c){}return true});if(document.activeElement.id==rsuggest.input.attr("id")){rsuggest.input.blur();rsuggest.input.focus()}rsuggest.postInit()})}})();
