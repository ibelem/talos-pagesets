dojo.provide("nielsenTracking");

nielsenTracking = {
      init: function() {
//  if(dj.util.Region.getViewByRegion() === "na,us") {
            var d = new Image(1, 1);
            d.onerror = d.onloaddisabled = function () {
              d.onerror = d.onloaddisabled = null;
            };
            d.src = ["//secure-us.imrworldwide.com/cgi-bin/m?ci=us-403743h&cg=0&cc=1&si=", escape(window.location.href), "&rp=", escape(document.referrer), "&ts=compact&rnd=", (new Date()).getTime()].join('');
//        }
      }

};dojo.provide("swfobject.swfobject_1_5.swfobject");
/**
 * SWFObject v1.5: Flash Player detection and embed - http://blog.deconcept.com/swfobject/
 *
 * SWFObject is (c) 2007 Geoff Stearns and is released under the MIT License:
 * http://voidsource.org/licenses/mit-license.php
 *
 */
if(typeof deconcept=="undefined"){var deconcept=new Object();}if(typeof deconcept.util=="undefined"){deconcept.util=new Object();}if(typeof deconcept.SWFObjectUtil=="undefined"){deconcept.SWFObjectUtil=new Object();}deconcept.SWFObject=function(_1,id,w,h,_5,c,_7,_8,_9,_a){if(!document.getElementById){return;}this.DETECT_KEY=_a?_a:"detectflash";this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY);this.params=new Object();this.variables=new Object();this.attributes=new Array();if(_1){this.setAttribute("swf",_1);}if(id){this.setAttribute("id",id);}if(w){this.setAttribute("width",w);}if(h){this.setAttribute("height",h);}if(_5){this.setAttribute("version",new deconcept.PlayerVersion(_5.toString().split(".")));}this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){deconcept.SWFObject.doPrepUnloaddisabled=true;}if(c){this.addParam("bgcolor",c);}var q=_7?_7:"high";this.addParam("quality",q);this.setAttribute("useExpressInstall",false);this.setAttribute("doExpressInstall",false);var _c=(_8)?_8:window.location;this.setAttribute("xiRedirectUrl",_c);this.setAttribute("redirectUrl","");if(_9){this.setAttribute("redirectUrl",_9);}};deconcept.SWFObject.prototype={useExpressInstall:function(_d){this.xiSWFPath=!_d?"expressinstall.swf":_d;this.setAttribute("useExpressInstall",true);},setAttribute:function(_e,_f){this.attributes[_e]=_f;},getAttribute:function(_10){return this.attributes[_10];},addParam:function(_11,_12){this.params[_11]=_12;},getParams:function(){return this.params;},addVariable:function(_13,_14){this.variables[_13]=_14;},getVariable:function(_15){return this.variables[_15];},getVariables:function(){return this.variables;},getVariablePairs:function(){var _16=new Array();var key;var _18=this.getVariables();for(key in _18){_16[_16.length]=key+"="+_18[key];}return _16;},getSWFHTML:function(){var _19="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","PlugIn");this.setAttribute("swf",this.xiSWFPath);}_19="<embeddisabled type=\"application/x-shockwave-flash\" src=\""+this.getAttribute("swf")+"\" width=\""+this.getAttribute("width")+"\" height=\""+this.getAttribute("height")+"\" style=\""+this.getAttribute("style")+"\"";_19+=" id=\""+this.getAttribute("id")+"\" name=\""+this.getAttribute("id")+"\" ";var _1a=this.getParams();for(var key in _1a){_19+=[key]+"=\""+_1a[key]+"\" ";}var _1c=this.getVariablePairs().join("&");if(_1c.length>0){_19+="flashvars=\""+_1c+"\"";}_19+="/>";}else{if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","ActiveX");this.setAttribute("swf",this.xiSWFPath);}_19="<objectdisabled id=\""+this.getAttribute("id")+"\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" width=\""+this.getAttribute("width")+"\" height=\""+this.getAttribute("height")+"\" style=\""+this.getAttribute("style")+"\">";_19+="<param name=\"movie\" value=\""+this.getAttribute("swf")+"\" />";var _1d=this.getParams();for(var key in _1d){_19+="<param name=\""+key+"\" value=\""+_1d[key]+"\" />";}var _1f=this.getVariablePairs().join("&");if(_1f.length>0){_19+="<param name=\"flashvars\" value=\""+_1f+"\" />";}_19+="</object>";}return _19;}void:function(_20){if(this.getAttribute("useExpressInstall")){var _21=new deconcept.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(_21)&&!this.installedVer.versionIsValid(this.getAttribute("version"))){this.setAttribute("doExpressInstall",true);this.addVariable("MMredirectURL",escape(this.getAttribute("xiRedirectUrl")));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title);}}if(this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))){var n=(typeof _20=="string")?document.getElementById(_20):_20;n.innerHTML=this.getSWFHTML();return true;}else{if(this.getAttribute("redirectUrl")!=""){document.location.replace(this.getAttribute("redirectUrl"));}}return false;}};deconcept.SWFObjectUtil.getPlayerVersion=function(){var _23=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var x=navigator.plugins["Shockwave Flash"];if(x&&x.description){_23=new deconcept.PlayerVersion(x.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."));}}else{if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var axo=1;var _26=3;while(axo){try{_26++;axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+_26);_23=new deconcept.PlayerVersion([_26,0,0]);}catch(e){axo=null;}}}else{try{var axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");}catch(e){try{var axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");_23=new deconcept.PlayerVersion([6,0,21]);axo.AllowScriptAccess="always";}catch(e){if(_23.major==6){return _23;}}try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");}catch(e){}}if(axo!=null){_23=new deconcept.PlayerVersion(axo.GetVariable("$version").split(" ")[1].split(","));}}}return _23;};deconcept.PlayerVersion=function(_29){this.major=_29[0]!=null?parseInt(_29[0]):0;this.minor=_29[1]!=null?parseInt(_29[1]):0;this.rev=_29[2]!=null?parseInt(_29[2]):0;};deconcept.PlayerVersion.prototype.versionIsValid=function(fv){if(this.major<fv.major){return false;}if(this.major>fv.major){return true;}if(this.minor<fv.minor){return false;}if(this.minor>fv.minor){return true;}if(this.rev<fv.rev){return false;}return true;};deconcept.util={getRequestParameter:function(_2b){var q=document.location.search||document.location.hash;if(_2b==null){return q;}if(q){var _2d=q.substring(1).split("&");for(var i=0;i<_2d.length;i++){if(_2d[i].substring(0,_2d[i].indexOf("="))==_2b){return _2d[i].substring((_2d[i].indexOf("=")+1));}}}return "";}};deconcept.SWFObjectUtil.cleanupSWFs=function(){var _2f=document.getElementsByTagName("OBJECT");for(var i=_2f.length-1;i>=0;i--){_2f[i].style.display="none";for(var x in _2f[i]){if(typeof _2f[i][x]=="function"){_2f[i][x]=function(){};}}}};if(deconcept.SWFObject.doPrepUnloaddisabled){if(!deconcept.unloaddisabledSet){deconcept.SWFObjectUtil.prepUnloaddisabled=function(){__flash_unloaddisabledHandler=function(){};__flash_savedUnloaddisabledHandler=function(){};window.attachEvent("onunloaddisabled",deconcept.SWFObjectUtil.cleanupSWFs);};window.attachEvent("onbeforeunloaddisabled",deconcept.SWFObjectUtil.prepUnloaddisabled);deconcept.unloaddisabledSet=true;}}if(!document.getElementById&&document.all){document.getElementById=function(id){return document.all[id];};}var getQueryParamValue=deconcept.util.getRequestParameter;var FlashObject=deconcept.SWFObject;var SWFObject=deconcept.SWFObject;/*  SWFObject v2.2 <http://code.google.com/p/swfobject/>
  is released under the MIT License <http://voidsource.org/licenses/mit-license.php>
*/
dojo.provide("swfobject.swfobject_2_2.swfobject");

swfobject = function() {
	
	var UNDEF = "undefined",
		OBJECT = "object",
		SHOCKWAVE_FLASH = "Shockwave Flash",
		SHOCKWAVE_FLASH_AX = "ShockwaveFlash.ShockwaveFlash",
		FLASH_MIME_TYPE = "application/x-shockwave-flash",
		EXPRESS_INSTALL_ID = "SWFObjectExprInst",
		ON_READY_STATE_CHANGE = "onreadystatechange",
		
		win = window,
		doc = document,
		nav = navigator,
		
		plugin = false,
		domLoadFnArr = [main],
		regObjArr = [],
		objIdArr = [],
		listenersArr = [],
		storedAltContent,
		storedAltContentId,
		storedCallbackFn,
		storedCallbackObj,
    isInitDelayed = true,
		isDomLoaded = isInitDelayed,
		isExpressInstallActive = false,
		dynamicStylesheet,
		dynamicStylesheetMedia,
		autoHideShow = true,
	
	/* Centralized function for browser feature detection
		- User agent string detection is only used when no good alternative is possible
		- Is executed directly for optimal performance
	*/	
	ua = function() {
		var w3cdom = typeof doc.getElementById != UNDEF && typeof doc.getElementsByTagName != UNDEF && typeof doc.createElement != UNDEF,
			u = nav.userAgent.toLowerCase(),
			p = nav.platform.toLowerCase(),
			windows = p ? /win/.test(p) : /win/.test(u),
			mac = p ? /mac/.test(p) : /mac/.test(u),
			webkit = /webkit/.test(u) ? parseFloat(u.replace(/^.*webkit\/(\d+(\.\d+)?).*$/, "$1")) : false, // returns either the webkit version or false if not webkit
			ie = !+"\v1", // feature detection based on Andrea Giammarchi's solution: http://webreflection.blogspot.com/2009/01/32-bytes-to-know-if-your-browser-is-ie.html
			playerVersion = [0,0,0],
			d = null;
		if (typeof nav.plugins != UNDEF && typeof nav.plugins[SHOCKWAVE_FLASH] == OBJECT) {
			d = nav.plugins[SHOCKWAVE_FLASH].description;
			if (d && !(typeof nav.mimeTypes != UNDEF && nav.mimeTypes[FLASH_MIME_TYPE] && !nav.mimeTypes[FLASH_MIME_TYPE].enabledPlugin)) { // navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin indicates whether plug-ins are enabled or disabled in Safari 3+
				plugin = true;
				ie = false; // cascaded feature detection for Internet Explorer
				d = d.replace(/^.*\s+(\S+\s+\S+$)/, "$1");
				playerVersion[0] = parseInt(d.replace(/^(.*)\..*$/, "$1"), 10);
				playerVersion[1] = parseInt(d.replace(/^.*\.(.*)\s.*$/, "$1"), 10);
				playerVersion[2] = /[a-zA-Z]/.test(d) ? parseInt(d.replace(/^.*[a-zA-Z]+(.*)$/, "$1"), 10) : 0;
			}
		}
		else if (typeof win.ActiveXObject != UNDEF) {
			try {
				var a = new ActiveXObject(SHOCKWAVE_FLASH_AX);
				if (a) { // a will return null when ActiveX is disabled
					d = a.GetVariable("$version");
					if (d) {
						ie = true; // cascaded feature detection for Internet Explorer
						d = d.split(" ")[1].split(",");
						playerVersion = [parseInt(d[0], 10), parseInt(d[1], 10), parseInt(d[2], 10)];
					}
				}
			}
			catch(e) {}
		}
		return { w3:w3cdom, pv:playerVersion, wk:webkit, ie:ie, win:windows, mac:mac };
	}(),
	
	/* Cross-browser onDomLoad
		- Will fire an event as soon as the DOM of a web page is loaddisableded
		- Internet Explorer workaround based on Diego Perini's solution: http://javascript.nwbox.com/IEContentLoaded/
		- Regular onloaddisabled serves as fallback
	*/ 
	onDomLoad = function() {
		if (!ua.w3) { return; }
		if ((typeof doc.readyState != UNDEF && doc.readyState == "complete") || (typeof doc.readyState == UNDEF && (doc.getElementsByTagName("body")[0] || doc.body))) { // function is fired after onloaddisabled, e.g. when script is inserted dynamically 
			callDomLoadFunctions();
		}
		if (!isDomLoaded) {
			if (typeof doc.addEventListener != UNDEF) {
				doc.addEventListener("DOMContentLoaded", callDomLoadFunctions, false);
			}		
			if (ua.ie && ua.win) {
				doc.attachEvent(ON_READY_STATE_CHANGE, function() {
					if (doc.readyState == "complete") {
						doc.detachEvent(ON_READY_STATE_CHANGE, arguments.callee);
						callDomLoadFunctions();
					}
				});
				if (win == top) { // if not inside an iframe
					(function(){
						if (isDomLoaded) { return; }
						try {
							doc.documentElement.doScroll("left");
						}
						catch(e) {
							setTimeout(arguments.callee, 0);
							return;
						}
						callDomLoadFunctions();
					})();
				}
			}
			if (ua.wk) {
				(function(){
					if (isDomLoaded) { return; }
					if (!/loaddisableded|complete/.test(doc.readyState)) {
						setTimeout(arguments.callee, 0);
						return;
					}
					callDomLoadFunctions();
				})();
			}
			addLoadEvent(callDomLoadFunctions);
		}
	}();
	
	function callDomLoadFunctions() {
		if (isDomLoaded) { return; }
		try { // test if we can really add/remove elements to/from the DOM; we don't want to fire it too early
			var t = doc.getElementsByTagName("body")[0].appendChild(createElement("span"));
			t.parentNode.removeChild(t);
		}
		catch (e) { return; }
		isDomLoaded = true;
		var dl = domLoadFnArr.length;
		for (var i = 0; i < dl; i++) {
			domLoadFnArr[i]();
		}
	}
	
	function addDomLoadEvent(fn) {
		if (isDomLoaded) {
			fn();
		}
		else { 
			domLoadFnArr[domLoadFnArr.length] = fn; // Array.push() is only available in IE5.5+
		}
	}
	
	/* Cross-browser onloaddisabled
		- Based on James Edwards' solution: http://brothercake.com/site/resources/scripts/onloaddisabled/
		- Will fire an event as soon as a web page including all of its assets are loaddisableded 
	 */
	function addLoadEvent(fn) {
		if (typeof win.addEventListener != UNDEF) {
			win.addEventListener("loaddisabled", fn, false);
		}
		else if (typeof doc.addEventListener != UNDEF) {
			doc.addEventListener("loaddisabled", fn, false);
		}
		else if (typeof win.attachEvent != UNDEF) {
			addListener(win, "onloaddisabled", fn);
		}
		else if (typeof win.onloaddisabled == "function") {
			var fnOld = win.onloaddisabled;
			win.onloaddisabled = function() {
				fnOld();
				fn();
			};
		}
		else {
			win.onloaddisabled = fn;
		}
	}
	
	/* Main function
		- Will preferably execute onDomLoad, otherwise onloaddisabled (as a fallback)
	*/
	function main() { 
		if (plugin) {
			testPlayerVersion();
		}
		else {
			matchVersions();
		}
	}
	
	/* Detect the Flash Player version for non-Internet Explorer browsers
		- Detecting the plug-in version via the object element is more precise than using the plugins collection item's description:
		  a. Both release and build numbers can be detected
		  b. Avoid wrong descriptions by corrupt installers provided by Adobe
		  c. Avoid wrong descriptions by multiple Flash Player entries in the plugin Array, caused by incorrect browser imports
		- Disadvantage of this method is that it depends on the availability of the DOM, while the plugins collection is immediately available
	*/
	function testPlayerVersion() {
		var b = doc.getElementsByTagName("body")[0];
		var o = createElement(OBJECT);
		o.setAttribute("type", FLASH_MIME_TYPE);
		var t = b.appendChild(o);
		if (t) {
			var counter = 0;
			(function(){
				if (typeof t.GetVariable != UNDEF) {
					var d = t.GetVariable("$version");
					if (d) {
						d = d.split(" ")[1].split(",");
						ua.pv = [parseInt(d[0], 10), parseInt(d[1], 10), parseInt(d[2], 10)];
					}
				}
				else if (counter < 10) {
					counter++;
					setTimeout(arguments.callee, 10);
					return;
				}
				b.removeChild(o);
				t = null;
				matchVersions();
			})();
		}
		else {
			matchVersions();
		}
	}
	
	/* Perform Flash Player and SWF version matching; static publishing only
	*/
	function matchVersions() {
		var rl = regObjArr.length;
		if (rl > 0) {
			for (var i = 0; i < rl; i++) { // for each registered object element
				var id = regObjArr[i].id;
				var cb = regObjArr[i].callbackFn;
				var cbObj = {success:false, id:id};
				if (ua.pv[0] > 0) {
					var obj = getElementById(id);
					if (obj) {
						if (hasPlayerVersion(regObjArr[i].swfVersion) && !(ua.wk && ua.wk < 312)) { // Flash Player version >= published SWF version: Houston, we have a match!
							setVisibility(id, true);
							if (cb) {
								cbObj.success = true;
								cbObj.ref = getObjectById(id);
								cb(cbObj);
							}
						}
						else if (regObjArr[i].expressInstall && canExpressInstall()) { // show the Adobe Express Install dialog if set by the web page author and if supported
							var att = {};
							att.data = regObjArr[i].expressInstall;
							att.width = obj.getAttribute("width") || "0";
							att.height = obj.getAttribute("height") || "0";
							if (obj.getAttribute("class")) { att.styleclass = obj.getAttribute("class"); }
							if (obj.getAttribute("align")) { att.align = obj.getAttribute("align"); }
							// parse HTML object param element's name-value pairs
							var par = {};
							var p = obj.getElementsByTagName("param");
							var pl = p.length;
							for (var j = 0; j < pl; j++) {
								if (p[j].getAttribute("name").toLowerCase() != "movie") {
									par[p[j].getAttribute("name")] = p[j].getAttribute("value");
								}
							}
							showExpressInstall(att, par, id, cb);
						}
						else { // Flash Player and SWF version mismatch or an older Webkit engine that ignores the HTML object element's nested param elements: display alternative content instead of SWF
							displayAltContent(obj);
							if (cb) { cb(cbObj); }
						}
					}
				}
				else {	// if no Flash Player is installed or the fp version cannot be detected we let the HTML object element do its job (either show a SWF or alternative content)
					setVisibility(id, true);
					if (cb) {
						var o = getObjectById(id); // test whether there is an HTML object element or not
						if (o && typeof o.SetVariable != UNDEF) { 
							cbObj.success = true;
							cbObj.ref = o;
						}
						cb(cbObj);
					}
				}
			}
		}
	}
	
	function getObjectById(objectIdStr) {
		var r = null;
		var o = getElementById(objectIdStr);
		if (o && o.nodeName == "OBJECT") {
			if (typeof o.SetVariable != UNDEF) {
				r = o;
			}
			else {
				var n = o.getElementsByTagName(OBJECT)[0];
				if (n) {
					r = n;
				}
			}
		}
		return r;
	}
	
	/* Requirements for Adobe Express Install
		- only one instance can be active at a time
		- fp 6.0.65 or higher
		- Win/Mac OS only
		- no Webkit engines older than version 312
	*/
	function canExpressInstall() {
		return !isExpressInstallActive && hasPlayerVersion("6.0.65") && (ua.win || ua.mac) && !(ua.wk && ua.wk < 312);
	}
	
	/* Show the Adobe Express Install dialog
		- Reference: http://www.adobe.com/cfusion/knowledgebase/index.cfm?id=6a253b75
	*/
	function showExpressInstall(att, par, replaceElemIdStr, callbackFn) {
		isExpressInstallActive = true;
		storedCallbackFn = callbackFn || null;
		storedCallbackObj = {success:false, id:replaceElemIdStr};
		var obj = getElementById(replaceElemIdStr);
		if (obj) {
			if (obj.nodeName == "OBJECT") { // static publishing
				storedAltContent = abstractAltContent(obj);
				storedAltContentId = null;
			}
			else { // dynamic publishing
				storedAltContent = obj;
				storedAltContentId = replaceElemIdStr;
			}
			att.id = EXPRESS_INSTALL_ID;
			if (typeof att.width == UNDEF || (!/%$/.test(att.width) && parseInt(att.width, 10) < 310)) { att.width = "310"; }
			if (typeof att.height == UNDEF || (!/%$/.test(att.height) && parseInt(att.height, 10) < 137)) { att.height = "137"; }
			doc.title = doc.title.slice(0, 47) + " - Flash Player Installation";
			var pt = ua.ie && ua.win ? "ActiveX" : "PlugIn",
				fv = "MMredirectURL=" + win.location.toString().replace(/&/g,"%26") + "&MMplayerType=" + pt + "&MMdoctitle=" + doc.title;
			if (typeof par.flashvars != UNDEF) {
				par.flashvars += "&" + fv;
			}
			else {
				par.flashvars = fv;
			}
			// IE only: when a SWF is loaddisableding (AND: not available in cache) wait for the readyState of the object element to become 4 before removing it,
			// because you cannot properly cancel a loaddisableding SWF file without breaking browser loaddisabled references, also obj.onreadystatechange doesn't work
			if (ua.ie && ua.win && obj.readyState != 4) {
				var newObj = createElement("div");
				replaceElemIdStr += "SWFObjectNew";
				newObj.setAttribute("id", replaceElemIdStr);
				obj.parentNode.insertBefore(newObj, obj); // insert placeholder div that will be replaced by the object element that loaddisableds expressinstall.swf
				obj.style.display = "none";
				(function(){
					if (obj.readyState == 4) {
						obj.parentNode.removeChild(obj);
					}
					else {
						setTimeout(arguments.callee, 10);
					}
				})();
			}
			createSWF(att, par, replaceElemIdStr);
		}
	}
	
	/* Functions to abstract and display alternative content
	*/
	function displayAltContent(obj) {
		if (ua.ie && ua.win && obj.readyState != 4) {
			// IE only: when a SWF is loaddisableding (AND: not available in cache) wait for the readyState of the object element to become 4 before removing it,
			// because you cannot properly cancel a loaddisableding SWF file without breaking browser loaddisabled references, also obj.onreadystatechange doesn't work
			var el = createElement("div");
			obj.parentNode.insertBefore(el, obj); // insert placeholder div that will be replaced by the alternative content
			el.parentNode.replaceChild(abstractAltContent(obj), el);
			obj.style.display = "none";
			(function(){
				if (obj.readyState == 4) {
					obj.parentNode.removeChild(obj);
				}
				else {
					setTimeout(arguments.callee, 10);
				}
			})();
		}
		else {
			obj.parentNode.replaceChild(abstractAltContent(obj), obj);
		}
	} 

	function abstractAltContent(obj) {
		var ac = createElement("div");
		if (ua.win && ua.ie) {
			ac.innerHTML = obj.innerHTML;
		}
		else {
			var nestedObj = obj.getElementsByTagName(OBJECT)[0];
			if (nestedObj) {
				var c = nestedObj.childNodes;
				if (c) {
					var cl = c.length;
					for (var i = 0; i < cl; i++) {
						if (!(c[i].nodeType == 1 && c[i].nodeName == "PARAM") && !(c[i].nodeType == 8)) {
							ac.appendChild(c[i].cloneNode(true));
						}
					}
				}
			}
		}
		return ac;
	}
	
	/* Cross-browser dynamic SWF creation
	*/
	function createSWF(attObj, parObj, id) {
		var r, el = getElementById(id);
		if (ua.wk && ua.wk < 312) { return r; }
		if (el) {
			if (typeof attObj.id == UNDEF) { // if no 'id' is defined for the object element, it will inherit the 'id' from the alternative content
				attObj.id = id;
			}
			if (ua.ie && ua.win) { // Internet Explorer + the HTML object element + W3C DOM methods do not combine: fall back to outerHTML
				var att = "";
				for (var i in attObj) {
					if (attObj[i] != Object.prototype[i]) { // filter out prototype additions from other potential libraries
						if (i.toLowerCase() == "data") {
							parObj.movie = attObj[i];
						}
						else if (i.toLowerCase() == "styleclass") { // 'class' is an ECMA4 reserved keyword
							att += ' class="' + attObj[i] + '"';
						}
						else if (i.toLowerCase() != "classid") {
							att += ' ' + i + '="' + attObj[i] + '"';
						}
					}
				}
				var par = "";
				for (var j in parObj) {
					if (parObj[j] != Object.prototype[j]) { // filter out prototype additions from other potential libraries
						par += '<param name="' + j + '" value="' + parObj[j] + '" />';
					}
				}
				el.outerHTML = '<objectdisabled classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"' + att + '>' + par + '</object>';
				objIdArr[objIdArr.length] = attObj.id; // stored to fix object 'leaks' on unloaddisabled (dynamic publishing only)
				r = getElementById(attObj.id);	
			}
			else { // well-behaving browsers
				var o = createElement(OBJECT);
				o.setAttribute("type", FLASH_MIME_TYPE);
				for (var m in attObj) {
					if (attObj[m] != Object.prototype[m]) { // filter out prototype additions from other potential libraries
						if (m.toLowerCase() == "styleclass") { // 'class' is an ECMA4 reserved keyword
							o.setAttribute("class", attObj[m]);
						}
						else if (m.toLowerCase() != "classid") { // filter out IE specific attribute
							o.setAttribute(m, attObj[m]);
						}
					}
				}
				for (var n in parObj) {
					if (parObj[n] != Object.prototype[n] && n.toLowerCase() != "movie") { // filter out prototype additions from other potential libraries and IE specific param element
						createObjParam(o, n, parObj[n]);
					}
				}
				el.parentNode.replaceChild(o, el);
				r = o;
			}
		}
		return r;
	}
	
	function createObjParam(el, pName, pValue) {
		var p = createElement("param");
		p.setAttribute("name", pName);	
		p.setAttribute("value", pValue);
		el.appendChild(p);
	}
	
	/* Cross-browser SWF removal
		- Especially needed to safely and completely remove a SWF in Internet Explorer
	*/
	function removeSWF(id) {
		var obj = getElementById(id);
		if (obj && obj.nodeName == "OBJECT") {
			if (ua.ie && ua.win) {
				obj.style.display = "none";
				(function(){
					if (obj.readyState == 4) {
						removeObjectInIE(id);
					}
					else {
						setTimeout(arguments.callee, 10);
					}
				})();
			}
			else {
				obj.parentNode.removeChild(obj);
			}
		}
	}
	
	function removeObjectInIE(id) {
		var obj = getElementById(id);
		if (obj) {
			for (var i in obj) {
				if (typeof obj[i] == "function") {
					obj[i] = null;
				}
			}
			obj.parentNode.removeChild(obj);
		}
	}
	
	/* Functions to optimize JavaScript compression
	*/
	function getElementById(id) {
		var el = null;
		try {
			el = doc.getElementById(id);
		}
		catch (e) {}
		return el;
	}
	
	function createElement(el) {
		return doc.createElement(el);
	}
	
	/* Updated attachEvent function for Internet Explorer
		- Stores attachEvent information in an Array, so on unloaddisabled the detachEvent functions can be called to avoid memory leaks
	*/	
	function addListener(target, eventType, fn) {
		target.attachEvent(eventType, fn);
		listenersArr[listenersArr.length] = [target, eventType, fn];
	}
	
	/* Flash Player and SWF content version matching
	*/
	function hasPlayerVersion(rv) {
		var pv = ua.pv, v = rv.split(".");
		v[0] = parseInt(v[0], 10);
		v[1] = parseInt(v[1], 10) || 0; // supports short notation, e.g. "9" instead of "9.0.0"
		v[2] = parseInt(v[2], 10) || 0;
		return (pv[0] > v[0] || (pv[0] == v[0] && pv[1] > v[1]) || (pv[0] == v[0] && pv[1] == v[1] && pv[2] >= v[2])) ? true : false;
	}
	
	/* Cross-browser dynamic CSS creation
		- Based on Bobby van der Sluis' solution: http://www.bobbyvandersluis.com/articles/dynamicCSS.php
	*/	
	function createCSS(sel, decl, media, newStyle) {
		if (ua.ie && ua.mac) { return; }
		var h = doc.getElementsByTagName("head")[0];
		if (!h) { return; } // to also support badly authored HTML pages that lack a head element
		var m = (media && typeof media == "string") ? media : "screen";
		if (newStyle) {
			dynamicStylesheet = null;
			dynamicStylesheetMedia = null;
		}
		if (!dynamicStylesheet || dynamicStylesheetMedia != m) { 
			// create dynamic stylesheet + get a global reference to it
			var s = createElement("style");
			s.setAttribute("type", "text/css");
			s.setAttribute("media", m);
			dynamicStylesheet = h.appendChild(s);
			if (ua.ie && ua.win && typeof doc.styleSheets != UNDEF && doc.styleSheets.length > 0) {
				dynamicStylesheet = doc.styleSheets[doc.styleSheets.length - 1];
			}
			dynamicStylesheetMedia = m;
		}
		// add style rule
		if (ua.ie && ua.win) {
			if (dynamicStylesheet && typeof dynamicStylesheet.addRule == OBJECT) {
				dynamicStylesheet.addRule(sel, decl);
			}
		}
		else {
			if (dynamicStylesheet && typeof doc.createTextNode != UNDEF) {
				dynamicStylesheet.appendChild(doc.createTextNode(sel + " {" + decl + "}"));
			}
		}
	}
	
	function setVisibility(id, isVisible) {
		if (!autoHideShow) { return; }
		var v = isVisible ? "visible" : "hidden";
		if (isDomLoaded && getElementById(id)) {
			getElementById(id).style.visibility = v;
		}
		else {
			createCSS("#" + id, "visibility:" + v);
		}
	}

	/* Filter to avoid XSS attacks
	*/
	function urlEncodeIfNecessary(s) {
		var regex = /[\\\"<>\.;]/;
		var hasBadChars = regex.exec(s) != null;
		return hasBadChars && typeof encodeURIComponent != UNDEF ? encodeURIComponent(s) : s;
	}
	
	/* Release memory to avoid memory leaks caused by closures, fix hanging audio/video threads and void sockets/NetConnections to disconnect (Internet Explorer only)
	*/
	var cleanup = function() {
		if (ua.ie && ua.win) {
			window.attachEvent("onunloaddisabled", function() {
				// remove listeners to avoid memory leaks
				var ll = listenersArr.length;
				for (var i = 0; i < ll; i++) {
					listenersArr[i][0].detachEvent(listenersArr[i][1], listenersArr[i][2]);
				}
				// cleanup dynamically embedded objects to fix audio/video threads and void sockets and NetConnections to disconnect
				var il = objIdArr.length;
				for (var j = 0; j < il; j++) {
					removeSWF(objIdArr[j]);
				}
				// cleanup library's main closures to avoid memory leaks
				for (var k in ua) {
					ua[k] = null;
				}
				ua = null;
				for (var l in swfobject) {
					swfobject[l] = null;
				}
				swfobject = null;
			});
		}
	}();
	
	var publicApi = {
		/* Public API
			- Reference: http://code.google.com/p/swfobject/wiki/documentation
		*/ 
		registerObject: function(objectIdStr, swfVersionStr, xiSwfUrlStr, callbackFn) {
			if (ua.w3 && objectIdStr && swfVersionStr) {
				var regObj = {};
				regObj.id = objectIdStr;
				regObj.swfVersion = swfVersionStr;
				regObj.expressInstall = xiSwfUrlStr;
				regObj.callbackFn = callbackFn;
				regObjArr[regObjArr.length] = regObj;
				setVisibility(objectIdStr, false);
			}
			else if (callbackFn) {
				callbackFn({success:false, id:objectIdStr});
			}
		},
		
		getObjectById: function(objectIdStr) {
			if (ua.w3) {
				return getObjectById(objectIdStr);
			}
		},
		
		embedSWF: function(swfUrlStr, replaceElemIdStr, widthStr, heightStr, swfVersionStr, xiSwfUrlStr, flashvarsObj, parObj, attObj, callbackFn) {
			var callbackObj = {success:false, id:replaceElemIdStr};
			if (ua.w3 && !(ua.wk && ua.wk < 312) && swfUrlStr && replaceElemIdStr && widthStr && heightStr && swfVersionStr) {
				setVisibility(replaceElemIdStr, false);
				addDomLoadEvent(function() {
					widthStr += ""; // auto-convert to string
					heightStr += "";
					var att = {};
					if (attObj && typeof attObj === OBJECT) {
						for (var i in attObj) { // copy object to avoid the use of references, because web authors often reuse attObj for multiple SWFs
							att[i] = attObj[i];
						}
					}
					att.data = swfUrlStr;
					att.width = widthStr;
					att.height = heightStr;
					var par = {}; 
					if (parObj && typeof parObj === OBJECT) {
						for (var j in parObj) { // copy object to avoid the use of references, because web authors often reuse parObj for multiple SWFs
							par[j] = parObj[j];
						}
					}
					if (flashvarsObj && typeof flashvarsObj === OBJECT) {
						for (var k in flashvarsObj) { // copy object to avoid the use of references, because web authors often reuse flashvarsObj for multiple SWFs
							if (typeof par.flashvars != UNDEF) {
								par.flashvars += "&" + k + "=" + flashvarsObj[k];
							}
							else {
								par.flashvars = k + "=" + flashvarsObj[k];
							}
						}
					}
					if (hasPlayerVersion(swfVersionStr)) { // create SWF
						var obj = createSWF(att, par, replaceElemIdStr);
						if (att.id == replaceElemIdStr) {
							setVisibility(replaceElemIdStr, true);
						}
						callbackObj.success = true;
						callbackObj.ref = obj;
					}
					else if (xiSwfUrlStr && canExpressInstall()) { // show Adobe Express Install
						att.data = xiSwfUrlStr;
						showExpressInstall(att, par, replaceElemIdStr, callbackFn);
						return;
					}
					else { // show alternative content
						setVisibility(replaceElemIdStr, true);
					}
					if (callbackFn) { callbackFn(callbackObj); }
				});
			}
			else if (callbackFn) { callbackFn(callbackObj);	}
		},
		
		switchOffAutoHideShow: function() {
			autoHideShow = false;
		},
		
		ua: ua,
		
		getFlashPlayerVersion: function() {
			return { major:ua.pv[0], minor:ua.pv[1], release:ua.pv[2] };
		},
		
		hasFlashPlayerVersion: hasPlayerVersion,
		
		createSWF: function(attObj, parObj, replaceElemIdStr) {
			if (ua.w3) {
				return createSWF(attObj, parObj, replaceElemIdStr);
			}
			else {
				return undefined;
			}
		},
		
		showExpressInstall: function(att, par, replaceElemIdStr, callbackFn) {
			if (ua.w3 && canExpressInstall()) {
				showExpressInstall(att, par, replaceElemIdStr, callbackFn);
			}
		},
		
		removeSWF: function(objElemIdStr) {
			if (ua.w3) {
				removeSWF(objElemIdStr);
			}
		},
		
		createCSS: function(selStr, declStr, mediaStr, newStyleBoolean) {
			if (ua.w3) {
				createCSS(selStr, declStr, mediaStr, newStyleBoolean);
			}
		},
		
		addDomLoadEvent: addDomLoadEvent,
		
		addLoadEvent: addLoadEvent,
		
		getQueryParamValue: function(param) {
			var q = doc.location.search || doc.location.hash;
			if (q) {
				if (/\?/.test(q)) { q = q.split("?")[1]; } // strip question mark
				if (param == null) {
					return urlEncodeIfNecessary(q);
				}
				var pairs = q.split("&");
				for (var i = 0; i < pairs.length; i++) {
					if (pairs[i].substring(0, pairs[i].indexOf("=")) == param) {
						return urlEncodeIfNecessary(pairs[i].substring((pairs[i].indexOf("=") + 1)));
					}
				}
			}
			return "";
		},
		
		// For internal usage only
		expressInstallCallback: function() {
			if (isExpressInstallActive) {
				var obj = getElementById(EXPRESS_INSTALL_ID);
				if (obj && storedAltContent) {
					obj.parentNode.replaceChild(storedAltContent, obj);
					if (storedAltContentId) {
						setVisibility(storedAltContentId, true);
						if (ua.ie && ua.win) { storedAltContent.style.display = "block"; }
					}
					if (storedCallbackFn) { storedCallbackFn(storedCallbackObj); }
				}
				isExpressInstallActive = false;
			} 
		}
	};

  if (isInitDelayed) {
    var that = this,
        isInitialized = false;
    for (var fn in publicApi) {
      (function(oldFn) {
        if (typeof oldFn === "function") {
          publicApi[fn] = function() {
            if (!isInitialized) { 
              main();
              isInitialized = true;
            }
            return oldFn.apply(that, arguments);
          };
        }
      }(publicApi[fn]));
    }
  }

  return publicApi;
}();

dojo.provide('trimpath.TrimPath');
/**
 * TrimPath Template. Release 1.1.2.
 * Copyright (C) 2004 - 2007 TrimPath.
 *
 * TrimPath Template is licensed under the GNU General Public License
 * and the Apache License, Version 2.0, as follows:
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 *
 * This program is distributed WITHOUT ANY WARRANTY; without even the
 * implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 * See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not,void to the Free Software
 * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if (typeof(TrimPath) == 'undefined'){TrimPath = {};}

// TODO: Debugging mode vs stop-on-error mode - runtime flag.
// TODO: Handle || (or) characters and backslashes.
// TODO: Add more modifiers.

(function() {               // Using a closure to keep global namespace clean.
    if (TrimPath.evalEx == null){TrimPath.evalEx = function(src) { return eval(src); };}

    var UNDEFINED;
    if (Array.prototype.pop == null){Array.prototype.pop = function() {
        if (this.length === 0) {return UNDEFINED;}
        return this[--this.length];
    };}
    if (Array.prototype.push == null){Array.prototype.push = function() {
        for (var i = 0; i < arguments.length; ++i) {this[this.length] = arguments[i];}
        return this.length;
    };}

    TrimPath.parseTemplate = function(tmplContent, optTmplName, optEtc) {
        if (optEtc == null){optEtc = TrimPath.parseTemplate_etc;}
        var funcSrc = parse(tmplContent, optTmplName, optEtc);
        var func = TrimPath.evalEx(funcSrc, optTmplName, 1);
        if (func != null) {
          return new optEtc.Template(optTmplName, tmplContent, funcSrc, func, optEtc);
        }
        return null;
    }

    var exceptionDetails = function(e) {
        return (e.toString()) + ";\n " +
               (e.message) + ";\n " +
               (e.name) + ";\n " +
               (e.stack       || 'no stack trace') + ";\n " +
               (e.description || 'no further description') + ";\n " +
               (e.fileName    || 'no file name') + ";\n " +
               (e.lineNumber  || 'no line number');
    }

    try {
        String.prototype.process = function(context, optFlags) {
            var template = TrimPath.parseTemplate(this, null);
            if (template != null) {
              return template.process(context, optFlags);
            }
            return this;
        }
    } catch (e) { // Swallow exception, such as when String.prototype is sealed.
    }

    TrimPath.parseTemplate_etc = {};            // Exposed for extensibility.
    TrimPath.parseTemplate_etc.statementTag = "forelse|for|if|elseif|else|var|macro";
    TrimPath.parseTemplate_etc.statementDef = { // Lookup table for statement tags.
        "if"     : { delta:  1, prefix: "if (", suffix: ") {", paramMin: 1 },
        "else"   : { delta:  0, prefix: "} else {" },
        "elseif" : { delta:  0, prefix: "} else if (", suffix: ") {", paramDefault: "true" },
        "/if"    : { delta: -1, prefix: "}" },
        "for"    : { delta:  1, paramMin: 3,
                     prefixFunc : function(stmtParts, state, tmplName, etc) {
                        if (stmtParts[2] != "in") {
                          throw new etc.ParseError(tmplName, state.line, "bad for loop statement: " + stmtParts.join(' '));
                        }
                        var iterVar = stmtParts[1];
                        var listVar = "__LIST__" + iterVar;
                        return [ "var ", listVar, " = ", stmtParts[3], ";",
                             // Fix from Ross Shaull for hash looping, make sure that we have an array of loop lengths to treat like a stack.
                             "var __LENGTH_STACK__;",
                             "if (typeof(__LENGTH_STACK__) == 'undefined' || !__LENGTH_STACK__.length) __LENGTH_STACK__ = new Array();",
                             "__LENGTH_STACK__[__LENGTH_STACK__.length] = 0;", // Push a new for-loop onto the stack of loop lengths.
                             "if ((", listVar, ") != null) { ",
                             "var ", iterVar, "_ct = 0;",       // iterVar_ct variable, added by B. Bittman
                             "for (var ", iterVar, "_index in ", listVar, ") { ",
                             iterVar, "_ct++;",
                             "if (typeof(", listVar, "[", iterVar, "_index]) == 'function') {continue;}", // IE 5.x fix from Igor Poteryaev.
                             "__LENGTH_STACK__[__LENGTH_STACK__.length - 1]++;",
                             "var ", iterVar, " = ", listVar, "[", iterVar, "_index];" ].join("");
                     } },
        "forelse" : { delta:  0, prefix: "} } if (__LENGTH_STACK__[__LENGTH_STACK__.length - 1] == 0) { if (", suffix: ") {", paramDefault: "true" },
        "/for"    : { delta: -1, prefix: "} }; delete __LENGTH_STACK__[__LENGTH_STACK__.length - 1];" }, // Remove the just-finished for-loop from the stack of loop lengths.
        "var"     : { delta:  0, prefix: "var ", suffix: ";" },
        "macro"   : { delta:  1,
                      prefixFunc : function(stmtParts, state, tmplName, etc) {
                          var macroName = stmtParts[1].split('(')[0];
                          return [ "var ", macroName, " = function",
                                   stmtParts.slice(1).join(' ').substring(macroName.length),
                                   "{ var _OUT_arr = []; var _OUT = {void: function(m) { if (m) _OUT_arr.push(m); } }; " ].join('');
                     } },
        "/macro"  : { delta: -1, prefix: " return _OUT_arr.join(''); };" }
    }
    TrimPath.parseTemplate_etc.modifierDef = {
        "eat"        : function(v)    { return ""; },
        "escape"     : function(s)    { return String(s).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;"); },
        "capitalize" : function(s)    { return String(s).toUpperCase(); },
        "default"    : function(s, d) { return s != null ? s : d; }
    }
    TrimPath.parseTemplate_etc.modifierDef.h = TrimPath.parseTemplate_etc.modifierDef.escape;

    TrimPath.parseTemplate_etc.Template = function(tmplName, tmplContent, funcSrc, func, etc) {
        this.process = function(context, flags) {
            if (context == null){context = {};}
            if (context._MODIFIERS == null){context._MODIFIERS = {};}
            if (context.defined == null){context.defined = function(str) { return (context[str] != undefined); };}
            for (var k in etc.modifierDef) {
                if (context._MODIFIERS[k] == null){context._MODIFIERS[k] = etc.modifierDef[k];}
            }
            if (flags == null){flags = {};}
            var resultArr = [];
            var resultOut = {void: function(m) { resultArr.push(m); } };
            try {
                func(resultOut, context, flags);
            } catch (e) {
                if (flags.throwExceptions == true) {
                  throw e;
                }
                var result = new String(resultArr.join("") +
                    "[ERROR: template: <pre>" + exceptionDetails(e) + "</pre>]");
                result["exception"] = e;
                return result;
            }
            return resultArr.join("");
        }
        this.name       = tmplName;
        this.source     = tmplContent;
        this.sourceFunc = funcSrc;
        this.toString   = function() { return "TrimPath.Template [" + tmplName + "]"; }
    }
    TrimPath.parseTemplate_etc.ParseError = function(name, line, message) {
        this.name    = name;
        this.line    = line;
        this.message = message;
    }
    TrimPath.parseTemplate_etc.ParseError.prototype.toString = function() {
        return ("TrimPath template ParseError in " + this.name + ": line " + this.line + ", " + this.message);
    }

    var parse = function(body, tmplName, etc) {
        body = cleanWhiteSpace(body);
        var funcText = [ "var TrimPath_Template_TEMP = function(_OUT, _CONTEXT, _FLAGS) { with (_CONTEXT) {" ];
        var state    = { stack: [], line: 1 };                              // TODO: Fix line number counting.
        var endStmtPrev = -1;
        while (endStmtPrev + 1 < body.length) {
            var begStmt = endStmtPrev;
            // Scan until we find some statement markup.
            begStmt = body.indexOf("{", begStmt + 1);
            while (begStmt >= 0) {
                var endStmt = body.indexOf('}', begStmt + 1);
                var stmt = body.substring(begStmt, endStmt);
                var blockrx = stmt.match(/^\{(cdata|minify|eval)/); // From B. Bittman, minify/eval/cdata implementation.
                if (blockrx) {
                    var blockType = blockrx[1];
                    var blockMarkerBeg = begStmt + blockType.length + 1;
                    var blockMarkerEnd = body.indexOf('}', blockMarkerBeg);
                    if (blockMarkerEnd >= 0) {
                        var blockMarker;
                        if( blockMarkerEnd - blockMarkerBeg <= 0 ) {
                            blockMarker = "{/" + blockType + "}";
                        } else {
                            blockMarker = body.substring(blockMarkerBeg + 1, blockMarkerEnd);
                        }

                        var blockEnd = body.indexOf(blockMarker, blockMarkerEnd + 1);
                        if (blockEnd >= 0) {
                            emitSectionText(body.substring(endStmtPrev + 1, begStmt), funcText);

                            var blockText = body.substring(blockMarkerEnd + 1, blockEnd);
                            if (blockType == 'cdata') {
                                emitText(blockText, funcText);
                            } else if (blockType == 'minify') {
                                emitText(scrubWhiteSpace(blockText), funcText);
                            } else if (blockType == 'eval') {
                                if (blockText != null && blockText.length > 0){funcText.push('void( (function() { ' + blockText + ' })() );');}
                            }
                            begStmt = endStmtPrev = blockEnd + blockMarker.length - 1;
                        }
                    }
                } else if (body.charAt(begStmt - 1) != '$' &&               // Not an expression or backslashed,
                           body.charAt(begStmt - 1) != '\\') {              // so check if it is a statement tag.
                    var offset = (body.charAt(begStmt + 1) == '/' ? 2 : 1); // Close tags offset of 2 skips '/'.
                                                                            // 10 is larger than maximum statement tag length.
                    if (body.substring(begStmt + offset, begStmt + 10 + offset).search(TrimPath.parseTemplate_etc.statementTag) == 0) {
                      break;                                              // Found a match.
                    }
                }
                begStmt = body.indexOf("{", begStmt + 1);
            }
            if (begStmt < 0) {
              break;
            }
            var endStmt = body.indexOf("}", begStmt + 1); // In "a{for}c", endStmt will be 5.
            if (endStmt < 0) {
              break;
            }
            emitSectionText(body.substring(endStmtPrev + 1, begStmt), funcText);
            emitStatement(body.substring(begStmt, endStmt + 1), state, funcText, tmplName, etc);
            endStmtPrev = endStmt;
        }
        emitSectionText(body.substring(endStmtPrev + 1), funcText);
        if (state.stack.length != 0) {
          throw new etc.ParseError(tmplName, state.line, "unclosed, unmatched statement(s): " + state.stack.join(","));
        }
        funcText.push("}}; TrimPath_Template_TEMP");
        return funcText.join("");
    }

    var emitStatement = function(stmtStr, state, funcText, tmplName, etc) {
        var parts = stmtStr.slice(1, -1).split(' ');
        var stmt = etc.statementDef[parts[0]]; // Here, parts[0] == for/if/else/...
        if (stmt == null) {                    // Not a real statement.
            emitSectionText(stmtStr, funcText);
            return;
        }
        if (stmt.delta < 0) {
            if (state.stack.length <= 0) {
              throw new etc.ParseError(tmplName, state.line, "close tag does not match any previous statement: " + stmtStr);
            }
            state.stack.pop();
        }
        if (stmt.delta > 0){state.stack.push(stmtStr);}

        if (stmt.paramMin != null &&
            stmt.paramMin >= parts.length) {
          throw new etc.ParseError(tmplName, state.line, "statement needs more parameters: " + stmtStr);
        }
        if (stmt.prefixFunc != null){funcText.push(stmt.prefixFunc(parts, state, tmplName, etc));} else {funcText.push(stmt.prefix);}
        if (stmt.suffix != null) {
            if (parts.length <= 1) {
                if (stmt.paramDefault != null){funcText.push(stmt.paramDefault);}
            } else {
                for (var i = 1; i < parts.length; i++) {
                    if (i > 1){funcText.push(' ');}
                    funcText.push(parts[i]);
                }
            }
            funcText.push(stmt.suffix);
        }
    }

    var emitSectionText = function(text, funcText) {
        if (text.length <= 0) {
          return;
        }
        var nlPrefix = 0;               // Index to first non-newline in prefix.
        var nlSuffix = text.length - 1; // Index to first non-space/tab in suffix.
        while (nlPrefix < text.length && (text.charAt(nlPrefix) == '\n')){nlPrefix++;}
        while (nlSuffix >= 0 && (text.charAt(nlSuffix) == ' ' || text.charAt(nlSuffix) == '\t')){nlSuffix--;}
        if (nlSuffix < nlPrefix){nlSuffix = nlPrefix;}
        if (nlPrefix > 0) {
            funcText.push('if (_FLAGS.keepWhitespace == true) void("');
            var s = text.substring(0, nlPrefix).replace('\n', '\\n'); // A macro IE fix from BJessen.
            if (s.charAt(s.length - 1) == '\n'){s = s.substring(0, s.length - 1);}
            funcText.push(s);
            funcText.push('");');
        }
        var lines = text.substring(nlPrefix, nlSuffix + 1).split('\n');
        for (var i = 0; i < lines.length; i++) {
            emitSectionTextLine(lines[i], funcText);
            if (i < lines.length - 1){funcText.push('void("\\n");\n');}
        }
        if (nlSuffix + 1 < text.length) {
            funcText.push('if (_FLAGS.keepWhitespace == true) void("');
            var s = text.substring(nlSuffix + 1).replace('\n', '\\n');
            if (s.charAt(s.length - 1) == '\n'){s = s.substring(0, s.length - 1);}
            funcText.push(s);
            funcText.push('");');
        }
    }

    var emitSectionTextLine = function(line, funcText) {
        var endMarkPrev = '}';
        var endExprPrev = -1;
        while (endExprPrev + endMarkPrev.length < line.length) {
            var begMark = "${", endMark = "}";
            var begExpr = line.indexOf(begMark, endExprPrev + endMarkPrev.length); // In "a${b}c", begExpr == 1
            if (begExpr < 0) {
              break;
            }
            if (line.charAt(begExpr + 2) == '%') {
                begMark = "${%";
                endMark = "%}";
            }
            var endExpr = line.indexOf(endMark, begExpr + begMark.length);         // In "a${b}c", endExpr == 4;
            if (endExpr < 0) {
              break;
            }
            emitText(line.substring(endExprPrev + endMarkPrev.length, begExpr), funcText);
            // Example: exprs == 'firstName|default:"John Doe"|capitalize'.split('|')
            var exprArr = line.substring(begExpr + begMark.length, endExpr).replace(/\|\|/g, "#@@#").split('|');
            for (var k in exprArr) {
                if (exprArr[k].replace){exprArr[k] = exprArr[k].replace(/#@@#/g, '||');}
            }
            funcText.push('void(');
            emitExpression(exprArr, exprArr.length - 1, funcText);
            funcText.push(');');
            endExprPrev = endExpr;
            endMarkPrev = endMark;
        }
        emitText(line.substring(endExprPrev + endMarkPrev.length), funcText);
    }

    var emitText = function(text, funcText) {
        if (text == null ||
            text.length <= 0) {
          return;
        }
        text = text.replace(/\\/g, '\\\\');
        text = text.replace(/\n/g, '\\n');
        text = text.replace(/"/g,  '\\"');
        funcText.push('void("');
        funcText.push(text);
        funcText.push('");');
    }

    var emitExpression = function(exprArr, index, funcText) {
        // Ex: foo|a:x|b:y1,y2|c:z1,z2 is emitted as c(b(a(foo,x),y1,y2),z1,z2)
        var expr = exprArr[index]; // Ex: exprArr == [firstName,capitalize,default:"John Doe"]
        if (index <= 0) {          // Ex: expr    == 'default:"John Doe"'
            funcText.push(expr);
            return;
        }
        var parts = expr.split(':');
        funcText.push('_MODIFIERS["');
        funcText.push(parts[0]); // The parts[0] is a modifier function name, like capitalize.
        funcText.push('"](');
        emitExpression(exprArr, index - 1, funcText);
        if (parts.length > 1) {
            funcText.push(',');
            funcText.push(parts[1]);
        }
        funcText.push(')');
    }

    var cleanWhiteSpace = function(result) {
        result = result.replace(/\t/g,   "    ");
        result = result.replace(/\r\n/g, "\n");
        result = result.replace(/\r/g,   "\n");
        result = result.replace(/^(\s*\S*(\s+\S+)*)\s*$/, '$1'); // Right trim by Igor Poteryaev.
        return result;
    }

    var scrubWhiteSpace = function(result) {
        result = result.replace(/^\s+/g,   "");
        result = result.replace(/\s+$/g,   "");
        result = result.replace(/\s+/g,   " ");
        result = result.replace(/^(\s*\S*(\s+\S+)*)\s*$/, '$1'); // Right trim by Igor Poteryaev.
        return result;
    }

    // The DOM helper functions depend on DOM/DHTML, so they only work in a browser.
    // However, these are not considered core to the engine.
    //
    TrimPath.parseDOMTemplate = function(elementId, optDocument, optEtc) {
        if (optDocument == null){optDocument = document;}
        var element = optDocument.getElementById(elementId);
        var content = element.value;     // Like textarea.value.
        if (content == null){content = element.innerHTML; // Like textarea.innerHTML.
}
        content = content.replace(/&lt;/g, "<").replace(/&gt;/g, ">");
        return TrimPath.parseTemplate(content, elementId, optEtc);
    }

    TrimPath.processDOMTemplate = function(elementId, context, optFlags, optDocument, optEtc) {
        return TrimPath.parseDOMTemplate(elementId, optDocument, optEtc).process(context, optFlags);
    }
}) ();
dojo.provide("yui.yui-2.5.2");
if(typeof YAHOO=="undefined"||!YAHOO){var YAHOO={};}YAHOO.namespace=function(){var A=arguments,E=null,C,B,D;for(C=0;C<A.length;C=C+1){D=A[C].split(".");E=YAHOO;for(B=(D[0]=="YAHOO")?1:0;B<D.length;B=B+1){E[D[B]]=E[D[B]]||{};E=E[D[B]];}}return E;};YAHOO.log=function(D,A,C){var B=YAHOO.widget.Logger;if(B&&B.log){return B.log(D,A,C);}else{return false;}};YAHOO.register=function(A,E,D){var I=YAHOO.env.modules;if(!I[A]){I[A]={versions:[],builds:[]};}var B=I[A],H=D.version,G=D.build,F=YAHOO.env.listeners;B.name=A;B.version=H;B.build=G;B.versions.push(H);B.builds.push(G);B.mainClass=E;for(var C=0;C<F.length;C=C+1){F[C](B);}if(E){E.VERSION=H;E.BUILD=G;}else{YAHOO.log("mainClass is undefined for module "+A,"warn");}};YAHOO.env=YAHOO.env||{modules:[],listeners:[]};YAHOO.env.getVersion=function(A){return YAHOO.env.modules[A]||null;};YAHOO.env.ua=function(){var C={ie:0,opera:0,gecko:0,webkit:0,mobile:null,air:0};var B=navigator.userAgent,A;if((/KHTML/).test(B)){C.webkit=1;}A=B.match(/AppleWebKit\/([^\s]*)/);if(A&&A[1]){C.webkit=parseFloat(A[1]);if(/ Mobile\//.test(B)){C.mobile="Apple";}else{A=B.match(/NokiaN[^\/]*/);if(A){C.mobile=A[0];}}A=B.match(/AdobeAIR\/([^\s]*)/);if(A){C.air=A[0];}}if(!C.webkit){A=B.match(/Opera[\s\/]([^\s]*)/);if(A&&A[1]){C.opera=parseFloat(A[1]);A=B.match(/Opera Mini[^;]*/);if(A){C.mobile=A[0];}}else{A=B.match(/MSIE\s([^;]*)/);if(A&&A[1]){C.ie=parseFloat(A[1]);}else{A=B.match(/Gecko\/([^\s]*)/);if(A){C.gecko=1;A=B.match(/rv:([^\s\)]*)/);if(A&&A[1]){C.gecko=parseFloat(A[1]);}}}}}return C;}();(function(){YAHOO.namespace("util","widget","example");if("undefined"!==typeof YAHOO_config){var B=YAHOO_config.listener,A=YAHOO.env.listeners,D=true,C;if(B){for(C=0;C<A.length;C=C+1){if(A[C]==B){D=false;break;}}if(D){A.push(B);}}}})();YAHOO.lang=YAHOO.lang||{};(function(){var A=YAHOO.lang,C=["toString","valueOf"],B={isArray:function(D){if(D){return A.isNumber(D.length)&&A.isFunction(D.splice);}return false;},isBoolean:function(D){return typeof D==="boolean";},isFunction:function(D){return typeof D==="function";},isNull:function(D){return D===null;},isNumber:function(D){return typeof D==="number"&&isFinite(D);},isObject:function(D){return(D&&(typeof D==="object"||A.isFunction(D)))||false;},isString:function(D){return typeof D==="string";},isUndefined:function(D){return typeof D==="undefined";},_IEEnumFix:(YAHOO.env.ua.ie)?function(F,E){for(var D=0;D<C.length;D=D+1){var H=C[D],G=E[H];if(A.isFunction(G)&&G!=Object.prototype[H]){F[H]=G;}}}:function(){},extend:function(H,I,G){if(!I||!H){throw new Error("extend failed, please check that "+"all dependencies are included.");}var E=function(){};E.prototype=I.prototype;H.prototype=new E();H.prototype.constructor=H;H.superclass=I.prototype;if(I.prototype.constructor==Object.prototype.constructor){I.prototype.constructor=I;}if(G){for(var D in G){if(A.hasOwnProperty(G,D)){H.prototype[D]=G[D];}}A._IEEnumFix(H.prototype,G);}},augmentObject:function(H,G){if(!G||!H){throw new Error("Absorb failed, verify dependencies.");}var D=arguments,F,I,E=D[2];if(E&&E!==true){for(F=2;F<D.length;F=F+1){H[D[F]]=G[D[F]];}}else{for(I in G){if(E||!(I in H)){H[I]=G[I];}}A._IEEnumFix(H,G);}},augmentProto:function(G,F){if(!F||!G){throw new Error("Augment failed, verify dependencies.");}var D=[G.prototype,F.prototype];for(var E=2;E<arguments.length;E=E+1){D.push(arguments[E]);}A.augmentObject.apply(this,D);},dump:function(D,I){var F,H,K=[],L="{...}",E="f(){...}",J=", ",G=" => ";if(!A.isObject(D)){return D+"";}else{if(D instanceof Date||("nodeType"in D&&"tagName"in D)){return D;}else{if(A.isFunction(D)){return E;}}}I=(A.isNumber(I))?I:3;if(A.isArray(D)){K.push("[");for(F=0,H=D.length;F<H;F=F+1){if(A.isObject(D[F])){K.push((I>0)?A.dump(D[F],I-1):L);}else{K.push(D[F]);}K.push(J);}if(K.length>1){K.pop();}K.push("]");}else{K.push("{");for(F in D){if(A.hasOwnProperty(D,F)){K.push(F+G);if(A.isObject(D[F])){K.push((I>0)?A.dump(D[F],I-1):L);}else{K.push(D[F]);}K.push(J);}}if(K.length>1){K.pop();}K.push("}");}return K.join("");},substitute:function(S,E,L){var I,H,G,O,P,R,N=[],F,J="dump",M=" ",D="{",Q="}";for(;;){I=S.lastIndexOf(D);if(I<0){break;}H=S.indexOf(Q,I);if(I+1>=H){break;}F=S.substring(I+1,H);O=F;R=null;G=O.indexOf(M);if(G>-1){R=O.substring(G+1);O=O.substring(0,G);}P=E[O];if(L){P=L(O,P,R);}if(A.isObject(P)){if(A.isArray(P)){P=A.dump(P,parseInt(R,10));}else{R=R||"";var K=R.indexOf(J);if(K>-1){R=R.substring(4);}if(P.toString===Object.prototype.toString||K>-1){P=A.dump(P,parseInt(R,10));}else{P=P.toString();}}}else{if(!A.isString(P)&&!A.isNumber(P)){P="~-"+N.length+"-~";N[N.length]=F;}}S=S.substring(0,I)+P+S.substring(H+1);}for(I=N.length-1;I>=0;I=I-1){S=S.replace(new RegExp("~-"+I+"-~"),"{"+N[I]+"}","g");}return S;},trim:function(D){try{return D.replace(/^\s+|\s+$/g,"");}catch(E){return D;}},merge:function(){var G={},E=arguments;for(var F=0,D=E.length;F<D;F=F+1){A.augmentObject(G,E[F],true);}return G;},later:function(K,E,L,G,H){K=K||0;E=E||{};var F=L,J=G,I,D;if(A.isString(L)){F=E[L];}if(!F){throw new TypeError("method undefined");}if(!A.isArray(J)){J=[G];}I=function(){F.apply(E,J);};D=(H)?setInterval(I,K):setTimeout(I,K);return{interval:H,cancel:function(){if(this.interval){clearInterval(D);}else{clearTimeout(D);}}};},isValue:function(D){return(A.isObject(D)||A.isString(D)||A.isNumber(D)||A.isBoolean(D));}};A.hasOwnProperty=(Object.prototype.hasOwnProperty)?function(D,E){return D&&D.hasOwnProperty(E);}:function(D,E){return!A.isUndefined(D[E])&&D.constructor.prototype[E]!==D[E];};B.augmentObject(A,B,true);YAHOO.util.Lang=A;A.augment=A.augmentProto;YAHOO.augment=A.augmentProto;YAHOO.extend=A.extend;})();YAHOO.register("yahoo",YAHOO,{version:"2.5.2",build:"1076"});(function(){var B=YAHOO.util,K,I,J={},F={},M=window.document;YAHOO.env._id_counter=YAHOO.env._id_counter||0;var C=YAHOO.env.ua.opera,L=YAHOO.env.ua.webkit,A=YAHOO.env.ua.gecko,G=YAHOO.env.ua.ie;var E={HYPHEN:/(-[a-z])/i,ROOT_TAG:/^body|html$/i,OP_SCROLL:/^(?:inline|table-row)$/i};var N=function(P){if(!E.HYPHEN.test(P)){return P;}if(J[P]){return J[P];}var Q=P;while(E.HYPHEN.exec(Q)){Q=Q.replace(RegExp.$1,RegExp.$1.substr(1).toUpperCase());}J[P]=Q;return Q;};var O=function(Q){var P=F[Q];if(!P){P=new RegExp("(?:^|\\s+)"+Q+"(?:\\s+|$)");F[Q]=P;}return P;};if(M.defaultView&&M.defaultView.getComputedStyle){K=function(P,S){var R=null;if(S=="float"){S="cssFloat";}var Q=P.ownerDocument.defaultView.getComputedStyle(P,"");if(Q){R=Q[N(S)];}return P.style[S]||R;};}else{if(M.documentElement.currentStyle&&G){K=function(P,R){switch(N(R)){case"opacity":var T=100;try{T=P.filters["DXImageTransform.Microsoft.Alpha"].opacity;}catch(S){try{T=P.filters("alpha").opacity;}catch(S){}}return T/100;case"float":R="styleFloat";default:var Q=P.currentStyle?P.currentStyle[R]:null;return(P.style[R]||Q);}};}else{K=function(P,Q){return P.style[Q];};}}if(G){I=function(P,Q,R){switch(Q){case"opacity":if(YAHOO.lang.isString(P.style.filter)){P.style.filter="alpha(opacity="+R*100+")";if(!P.currentStyle||!P.currentStyle.hasLayout){P.style.zoom=1;}}break;case"float":Q="styleFloat";default:P.style[Q]=R;}};}else{I=function(P,Q,R){if(Q=="float"){Q="cssFloat";}P.style[Q]=R;};}var D=function(P,Q){return P&&P.nodeType==1&&(!Q||Q(P));};YAHOO.util.Dom={get:function(R){if(R&&(R.nodeType||R.item)){return R;}if(YAHOO.lang.isString(R)||!R){return M.getElementById(R);}if(R.length!==undefined){var S=[];for(var Q=0,P=R.length;Q<P;++Q){S[S.length]=B.Dom.get(R[Q]);}return S;}return R;},getStyle:function(P,R){R=N(R);var Q=function(S){return K(S,R);};return B.Dom.batch(P,Q,B.Dom,true);},setStyle:function(P,R,S){R=N(R);var Q=function(T){I(T,R,S);};B.Dom.batch(P,Q,B.Dom,true);},getXY:function(P){var Q=function(R){if((R.parentNode===null||R.offsetParent===null||this.getStyle(R,"display")=="none")&&R!=R.ownerDocument.body){return false;}return H(R);};return B.Dom.batch(P,Q,B.Dom,true);},getX:function(P){var Q=function(R){return B.Dom.getXY(R)[0];};return B.Dom.batch(P,Q,B.Dom,true);},getY:function(P){var Q=function(R){return B.Dom.getXY(R)[1];};return B.Dom.batch(P,Q,B.Dom,true);},setXY:function(P,S,R){var Q=function(V){var U=this.getStyle(V,"position");if(U=="static"){this.setStyle(V,"position","relative");U="relative";}var X=this.getXY(V);if(X===false){return false;}var W=[parseInt(this.getStyle(V,"left"),10),parseInt(this.getStyle(V,"top"),10)];if(isNaN(W[0])){W[0]=(U=="relative")?0:V.offsetLeft;}if(isNaN(W[1])){W[1]=(U=="relative")?0:V.offsetTop;}if(S[0]!==null){V.style.left=S[0]-X[0]+W[0]+"px";}if(S[1]!==null){V.style.top=S[1]-X[1]+W[1]+"px";}if(!R){var T=this.getXY(V);if((S[0]!==null&&T[0]!=S[0])||(S[1]!==null&&T[1]!=S[1])){this.setXY(V,S,true);}}};B.Dom.batch(P,Q,B.Dom,true);},setX:function(Q,P){B.Dom.setXY(Q,[P,null]);},setY:function(P,Q){B.Dom.setXY(P,[null,Q]);},getRegion:function(P){var Q=function(R){if((R.parentNode===null||R.offsetParent===null||this.getStyle(R,"display")=="none")&&R!=R.ownerDocument.body){return false;}var S=B.Region.getRegion(R);return S;};return B.Dom.batch(P,Q,B.Dom,true);},getClientWidth:function(){return B.Dom.getViewportWidth();},getClientHeight:function(){return B.Dom.getViewportHeight();},getElementsByClassName:function(T,X,U,V){X=X||"*";U=(U)?B.Dom.get(U):null||M;if(!U){return[];}var Q=[],P=U.getElementsByTagName(X),W=O(T);for(var R=0,S=P.length;R<S;++R){if(W.test(P[R].className)){Q[Q.length]=P[R];if(V){V.call(P[R],P[R]);}}}return Q;},hasClass:function(R,Q){var P=O(Q);var S=function(T){return P.test(T.className);};return B.Dom.batch(R,S,B.Dom,true);},addClass:function(Q,P){var R=function(S){if(this.hasClass(S,P)){return false;}S.className=YAHOO.lang.trim([S.className,P].join(" "));return true;};return B.Dom.batch(Q,R,B.Dom,true);},removeClass:function(R,Q){var P=O(Q);var S=function(T){if(!Q||!this.hasClass(T,Q)){return false;}var U=T.className;T.className=U.replace(P," ");if(this.hasClass(T,Q)){this.removeClass(T,Q);}T.className=YAHOO.lang.trim(T.className);return true;};return B.Dom.batch(R,S,B.Dom,true);},replaceClass:function(S,Q,P){if(!P||Q===P){return false;}var R=O(Q);var T=function(U){if(!this.hasClass(U,Q)){this.addClass(U,P);return true;}U.className=U.className.replace(R," "+P+" ");if(this.hasClass(U,Q)){this.replaceClass(U,Q,P);}U.className=YAHOO.lang.trim(U.className);return true;};return B.Dom.batch(S,T,B.Dom,true);},generateId:function(P,R){R=R||"yui-gen";var Q=function(S){if(S&&S.id){return S.id;}var T=R+YAHOO.env._id_counter++;if(S){S.id=T;}return T;};return B.Dom.batch(P,Q,B.Dom,true)||Q.apply(B.Dom,arguments);},isAncestor:function(P,Q){P=B.Dom.get(P);Q=B.Dom.get(Q);if(!P||!Q){return false;}if(P.contains&&Q.nodeType&&!L){return P.contains(Q);}else{if(P.compareDocumentPosition&&Q.nodeType){return!!(P.compareDocumentPosition(Q)&16);}else{if(Q.nodeType){return!!this.getAncestorBy(Q,function(R){return R==P;});}}}return false;},inDocument:function(P){return this.isAncestor(M.documentElement,P);},getElementsBy:function(W,Q,R,T){Q=Q||"*";R=(R)?B.Dom.get(R):null||M;if(!R){return[];}var S=[],V=R.getElementsByTagName(Q);for(var U=0,P=V.length;U<P;++U){if(W(V[U])){S[S.length]=V[U];if(T){T(V[U]);}}}return S;},batch:function(T,W,V,R){T=(T&&(T.tagName||T.item))?T:B.Dom.get(T);if(!T||!W){return false;}var S=(R)?V:window;if(T.tagName||T.length===undefined){return W.call(S,T,V);}var U=[];for(var Q=0,P=T.length;Q<P;++Q){U[U.length]=W.call(S,T[Q],V);}return U;},getDocumentHeight:function(){var Q=(M.compatMode!="CSS1Compat")?M.body.scrollHeight:M.documentElement.scrollHeight;var P=Math.max(Q,B.Dom.getViewportHeight());return P;},getDocumentWidth:function(){var Q=(M.compatMode!="CSS1Compat")?M.body.scrollWidth:M.documentElement.scrollWidth;var P=Math.max(Q,B.Dom.getViewportWidth());return P;},getViewportHeight:function(){var P=self.innerHeight;var Q=M.compatMode;if((Q||G)&&!C){P=(Q=="CSS1Compat")?M.documentElement.clientHeight:M.body.clientHeight;}return P;},getViewportWidth:function(){var P=self.innerWidth;var Q=M.compatMode;if(Q||G){P=(Q=="CSS1Compat")?M.documentElement.clientWidth:M.body.clientWidth;}return P;},getAncestorBy:function(P,Q){while(P=P.parentNode){if(D(P,Q)){return P;}}return null;},getAncestorByClassName:function(Q,P){Q=B.Dom.get(Q);if(!Q){return null;}var R=function(S){return B.Dom.hasClass(S,P);};return B.Dom.getAncestorBy(Q,R);},getAncestorByTagName:function(Q,P){Q=B.Dom.get(Q);if(!Q){return null;}var R=function(S){return S.tagName&&S.tagName.toUpperCase()==P.toUpperCase();};return B.Dom.getAncestorBy(Q,R);},getPreviousSiblingBy:function(P,Q){while(P){P=P.previousSibling;if(D(P,Q)){return P;}}return null;},getPreviousSibling:function(P){P=B.Dom.get(P);if(!P){return null;}return B.Dom.getPreviousSiblingBy(P);},getNextSiblingBy:function(P,Q){while(P){P=P.nextSibling;if(D(P,Q)){return P;}}return null;},getNextSibling:function(P){P=B.Dom.get(P);if(!P){return null;}return B.Dom.getNextSiblingBy(P);},getFirstChildBy:function(P,R){var Q=(D(P.firstChild,R))?P.firstChild:null;return Q||B.Dom.getNextSiblingBy(P.firstChild,R);},getFirstChild:function(P,Q){P=B.Dom.get(P);if(!P){return null;}return B.Dom.getFirstChildBy(P);},getLastChildBy:function(P,R){if(!P){return null;}var Q=(D(P.lastChild,R))?P.lastChild:null;return Q||B.Dom.getPreviousSiblingBy(P.lastChild,R);},getLastChild:function(P){P=B.Dom.get(P);return B.Dom.getLastChildBy(P);},getChildrenBy:function(Q,S){var R=B.Dom.getFirstChildBy(Q,S);var P=R?[R]:[];B.Dom.getNextSiblingBy(R,function(T){if(!S||S(T)){P[P.length]=T;}return false;});return P;},getChildren:function(P){P=B.Dom.get(P);if(!P){}return B.Dom.getChildrenBy(P);},getDocumentScrollLeft:function(P){P=P||M;return Math.max(P.documentElement.scrollLeft,P.body.scrollLeft);},getDocumentScrollTop:function(P){P=P||M;return Math.max(P.documentElement.scrollTop,P.body.scrollTop);},insertBefore:function(Q,P){Q=B.Dom.get(Q);P=B.Dom.get(P);if(!Q||!P||!P.parentNode){return null;}return P.parentNode.insertBefore(Q,P);},insertAfter:function(Q,P){Q=B.Dom.get(Q);P=B.Dom.get(P);if(!Q||!P||!P.parentNode){return null;}if(P.nextSibling){return P.parentNode.insertBefore(Q,P.nextSibling);}else{return P.parentNode.appendChild(Q);}},getClientRegion:function(){var R=B.Dom.getDocumentScrollTop(),Q=B.Dom.getDocumentScrollLeft(),S=B.Dom.getViewportWidth()+Q,P=B.Dom.getViewportHeight()+R;return new B.Region(R,S,P,Q);}};var H=function(){if(M.documentElement.getBoundingClientRect){return function(Q){var R=Q.getBoundingClientRect();var P=Q.ownerDocument;return[R.left+B.Dom.getDocumentScrollLeft(P),R.top+B.Dom.getDocumentScrollTop(P)];};}else{return function(R){var S=[R.offsetLeft,R.offsetTop];var Q=R.offsetParent;var P=(L&&B.Dom.getStyle(R,"position")=="absolute"&&R.offsetParent==R.ownerDocument.body);if(Q!=R){while(Q){S[0]+=Q.offsetLeft;S[1]+=Q.offsetTop;if(!P&&L&&B.Dom.getStyle(Q,"position")=="absolute"){P=true;}Q=Q.offsetParent;}}if(P){S[0]-=R.ownerDocument.body.offsetLeft;S[1]-=R.ownerDocument.body.offsetTop;}Q=R.parentNode;while(Q.tagName&&!E.ROOT_TAG.test(Q.tagName)){if(Q.scrollTop||Q.scrollLeft){if(!E.OP_SCROLL.test(B.Dom.getStyle(Q,"display"))){if(!C||B.Dom.getStyle(Q,"overflow")!=="visible"){S[0]-=Q.scrollLeft;S[1]-=Q.scrollTop;}}}Q=Q.parentNode;}return S;};}}();})();YAHOO.util.Region=function(C,D,A,B){this.top=C;this[1]=C;this.right=D;this.bottom=A;this.left=B;this[0]=B;};YAHOO.util.Region.prototype.contains=function(A){return(A.left>=this.left&&A.right<=this.right&&A.top>=this.top&&A.bottom<=this.bottom);};YAHOO.util.Region.prototype.getArea=function(){return((this.bottom-this.top)*(this.right-this.left));};YAHOO.util.Region.prototype.intersect=function(E){var C=Math.max(this.top,E.top);var D=Math.min(this.right,E.right);var A=Math.min(this.bottom,E.bottom);var B=Math.max(this.left,E.left);if(A>=C&&D>=B){return new YAHOO.util.Region(C,D,A,B);}else{return null;}};YAHOO.util.Region.prototype.union=function(E){var C=Math.min(this.top,E.top);var D=Math.max(this.right,E.right);var A=Math.max(this.bottom,E.bottom);var B=Math.min(this.left,E.left);return new YAHOO.util.Region(C,D,A,B);};YAHOO.util.Region.prototype.toString=function(){return("Region {"+"top: "+this.top+", right: "+this.right+", bottom: "+this.bottom+", left: "+this.left+"}");};YAHOO.util.Region.getRegion=function(D){var F=YAHOO.util.Dom.getXY(D);var C=F[1];var E=F[0]+D.offsetWidth;var A=F[1]+D.offsetHeight;var B=F[0];return new YAHOO.util.Region(C,E,A,B);};YAHOO.util.Point=function(A,B){if(YAHOO.lang.isArray(A)){B=A[1];A=A[0];}this.x=this.right=this.left=this[0]=A;this.y=this.top=this.bottom=this[1]=B;};YAHOO.util.Point.prototype=new YAHOO.util.Region();YAHOO.register("dom",YAHOO.util.Dom,{version:"2.5.2",build:"1076"});YAHOO.util.CustomEvent=function(D,B,C,A){this.type=D;this.scope=B||window;this.silent=C;this.signature=A||YAHOO.util.CustomEvent.LIST;this.subscribers=[];if(!this.silent){}var E="_YUICEOnSubscribe";if(D!==E){this.subscribeEvent=new YAHOO.util.CustomEvent(E,this,true);}this.lastError=null;};YAHOO.util.CustomEvent.LIST=0;YAHOO.util.CustomEvent.FLAT=1;YAHOO.util.CustomEvent.prototype={subscribe:function(B,C,A){if(!B){throw new Error("Invalid callback for subscriber to '"+this.type+"'");}if(this.subscribeEvent){this.subscribeEvent.fire(B,C,A);}this.subscribers.push(new YAHOO.util.Subscriber(B,C,A));},unsubscribe:function(D,F){if(!D){return this.unsubscribeAll();}var E=false;for(var B=0,A=this.subscribers.length;B<A;++B){var C=this.subscribers[B];if(C&&C.contains(D,F)){this._delete(B);E=true;}}return E;},fire:function(){this.lastError=null;var K=[],E=this.subscribers.length;if(!E&&this.silent){return true;}var I=[].slice.call(arguments,0),G=true,D,J=false;if(!this.silent){}var C=this.subscribers.slice(),A=YAHOO.util.Event.throwErrors;for(D=0;D<E;++D){var M=C[D];if(!M){J=true;}else{if(!this.silent){}var L=M.getScope(this.scope);if(this.signature==YAHOO.util.CustomEvent.FLAT){var B=null;if(I.length>0){B=I[0];}try{G=M.fn.call(L,B,M.obj);}catch(F){this.lastError=F;if(A){throw F;}}}else{try{G=M.fn.call(L,this.type,I,M.obj);}catch(H){this.lastError=H;if(A){throw H;}}}if(false===G){if(!this.silent){}break;}}}return(G!==false);},unsubscribeAll:function(){for(var A=this.subscribers.length-1;A>-1;A--){this._delete(A);}this.subscribers=[];return A;},_delete:function(A){var B=this.subscribers[A];if(B){delete B.fn;delete B.obj;}this.subscribers.splice(A,1);},toString:function(){return"CustomEvent: "+"'"+this.type+"', "+"scope: "+this.scope;}};YAHOO.util.Subscriber=function(B,C,A){this.fn=B;this.obj=YAHOO.lang.isUndefined(C)?null:C;this.override=A;};YAHOO.util.Subscriber.prototype.getScope=function(A){if(this.override){if(this.override===true){return this.obj;}else{return this.override;}}return A;};YAHOO.util.Subscriber.prototype.contains=function(A,B){if(B){return(this.fn==A&&this.obj==B);}else{return(this.fn==A);}};YAHOO.util.Subscriber.prototype.toString=function(){return"Subscriber { obj: "+this.obj+", override: "+(this.override||"no")+" }";};if(!YAHOO.util.Event){YAHOO.util.Event=function(){var H=false;var I=[];var J=[];var G=[];var E=[];var C=0;var F=[];var B=[];var A=0;var D={63232:38,63233:40,63234:37,63235:39,63276:33,63277:34,25:9};return{POLL_RETRYS:2000,POLL_INTERVAL:20,EL:0,TYPE:1,FN:2,WFN:3,UNLOAD_OBJ:3,ADJ_SCOPE:4,OBJ:5,OVERRIDE:6,lastError:null,isSafari:YAHOO.env.ua.webkit,webkit:YAHOO.env.ua.webkit,isIE:YAHOO.env.ua.ie,_interval:null,_dri:null,DOMReady:false,throwErrors:false,startInterval:function(){if(!this._interval){var K=this;var L=function(){K._tryPreloaddisabledAttach();};this._interval=setInterval(L,this.POLL_INTERVAL);}},onAvailable:function(P,M,Q,O,N){var K=(YAHOO.lang.isString(P))?[P]:P;for(var L=0;L<K.length;L=L+1){F.push({id:K[L],fn:M,obj:Q,override:O,checkReady:N});}C=this.POLL_RETRYS;this.startInterval();},onContentReady:function(M,K,N,L){this.onAvailable(M,K,N,L,true);},onDOMReady:function(K,M,L){if(this.DOMReady){setTimeout(function(){var N=window;if(L){if(L===true){N=M;}else{N=L;}}K.call(N,"DOMReady",[],M);},0);}else{this.DOMReadyEvent.subscribe(K,M,L);}},addListener:function(M,K,V,Q,L){if(!V||!V.call){return false;}if(this._isValidCollection(M)){var W=true;for(var R=0,T=M.length;R<T;++R){W=this.on(M[R],K,V,Q,L)&&W;}return W;}else{if(YAHOO.lang.isString(M)){var P=this.getEl(M);if(P){M=P;}else{this.onAvailable(M,function(){YAHOO.util.Event.on(M,K,V,Q,L);});return true;}}}if(!M){return false;}if("unloaddisabled"==K&&Q!==this){J[J.length]=[M,K,V,Q,L];return true;}var Y=M;if(L){if(L===true){Y=Q;}else{Y=L;}}var N=function(Z){return V.call(Y,YAHOO.util.Event.getEvent(Z,M),Q);};var X=[M,K,V,N,Y,Q,L];var S=I.length;I[S]=X;if(this.useLegacyEvent(M,K)){var O=this.getLegacyIndex(M,K);if(O==-1||M!=G[O][0]){O=G.length;B[M.id+K]=O;G[O]=[M,K,M["on"+K]];E[O]=[];M["on"+K]=function(Z){YAHOO.util.Event.fireLegacyEvent(YAHOO.util.Event.getEvent(Z),O);};}E[O].push(X);}else{try{this._simpleAdd(M,K,N,false);}catch(U){this.lastError=U;this.removeListener(M,K,V);return false;}}return true;},fireLegacyEvent:function(O,M){var Q=true,K,S,R,T,P;S=E[M].slice();for(var L=0,N=S.length;L<N;++L){R=S[L];if(R&&R[this.WFN]){T=R[this.ADJ_SCOPE];P=R[this.WFN].call(T,O);Q=(Q&&P);}}K=G[M];if(K&&K[2]){K[2](O);}return Q;},getLegacyIndex:function(L,M){var K=this.generateId(L)+M;if(typeof B[K]=="undefined"){return-1;}else{return B[K];}},useLegacyEvent:function(L,M){if(this.webkit&&("click"==M||"dblclick"==M)){var K=parseInt(this.webkit,10);if(!isNaN(K)&&K<418){return true;}}return false;},removeListener:function(L,K,T){var O,R,V;if(typeof L=="string"){L=this.getEl(L);}else{if(this._isValidCollection(L)){var U=true;for(O=L.length-1;O>-1;O--){U=(this.removeListener(L[O],K,T)&&U);}return U;}}if(!T||!T.call){return this.purgeElement(L,false,K);}if("unloaddisabled"==K){for(O=J.length-1;O>-1;O--){V=J[O];if(V&&V[0]==L&&V[1]==K&&V[2]==T){J.splice(O,1);return true;}}return false;}var P=null;var Q=arguments[3];if("undefined"===typeof Q){Q=this._getCacheIndex(L,K,T);}if(Q>=0){P=I[Q];}if(!L||!P){return false;}if(this.useLegacyEvent(L,K)){var N=this.getLegacyIndex(L,K);var M=E[N];if(M){for(O=0,R=M.length;O<R;++O){V=M[O];if(V&&V[this.EL]==L&&V[this.TYPE]==K&&V[this.FN]==T){M.splice(O,1);break;}}}}else{try{this._simpleRemove(L,K,P[this.WFN],false);}catch(S){this.lastError=S;return false;}}delete I[Q][this.WFN];delete I[Q][this.FN];I.splice(Q,1);return true;},getTarget:function(M,L){var K=M.target||M.srcElement;return this.resolveTextNode(K);},resolveTextNode:function(L){try{if(L&&3==L.nodeType){return L.parentNode;}}catch(K){}return L;},getPageX:function(L){var K=L.pageX;if(!K&&0!==K){K=L.clientX||0;if(this.isIE){K+=this._getScrollLeft();}}return K;},getPageY:function(K){var L=K.pageY;if(!L&&0!==L){L=K.clientY||0;if(this.isIE){L+=this._getScrollTop();}}return L;},getXY:function(K){return[this.getPageX(K),this.getPageY(K)];},getRelatedTarget:function(L){var K=L.relatedTarget;if(!K){if(L.type=="mouseout"){K=L.toElement;}else{if(L.type=="mouseover"){K=L.fromElement;}}}return this.resolveTextNode(K);},getTime:function(M){if(!M.time){var L=new Date().getTime();try{M.time=L;}catch(K){this.lastError=K;return L;}}return M.time;},stopEvent:function(K){this.stopPropagation(K);this.preventDefault(K);},stopPropagation:function(K){if(K.stopPropagation){K.stopPropagation();}else{K.cancelBubble=true;}},preventDefault:function(K){if(K.preventDefault){K.preventDefault();}else{K.returnValue=false;}},getEvent:function(M,K){var L=M||window.event;if(!L){var N=this.getEvent.caller;while(N){L=N.arguments[0];if(L&&Event==L.constructor){break;}N=N.caller;}}return L;},getCharCode:function(L){var K=L.keyCode||L.charCode||0;if(YAHOO.env.ua.webkit&&(K in D)){K=D[K];}return K;},_getCacheIndex:function(O,P,N){for(var M=0,L=I.length;M<L;M=M+1){var K=I[M];if(K&&K[this.FN]==N&&K[this.EL]==O&&K[this.TYPE]==P){return M;}}return-1;},generateId:function(K){var L=K.id;if(!L){L="yuievtautoid-"+A;++A;K.id=L;}return L;},_isValidCollection:function(L){try{return(L&&typeof L!=="string"&&L.length&&!L.tagName&&!L.alert&&typeof L[0]!=="undefined");}catch(K){return false;}},elCache:{},getEl:function(K){return(typeof K==="string")?document.getElementById(K):K;},clearCache:function(){},DOMReadyEvent:new YAHOO.util.CustomEvent("DOMReady",this),_loaddisabled:function(L){if(!H){H=true;var K=YAHOO.util.Event;K._ready();K._tryPreloaddisabledAttach();}},_ready:function(L){var K=YAHOO.util.Event;if(!K.DOMReady){K.DOMReady=true;K.DOMReadyEvent.fire();K._simpleRemove(document,"DOMContentLoaded",K._ready);}},_tryPreloaddisabledAttach:function(){if(F.length===0){C=0;clearInterval(this._interval);this._interval=null;return;}if(this.locked){return;}if(this.isIE){if(!this.DOMReady){this.startInterval();return;}}this.locked=true;var Q=!H;if(!Q){Q=(C>0&&F.length>0);}var P=[];var R=function(T,U){var S=T;if(U.override){if(U.override===true){S=U.obj;}else{S=U.override;}}U.fn.call(S,U.obj);};var L,K,O,N,M=[];for(L=0,K=F.length;L<K;L=L+1){O=F[L];if(O){N=this.getEl(O.id);if(N){if(O.checkReady){if(H||N.nextSibling||!Q){M.push(O);F[L]=null;}}else{R(N,O);F[L]=null;}}else{P.push(O);}}}for(L=0,K=M.length;L<K;L=L+1){O=M[L];R(this.getEl(O.id),O);}C--;if(Q){for(L=F.length-1;L>-1;L--){O=F[L];if(!O||!O.id){F.splice(L,1);}}this.startInterval();}else{clearInterval(this._interval);this._interval=null;}this.locked=false;},purgeElement:function(O,P,R){var M=(YAHOO.lang.isString(O))?this.getEl(O):O;var Q=this.getListeners(M,R),N,K;if(Q){for(N=Q.length-1;N>-1;N--){var L=Q[N];this.removeListener(M,L.type,L.fn);}}if(P&&M&&M.childNodes){for(N=0,K=M.childNodes.length;N<K;++N){this.purgeElement(M.childNodes[N],P,R);}}},getListeners:function(M,K){var P=[],L;if(!K){L=[I,J];}else{if(K==="unloaddisabled"){L=[J];}else{L=[I];}}var R=(YAHOO.lang.isString(M))?this.getEl(M):M;for(var O=0;O<L.length;O=O+1){var T=L[O];if(T){for(var Q=0,S=T.length;Q<S;++Q){var N=T[Q];if(N&&N[this.EL]===R&&(!K||K===N[this.TYPE])){P.push({type:N[this.TYPE],fn:N[this.FN],obj:N[this.OBJ],adjust:N[this.OVERRIDE],scope:N[this.ADJ_SCOPE],index:Q});}}}}return(P.length)?P:null;},_unloaddisabled:function(Q){var K=YAHOO.util.Event,N,M,L,P,O,R=J.slice();for(N=0,P=J.length;N<P;++N){L=R[N];if(L){var S=window;if(L[K.ADJ_SCOPE]){if(L[K.ADJ_SCOPE]===true){S=L[K.UNLOAD_OBJ];}else{S=L[K.ADJ_SCOPE];}}L[K.FN].call(S,K.getEvent(Q,L[K.EL]),L[K.UNLOAD_OBJ]);R[N]=null;L=null;S=null;}}J=null;if(I){for(M=I.length-1;M>-1;M--){L=I[M];if(L){K.removeListener(L[K.EL],L[K.TYPE],L[K.FN],M);}}L=null;}G=null;K._simpleRemove(window,"unloaddisabled",K._unloaddisabled);},_getScrollLeft:function(){return this._getScroll()[1];},_getScrollTop:function(){return this._getScroll()[0];},_getScroll:function(){var K=document.documentElement,L=document.body;if(K&&(K.scrollTop||K.scrollLeft)){return[K.scrollTop,K.scrollLeft];}else{if(L){return[L.scrollTop,L.scrollLeft];}else{return[0,0];}}},regCE:function(){},_simpleAdd:function(){if(window.addEventListener){return function(M,N,L,K){M.addEventListener(N,L,(K));};}else{if(window.attachEvent){return function(M,N,L,K){M.attachEvent("on"+N,L);};}else{return function(){};}}}(),_simpleRemove:function(){if(window.removeEventListener){return function(M,N,L,K){M.removeEventListener(N,L,(K));};}else{if(window.detachEvent){return function(L,M,K){L.detachEvent("on"+M,K);};}else{return function(){};}}}()};}();(function(){var EU=YAHOO.util.Event;EU.on=EU.addListener;if(EU.isIE){YAHOO.util.Event.onDOMReady(YAHOO.util.Event._tryPreloaddisabledAttach,YAHOO.util.Event,true);var n=document.createElement("p");EU._dri=setInterval(function(){try{n.doScroll("left");clearInterval(EU._dri);EU._dri=null;EU._ready();n=null;}catch(ex){}},EU.POLL_INTERVAL);}else{if(EU.webkit&&EU.webkit<525){EU._dri=setInterval(function(){var rs=document.readyState;if("loaddisableded"==rs||"complete"==rs){clearInterval(EU._dri);EU._dri=null;EU._ready();}},EU.POLL_INTERVAL);}else{EU._simpleAdd(document,"DOMContentLoaded",EU._ready);}}EU._simpleAdd(window,"loaddisabled",EU._loaddisabled);EU._simpleAdd(window,"unloaddisabled",EU._unloaddisabled);EU._tryPreloaddisabledAttach();})();}YAHOO.util.EventProvider=function(){};YAHOO.util.EventProvider.prototype={__yui_events:null,__yui_subscribers:null,subscribe:function(A,C,F,E){this.__yui_events=this.__yui_events||{};var D=this.__yui_events[A];if(D){D.subscribe(C,F,E);}else{this.__yui_subscribers=this.__yui_subscribers||{};var B=this.__yui_subscribers;if(!B[A]){B[A]=[];}B[A].push({fn:C,obj:F,override:E});}},unsubscribe:function(C,E,G){this.__yui_events=this.__yui_events||{};var A=this.__yui_events;if(C){var F=A[C];if(F){return F.unsubscribe(E,G);}}else{var B=true;for(var D in A){if(YAHOO.lang.hasOwnProperty(A,D)){B=B&&A[D].unsubscribe(E,G);}}return B;}return false;},unsubscribeAll:function(A){return this.unsubscribe(A);},createEvent:function(G,D){this.__yui_events=this.__yui_events||{};var A=D||{};var I=this.__yui_events;if(I[G]){}else{var H=A.scope||this;var E=(A.silent);var B=new YAHOO.util.CustomEvent(G,H,E,YAHOO.util.CustomEvent.FLAT);I[G]=B;if(A.onSubscribeCallback){B.subscribeEvent.subscribe(A.onSubscribeCallback);}this.__yui_subscribers=this.__yui_subscribers||{};var F=this.__yui_subscribers[G];if(F){for(var C=0;C<F.length;++C){B.subscribe(F[C].fn,F[C].obj,F[C].override);}}}return I[G];},fireEvent:function(E,D,A,C){this.__yui_events=this.__yui_events||{};var G=this.__yui_events[E];if(!G){return null;}var B=[];for(var F=1;F<arguments.length;++F){B.push(arguments[F]);}return G.fire.apply(G,B);},hasEvent:function(A){if(this.__yui_events){if(this.__yui_events[A]){return true;}}return false;}};YAHOO.util.KeyListener=function(A,F,B,C){if(!A){}else{if(!F){}else{if(!B){}}}if(!C){C=YAHOO.util.KeyListener.KEYDOWN;}var D=new YAHOO.util.CustomEvent("keyPressed");this.enabledEvent=new YAHOO.util.CustomEvent("enabled");this.disabledEvent=new YAHOO.util.CustomEvent("disabled");if(typeof A=="string"){A=document.getElementById(A);}if(typeof B=="function"){D.subscribe(B);}else{D.subscribe(B.fn,B.scope,B.correctScope);}function E(J,I){if(!F.shift){F.shift=false;}if(!F.alt){F.alt=false;}if(!F.ctrl){F.ctrl=false;}if(J.shiftKey==F.shift&&J.altKey==F.alt&&J.ctrlKey==F.ctrl){var G;if(F.keys instanceof Array){for(var H=0;H<F.keys.length;H++){G=F.keys[H];if(G==J.charCode){D.fire(J.charCode,J);break;}else{if(G==J.keyCode){D.fire(J.keyCode,J);break;}}}}else{G=F.keys;if(G==J.charCode){D.fire(J.charCode,J);}else{if(G==J.keyCode){D.fire(J.keyCode,J);}}}}}this.enable=function(){if(!this.enabled){YAHOO.util.Event.addListener(A,C,E);this.enabledEvent.fire(F);}this.enabled=true;};this.disable=function(){if(this.enabled){YAHOO.util.Event.removeListener(A,C,E);this.disabledEvent.fire(F);}this.enabled=false;};this.toString=function(){return"KeyListener ["+F.keys+"] "+A.tagName+(A.id?"["+A.id+"]":"");};};YAHOO.util.KeyListener.KEYDOWN="keydown";YAHOO.util.KeyListener.KEYUP="keyup";YAHOO.util.KeyListener.KEY={ALT:18,BACK_SPACE:8,CAPS_LOCK:20,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,META:224,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PRINTSCREEN:44,RIGHT:39,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,UP:38};YAHOO.register("event",YAHOO.util.Event,{version:"2.5.2",build:"1076"});YAHOO.register("yahoo-dom-event",YAHOO,{version:"2.5.2",build:"1076"});

if(!YAHOO.util.DragDropMgr){YAHOO.util.DragDropMgr=function(){var Event=YAHOO.util.Event;return{ids:{},handleIds:{},dragCurrent:null,dragOvers:{},deltaX:0,deltaY:0,preventDefault:true,stopPropagation:true,initialized:false,locked:false,interactionInfo:null,init:function(){this.initialized=true;},POINT:0,INTERSECT:1,STRICT_INTERSECT:2,mode:0,_execOnAll:function(sMethod,args){for(var i in this.ids){for(var j in this.ids[i]){var oDD=this.ids[i][j];if(!this.isTypeOfDD(oDD)){continue;}
oDD[sMethod].apply(oDD,args);}}},_onLoad:function(){this.init();Event.on(document,"mouseup",this.handleMouseUp,this,true);Event.on(document,"mousemove",this.handleMouseMove,this,true);Event.on(window,"unloaddisabled",this._onUnloaddisabled,this,true);Event.on(window,"resize",this._onResize,this,true);},_onResize:function(e){this._execOnAll("resetConstraints",[]);},lock:function(){this.locked=true;},unlock:function(){this.locked=false;},isLocked:function(){return this.locked;},locationCache:{},useCache:true,clickPixelThresh:3,clickTimeThresh:1000,dragThreshMet:false,clickTimeout:null,startX:0,startY:0,fromTimeout:false,regDragDrop:function(oDD,sGroup){if(!this.initialized){this.init();}
if(!this.ids[sGroup]){this.ids[sGroup]={};}
this.ids[sGroup][oDD.id]=oDD;},removeDDFromGroup:function(oDD,sGroup){if(!this.ids[sGroup]){this.ids[sGroup]={};}
var obj=this.ids[sGroup];if(obj&&obj[oDD.id]){delete obj[oDD.id];}},_remove:function(oDD){for(var g in oDD.groups){if(g&&this.ids[g][oDD.id]){delete this.ids[g][oDD.id];}}
delete this.handleIds[oDD.id];},regHandle:function(sDDId,sHandleId){if(!this.handleIds[sDDId]){this.handleIds[sDDId]={};}
this.handleIds[sDDId][sHandleId]=sHandleId;},isDragDrop:function(id){return(this.getDDById(id))?true:false;},getRelated:function(p_oDD,bTargetsOnly){var oDDs=[];for(var i in p_oDD.groups){for(var j in this.ids[i]){var dd=this.ids[i][j];if(!this.isTypeOfDD(dd)){continue;}
if(!bTargetsOnly||dd.isTarget){oDDs[oDDs.length]=dd;}}}
return oDDs;},isLegalTarget:function(oDD,oTargetDD){var targets=this.getRelated(oDD,true);for(var i=0,len=targets.length;i<len;++i){if(targets[i].id==oTargetDD.id){return true;}}
return false;},isTypeOfDD:function(oDD){return(oDD&&oDD.__ygDragDrop);},isHandle:function(sDDId,sHandleId){return(this.handleIds[sDDId]&&this.handleIds[sDDId][sHandleId]);},getDDById:function(id){for(var i in this.ids){if(this.ids[i][id]){return this.ids[i][id];}}
return null;},handleMouseDown:function(e,oDD){this.currentTarget=YAHOO.util.Event.getTarget(e);this.dragCurrent=oDD;var el=oDD.getEl();this.startX=YAHOO.util.Event.getPageX(e);this.startY=YAHOO.util.Event.getPageY(e);this.deltaX=this.startX-el.offsetLeft;this.deltaY=this.startY-el.offsetTop;this.dragThreshMet=false;this.clickTimeout=setTimeout(function(){var DDM=YAHOO.util.DDM;DDM.startDrag(DDM.startX,DDM.startY);DDM.fromTimeout=true;},this.clickTimeThresh);},startDrag:function(x,y){clearTimeout(this.clickTimeout);var dc=this.dragCurrent;if(dc&&dc.events.b4StartDrag){dc.b4StartDrag(x,y);dc.fireEvent('b4StartDragEvent',{x:x,y:y});}
if(dc&&dc.events.startDrag){dc.startDrag(x,y);dc.fireEvent('startDragEvent',{x:x,y:y});}
this.dragThreshMet=true;},handleMouseUp:function(e){if(this.dragCurrent){clearTimeout(this.clickTimeout);if(this.dragThreshMet){if(this.fromTimeout){this.fromTimeout=false;this.handleMouseMove(e);}
this.fromTimeout=false;this.fireEvents(e,true);}else{}
this.stopDrag(e);this.stopEvent(e);}},stopEvent:function(e){if(this.stopPropagation){YAHOO.util.Event.stopPropagation(e);}
if(this.preventDefault){YAHOO.util.Event.preventDefault(e);}},stopDrag:function(e,silent){var dc=this.dragCurrent;if(dc&&!silent){if(this.dragThreshMet){if(dc.events.b4EndDrag){dc.b4EndDrag(e);dc.fireEvent('b4EndDragEvent',{e:e});}
if(dc.events.endDrag){dc.endDrag(e);dc.fireEvent('endDragEvent',{e:e});}}
if(dc.events.mouseUp){dc.onMouseUp(e);dc.fireEvent('mouseUpEvent',{e:e});}}
this.dragCurrent=null;this.dragOvers={};},handleMouseMove:function(e){var dc=this.dragCurrent;if(dc){if(YAHOO.util.Event.isIE&&!e.button){this.stopEvent(e);return this.handleMouseUp(e);}else{if(e.clientX<0||e.clientY<0){}}
if(!this.dragThreshMet){var diffX=Math.abs(this.startX-YAHOO.util.Event.getPageX(e));var diffY=Math.abs(this.startY-YAHOO.util.Event.getPageY(e));if(diffX>this.clickPixelThresh||diffY>this.clickPixelThresh){this.startDrag(this.startX,this.startY);}}
if(this.dragThreshMet){if(dc&&dc.events.b4Drag){dc.b4Drag(e);dc.fireEvent('b4DragEvent',{e:e});}
if(dc&&dc.events.drag){dc.onDrag(e);dc.fireEvent('dragEvent',{e:e});}
if(dc){this.fireEvents(e,false);}}
this.stopEvent(e);}},fireEvents:function(e,isDrop){var dc=this.dragCurrent;if(!dc||dc.isLocked()||dc.dragOnly){return;}
var x=YAHOO.util.Event.getPageX(e),y=YAHOO.util.Event.getPageY(e),pt=new YAHOO.util.Point(x,y),pos=dc.getTargetCoord(pt.x,pt.y),el=dc.getDragEl(),events=['out','over','drop','enter'],curRegion=new YAHOO.util.Region(pos.y,pos.x+el.offsetWidth,pos.y+el.offsetHeight,pos.x),oldOvers=[],inGroupsObj={},inGroups=[],data={outEvts:[],overEvts:[],dropEvts:[],enterEvts:[]};for(var i in this.dragOvers){var ddo=this.dragOvers[i];if(!this.isTypeOfDD(ddo)){continue;}
if(!this.isOverTarget(pt,ddo,this.mode,curRegion)){data.outEvts.push(ddo);}
oldOvers[i]=true;delete this.dragOvers[i];}
for(var sGroup in dc.groups){if("string"!=typeof sGroup){continue;}
for(i in this.ids[sGroup]){var oDD=this.ids[sGroup][i];if(!this.isTypeOfDD(oDD)){continue;}
if(oDD.isTarget&&!oDD.isLocked()&&oDD!=dc){if(this.isOverTarget(pt,oDD,this.mode,curRegion)){inGroupsObj[sGroup]=true;if(isDrop){data.dropEvts.push(oDD);}else{if(!oldOvers[oDD.id]){data.enterEvts.push(oDD);}else{data.overEvts.push(oDD);}
this.dragOvers[oDD.id]=oDD;}}}}}
this.interactionInfo={out:data.outEvts,enter:data.enterEvts,over:data.overEvts,drop:data.dropEvts,point:pt,draggedRegion:curRegion,sourceRegion:this.locationCache[dc.id],validDrop:isDrop};for(var inG in inGroupsObj){inGroups.push(inG);}
if(isDrop&&!data.dropEvts.length){this.interactionInfo.validDrop=false;if(dc.events.invalidDrop){dc.onInvalidDrop(e);dc.fireEvent('invalidDropEvent',{e:e});}}
for(i=0;i<events.length;i++){var tmp=null;if(data[events[i]+'Evts']){tmp=data[events[i]+'Evts'];}
if(tmp&&tmp.length){var type=events[i].charAt(0).toUpperCase()+events[i].substr(1),ev='onDrag'+type,b4='b4Drag'+type,cev='drag'+type+'Event',check='drag'+type;if(this.mode){if(dc.events[b4]){dc[b4](e,tmp,inGroups);dc.fireEvent(b4+'Event',{event:e,info:tmp,group:inGroups});}
if(dc.events[check]){dc[ev](e,tmp,inGroups);dc.fireEvent(cev,{event:e,info:tmp,group:inGroups});}}else{for(var b=0,len=tmp.length;b<len;++b){if(dc.events[b4]){dc[b4](e,tmp[b].id,inGroups[0]);dc.fireEvent(b4+'Event',{event:e,info:tmp[b].id,group:inGroups[0]});}
if(dc.events[check]){dc[ev](e,tmp[b].id,inGroups[0]);dc.fireEvent(cev,{event:e,info:tmp[b].id,group:inGroups[0]});}}}}}},getBestMatch:function(dds){var winner=null;var len=dds.length;if(len==1){winner=dds[0];}else{for(var i=0;i<len;++i){var dd=dds[i];if(this.mode==this.INTERSECT&&dd.cursorIsOver){winner=dd;break;}else{if(!winner||!winner.overlap||(dd.overlap&&winner.overlap.getArea()<dd.overlap.getArea())){winner=dd;}}}}
return winner;},refreshCache:function(groups){var g=groups||this.ids;for(var sGroup in g){if("string"!=typeof sGroup){continue;}
for(var i in this.ids[sGroup]){var oDD=this.ids[sGroup][i];if(this.isTypeOfDD(oDD)){var loc=this.getLocation(oDD);if(loc){this.locationCache[oDD.id]=loc;}else{delete this.locationCache[oDD.id];}}}}},verifyEl:function(el){try{if(el){var parent=el.offsetParent;if(parent){return true;}}}catch(e){}
return false;},getLocation:function(oDD){if(!this.isTypeOfDD(oDD)){return null;}
var el=oDD.getEl(),pos,x1,x2,y1,y2,t,r,b,l;try{pos=YAHOO.util.Dom.getXY(el);}catch(e){}
if(!pos){return null;}
x1=pos[0];x2=x1+el.offsetWidth;y1=pos[1];y2=y1+el.offsetHeight;t=y1-oDD.padding[0];r=x2+oDD.padding[1];b=y2+oDD.padding[2];l=x1-oDD.padding[3];return new YAHOO.util.Region(t,r,b,l);},isOverTarget:function(pt,oTarget,intersect,curRegion){var loc=this.locationCache[oTarget.id];if(!loc||!this.useCache){loc=this.getLocation(oTarget);this.locationCache[oTarget.id]=loc;}
if(!loc){return false;}
oTarget.cursorIsOver=loc.contains(pt);var dc=this.dragCurrent;if(!dc||(!intersect&&!dc.constrainX&&!dc.constrainY)){return oTarget.cursorIsOver;}
oTarget.overlap=null;if(!curRegion){var pos=dc.getTargetCoord(pt.x,pt.y);var el=dc.getDragEl();curRegion=new YAHOO.util.Region(pos.y,pos.x+el.offsetWidth,pos.y+el.offsetHeight,pos.x);}
var overlap=curRegion.intersect(loc);if(overlap){oTarget.overlap=overlap;return(intersect)?true:oTarget.cursorIsOver;}else{return false;}},_onUnloaddisabled:function(e,me){this.unregAll();},unregAll:function(){if(this.dragCurrent){this.stopDrag();this.dragCurrent=null;}
this._execOnAll("unreg",[]);this.ids={};},elementCache:{},getElWrapper:function(id){var oWrapper=this.elementCache[id];if(!oWrapper||!oWrapper.el){oWrapper=this.elementCache[id]=new this.ElementWrapper(YAHOO.util.Dom.get(id));}
return oWrapper;},getElement:function(id){return YAHOO.util.Dom.get(id);},getCss:function(id){var el=YAHOO.util.Dom.get(id);return(el)?el.style:null;},ElementWrapper:function(el){this.el=el||null;this.id=this.el&&el.id;this.css=this.el&&el.style;},getPosX:function(el){return YAHOO.util.Dom.getX(el);},getPosY:function(el){return YAHOO.util.Dom.getY(el);},swapNode:function(n1,n2){if(n1.swapNode){n1.swapNode(n2);}else{var p=n2.parentNode;var s=n2.nextSibling;if(s==n1){p.insertBefore(n1,n2);}else if(n2==n1.nextSibling){p.insertBefore(n2,n1);}else{n1.parentNode.replaceChild(n2,n1);p.insertBefore(n1,s);}}},getScroll:function(){var t,l,dde=document.documentElement,db=document.body;if(dde&&(dde.scrollTop||dde.scrollLeft)){t=dde.scrollTop;l=dde.scrollLeft;}else if(db){t=db.scrollTop;l=db.scrollLeft;}else{}
return{top:t,left:l};},getStyle:function(el,styleProp){return YAHOO.util.Dom.getStyle(el,styleProp);},getScrollTop:function(){return this.getScroll().top;},getScrollLeft:function(){return this.getScroll().left;},moveToEl:function(moveEl,targetEl){var aCoord=YAHOO.util.Dom.getXY(targetEl);YAHOO.util.Dom.setXY(moveEl,aCoord);},getClientHeight:function(){return YAHOO.util.Dom.getViewportHeight();},getClientWidth:function(){return YAHOO.util.Dom.getViewportWidth();},numericSort:function(a,b){return(a-b);},_timeoutCount:0,_addListeners:function(){var DDM=YAHOO.util.DDM;if(YAHOO.util.Event&&document){DDM._onLoad();}else{if(DDM._timeoutCount>2000){}else{setTimeout(DDM._addListeners,10);if(document&&document.body){DDM._timeoutCount+=1;}}}},handleWasClicked:function(node,id){if(this.isHandle(id,node.id)){return true;}else{var p=node.parentNode;while(p){if(this.isHandle(id,p.id)){return true;}else{p=p.parentNode;}}}
return false;}};}();YAHOO.util.DDM=YAHOO.util.DragDropMgr;YAHOO.util.DDM._addListeners();}
(function(){var Event=YAHOO.util.Event;var Dom=YAHOO.util.Dom;YAHOO.util.DragDrop=function(id,sGroup,config){if(id){this.init(id,sGroup,config);}};YAHOO.util.DragDrop.prototype={events:null,on:function(){this.subscribe.apply(this,arguments);},id:null,config:null,dragElId:null,handleElId:null,invalidHandleTypes:null,invalidHandleIds:null,invalidHandleClasses:null,startPageX:0,startPageY:0,groups:null,locked:false,lock:function(){this.locked=true;},unlock:function(){this.locked=false;},isTarget:true,padding:null,dragOnly:false,_domRef:null,__ygDragDrop:true,constrainX:false,constrainY:false,minX:0,maxX:0,minY:0,maxY:0,deltaX:0,deltaY:0,maintainOffset:false,xTicks:null,yTicks:null,primaryButtonOnly:true,available:false,hasOuterHandles:false,cursorIsOver:false,overlap:null,b4StartDrag:function(x,y){},startDrag:function(x,y){},b4Drag:function(e){},onDrag:function(e){},onDragEnter:function(e,id){},b4DragOver:function(e){},onDragOver:function(e,id){},b4DragOut:function(e){},onDragOut:function(e,id){},b4DragDrop:function(e){},onDragDrop:function(e,id){},onInvalidDrop:function(e){},b4EndDrag:function(e){},endDrag:function(e){},b4MouseDown:function(e){},onMouseDown:function(e){},onMouseUp:function(e){},onAvailable:function(){},getEl:function(){if(!this._domRef){this._domRef=Dom.get(this.id);}
return this._domRef;},getDragEl:function(){return Dom.get(this.dragElId);},init:function(id,sGroup,config){this.initTarget(id,sGroup,config);Event.on(this._domRef||this.id,"mousedown",this.handleMouseDown,this,true);for(var i in this.events){this.createEvent(i+'Event');}},initTarget:function(id,sGroup,config){this.config=config||{};this.events={};this.DDM=YAHOO.util.DDM;this.groups={};if(typeof id!=="string"){this._domRef=id;id=Dom.generateId(id);}
this.id=id;this.addToGroup((sGroup)?sGroup:"default");this.handleElId=id;Event.onAvailable(id,this.handleOnAvailable,this,true);this.setDragElId(id);this.invalidHandleTypes={A:"A"};this.invalidHandleIds={};this.invalidHandleClasses=[];this.applyConfig();},applyConfig:function(){this.events={mouseDown:true,b4MouseDown:true,mouseUp:true,b4StartDrag:true,startDrag:true,b4EndDrag:true,endDrag:true,drag:true,b4Drag:true,invalidDrop:true,b4DragOut:true,dragOut:true,dragEnter:true,b4DragOver:true,dragOver:true,b4DragDrop:true,dragDrop:true};if(this.config.events){for(var i in this.config.events){if(this.config.events[i]===false){this.events[i]=false;}}}
this.padding=this.config.padding||[0,0,0,0];this.isTarget=(this.config.isTarget!==false);this.maintainOffset=(this.config.maintainOffset);this.primaryButtonOnly=(this.config.primaryButtonOnly!==false);this.dragOnly=((this.config.dragOnly===true)?true:false);},handleOnAvailable:function(){this.available=true;this.resetConstraints();this.onAvailable();},setPadding:function(iTop,iRight,iBot,iLeft){if(!iRight&&0!==iRight){this.padding=[iTop,iTop,iTop,iTop];}else if(!iBot&&0!==iBot){this.padding=[iTop,iRight,iTop,iRight];}else{this.padding=[iTop,iRight,iBot,iLeft];}},setInitPosition:function(diffX,diffY){var el=this.getEl();if(!this.DDM.verifyEl(el)){if(el&&el.style&&(el.style.display=='none')){}else{}
return;}
var dx=diffX||0;var dy=diffY||0;var p=Dom.getXY(el);this.initPageX=p[0]-dx;this.initPageY=p[1]-dy;this.lastPageX=p[0];this.lastPageY=p[1];this.setStartPosition(p);},setStartPosition:function(pos){var p=pos||Dom.getXY(this.getEl());this.deltaSetXY=null;this.startPageX=p[0];this.startPageY=p[1];},addToGroup:function(sGroup){this.groups[sGroup]=true;this.DDM.regDragDrop(this,sGroup);},removeFromGroup:function(sGroup){if(this.groups[sGroup]){delete this.groups[sGroup];}
this.DDM.removeDDFromGroup(this,sGroup);},setDragElId:function(id){this.dragElId=id;},setHandleElId:function(id){if(typeof id!=="string"){id=Dom.generateId(id);}
this.handleElId=id;this.DDM.regHandle(this.id,id);},setOuterHandleElId:function(id){if(typeof id!=="string"){id=Dom.generateId(id);}
Event.on(id,"mousedown",this.handleMouseDown,this,true);this.setHandleElId(id);this.hasOuterHandles=true;},unreg:function(){Event.removeListener(this.id,"mousedown",this.handleMouseDown);this._domRef=null;this.DDM._remove(this);},isLocked:function(){return(this.DDM.isLocked()||this.locked);},handleMouseDown:function(e,oDD){var button=e.which||e.button;if(this.primaryButtonOnly&&button>1){return;}
if(this.isLocked()){return;}
var b4Return=this.b4MouseDown(e);if(this.events.b4MouseDown){b4Return=this.fireEvent('b4MouseDownEvent',e);}
var mDownReturn=this.onMouseDown(e);if(this.events.mouseDown){mDownReturn=this.fireEvent('mouseDownEvent',e);}
if((b4Return===false)||(mDownReturn===false)){return;}
this.DDM.refreshCache(this.groups);var pt=new YAHOO.util.Point(Event.getPageX(e),Event.getPageY(e));if(!this.hasOuterHandles&&!this.DDM.isOverTarget(pt,this)){}else{if(this.clickValidator(e)){this.setStartPosition();this.DDM.handleMouseDown(e,this);this.DDM.stopEvent(e);}else{}}},clickValidator:function(e){var target=YAHOO.util.Event.getTarget(e);return(this.isValidHandleChild(target)&&(this.id==this.handleElId||this.DDM.handleWasClicked(target,this.id)));},getTargetCoord:function(iPageX,iPageY){var x=iPageX-this.deltaX;var y=iPageY-this.deltaY;if(this.constrainX){if(x<this.minX){x=this.minX;}
if(x>this.maxX){x=this.maxX;}}
if(this.constrainY){if(y<this.minY){y=this.minY;}
if(y>this.maxY){y=this.maxY;}}
x=this.getTick(x,this.xTicks);y=this.getTick(y,this.yTicks);return{x:x,y:y};},addInvalidHandleType:function(tagName){var type=tagName.toUpperCase();this.invalidHandleTypes[type]=type;},addInvalidHandleId:function(id){if(typeof id!=="string"){id=Dom.generateId(id);}
this.invalidHandleIds[id]=id;},addInvalidHandleClass:function(cssClass){this.invalidHandleClasses.push(cssClass);},removeInvalidHandleType:function(tagName){var type=tagName.toUpperCase();delete this.invalidHandleTypes[type];},removeInvalidHandleId:function(id){if(typeof id!=="string"){id=Dom.generateId(id);}
delete this.invalidHandleIds[id];},removeInvalidHandleClass:function(cssClass){for(var i=0,len=this.invalidHandleClasses.length;i<len;++i){if(this.invalidHandleClasses[i]==cssClass){delete this.invalidHandleClasses[i];}}},isValidHandleChild:function(node){var valid=true;var nodeName;try{nodeName=node.nodeName.toUpperCase();}catch(e){nodeName=node.nodeName;}
valid=valid&&!this.invalidHandleTypes[nodeName];valid=valid&&!this.invalidHandleIds[node.id];for(var i=0,len=this.invalidHandleClasses.length;valid&&i<len;++i){valid=!Dom.hasClass(node,this.invalidHandleClasses[i]);}
return valid;},setXTicks:function(iStartX,iTickSize){this.xTicks=[];this.xTickSize=iTickSize;var tickMap={};for(var i=this.initPageX;i>=this.minX;i=i-iTickSize){if(!tickMap[i]){this.xTicks[this.xTicks.length]=i;tickMap[i]=true;}}
for(i=this.initPageX;i<=this.maxX;i=i+iTickSize){if(!tickMap[i]){this.xTicks[this.xTicks.length]=i;tickMap[i]=true;}}
this.xTicks.sort(this.DDM.numericSort);},setYTicks:function(iStartY,iTickSize){this.yTicks=[];this.yTickSize=iTickSize;var tickMap={};for(var i=this.initPageY;i>=this.minY;i=i-iTickSize){if(!tickMap[i]){this.yTicks[this.yTicks.length]=i;tickMap[i]=true;}}
for(i=this.initPageY;i<=this.maxY;i=i+iTickSize){if(!tickMap[i]){this.yTicks[this.yTicks.length]=i;tickMap[i]=true;}}
this.yTicks.sort(this.DDM.numericSort);},setXConstraint:function(iLeft,iRight,iTickSize){this.leftConstraint=parseInt(iLeft,10);this.rightConstraint=parseInt(iRight,10);this.minX=this.initPageX-this.leftConstraint;this.maxX=this.initPageX+this.rightConstraint;if(iTickSize){this.setXTicks(this.initPageX,iTickSize);}
this.constrainX=true;},clearConstraints:function(){this.constrainX=false;this.constrainY=false;this.clearTicks();},clearTicks:function(){this.xTicks=null;this.yTicks=null;this.xTickSize=0;this.yTickSize=0;},setYConstraint:function(iUp,iDown,iTickSize){this.topConstraint=parseInt(iUp,10);this.bottomConstraint=parseInt(iDown,10);this.minY=this.initPageY-this.topConstraint;this.maxY=this.initPageY+this.bottomConstraint;if(iTickSize){this.setYTicks(this.initPageY,iTickSize);}
this.constrainY=true;},resetConstraints:function(){if(this.initPageX||this.initPageX===0){var dx=(this.maintainOffset)?this.lastPageX-this.initPageX:0;var dy=(this.maintainOffset)?this.lastPageY-this.initPageY:0;this.setInitPosition(dx,dy);}else{this.setInitPosition();}
if(this.constrainX){this.setXConstraint(this.leftConstraint,this.rightConstraint,this.xTickSize);}
if(this.constrainY){this.setYConstraint(this.topConstraint,this.bottomConstraint,this.yTickSize);}},getTick:function(val,tickArray){if(!tickArray){return val;}else if(tickArray[0]>=val){return tickArray[0];}else{for(var i=0,len=tickArray.length;i<len;++i){var next=i+1;if(tickArray[next]&&tickArray[next]>=val){var diff1=val-tickArray[i];var diff2=tickArray[next]-val;return(diff2>diff1)?tickArray[i]:tickArray[next];}}
return tickArray[tickArray.length-1];}},toString:function(){return("DragDrop "+this.id);}};YAHOO.augment(YAHOO.util.DragDrop,YAHOO.util.EventProvider);})();YAHOO.util.DD=function(id,sGroup,config){if(id){this.init(id,sGroup,config);}};YAHOO.extend(YAHOO.util.DD,YAHOO.util.DragDrop,{scroll:true,autoOffset:function(iPageX,iPageY){var x=iPageX-this.startPageX;var y=iPageY-this.startPageY;this.setDelta(x,y);},setDelta:function(iDeltaX,iDeltaY){this.deltaX=iDeltaX;this.deltaY=iDeltaY;},setDragElPos:function(iPageX,iPageY){var el=this.getDragEl();this.alignElWithMouse(el,iPageX,iPageY);},alignElWithMouse:function(el,iPageX,iPageY){var oCoord=this.getTargetCoord(iPageX,iPageY);if(!this.deltaSetXY){var aCoord=[oCoord.x,oCoord.y];YAHOO.util.Dom.setXY(el,aCoord);var newLeft=parseInt(YAHOO.util.Dom.getStyle(el,"left"),10);var newTop=parseInt(YAHOO.util.Dom.getStyle(el,"top"),10);this.deltaSetXY=[newLeft-oCoord.x,newTop-oCoord.y];}else{YAHOO.util.Dom.setStyle(el,"left",(oCoord.x+this.deltaSetXY[0])+"px");YAHOO.util.Dom.setStyle(el,"top",(oCoord.y+this.deltaSetXY[1])+"px");}
this.cachePosition(oCoord.x,oCoord.y);var self=this;setTimeout(function(){self.autoScroll.call(self,oCoord.x,oCoord.y,el.offsetHeight,el.offsetWidth);},0);},cachePosition:function(iPageX,iPageY){if(iPageX){this.lastPageX=iPageX;this.lastPageY=iPageY;}else{var aCoord=YAHOO.util.Dom.getXY(this.getEl());this.lastPageX=aCoord[0];this.lastPageY=aCoord[1];}},autoScroll:function(x,y,h,w){if(this.scroll){var clientH=this.DDM.getClientHeight();var clientW=this.DDM.getClientWidth();var st=this.DDM.getScrollTop();var sl=this.DDM.getScrollLeft();var bot=h+y;var right=w+x;var toBot=(clientH+st-y-this.deltaY);var toRight=(clientW+sl-x-this.deltaX);var thresh=40;var scrAmt=(document.all)?80:30;if(bot>clientH&&toBot<thresh){window.scrollTo(sl,st+scrAmt);}
if(y<st&&st>0&&y-st<thresh){window.scrollTo(sl,st-scrAmt);}
if(right>clientW&&toRight<thresh){window.scrollTo(sl+scrAmt,st);}
if(x<sl&&sl>0&&x-sl<thresh){window.scrollTo(sl-scrAmt,st);}}},applyConfig:function(){YAHOO.util.DD.superclass.applyConfig.call(this);this.scroll=(this.config.scroll!==false);},b4MouseDown:function(e){this.setStartPosition();this.autoOffset(YAHOO.util.Event.getPageX(e),YAHOO.util.Event.getPageY(e));},b4Drag:function(e){this.setDragElPos(YAHOO.util.Event.getPageX(e),YAHOO.util.Event.getPageY(e));},toString:function(){return("DD "+this.id);}});YAHOO.util.DDProxy=function(id,sGroup,config){if(id){this.init(id,sGroup,config);this.initFrame();}};YAHOO.util.DDProxy.dragElId="ygddfdiv";YAHOO.extend(YAHOO.util.DDProxy,YAHOO.util.DD,{resizeFrame:true,centerFrame:false,createFrame:function(){var self=this,body=document.body;if(!body||!body.firstChild){setTimeout(function(){self.createFrame();},50);return;}
var div=this.getDragEl(),Dom=YAHOO.util.Dom;if(!div){div=document.createElement("div");div.id=this.dragElId;var s=div.style;s.position="absolute";s.visibility="hidden";s.cursor="move";s.border="2px solid #aaa";s.zIndex=999;s.height="25px";s.width="25px";var _data=document.createElement('div');Dom.setStyle(_data,'height','100%');Dom.setStyle(_data,'width','100%');Dom.setStyle(_data,'background-color','#ccc');Dom.setStyle(_data,'opacity','0');div.appendChild(_data);if(YAHOO.env.ua.ie){var ifr=document.createElement('iframe');ifr.setAttribute('src','javascript:');ifr.setAttribute('scrolling','no');ifr.setAttribute('frameborder','0');div.insertBefore(ifr,div.firstChild);Dom.setStyle(ifr,'height','100%');Dom.setStyle(ifr,'width','100%');Dom.setStyle(ifr,'position','absolute');Dom.setStyle(ifr,'top','0');Dom.setStyle(ifr,'left','0');Dom.setStyle(ifr,'opacity','0');Dom.setStyle(ifr,'zIndex','-1');Dom.setStyle(ifr.nextSibling,'zIndex','2');}
body.insertBefore(div,body.firstChild);}},initFrame:function(){this.createFrame();},applyConfig:function(){YAHOO.util.DDProxy.superclass.applyConfig.call(this);this.resizeFrame=(this.config.resizeFrame!==false);this.centerFrame=(this.config.centerFrame);this.setDragElId(this.config.dragElId||YAHOO.util.DDProxy.dragElId);},showFrame:function(iPageX,iPageY){var el=this.getEl();var dragEl=this.getDragEl();var s=dragEl.style;this._resizeProxy();if(this.centerFrame){this.setDelta(Math.round(parseInt(s.width,10)/2),Math.round(parseInt(s.height,10)/2));}
this.setDragElPos(iPageX,iPageY);YAHOO.util.Dom.setStyle(dragEl,"visibility","visible");},_resizeProxy:function(){if(this.resizeFrame){var DOM=YAHOO.util.Dom;var el=this.getEl();var dragEl=this.getDragEl();var bt=parseInt(DOM.getStyle(dragEl,"borderTopWidth"),10);var br=parseInt(DOM.getStyle(dragEl,"borderRightWidth"),10);var bb=parseInt(DOM.getStyle(dragEl,"borderBottomWidth"),10);var bl=parseInt(DOM.getStyle(dragEl,"borderLeftWidth"),10);if(isNaN(bt)){bt=0;}
if(isNaN(br)){br=0;}
if(isNaN(bb)){bb=0;}
if(isNaN(bl)){bl=0;}
var newWidth=Math.max(0,el.offsetWidth-br-bl);var newHeight=Math.max(0,el.offsetHeight-bt-bb);DOM.setStyle(dragEl,"width",newWidth+"px");DOM.setStyle(dragEl,"height",newHeight+"px");}},b4MouseDown:function(e){this.setStartPosition();var x=YAHOO.util.Event.getPageX(e);var y=YAHOO.util.Event.getPageY(e);this.autoOffset(x,y);},b4StartDrag:function(x,y){this.showFrame(x,y);},b4EndDrag:function(e){YAHOO.util.Dom.setStyle(this.getDragEl(),"visibility","hidden");},endDrag:function(e){var DOM=YAHOO.util.Dom;var lel=this.getEl();var del=this.getDragEl();DOM.setStyle(del,"visibility","");DOM.setStyle(lel,"visibility","hidden");YAHOO.util.DDM.moveToEl(lel,del);DOM.setStyle(del,"visibility","hidden");DOM.setStyle(lel,"visibility","");},toString:function(){return("DDProxy "+this.id);}});YAHOO.util.DDTarget=function(id,sGroup,config){if(id){this.initTarget(id,sGroup,config);}};YAHOO.extend(YAHOO.util.DDTarget,YAHOO.util.DragDrop,{toString:function(){return("DDTarget "+this.id);}});YAHOO.register("dragdrop",YAHOO.util.DragDropMgr,{version:"2.5.2",build:"1076"});

(function(){YAHOO.util.Config=function(owner){if(owner){this.init(owner);}};var Lang=YAHOO.lang,CustomEvent=YAHOO.util.CustomEvent,Config=YAHOO.util.Config;Config.CONFIG_CHANGED_EVENT="configChanged";Config.BOOLEAN_TYPE="boolean";Config.prototype={owner:null,queueInProgress:false,config:null,initialConfig:null,eventQueue:null,configChangedEvent:null,init:function(owner){this.owner=owner;this.configChangedEvent=this.createEvent(Config.CONFIG_CHANGED_EVENT);this.configChangedEvent.signature=CustomEvent.LIST;this.queueInProgress=false;this.config={};this.initialConfig={};this.eventQueue=[];},checkBoolean:function(val){return(typeof val==Config.BOOLEAN_TYPE);},checkNumber:function(val){return(!isNaN(val));},fireEvent:function(key,value){var property=this.config[key];if(property&&property.event){property.event.fire(value);}},addProperty:function(key,propertyObject){key=key.toLowerCase();this.config[key]=propertyObject;propertyObject.event=this.createEvent(key,{scope:this.owner});propertyObject.event.signature=CustomEvent.LIST;propertyObject.key=key;if(propertyObject.handler){propertyObject.event.subscribe(propertyObject.handler,this.owner);}
this.setProperty(key,propertyObject.value,true);if(!propertyObject.suppressEvent){this.queueProperty(key,propertyObject.value);}},getConfig:function(){var cfg={},prop,property;for(prop in this.config){property=this.config[prop];if(property&&property.event){cfg[prop]=property.value;}}
return cfg;},getProperty:function(key){var property=this.config[key.toLowerCase()];if(property&&property.event){return property.value;}else{return undefined;}},resetProperty:function(key){key=key.toLowerCase();var property=this.config[key];if(property&&property.event){if(this.initialConfig[key]&&!Lang.isUndefined(this.initialConfig[key])){this.setProperty(key,this.initialConfig[key]);return true;}}else{return false;}},setProperty:function(key,value,silent){var property;key=key.toLowerCase();if(this.queueInProgress&&!silent){this.queueProperty(key,value);return true;}else{property=this.config[key];if(property&&property.event){if(property.validator&&!property.validator(value)){return false;}else{property.value=value;if(!silent){this.fireEvent(key,value);this.configChangedEvent.fire([key,value]);}
return true;}}else{return false;}}},queueProperty:function(key,value){key=key.toLowerCase();var property=this.config[key],foundDuplicate=false,iLen,queueItem,queueItemKey,queueItemValue,sLen,supercedesCheck,qLen,queueItemCheck,queueItemCheckKey,queueItemCheckValue,i,s,q;if(property&&property.event){if(!Lang.isUndefined(value)&&property.validator&&!property.validator(value)){return false;}else{if(!Lang.isUndefined(value)){property.value=value;}else{value=property.value;}
foundDuplicate=false;iLen=this.eventQueue.length;for(i=0;i<iLen;i++){queueItem=this.eventQueue[i];if(queueItem){queueItemKey=queueItem[0];queueItemValue=queueItem[1];if(queueItemKey==key){this.eventQueue[i]=null;this.eventQueue.push([key,(!Lang.isUndefined(value)?value:queueItemValue)]);foundDuplicate=true;break;}}}
if(!foundDuplicate&&!Lang.isUndefined(value)){this.eventQueue.push([key,value]);}}
if(property.supercedes){sLen=property.supercedes.length;for(s=0;s<sLen;s++){supercedesCheck=property.supercedes[s];qLen=this.eventQueue.length;for(q=0;q<qLen;q++){queueItemCheck=this.eventQueue[q];if(queueItemCheck){queueItemCheckKey=queueItemCheck[0];queueItemCheckValue=queueItemCheck[1];if(queueItemCheckKey==supercedesCheck.toLowerCase()){this.eventQueue.push([queueItemCheckKey,queueItemCheckValue]);this.eventQueue[q]=null;break;}}}}}
return true;}else{return false;}},refireEvent:function(key){key=key.toLowerCase();var property=this.config[key];if(property&&property.event&&!Lang.isUndefined(property.value)){if(this.queueInProgress){this.queueProperty(key);}else{this.fireEvent(key,property.value);}}},applyConfig:function(userConfig,init){var sKey,oConfig;if(init){oConfig={};for(sKey in userConfig){if(Lang.hasOwnProperty(userConfig,sKey)){oConfig[sKey.toLowerCase()]=userConfig[sKey];}}
this.initialConfig=oConfig;}
for(sKey in userConfig){if(Lang.hasOwnProperty(userConfig,sKey)){this.queueProperty(sKey,userConfig[sKey]);}}},refresh:function(){var prop;for(prop in this.config){this.refireEvent(prop);}},fireQueue:function(){var i,queueItem,key,value,property;this.queueInProgress=true;for(i=0;i<this.eventQueue.length;i++){queueItem=this.eventQueue[i];if(queueItem){key=queueItem[0];value=queueItem[1];property=this.config[key];property.value=value;this.fireEvent(key,value);}}
this.queueInProgress=false;this.eventQueue=[];},subscribeToConfigEvent:function(key,handler,obj,override){var property=this.config[key.toLowerCase()];if(property&&property.event){if(!Config.alreadySubscribed(property.event,handler,obj)){property.event.subscribe(handler,obj,override);}
return true;}else{return false;}},unsubscribeFromConfigEvent:function(key,handler,obj){var property=this.config[key.toLowerCase()];if(property&&property.event){return property.event.unsubscribe(handler,obj);}else{return false;}},toString:function(){var output="Config";if(this.owner){output+=" ["+this.owner.toString()+"]";}
return output;},outputEventQueue:function(){var output="",queueItem,q,nQueue=this.eventQueue.length;for(q=0;q<nQueue;q++){queueItem=this.eventQueue[q];if(queueItem){output+=queueItem[0]+"="+queueItem[1]+", ";}}
return output;},destroy:function(){var oConfig=this.config,sProperty,oProperty;for(sProperty in oConfig){if(Lang.hasOwnProperty(oConfig,sProperty)){oProperty=oConfig[sProperty];oProperty.event.unsubscribeAll();oProperty.event=null;}}
this.configChangedEvent.unsubscribeAll();this.configChangedEvent=null;this.owner=null;this.config=null;this.initialConfig=null;this.eventQueue=null;}};Config.alreadySubscribed=function(evt,fn,obj){var nSubscribers=evt.subscribers.length,subsc,i;if(nSubscribers>0){i=nSubscribers-1;do{subsc=evt.subscribers[i];if(subsc&&subsc.obj==obj&&subsc.fn==fn){return true;}}
while(i--);}
return false;};YAHOO.lang.augmentProto(Config,YAHOO.util.EventProvider);}());(function(){YAHOO.widget.Module=function(el,userConfig){if(el){this.init(el,userConfig);}else{}};var Dom=YAHOO.util.Dom,Config=YAHOO.util.Config,Event=YAHOO.util.Event,CustomEvent=YAHOO.util.CustomEvent,Module=YAHOO.widget.Module,m_oModuleTemplate,m_oHeaderTemplate,m_oBodyTemplate,m_oFooterTemplate,EVENT_TYPES={"BEFORE_INIT":"beforeInit","INIT":"init","APPEND":"append","BEFORE_RENDER":"beforeRender","RENDER":"render","CHANGE_HEADER":"changeHeader","CHANGE_BODY":"changeBody","CHANGE_FOOTER":"changeFooter","CHANGE_CONTENT":"changeContent","DESTORY":"destroy","BEFORE_SHOW":"beforeShow","SHOW":"show","BEFORE_HIDE":"beforeHide","HIDE":"hide"},DEFAULT_CONFIG={"VISIBLE":{key:"visible",value:true,validator:YAHOO.lang.isBoolean},"EFFECT":{key:"effect",suppressEvent:true,supercedes:["visible"]},"MONITOR_RESIZE":{key:"monitorresize",value:true},"APPEND_TO_DOCUMENT_BODY":{key:"appendtodocumentbody",value:false}};Module.IMG_ROOT=null;Module.IMG_ROOT_SSL=null;Module.CSS_MODULE="yui-module";Module.CSS_HEADER="hd";Module.CSS_BODY="bd";Module.CSS_FOOTER="ft";Module.RESIZE_MONITOR_SECURE_URL="javascript:false;";Module.textResizeEvent=new CustomEvent("textResize");function createModuleTemplate(){if(!m_oModuleTemplate){m_oModuleTemplate=document.createElement("div");m_oModuleTemplate.innerHTML=("<div class=\""+
Module.CSS_HEADER+"\"></div>"+"<div class=\""+
Module.CSS_BODY+"\"></div><div class=\""+
Module.CSS_FOOTER+"\"></div>");m_oHeaderTemplate=m_oModuleTemplate.firstChild;m_oBodyTemplate=m_oHeaderTemplate.nextSibling;m_oFooterTemplate=m_oBodyTemplate.nextSibling;}
return m_oModuleTemplate;}
function createHeader(){if(!m_oHeaderTemplate){createModuleTemplate();}
return(m_oHeaderTemplate.cloneNode(false));}
function createBody(){if(!m_oBodyTemplate){createModuleTemplate();}
return(m_oBodyTemplate.cloneNode(false));}
function createFooter(){if(!m_oFooterTemplate){createModuleTemplate();}
return(m_oFooterTemplate.cloneNode(false));}
Module.prototype={constructor:Module,element:null,header:null,body:null,footer:null,id:null,imageRoot:Module.IMG_ROOT,initEvents:function(){var SIGNATURE=CustomEvent.LIST;this.beforeInitEvent=this.createEvent(EVENT_TYPES.BEFORE_INIT);this.beforeInitEvent.signature=SIGNATURE;this.initEvent=this.createEvent(EVENT_TYPES.INIT);this.initEvent.signature=SIGNATURE;this.appendEvent=this.createEvent(EVENT_TYPES.APPEND);this.appendEvent.signature=SIGNATURE;this.beforeRenderEvent=this.createEvent(EVENT_TYPES.BEFORE_RENDER);this.beforeRenderEvent.signature=SIGNATURE;this.renderEvent=this.createEvent(EVENT_TYPES.RENDER);this.renderEvent.signature=SIGNATURE;this.changeHeaderEvent=this.createEvent(EVENT_TYPES.CHANGE_HEADER);this.changeHeaderEvent.signature=SIGNATURE;this.changeBodyEvent=this.createEvent(EVENT_TYPES.CHANGE_BODY);this.changeBodyEvent.signature=SIGNATURE;this.changeFooterEvent=this.createEvent(EVENT_TYPES.CHANGE_FOOTER);this.changeFooterEvent.signature=SIGNATURE;this.changeContentEvent=this.createEvent(EVENT_TYPES.CHANGE_CONTENT);this.changeContentEvent.signature=SIGNATURE;this.destroyEvent=this.createEvent(EVENT_TYPES.DESTORY);this.destroyEvent.signature=SIGNATURE;this.beforeShowEvent=this.createEvent(EVENT_TYPES.BEFORE_SHOW);this.beforeShowEvent.signature=SIGNATURE;this.showEvent=this.createEvent(EVENT_TYPES.SHOW);this.showEvent.signature=SIGNATURE;this.beforeHideEvent=this.createEvent(EVENT_TYPES.BEFORE_HIDE);this.beforeHideEvent.signature=SIGNATURE;this.hideEvent=this.createEvent(EVENT_TYPES.HIDE);this.hideEvent.signature=SIGNATURE;},platform:function(){var ua=navigator.userAgent.toLowerCase();if(ua.indexOf("windows")!=-1||ua.indexOf("win32")!=-1){return"windows";}else if(ua.indexOf("macintosh")!=-1){return"mac";}else{return false;}}(),browser:function(){var ua=navigator.userAgent.toLowerCase();if(ua.indexOf('opera')!=-1){return'opera';}else if(ua.indexOf('msie 7')!=-1){return'ie7';}else if(ua.indexOf('msie')!=-1){return'ie';}else if(ua.indexOf('safari')!=-1){return'safari';}else if(ua.indexOf('gecko')!=-1){return'gecko';}else{return false;}}(),isSecure:function(){if(window.location.href.toLowerCase().indexOf("httpdisabledsdisabled")===0){return true;}else{return false;}}(),initDefaultConfig:function(){this.cfg.addProperty(DEFAULT_CONFIG.VISIBLE.key,{handler:this.configVisible,value:DEFAULT_CONFIG.VISIBLE.value,validator:DEFAULT_CONFIG.VISIBLE.validator});this.cfg.addProperty(DEFAULT_CONFIG.EFFECT.key,{suppressEvent:DEFAULT_CONFIG.EFFECT.suppressEvent,supercedes:DEFAULT_CONFIG.EFFECT.supercedes});this.cfg.addProperty(DEFAULT_CONFIG.MONITOR_RESIZE.key,{handler:this.configMonitorResize,value:DEFAULT_CONFIG.MONITOR_RESIZE.value});this.cfg.addProperty(DEFAULT_CONFIG.APPEND_TO_DOCUMENT_BODY.key,{value:DEFAULT_CONFIG.APPEND_TO_DOCUMENT_BODY.value});},init:function(el,userConfig){var elId,child;this.initEvents();this.beforeInitEvent.fire(Module);this.cfg=new Config(this);if(this.isSecure){this.imageRoot=Module.IMG_ROOT_SSL;}
if(typeof el=="string"){elId=el;el=document.getElementById(el);if(!el){el=(createModuleTemplate()).cloneNode(false);el.id=elId;}}
this.element=el;if(el.id){this.id=el.id;}
child=this.element.firstChild;if(child){var fndHd=false,fndBd=false,fndFt=false;do{if(1==child.nodeType){if(!fndHd&&Dom.hasClass(child,Module.CSS_HEADER)){this.header=child;fndHd=true;}else if(!fndBd&&Dom.hasClass(child,Module.CSS_BODY)){this.body=child;fndBd=true;}else if(!fndFt&&Dom.hasClass(child,Module.CSS_FOOTER)){this.footer=child;fndFt=true;}}}while((child=child.nextSibling));}
this.initDefaultConfig();Dom.addClass(this.element,Module.CSS_MODULE);if(userConfig){this.cfg.applyConfig(userConfig,true);}
if(!Config.alreadySubscribed(this.renderEvent,this.cfg.fireQueue,this.cfg)){this.renderEvent.subscribe(this.cfg.fireQueue,this.cfg,true);}
this.initEvent.fire(Module);},initResizeMonitor:function(){var isGeckoWin=(YAHOO.env.ua.gecko&&this.platform=="windows");if(isGeckoWin){var self=this;setTimeout(function(){self._initResizeMonitor();},0);}else{this._initResizeMonitor();}},_initResizeMonitor:function(){var oDoc,oIFrame,sHTML;function fireTextResize(){Module.textResizeEvent.fire();}
if(!YAHOO.env.ua.opera){oIFrame=Dom.get("_yuiResizeMonitor");var supportsCWResize=this._supportsCWResize();if(!oIFrame){oIFrame=document.createElement("iframe");if(this.isSecure&&Module.RESIZE_MONITOR_SECURE_URL&&YAHOO.env.ua.ie){oIFrame.src=Module.RESIZE_MONITOR_SECURE_URL;}
if(!supportsCWResize){sHTML=["<html><head><script ","type=\"text/javascript\">","window.onresize=function(){window.parent.","YAHOO.widget.Module.textResizeEvent.","fire();};<","\/script></head>","<body></body></html>"].join('');oIFrame.src="data:text/html;charset=utf-8,"+encodeURIComponent(sHTML);}
oIFrame.id="_yuiResizeMonitor";oIFrame.style.position="absolute";oIFrame.style.visibility="hidden";var db=document.body,fc=db.firstChild;if(fc){db.insertBefore(oIFrame,fc);}else{db.appendChild(oIFrame);}
oIFrame.style.width="10em";oIFrame.style.height="10em";oIFrame.style.top=(-1*oIFrame.offsetHeight)+"px";oIFrame.style.left=(-1*oIFrame.offsetWidth)+"px";oIFrame.style.borderWidth="0";oIFrame.style.visibility="visible";if(YAHOO.env.ua.webkit){oDoc=oIFrame.contentWindow.document;void();oDoc.close();}}
if(oIFrame&&oIFrame.contentWindow){Module.textResizeEvent.subscribe(this.onDomResize,this,true);if(!Module.textResizeInitialized){if(supportsCWResize){if(!Event.on(oIFrame.contentWindow,"resize",fireTextResize)){Event.on(oIFrame,"resize",fireTextResize);}}
Module.textResizeInitialized=true;}
this.resizeMonitor=oIFrame;}}},_supportsCWResize:function(){var bSupported=true;if(YAHOO.env.ua.gecko&&YAHOO.env.ua.gecko<=1.8){bSupported=false;}
return bSupported;},onDomResize:function(e,obj){var nLeft=-1*this.resizeMonitor.offsetWidth,nTop=-1*this.resizeMonitor.offsetHeight;this.resizeMonitor.style.top=nTop+"px";this.resizeMonitor.style.left=nLeft+"px";},setHeader:function(headerContent){var oHeader=this.header||(this.header=createHeader());if(headerContent.nodeName){oHeader.innerHTML="";oHeader.appendChild(headerContent);}else{oHeader.innerHTML=headerContent;}
this.changeHeaderEvent.fire(headerContent);this.changeContentEvent.fire();},appendToHeader:function(element){var oHeader=this.header||(this.header=createHeader());oHeader.appendChild(element);this.changeHeaderEvent.fire(element);this.changeContentEvent.fire();},setBody:function(bodyContent){var oBody=this.body||(this.body=createBody());if(bodyContent.nodeName){oBody.innerHTML="";oBody.appendChild(bodyContent);}else{oBody.innerHTML=bodyContent;}
this.changeBodyEvent.fire(bodyContent);this.changeContentEvent.fire();},appendToBody:function(element){var oBody=this.body||(this.body=createBody());oBody.appendChild(element);this.changeBodyEvent.fire(element);this.changeContentEvent.fire();},setFooter:function(footerContent){var oFooter=this.footer||(this.footer=createFooter());if(footerContent.nodeName){oFooter.innerHTML="";oFooter.appendChild(footerContent);}else{oFooter.innerHTML=footerContent;}
this.changeFooterEvent.fire(footerContent);this.changeContentEvent.fire();},appendToFooter:function(element){var oFooter=this.footer||(this.footer=createFooter());oFooter.appendChild(element);this.changeFooterEvent.fire(element);this.changeContentEvent.fire();},render:function(appendToNode,moduleElement){var me=this,firstChild;function appendTo(parentNode){if(typeof parentNode=="string"){parentNode=document.getElementById(parentNode);}
if(parentNode){me._addToParent(parentNode,me.element);me.appendEvent.fire();}}
this.beforeRenderEvent.fire();if(!moduleElement){moduleElement=this.element;}
if(appendToNode){appendTo(appendToNode);}else{if(!Dom.inDocument(this.element)){return false;}}
if(this.header&&!Dom.inDocument(this.header)){firstChild=moduleElement.firstChild;if(firstChild){moduleElement.insertBefore(this.header,firstChild);}else{moduleElement.appendChild(this.header);}}
if(this.body&&!Dom.inDocument(this.body)){if(this.footer&&Dom.isAncestor(this.moduleElement,this.footer)){moduleElement.insertBefore(this.body,this.footer);}else{moduleElement.appendChild(this.body);}}
if(this.footer&&!Dom.inDocument(this.footer)){moduleElement.appendChild(this.footer);}
this.renderEvent.fire();return true;},destroy:function(){var parent,e;if(this.element){Event.purgeElement(this.element,true);parent=this.element.parentNode;}
if(parent){parent.removeChild(this.element);}
this.element=null;this.header=null;this.body=null;this.footer=null;Module.textResizeEvent.unsubscribe(this.onDomResize,this);this.cfg.destroy();this.cfg=null;this.destroyEvent.fire();for(e in this){if(e instanceof CustomEvent){e.unsubscribeAll();}}},show:function(){this.cfg.setProperty("visible",true);},hide:function(){this.cfg.setProperty("visible",false);},configVisible:function(type,args,obj){var visible=args[0];if(visible){this.beforeShowEvent.fire();Dom.setStyle(this.element,"display","block");this.showEvent.fire();}else{this.beforeHideEvent.fire();Dom.setStyle(this.element,"display","none");this.hideEvent.fire();}},configMonitorResize:function(type,args,obj){var monitor=args[0];if(monitor){this.initResizeMonitor();}else{Module.textResizeEvent.unsubscribe(this.onDomResize,this,true);this.resizeMonitor=null;}},_addToParent:function(parentNode,element){if(!this.cfg.getProperty("appendtodocumentbody")&&parentNode===document.body&&parentNode.firstChild){parentNode.insertBefore(element,parentNode.firstChild);}else{parentNode.appendChild(element);}},toString:function(){return"Module "+this.id;}};YAHOO.lang.augmentProto(Module,YAHOO.util.EventProvider);}());(function(){YAHOO.widget.Overlay=function(el,userConfig){YAHOO.widget.Overlay.superclass.constructor.call(this,el,userConfig);};var Lang=YAHOO.lang,CustomEvent=YAHOO.util.CustomEvent,Module=YAHOO.widget.Module,Event=YAHOO.util.Event,Dom=YAHOO.util.Dom,Config=YAHOO.util.Config,Overlay=YAHOO.widget.Overlay,m_oIFrameTemplate,EVENT_TYPES={"BEFORE_MOVE":"beforeMove","MOVE":"move"},DEFAULT_CONFIG={"X":{key:"x",validator:Lang.isNumber,suppressEvent:true,supercedes:["iframe"]},"Y":{key:"y",validator:Lang.isNumber,suppressEvent:true,supercedes:["iframe"]},"XY":{key:"xy",suppressEvent:true,supercedes:["iframe"]},"CONTEXT":{key:"context",suppressEvent:true,supercedes:["iframe"]},"FIXED_CENTER":{key:"fixedcenter",value:false,validator:Lang.isBoolean,supercedes:["iframe","visible"]},"WIDTH":{key:"width",suppressEvent:true,supercedes:["context","fixedcenter","iframe"]},"HEIGHT":{key:"height",suppressEvent:true,supercedes:["context","fixedcenter","iframe"]},"ZINDEX":{key:"zindex",value:null},"CONSTRAIN_TO_VIEWPORT":{key:"constraintoviewport",value:false,validator:Lang.isBoolean,supercedes:["iframe","x","y","xy"]},"IFRAME":{key:"iframe",value:(YAHOO.env.ua.ie==6?true:false),validator:Lang.isBoolean,supercedes:["zindex"]}};Overlay.IFRAME_SRC="javascript:false;";Overlay.IFRAME_OFFSET=3;Overlay.VIEWPORT_OFFSET=10;Overlay.TOP_LEFT="tl";Overlay.TOP_RIGHT="tr";Overlay.BOTTOM_LEFT="bl";Overlay.BOTTOM_RIGHT="br";Overlay.CSS_OVERLAY="yui-overlay";Overlay.windowScrollEvent=new CustomEvent("windowScroll");Overlay.windowResizeEvent=new CustomEvent("windowResize");Overlay.windowScrollHandler=function(e){if(YAHOO.env.ua.ie){if(!window.scrollEnd){window.scrollEnd=-1;}
clearTimeout(window.scrollEnd);window.scrollEnd=setTimeout(function(){Overlay.windowScrollEvent.fire();},1);}else{Overlay.windowScrollEvent.fire();}};Overlay.windowResizeHandler=function(e){if(YAHOO.env.ua.ie){if(!window.resizeEnd){window.resizeEnd=-1;}
clearTimeout(window.resizeEnd);window.resizeEnd=setTimeout(function(){Overlay.windowResizeEvent.fire();},100);}else{Overlay.windowResizeEvent.fire();}};Overlay._initialized=null;if(Overlay._initialized===null){Event.on(window,"scroll",Overlay.windowScrollHandler);Event.on(window,"resize",Overlay.windowResizeHandler);Overlay._initialized=true;}
YAHOO.extend(Overlay,Module,{init:function(el,userConfig){Overlay.superclass.init.call(this,el);this.beforeInitEvent.fire(Overlay);Dom.addClass(this.element,Overlay.CSS_OVERLAY);if(userConfig){this.cfg.applyConfig(userConfig,true);}
if(this.platform=="mac"&&YAHOO.env.ua.gecko){if(!Config.alreadySubscribed(this.showEvent,this.showMacGeckoScrollbars,this)){this.showEvent.subscribe(this.showMacGeckoScrollbars,this,true);}
if(!Config.alreadySubscribed(this.hideEvent,this.hideMacGeckoScrollbars,this)){this.hideEvent.subscribe(this.hideMacGeckoScrollbars,this,true);}}
this.initEvent.fire(Overlay);},initEvents:function(){Overlay.superclass.initEvents.call(this);var SIGNATURE=CustomEvent.LIST;this.beforeMoveEvent=this.createEvent(EVENT_TYPES.BEFORE_MOVE);this.beforeMoveEvent.signature=SIGNATURE;this.moveEvent=this.createEvent(EVENT_TYPES.MOVE);this.moveEvent.signature=SIGNATURE;},initDefaultConfig:function(){Overlay.superclass.initDefaultConfig.call(this);this.cfg.addProperty(DEFAULT_CONFIG.X.key,{handler:this.configX,validator:DEFAULT_CONFIG.X.validator,suppressEvent:DEFAULT_CONFIG.X.suppressEvent,supercedes:DEFAULT_CONFIG.X.supercedes});this.cfg.addProperty(DEFAULT_CONFIG.Y.key,{handler:this.configY,validator:DEFAULT_CONFIG.Y.validator,suppressEvent:DEFAULT_CONFIG.Y.suppressEvent,supercedes:DEFAULT_CONFIG.Y.supercedes});this.cfg.addProperty(DEFAULT_CONFIG.XY.key,{handler:this.configXY,suppressEvent:DEFAULT_CONFIG.XY.suppressEvent,supercedes:DEFAULT_CONFIG.XY.supercedes});this.cfg.addProperty(DEFAULT_CONFIG.CONTEXT.key,{handler:this.configContext,suppressEvent:DEFAULT_CONFIG.CONTEXT.suppressEvent,supercedes:DEFAULT_CONFIG.CONTEXT.supercedes});this.cfg.addProperty(DEFAULT_CONFIG.FIXED_CENTER.key,{handler:this.configFixedCenter,value:DEFAULT_CONFIG.FIXED_CENTER.value,validator:DEFAULT_CONFIG.FIXED_CENTER.validator,supercedes:DEFAULT_CONFIG.FIXED_CENTER.supercedes});this.cfg.addProperty(DEFAULT_CONFIG.WIDTH.key,{handler:this.configWidth,suppressEvent:DEFAULT_CONFIG.WIDTH.suppressEvent,supercedes:DEFAULT_CONFIG.WIDTH.supercedes});this.cfg.addProperty(DEFAULT_CONFIG.HEIGHT.key,{handler:this.configHeight,suppressEvent:DEFAULT_CONFIG.HEIGHT.suppressEvent,supercedes:DEFAULT_CONFIG.HEIGHT.supercedes});this.cfg.addProperty(DEFAULT_CONFIG.ZINDEX.key,{handler:this.configzIndex,value:DEFAULT_CONFIG.ZINDEX.value});this.cfg.addProperty(DEFAULT_CONFIG.CONSTRAIN_TO_VIEWPORT.key,{handler:this.configConstrainToViewport,value:DEFAULT_CONFIG.CONSTRAIN_TO_VIEWPORT.value,validator:DEFAULT_CONFIG.CONSTRAIN_TO_VIEWPORT.validator,supercedes:DEFAULT_CONFIG.CONSTRAIN_TO_VIEWPORT.supercedes});this.cfg.addProperty(DEFAULT_CONFIG.IFRAME.key,{handler:this.configIframe,value:DEFAULT_CONFIG.IFRAME.value,validator:DEFAULT_CONFIG.IFRAME.validator,supercedes:DEFAULT_CONFIG.IFRAME.supercedes});},moveTo:function(x,y){this.cfg.setProperty("xy",[x,y]);},hideMacGeckoScrollbars:function(){Dom.removeClass(this.element,"show-scrollbars");Dom.addClass(this.element,"hide-scrollbars");},showMacGeckoScrollbars:function(){Dom.removeClass(this.element,"hide-scrollbars");Dom.addClass(this.element,"show-scrollbars");},configVisible:function(type,args,obj){var visible=args[0],currentVis=Dom.getStyle(this.element,"visibility"),effect=this.cfg.getProperty("effect"),effectInstances=[],isMacGecko=(this.platform=="mac"&&YAHOO.env.ua.gecko),alreadySubscribed=Config.alreadySubscribed,eff,ei,e,i,j,k,h,nEffects,nEffectInstances;if(currentVis=="inherit"){e=this.element.parentNode;while(e.nodeType!=9&&e.nodeType!=11){currentVis=Dom.getStyle(e,"visibility");if(currentVis!="inherit"){break;}
e=e.parentNode;}
if(currentVis=="inherit"){currentVis="visible";}}
if(effect){if(effect instanceof Array){nEffects=effect.length;for(i=0;i<nEffects;i++){eff=effect[i];effectInstances[effectInstances.length]=eff.effect(this,eff.duration);}}else{effectInstances[effectInstances.length]=effect.effect(this,effect.duration);}}
if(visible){if(isMacGecko){this.showMacGeckoScrollbars();}
if(effect){if(visible){if(currentVis!="visible"||currentVis===""){this.beforeShowEvent.fire();nEffectInstances=effectInstances.length;for(j=0;j<nEffectInstances;j++){ei=effectInstances[j];if(j===0&&!alreadySubscribed(ei.animateInCompleteEvent,this.showEvent.fire,this.showEvent)){ei.animateInCompleteEvent.subscribe(this.showEvent.fire,this.showEvent,true);}
ei.animateIn();}}}}else{if(currentVis!="visible"||currentVis===""){this.beforeShowEvent.fire();Dom.setStyle(this.element,"visibility","visible");this.cfg.refireEvent("iframe");this.showEvent.fire();}}}else{if(isMacGecko){this.hideMacGeckoScrollbars();}
if(effect){if(currentVis=="visible"){this.beforeHideEvent.fire();nEffectInstances=effectInstances.length;for(k=0;k<nEffectInstances;k++){h=effectInstances[k];if(k===0&&!alreadySubscribed(h.animateOutCompleteEvent,this.hideEvent.fire,this.hideEvent)){h.animateOutCompleteEvent.subscribe(this.hideEvent.fire,this.hideEvent,true);}
h.animateOut();}}else if(currentVis===""){Dom.setStyle(this.element,"visibility","hidden");}}else{if(currentVis=="visible"||currentVis===""){this.beforeHideEvent.fire();Dom.setStyle(this.element,"visibility","hidden");this.hideEvent.fire();}}}},doCenterOnDOMEvent:function(){if(this.cfg.getProperty("visible")){this.center();}},configFixedCenter:function(type,args,obj){var val=args[0],alreadySubscribed=Config.alreadySubscribed,windowResizeEvent=Overlay.windowResizeEvent,windowScrollEvent=Overlay.windowScrollEvent;if(val){this.center();if(!alreadySubscribed(this.beforeShowEvent,this.center,this)){this.beforeShowEvent.subscribe(this.center);}
if(!alreadySubscribed(windowResizeEvent,this.doCenterOnDOMEvent,this)){windowResizeEvent.subscribe(this.doCenterOnDOMEvent,this,true);}
if(!alreadySubscribed(windowScrollEvent,this.doCenterOnDOMEvent,this)){windowScrollEvent.subscribe(this.doCenterOnDOMEvent,this,true);}}else{this.beforeShowEvent.unsubscribe(this.center);windowResizeEvent.unsubscribe(this.doCenterOnDOMEvent,this);windowScrollEvent.unsubscribe(this.doCenterOnDOMEvent,this);}},configHeight:function(type,args,obj){var height=args[0],el=this.element;Dom.setStyle(el,"height",height);this.cfg.refireEvent("iframe");},configWidth:function(type,args,obj){var width=args[0],el=this.element;Dom.setStyle(el,"width",width);this.cfg.refireEvent("iframe");},configzIndex:function(type,args,obj){var zIndex=args[0],el=this.element;if(!zIndex){zIndex=Dom.getStyle(el,"zIndex");if(!zIndex||isNaN(zIndex)){zIndex=0;}}
if(this.iframe||this.cfg.getProperty("iframe")===true){if(zIndex<=0){zIndex=1;}}
Dom.setStyle(el,"zIndex",zIndex);this.cfg.setProperty("zIndex",zIndex,true);if(this.iframe){this.stackIframe();}},configXY:function(type,args,obj){var pos=args[0],x=pos[0],y=pos[1];this.cfg.setProperty("x",x);this.cfg.setProperty("y",y);this.beforeMoveEvent.fire([x,y]);x=this.cfg.getProperty("x");y=this.cfg.getProperty("y");this.cfg.refireEvent("iframe");this.moveEvent.fire([x,y]);},configX:function(type,args,obj){var x=args[0],y=this.cfg.getProperty("y");this.cfg.setProperty("x",x,true);this.cfg.setProperty("y",y,true);this.beforeMoveEvent.fire([x,y]);x=this.cfg.getProperty("x");y=this.cfg.getProperty("y");Dom.setX(this.element,x,true);this.cfg.setProperty("xy",[x,y],true);this.cfg.refireEvent("iframe");this.moveEvent.fire([x,y]);},configY:function(type,args,obj){var x=this.cfg.getProperty("x"),y=args[0];this.cfg.setProperty("x",x,true);this.cfg.setProperty("y",y,true);this.beforeMoveEvent.fire([x,y]);x=this.cfg.getProperty("x");y=this.cfg.getProperty("y");Dom.setY(this.element,y,true);this.cfg.setProperty("xy",[x,y],true);this.cfg.refireEvent("iframe");this.moveEvent.fire([x,y]);},showIframe:function(){var oIFrame=this.iframe,oParentNode;if(oIFrame){oParentNode=this.element.parentNode;if(oParentNode!=oIFrame.parentNode){this._addToParent(oParentNode,oIFrame);}
oIFrame.style.display="block";}},hideIframe:function(){if(this.iframe){this.iframe.style.display="none";}},syncIframe:function(){var oIFrame=this.iframe,oElement=this.element,nOffset=Overlay.IFRAME_OFFSET,nDimensionOffset=(nOffset*2),aXY;if(oIFrame){oIFrame.style.width=(oElement.offsetWidth+nDimensionOffset+"px");oIFrame.style.height=(oElement.offsetHeight+nDimensionOffset+"px");aXY=this.cfg.getProperty("xy");if(!Lang.isArray(aXY)||(isNaN(aXY[0])||isNaN(aXY[1]))){this.syncPosition();aXY=this.cfg.getProperty("xy");}
Dom.setXY(oIFrame,[(aXY[0]-nOffset),(aXY[1]-nOffset)]);}},stackIframe:function(){if(this.iframe){var overlayZ=Dom.getStyle(this.element,"zIndex");if(!YAHOO.lang.isUndefined(overlayZ)&&!isNaN(overlayZ)){Dom.setStyle(this.iframe,"zIndex",(overlayZ-1));}}},configIframe:function(type,args,obj){var bIFrame=args[0];function createIFrame(){var oIFrame=this.iframe,oElement=this.element,oParent;if(!oIFrame){if(!m_oIFrameTemplate){m_oIFrameTemplate=document.createElement("iframe");if(this.isSecure){m_oIFrameTemplate.src=Overlay.IFRAME_SRC;}
if(YAHOO.env.ua.ie){m_oIFrameTemplate.style.filter="alpha(opacity=0)";m_oIFrameTemplate.frameBorder=0;}
else{m_oIFrameTemplate.style.opacity="0";}
m_oIFrameTemplate.style.position="absolute";m_oIFrameTemplate.style.border="none";m_oIFrameTemplate.style.margin="0";m_oIFrameTemplate.style.padding="0";m_oIFrameTemplate.style.display="none";}
oIFrame=m_oIFrameTemplate.cloneNode(false);oParent=oElement.parentNode;var parentNode=oParent||document.body;this._addToParent(parentNode,oIFrame);this.iframe=oIFrame;}
this.showIframe();this.syncIframe();this.stackIframe();if(!this._hasIframeEventListeners){this.showEvent.subscribe(this.showIframe);this.hideEvent.subscribe(this.hideIframe);this.changeContentEvent.subscribe(this.syncIframe);this._hasIframeEventListeners=true;}}
function onBeforeShow(){createIFrame.call(this);this.beforeShowEvent.unsubscribe(onBeforeShow);this._iframeDeferred=false;}
if(bIFrame){if(this.cfg.getProperty("visible")){createIFrame.call(this);}else{if(!this._iframeDeferred){this.beforeShowEvent.subscribe(onBeforeShow);this._iframeDeferred=true;}}}else{this.hideIframe();if(this._hasIframeEventListeners){this.showEvent.unsubscribe(this.showIframe);this.hideEvent.unsubscribe(this.hideIframe);this.changeContentEvent.unsubscribe(this.syncIframe);this._hasIframeEventListeners=false;}}},_primeXYFromDOM:function(){if(YAHOO.lang.isUndefined(this.cfg.getProperty("xy"))){this.syncPosition();this.cfg.refireEvent("xy");this.beforeShowEvent.unsubscribe(this._primeXYFromDOM);}},configConstrainToViewport:function(type,args,obj){var val=args[0];if(val){if(!Config.alreadySubscribed(this.beforeMoveEvent,this.enforceConstraints,this)){this.beforeMoveEvent.subscribe(this.enforceConstraints,this,true);}
if(!Config.alreadySubscribed(this.beforeShowEvent,this._primeXYFromDOM)){this.beforeShowEvent.subscribe(this._primeXYFromDOM);}}else{this.beforeShowEvent.unsubscribe(this._primeXYFromDOM);this.beforeMoveEvent.unsubscribe(this.enforceConstraints,this);}},configContext:function(type,args,obj){var contextArgs=args[0],contextEl,elementMagnetCorner,contextMagnetCorner;if(contextArgs){contextEl=contextArgs[0];elementMagnetCorner=contextArgs[1];contextMagnetCorner=contextArgs[2];if(contextEl){if(typeof contextEl=="string"){this.cfg.setProperty("context",[document.getElementById(contextEl),elementMagnetCorner,contextMagnetCorner],true);}
if(elementMagnetCorner&&contextMagnetCorner){this.align(elementMagnetCorner,contextMagnetCorner);}}}},align:function(elementAlign,contextAlign){var contextArgs=this.cfg.getProperty("context"),me=this,context,element,contextRegion;function doAlign(v,h){switch(elementAlign){case Overlay.TOP_LEFT:me.moveTo(h,v);break;case Overlay.TOP_RIGHT:me.moveTo((h-element.offsetWidth),v);break;case Overlay.BOTTOM_LEFT:me.moveTo(h,(v-element.offsetHeight));break;case Overlay.BOTTOM_RIGHT:me.moveTo((h-element.offsetWidth),(v-element.offsetHeight));break;}}
if(contextArgs){context=contextArgs[0];element=this.element;me=this;if(!elementAlign){elementAlign=contextArgs[1];}
if(!contextAlign){contextAlign=contextArgs[2];}
if(element&&context){contextRegion=Dom.getRegion(context);switch(contextAlign){case Overlay.TOP_LEFT:doAlign(contextRegion.top,contextRegion.left);break;case Overlay.TOP_RIGHT:doAlign(contextRegion.top,contextRegion.right);break;case Overlay.BOTTOM_LEFT:doAlign(contextRegion.bottom,contextRegion.left);break;case Overlay.BOTTOM_RIGHT:doAlign(contextRegion.bottom,contextRegion.right);break;}}}},enforceConstraints:function(type,args,obj){var pos=args[0];var cXY=this.getConstrainedXY(pos[0],pos[1]);this.cfg.setProperty("x",cXY[0],true);this.cfg.setProperty("y",cXY[1],true);this.cfg.setProperty("xy",cXY,true);},getConstrainedXY:function(x,y){var nViewportOffset=Overlay.VIEWPORT_OFFSET,viewPortWidth=Dom.getViewportWidth(),viewPortHeight=Dom.getViewportHeight(),offsetHeight=this.element.offsetHeight,offsetWidth=this.element.offsetWidth,scrollX=Dom.getDocumentScrollLeft(),scrollY=Dom.getDocumentScrollTop();var xNew=x;var yNew=y;if(offsetWidth+nViewportOffset<viewPortWidth){var leftConstraint=scrollX+nViewportOffset;var rightConstraint=scrollX+viewPortWidth-offsetWidth-nViewportOffset;if(x<leftConstraint){xNew=leftConstraint;}else if(x>rightConstraint){xNew=rightConstraint;}}else{xNew=nViewportOffset+scrollX;}
if(offsetHeight+nViewportOffset<viewPortHeight){var topConstraint=scrollY+nViewportOffset;var bottomConstraint=scrollY+viewPortHeight-offsetHeight-nViewportOffset;if(y<topConstraint){yNew=topConstraint;}else if(y>bottomConstraint){yNew=bottomConstraint;}}else{yNew=nViewportOffset+scrollY;}
return[xNew,yNew];},center:function(){var nViewportOffset=Overlay.VIEWPORT_OFFSET,elementWidth=this.element.offsetWidth,elementHeight=this.element.offsetHeight,viewPortWidth=Dom.getViewportWidth(),viewPortHeight=Dom.getViewportHeight(),x,y;if(elementWidth<viewPortWidth){x=(viewPortWidth/2)-(elementWidth/2)+Dom.getDocumentScrollLeft();}else{x=nViewportOffset+Dom.getDocumentScrollLeft();}
if(elementHeight<viewPortHeight){y=(viewPortHeight/2)-(elementHeight/2)+Dom.getDocumentScrollTop();}else{y=nViewportOffset+Dom.getDocumentScrollTop();}
this.cfg.setProperty("xy",[parseInt(x,10),parseInt(y,10)]);this.cfg.refireEvent("iframe");},syncPosition:function(){var pos=Dom.getXY(this.element);this.cfg.setProperty("x",pos[0],true);this.cfg.setProperty("y",pos[1],true);this.cfg.setProperty("xy",pos,true);},onDomResize:function(e,obj){var me=this;Overlay.superclass.onDomResize.call(this,e,obj);setTimeout(function(){me.syncPosition();me.cfg.refireEvent("iframe");me.cfg.refireEvent("context");},0);},bringToTop:function(){var aOverlays=[],oElement=this.element;function compareZIndexDesc(p_oOverlay1,p_oOverlay2){var sZIndex1=Dom.getStyle(p_oOverlay1,"zIndex"),sZIndex2=Dom.getStyle(p_oOverlay2,"zIndex"),nZIndex1=(!sZIndex1||isNaN(sZIndex1))?0:parseInt(sZIndex1,10),nZIndex2=(!sZIndex2||isNaN(sZIndex2))?0:parseInt(sZIndex2,10);if(nZIndex1>nZIndex2){return-1;}else if(nZIndex1<nZIndex2){return 1;}else{return 0;}}
function isOverlayElement(p_oElement){var oOverlay=Dom.hasClass(p_oElement,Overlay.CSS_OVERLAY),Panel=YAHOO.widget.Panel;if(oOverlay&&!Dom.isAncestor(oElement,oOverlay)){if(Panel&&Dom.hasClass(p_oElement,Panel.CSS_PANEL)){aOverlays[aOverlays.length]=p_oElement.parentNode;}else{aOverlays[aOverlays.length]=p_oElement;}}}
Dom.getElementsBy(isOverlayElement,"DIV",document.body);aOverlays.sort(compareZIndexDesc);var oTopOverlay=aOverlays[0],nTopZIndex;if(oTopOverlay){nTopZIndex=Dom.getStyle(oTopOverlay,"zIndex");if(!isNaN(nTopZIndex)){var bRequiresBump=false;if(oTopOverlay!=oElement){bRequiresBump=true;}else if(aOverlays.length>1){var nNextZIndex=Dom.getStyle(aOverlays[1],"zIndex");if(!isNaN(nNextZIndex)&&(nTopZIndex==nNextZIndex)){bRequiresBump=true;}}
if(bRequiresBump){this.cfg.setProperty("zindex",(parseInt(nTopZIndex,10)+2));}}}},destroy:function(){if(this.iframe){this.iframe.parentNode.removeChild(this.iframe);}
this.iframe=null;Overlay.windowResizeEvent.unsubscribe(this.doCenterOnDOMEvent,this);Overlay.windowScrollEvent.unsubscribe(this.doCenterOnDOMEvent,this);Overlay.superclass.destroy.call(this);},toString:function(){return"Overlay "+this.id;}});}());(function(){YAHOO.widget.OverlayManager=function(userConfig){this.init(userConfig);};var Overlay=YAHOO.widget.Overlay,Event=YAHOO.util.Event,Dom=YAHOO.util.Dom,Config=YAHOO.util.Config,CustomEvent=YAHOO.util.CustomEvent,OverlayManager=YAHOO.widget.OverlayManager;OverlayManager.CSS_FOCUSED="focused";OverlayManager.prototype={constructor:OverlayManager,overlays:null,initDefaultConfig:function(){this.cfg.addProperty("overlays",{suppressEvent:true});this.cfg.addProperty("focusevent",{value:"mousedown"});},init:function(userConfig){this.cfg=new Config(this);this.initDefaultConfig();if(userConfig){this.cfg.applyConfig(userConfig,true);}
this.cfg.fireQueue();var activeOverlay=null;this.getActive=function(){return activeOverlay;};this.focus=function(overlay){var o=this.find(overlay);if(o){if(activeOverlay!=o){if(activeOverlay){activeOverlay.blur();}
this.bringToTop(o);activeOverlay=o;Dom.addClass(activeOverlay.element,OverlayManager.CSS_FOCUSED);o.focusEvent.fire();}}};this.remove=function(overlay){var o=this.find(overlay),originalZ;if(o){if(activeOverlay==o){activeOverlay=null;}
var bDestroyed=(o.element===null&&o.cfg===null)?true:false;if(!bDestroyed){originalZ=Dom.getStyle(o.element,"zIndex");o.cfg.setProperty("zIndex",-1000,true);}
this.overlays.sort(this.compareZIndexDesc);this.overlays=this.overlays.slice(0,(this.overlays.length-1));o.hideEvent.unsubscribe(o.blur);o.destroyEvent.unsubscribe(this._onOverlayDestroy,o);if(!bDestroyed){Event.removeListener(o.element,this.cfg.getProperty("focusevent"),this._onOverlayElementFocus);o.cfg.setProperty("zIndex",originalZ,true);o.cfg.setProperty("manager",null);}
o.focusEvent.unsubscribeAll();o.blurEvent.unsubscribeAll();o.focusEvent=null;o.blurEvent=null;o.focus=null;o.blur=null;}};this.blurAll=function(){var nOverlays=this.overlays.length,i;if(nOverlays>0){i=nOverlays-1;do{this.overlays[i].blur();}
while(i--);}};this._onOverlayBlur=function(p_sType,p_aArgs){activeOverlay=null;};var overlays=this.cfg.getProperty("overlays");if(!this.overlays){this.overlays=[];}
if(overlays){this.register(overlays);this.overlays.sort(this.compareZIndexDesc);}},_onOverlayElementFocus:function(p_oEvent){var oTarget=Event.getTarget(p_oEvent),oClose=this.close;if(oClose&&(oTarget==oClose||Dom.isAncestor(oClose,oTarget))){this.blur();}else{this.focus();}},_onOverlayDestroy:function(p_sType,p_aArgs,p_oOverlay){this.remove(p_oOverlay);},register:function(overlay){var mgr=this,zIndex,regcount,i,nOverlays;if(overlay instanceof Overlay){overlay.cfg.addProperty("manager",{value:this});overlay.focusEvent=overlay.createEvent("focus");overlay.focusEvent.signature=CustomEvent.LIST;overlay.blurEvent=overlay.createEvent("blur");overlay.blurEvent.signature=CustomEvent.LIST;overlay.focus=function(){mgr.focus(this);};overlay.blur=function(){if(mgr.getActive()==this){Dom.removeClass(this.element,OverlayManager.CSS_FOCUSED);this.blurEvent.fire();}};overlay.blurEvent.subscribe(mgr._onOverlayBlur);overlay.hideEvent.subscribe(overlay.blur);overlay.destroyEvent.subscribe(this._onOverlayDestroy,overlay,this);Event.on(overlay.element,this.cfg.getProperty("focusevent"),this._onOverlayElementFocus,null,overlay);zIndex=Dom.getStyle(overlay.element,"zIndex");if(!isNaN(zIndex)){overlay.cfg.setProperty("zIndex",parseInt(zIndex,10));}else{overlay.cfg.setProperty("zIndex",0);}
this.overlays.push(overlay);this.bringToTop(overlay);return true;}else if(overlay instanceof Array){regcount=0;nOverlays=overlay.length;for(i=0;i<nOverlays;i++){if(this.register(overlay[i])){regcount++;}}
if(regcount>0){return true;}}else{return false;}},bringToTop:function(p_oOverlay){var oOverlay=this.find(p_oOverlay),nTopZIndex,oTopOverlay,aOverlays;if(oOverlay){aOverlays=this.overlays;aOverlays.sort(this.compareZIndexDesc);oTopOverlay=aOverlays[0];if(oTopOverlay){nTopZIndex=Dom.getStyle(oTopOverlay.element,"zIndex");if(!isNaN(nTopZIndex)){var bRequiresBump=false;if(oTopOverlay!==oOverlay){bRequiresBump=true;}else if(aOverlays.length>1){var nNextZIndex=Dom.getStyle(aOverlays[1].element,"zIndex");if(!isNaN(nNextZIndex)&&(nTopZIndex==nNextZIndex)){bRequiresBump=true;}}
if(bRequiresBump){oOverlay.cfg.setProperty("zindex",(parseInt(nTopZIndex,10)+2));}}
aOverlays.sort(this.compareZIndexDesc);}}},find:function(overlay){var aOverlays=this.overlays,nOverlays=aOverlays.length,i;if(nOverlays>0){i=nOverlays-1;if(overlay instanceof Overlay){do{if(aOverlays[i]==overlay){return aOverlays[i];}}
while(i--);}else if(typeof overlay=="string"){do{if(aOverlays[i].id==overlay){return aOverlays[i];}}
while(i--);}
return null;}},compareZIndexDesc:function(o1,o2){var zIndex1=(o1.cfg)?o1.cfg.getProperty("zIndex"):null,zIndex2=(o2.cfg)?o2.cfg.getProperty("zIndex"):null;if(zIndex1===null&&zIndex2===null){return 0;}else if(zIndex1===null){return 1;}else if(zIndex2===null){return-1;}else if(zIndex1>zIndex2){return-1;}else if(zIndex1<zIndex2){return 1;}else{return 0;}},showAll:function(){var aOverlays=this.overlays,nOverlays=aOverlays.length,i;if(nOverlays>0){i=nOverlays-1;do{aOverlays[i].show();}
while(i--);}},hideAll:function(){var aOverlays=this.overlays,nOverlays=aOverlays.length,i;if(nOverlays>0){i=nOverlays-1;do{aOverlays[i].hide();}
while(i--);}},toString:function(){return"OverlayManager";}};}());(function(){YAHOO.widget.Tooltip=function(el,userConfig){YAHOO.widget.Tooltip.superclass.constructor.call(this,el,userConfig);};var Lang=YAHOO.lang,Event=YAHOO.util.Event,CustomEvent=YAHOO.util.CustomEvent,Dom=YAHOO.util.Dom,Tooltip=YAHOO.widget.Tooltip,m_oShadowTemplate,DEFAULT_CONFIG={"PREVENT_OVERLAP":{key:"preventoverlap",value:true,validator:Lang.isBoolean,supercedes:["x","y","xy"]},"SHOW_DELAY":{key:"showdelay",value:200,validator:Lang.isNumber},"AUTO_DISMISS_DELAY":{key:"autodismissdelay",value:5000,validator:Lang.isNumber},"HIDE_DELAY":{key:"hidedelay",value:250,validator:Lang.isNumber},"TEXT":{key:"text",suppressEvent:true},"CONTAINER":{key:"container"},"DISABLED":{key:"disabled",value:false,suppressEvent:true}},EVENT_TYPES={"CONTEXT_MOUSE_OVER":"contextMouseOver","CONTEXT_MOUSE_OUT":"contextMouseOut","CONTEXT_TRIGGER":"contextTrigger"};Tooltip.CSS_TOOLTIP="yui-tt";function restoreOriginalWidth(p_sType,p_aArgs,p_oObject){var sOriginalWidth=p_oObject[0],sNewWidth=p_oObject[1],oConfig=this.cfg,sCurrentWidth=oConfig.getProperty("width");if(sCurrentWidth==sNewWidth){oConfig.setProperty("width",sOriginalWidth);}
this.unsubscribe("hide",this._onHide,p_oObject);}
function setWidthToOffsetWidth(p_sType,p_aArgs){var oBody=document.body,oConfig=this.cfg,sOriginalWidth=oConfig.getProperty("width"),sNewWidth,oClone;if((!sOriginalWidth||sOriginalWidth=="auto")&&(oConfig.getProperty("container")!=oBody||oConfig.getProperty("x")>=Dom.getViewportWidth()||oConfig.getProperty("y")>=Dom.getViewportHeight())){oClone=this.element.cloneNode(true);oClone.style.visibility="hidden";oClone.style.top="0px";oClone.style.left="0px";oBody.appendChild(oClone);sNewWidth=(oClone.offsetWidth+"px");oBody.removeChild(oClone);oClone=null;oConfig.setProperty("width",sNewWidth);oConfig.refireEvent("xy");this.subscribe("hide",restoreOriginalWidth,[(sOriginalWidth||""),sNewWidth]);}}
function onDOMReady(p_sType,p_aArgs,p_oObject){this.render(p_oObject);}
function onInit(){Event.onDOMReady(onDOMReady,this.cfg.getProperty("container"),this);}
YAHOO.extend(Tooltip,YAHOO.widget.Overlay,{init:function(el,userConfig){Tooltip.superclass.init.call(this,el);this.beforeInitEvent.fire(Tooltip);Dom.addClass(this.element,Tooltip.CSS_TOOLTIP);if(userConfig){this.cfg.applyConfig(userConfig,true);}
this.cfg.queueProperty("visible",false);this.cfg.queueProperty("constraintoviewport",true);this.setBody("");this.subscribe("beforeShow",setWidthToOffsetWidth);this.subscribe("init",onInit);this.subscribe("render",this.onRender);this.initEvent.fire(Tooltip);},initEvents:function(){Tooltip.superclass.initEvents.call(this);var SIGNATURE=CustomEvent.LIST;this.contextMouseOverEvent=this.createEvent(EVENT_TYPES.CONTEXT_MOUSE_OVER);this.contextMouseOverEvent.signature=SIGNATURE;this.contextMouseOutEvent=this.createEvent(EVENT_TYPES.CONTEXT_MOUSE_OUT);this.contextMouseOutEvent.signature=SIGNATURE;this.contextTriggerEvent=this.createEvent(EVENT_TYPES.CONTEXT_TRIGGER);this.contextTriggerEvent.signature=SIGNATURE;},initDefaultConfig:function(){Tooltip.superclass.initDefaultConfig.call(this);this.cfg.addProperty(DEFAULT_CONFIG.PREVENT_OVERLAP.key,{value:DEFAULT_CONFIG.PREVENT_OVERLAP.value,validator:DEFAULT_CONFIG.PREVENT_OVERLAP.validator,supercedes:DEFAULT_CONFIG.PREVENT_OVERLAP.supercedes});this.cfg.addProperty(DEFAULT_CONFIG.SHOW_DELAY.key,{handler:this.configShowDelay,value:200,validator:DEFAULT_CONFIG.SHOW_DELAY.validator});this.cfg.addProperty(DEFAULT_CONFIG.AUTO_DISMISS_DELAY.key,{handler:this.configAutoDismissDelay,value:DEFAULT_CONFIG.AUTO_DISMISS_DELAY.value,validator:DEFAULT_CONFIG.AUTO_DISMISS_DELAY.validator});this.cfg.addProperty(DEFAULT_CONFIG.HIDE_DELAY.key,{handler:this.configHideDelay,value:DEFAULT_CONFIG.HIDE_DELAY.value,validator:DEFAULT_CONFIG.HIDE_DELAY.validator});this.cfg.addProperty(DEFAULT_CONFIG.TEXT.key,{handler:this.configText,suppressEvent:DEFAULT_CONFIG.TEXT.suppressEvent});this.cfg.addProperty(DEFAULT_CONFIG.CONTAINER.key,{handler:this.configContainer,value:document.body});this.cfg.addProperty(DEFAULT_CONFIG.DISABLED.key,{handler:this.configContainer,value:DEFAULT_CONFIG.DISABLED.value,supressEvent:DEFAULT_CONFIG.DISABLED.suppressEvent});},configText:function(type,args,obj){var text=args[0];if(text){this.setBody(text);}},configContainer:function(type,args,obj){var container=args[0];if(typeof container=='string'){this.cfg.setProperty("container",document.getElementById(container),true);}},_removeEventListeners:function(){var aElements=this._context,nElements,oElement,i;if(aElements){nElements=aElements.length;if(nElements>0){i=nElements-1;do{oElement=aElements[i];Event.removeListener(oElement,"mouseover",this.onContextMouseOver);Event.removeListener(oElement,"mousemove",this.onContextMouseMove);Event.removeListener(oElement,"mouseout",this.onContextMouseOut);}
while(i--);}}},configContext:function(type,args,obj){var context=args[0],aElements,nElements,oElement,i;if(context){if(!(context instanceof Array)){if(typeof context=="string"){this.cfg.setProperty("context",[document.getElementById(context)],true);}else{this.cfg.setProperty("context",[context],true);}
context=this.cfg.getProperty("context");}
this._removeEventListeners();this._context=context;aElements=this._context;if(aElements){nElements=aElements.length;if(nElements>0){i=nElements-1;do{oElement=aElements[i];Event.on(oElement,"mouseover",this.onContextMouseOver,this);Event.on(oElement,"mousemove",this.onContextMouseMove,this);Event.on(oElement,"mouseout",this.onContextMouseOut,this);}
while(i--);}}}},onContextMouseMove:function(e,obj){obj.pageX=Event.getPageX(e);obj.pageY=Event.getPageY(e);},onContextMouseOver:function(e,obj){var context=this;if(context.title){obj._tempTitle=context.title;context.title="";}
if(obj.fireEvent("contextMouseOver",context,e)!==false&&!obj.cfg.getProperty("disabled")){if(obj.hideProcId){clearTimeout(obj.hideProcId);obj.hideProcId=null;}
Event.on(context,"mousemove",obj.onContextMouseMove,obj);obj.showProcId=obj.doShow(e,context);}},onContextMouseOut:function(e,obj){var el=this;if(obj._tempTitle){el.title=obj._tempTitle;obj._tempTitle=null;}
if(obj.showProcId){clearTimeout(obj.showProcId);obj.showProcId=null;}
if(obj.hideProcId){clearTimeout(obj.hideProcId);obj.hideProcId=null;}
obj.fireEvent("contextMouseOut",el,e);obj.hideProcId=setTimeout(function(){obj.hide();},obj.cfg.getProperty("hidedelay"));},doShow:function(e,context){var yOffset=25,me=this;if(YAHOO.env.ua.opera&&context.tagName&&context.tagName.toUpperCase()=="A"){yOffset+=12;}
return setTimeout(function(){var txt=me.cfg.getProperty("text");if(me._tempTitle&&(txt===""||YAHOO.lang.isUndefined(txt)||YAHOO.lang.isNull(txt))){me.setBody(me._tempTitle);}else{me.cfg.refireEvent("text");}
me.moveTo(me.pageX,me.pageY+yOffset);if(me.cfg.getProperty("preventoverlap")){me.preventOverlap(me.pageX,me.pageY);}
Event.removeListener(context,"mousemove",me.onContextMouseMove);me.contextTriggerEvent.fire(context);me.show();me.hideProcId=me.doHide();},this.cfg.getProperty("showdelay"));},doHide:function(){var me=this;return setTimeout(function(){me.hide();},this.cfg.getProperty("autodismissdelay"));},preventOverlap:function(pageX,pageY){var height=this.element.offsetHeight,mousePoint=new YAHOO.util.Point(pageX,pageY),elementRegion=Dom.getRegion(this.element);elementRegion.top-=5;elementRegion.left-=5;elementRegion.right+=5;elementRegion.bottom+=5;if(elementRegion.contains(mousePoint)){this.cfg.setProperty("y",(pageY-height-5));}},onRender:function(p_sType,p_aArgs){function sizeShadow(){var oElement=this.element,oShadow=this._shadow;if(oShadow){oShadow.style.width=(oElement.offsetWidth+6)+"px";oShadow.style.height=(oElement.offsetHeight+1)+"px";}}
function addShadowVisibleClass(){Dom.addClass(this._shadow,"yui-tt-shadow-visible");}
function removeShadowVisibleClass(){Dom.removeClass(this._shadow,"yui-tt-shadow-visible");}
function createShadow(){var oShadow=this._shadow,oElement,Module,nIE,me;if(!oShadow){oElement=this.element;Module=YAHOO.widget.Module;nIE=YAHOO.env.ua.ie;me=this;if(!m_oShadowTemplate){m_oShadowTemplate=document.createElement("div");m_oShadowTemplate.className="yui-tt-shadow";}
oShadow=m_oShadowTemplate.cloneNode(false);oElement.appendChild(oShadow);this._shadow=oShadow;addShadowVisibleClass.call(this);this.subscribe("beforeShow",addShadowVisibleClass);this.subscribe("beforeHide",removeShadowVisibleClass);if(nIE==6||(nIE==7&&document.compatMode=="BackCompat")){window.setTimeout(function(){sizeShadow.call(me);},0);this.cfg.subscribeToConfigEvent("width",sizeShadow);this.cfg.subscribeToConfigEvent("height",sizeShadow);this.subscribe("changeContent",sizeShadow);Module.textResizeEvent.subscribe(sizeShadow,this,true);this.subscribe("destroy",function(){Module.textResizeEvent.unsubscribe(sizeShadow,this);});}}}
function onBeforeShow(){createShadow.call(this);this.unsubscribe("beforeShow",onBeforeShow);}
if(this.cfg.getProperty("visible")){createShadow.call(this);}else{this.subscribe("beforeShow",onBeforeShow);}},destroy:function(){this._removeEventListeners();Tooltip.superclass.destroy.call(this);},toString:function(){return"Tooltip "+this.id;}});}());(function(){YAHOO.widget.Panel=function(el,userConfig){YAHOO.widget.Panel.superclass.constructor.call(this,el,userConfig);};var Lang=YAHOO.lang,DD=YAHOO.util.DD,Dom=YAHOO.util.Dom,Event=YAHOO.util.Event,Overlay=YAHOO.widget.Overlay,CustomEvent=YAHOO.util.CustomEvent,Config=YAHOO.util.Config,Panel=YAHOO.widget.Panel,m_oMaskTemplate,m_oUnderlayTemplate,m_oCloseIconTemplate,EVENT_TYPES={"SHOW_MASK":"showMask","HIDE_MASK":"hideMask","DRAG":"drag"},DEFAULT_CONFIG={"CLOSE":{key:"close",value:true,validator:Lang.isBoolean,supercedes:["visible"]},"DRAGGABLE":{key:"draggable",value:(DD?true:false),validator:Lang.isBoolean,supercedes:["visible"]},"DRAG_ONLY":{key:"dragonly",value:false,validator:Lang.isBoolean,supercedes:["draggable"]},"UNDERLAY":{key:"underlay",value:"shadow",supercedes:["visible"]},"MODAL":{key:"modal",value:false,validator:Lang.isBoolean,supercedes:["visible","zindex"]},"KEY_LISTENERS":{key:"keylisteners",suppressEvent:true,supercedes:["visible"]}};Panel.CSS_PANEL="yui-panel";Panel.CSS_PANEL_CONTAINER="yui-panel-container";Panel.FOCUSABLE=["a","button","select","textarea","input"];function createHeader(p_sType,p_aArgs){if(!this.header&&this.cfg.getProperty("draggable")){this.setHeader("&#160;");}}
function restoreOriginalWidth(p_sType,p_aArgs,p_oObject){var sOriginalWidth=p_oObject[0],sNewWidth=p_oObject[1],oConfig=this.cfg,sCurrentWidth=oConfig.getProperty("width");if(sCurrentWidth==sNewWidth){oConfig.setProperty("width",sOriginalWidth);}
this.unsubscribe("hide",restoreOriginalWidth,p_oObject);}
function setWidthToOffsetWidth(p_sType,p_aArgs){var nIE=YAHOO.env.ua.ie,oConfig,sOriginalWidth,sNewWidth;if(nIE==6||(nIE==7&&document.compatMode=="BackCompat")){oConfig=this.cfg;sOriginalWidth=oConfig.getProperty("width");if(!sOriginalWidth||sOriginalWidth=="auto"){sNewWidth=(this.element.offsetWidth+"px");oConfig.setProperty("width",sNewWidth);this.subscribe("hide",restoreOriginalWidth,[(sOriginalWidth||""),sNewWidth]);}}}
YAHOO.extend(Panel,Overlay,{init:function(el,userConfig){Panel.superclass.init.call(this,el);this.beforeInitEvent.fire(Panel);Dom.addClass(this.element,Panel.CSS_PANEL);this.buildWrapper();if(userConfig){this.cfg.applyConfig(userConfig,true);}
this.subscribe("showMask",this._addFocusHandlers);this.subscribe("hideMask",this._removeFocusHandlers);this.subscribe("beforeRender",createHeader);this.initEvent.fire(Panel);},_onElementFocus:function(e){this.blur();},_addFocusHandlers:function(p_sType,p_aArgs){var me=this,focus="focus",hidden="hidden";function isFocusable(el){if(el.type!==hidden&&!Dom.isAncestor(me.element,el)){Event.on(el,focus,me._onElementFocus);return true;}
return false;}
var focusable=Panel.FOCUSABLE,l=focusable.length,arr=[];for(var i=0;i<l;i++){arr=arr.concat(Dom.getElementsBy(isFocusable,focusable[i]));}
this.focusableElements=arr;},_removeFocusHandlers:function(p_sType,p_aArgs){var aElements=this.focusableElements,nElements=aElements.length,focus="focus";if(aElements){for(var i=0;i<nElements;i++){Event.removeListener(aElements[i],focus,this._onElementFocus);}}},initEvents:function(){Panel.superclass.initEvents.call(this);var SIGNATURE=CustomEvent.LIST;this.showMaskEvent=this.createEvent(EVENT_TYPES.SHOW_MASK);this.showMaskEvent.signature=SIGNATURE;this.hideMaskEvent=this.createEvent(EVENT_TYPES.HIDE_MASK);this.hideMaskEvent.signature=SIGNATURE;this.dragEvent=this.createEvent(EVENT_TYPES.DRAG);this.dragEvent.signature=SIGNATURE;},initDefaultConfig:function(){Panel.superclass.initDefaultConfig.call(this);this.cfg.addProperty(DEFAULT_CONFIG.CLOSE.key,{handler:this.configClose,value:DEFAULT_CONFIG.CLOSE.value,validator:DEFAULT_CONFIG.CLOSE.validator,supercedes:DEFAULT_CONFIG.CLOSE.supercedes});this.cfg.addProperty(DEFAULT_CONFIG.DRAGGABLE.key,{handler:this.configDraggable,value:DEFAULT_CONFIG.DRAGGABLE.value,validator:DEFAULT_CONFIG.DRAGGABLE.validator,supercedes:DEFAULT_CONFIG.DRAGGABLE.supercedes});this.cfg.addProperty(DEFAULT_CONFIG.DRAG_ONLY.key,{value:DEFAULT_CONFIG.DRAG_ONLY.value,validator:DEFAULT_CONFIG.DRAG_ONLY.validator,supercedes:DEFAULT_CONFIG.DRAG_ONLY.supercedes});this.cfg.addProperty(DEFAULT_CONFIG.UNDERLAY.key,{handler:this.configUnderlay,value:DEFAULT_CONFIG.UNDERLAY.value,supercedes:DEFAULT_CONFIG.UNDERLAY.supercedes});this.cfg.addProperty(DEFAULT_CONFIG.MODAL.key,{handler:this.configModal,value:DEFAULT_CONFIG.MODAL.value,validator:DEFAULT_CONFIG.MODAL.validator,supercedes:DEFAULT_CONFIG.MODAL.supercedes});this.cfg.addProperty(DEFAULT_CONFIG.KEY_LISTENERS.key,{handler:this.configKeyListeners,suppressEvent:DEFAULT_CONFIG.KEY_LISTENERS.suppressEvent,supercedes:DEFAULT_CONFIG.KEY_LISTENERS.supercedes});},configClose:function(type,args,obj){var val=args[0],oClose=this.close;function doHide(e,obj){obj.hide();}
if(val){if(!oClose){if(!m_oCloseIconTemplate){m_oCloseIconTemplate=document.createElement("span");m_oCloseIconTemplate.innerHTML="&#160;";m_oCloseIconTemplate.className="container-close";}
oClose=m_oCloseIconTemplate.cloneNode(true);this.innerElement.appendChild(oClose);Event.on(oClose,"click",doHide,this);this.close=oClose;}else{oClose.style.display="block";}}else{if(oClose){oClose.style.display="none";}}},configDraggable:function(type,args,obj){var val=args[0];if(val){if(!DD){this.cfg.setProperty("draggable",false);return;}
if(this.header){Dom.setStyle(this.header,"cursor","move");this.registerDragDrop();}
this.subscribe("beforeShow",setWidthToOffsetWidth);}else{if(this.dd){this.dd.unreg();}
if(this.header){Dom.setStyle(this.header,"cursor","auto");}
this.unsubscribe("beforeShow",setWidthToOffsetWidth);}},configUnderlay:function(type,args,obj){var UA=YAHOO.env.ua,bMacGecko=(this.platform=="mac"&&UA.gecko),bIEQuirks=(UA.ie==6||(UA.ie==7&&document.compatMode=="BackCompat")),sUnderlay=args[0].toLowerCase(),oUnderlay=this.underlay,oElement=this.element;function fixWebkitUnderlay(){var u=this.underlay;Dom.addClass(u,"yui-force-redraw");window.setTimeout(function(){Dom.removeClass(u,"yui-force-redraw");},0);}
function createUnderlay(){var bNew=false;if(!oUnderlay){if(!m_oUnderlayTemplate){m_oUnderlayTemplate=document.createElement("div");m_oUnderlayTemplate.className="underlay";}
oUnderlay=m_oUnderlayTemplate.cloneNode(false);this.element.appendChild(oUnderlay);this.underlay=oUnderlay;if(bIEQuirks){this.sizeUnderlay();this.cfg.subscribeToConfigEvent("width",this.sizeUnderlay);this.cfg.subscribeToConfigEvent("height",this.sizeUnderlay);this.changeContentEvent.subscribe(this.sizeUnderlay);YAHOO.widget.Module.textResizeEvent.subscribe(this.sizeUnderlay,this,true);}
if(UA.webkit&&UA.webkit<420){this.changeContentEvent.subscribe(fixWebkitUnderlay);}
bNew=true;}}
function onBeforeShow(){var bNew=createUnderlay.call(this);if(!bNew&&bIEQuirks){this.sizeUnderlay();}
this._underlayDeferred=false;this.beforeShowEvent.unsubscribe(onBeforeShow);}
function destroyUnderlay(){if(this._underlayDeferred){this.beforeShowEvent.unsubscribe(onBeforeShow);this._underlayDeferred=false;}
if(oUnderlay){this.cfg.unsubscribeFromConfigEvent("width",this.sizeUnderlay);this.cfg.unsubscribeFromConfigEvent("height",this.sizeUnderlay);this.changeContentEvent.unsubscribe(this.sizeUnderlay);this.changeContentEvent.unsubscribe(fixWebkitUnderlay);YAHOO.widget.Module.textResizeEvent.unsubscribe(this.sizeUnderlay,this,true);this.element.removeChild(oUnderlay);this.underlay=null;}}
switch(sUnderlay){case"shadow":Dom.removeClass(oElement,"matte");Dom.addClass(oElement,"shadow");break;case"matte":if(!bMacGecko){destroyUnderlay.call(this);}
Dom.removeClass(oElement,"shadow");Dom.addClass(oElement,"matte");break;default:if(!bMacGecko){destroyUnderlay.call(this);}
Dom.removeClass(oElement,"shadow");Dom.removeClass(oElement,"matte");break;}
if((sUnderlay=="shadow")||(bMacGecko&&!oUnderlay)){if(this.cfg.getProperty("visible")){var bNew=createUnderlay.call(this);if(!bNew&&bIEQuirks){this.sizeUnderlay();}}else{if(!this._underlayDeferred){this.beforeShowEvent.subscribe(onBeforeShow);this._underlayDeferred=true;}}}},configModal:function(type,args,obj){var modal=args[0];if(modal){if(!this._hasModalityEventListeners){this.subscribe("beforeShow",this.buildMask);this.subscribe("beforeShow",this.bringToTop);this.subscribe("beforeShow",this.showMask);this.subscribe("hide",this.hideMask);Overlay.windowResizeEvent.subscribe(this.sizeMask,this,true);this._hasModalityEventListeners=true;}}else{if(this._hasModalityEventListeners){if(this.cfg.getProperty("visible")){this.hideMask();this.removeMask();}
this.unsubscribe("beforeShow",this.buildMask);this.unsubscribe("beforeShow",this.bringToTop);this.unsubscribe("beforeShow",this.showMask);this.unsubscribe("hide",this.hideMask);Overlay.windowResizeEvent.unsubscribe(this.sizeMask,this);this._hasModalityEventListeners=false;}}},removeMask:function(){var oMask=this.mask,oParentNode;if(oMask){this.hideMask();oParentNode=oMask.parentNode;if(oParentNode){oParentNode.removeChild(oMask);}
this.mask=null;}},configKeyListeners:function(type,args,obj){var listeners=args[0],listener,nListeners,i;if(listeners){if(listeners instanceof Array){nListeners=listeners.length;for(i=0;i<nListeners;i++){listener=listeners[i];if(!Config.alreadySubscribed(this.showEvent,listener.enable,listener)){this.showEvent.subscribe(listener.enable,listener,true);}
if(!Config.alreadySubscribed(this.hideEvent,listener.disable,listener)){this.hideEvent.subscribe(listener.disable,listener,true);this.destroyEvent.subscribe(listener.disable,listener,true);}}}else{if(!Config.alreadySubscribed(this.showEvent,listeners.enable,listeners)){this.showEvent.subscribe(listeners.enable,listeners,true);}
if(!Config.alreadySubscribed(this.hideEvent,listeners.disable,listeners)){this.hideEvent.subscribe(listeners.disable,listeners,true);this.destroyEvent.subscribe(listeners.disable,listeners,true);}}}},configHeight:function(type,args,obj){var height=args[0],el=this.innerElement;Dom.setStyle(el,"height",height);this.cfg.refireEvent("iframe");},configWidth:function(type,args,obj){var width=args[0],el=this.innerElement;Dom.setStyle(el,"width",width);this.cfg.refireEvent("iframe");},configzIndex:function(type,args,obj){Panel.superclass.configzIndex.call(this,type,args,obj);if(this.mask||this.cfg.getProperty("modal")===true){var panelZ=Dom.getStyle(this.element,"zIndex");if(!panelZ||isNaN(panelZ)){panelZ=0;}
if(panelZ===0){this.cfg.setProperty("zIndex",1);}else{this.stackMask();}}},buildWrapper:function(){var elementParent=this.element.parentNode,originalElement=this.element,wrapper=document.createElement("div");wrapper.className=Panel.CSS_PANEL_CONTAINER;wrapper.id=originalElement.id+"_c";if(elementParent){elementParent.insertBefore(wrapper,originalElement);}
wrapper.appendChild(originalElement);this.element=wrapper;this.innerElement=originalElement;Dom.setStyle(this.innerElement,"visibility","inherit");},sizeUnderlay:function(){var oUnderlay=this.underlay,oElement;if(oUnderlay){oElement=this.element;oUnderlay.style.width=oElement.offsetWidth+"px";oUnderlay.style.height=oElement.offsetHeight+"px";}},registerDragDrop:function(){var me=this;if(this.header){if(!DD){return;}
var bDragOnly=(this.cfg.getProperty("dragonly")===true);this.dd=new DD(this.element.id,this.id,{dragOnly:bDragOnly});if(!this.header.id){this.header.id=this.id+"_h";}
this.dd.startDrag=function(){var offsetHeight,offsetWidth,viewPortWidth,viewPortHeight,scrollX,scrollY;if(YAHOO.env.ua.ie==6){Dom.addClass(me.element,"drag");}
if(me.cfg.getProperty("constraintoviewport")){var nViewportOffset=Overlay.VIEWPORT_OFFSET;offsetHeight=me.element.offsetHeight;offsetWidth=me.element.offsetWidth;viewPortWidth=Dom.getViewportWidth();viewPortHeight=Dom.getViewportHeight();scrollX=Dom.getDocumentScrollLeft();scrollY=Dom.getDocumentScrollTop();if(offsetHeight+nViewportOffset<viewPortHeight){this.minY=scrollY+nViewportOffset;this.maxY=scrollY+viewPortHeight-offsetHeight-nViewportOffset;}else{this.minY=scrollY+nViewportOffset;this.maxY=scrollY+nViewportOffset;}
if(offsetWidth+nViewportOffset<viewPortWidth){this.minX=scrollX+nViewportOffset;this.maxX=scrollX+viewPortWidth-offsetWidth-nViewportOffset;}else{this.minX=scrollX+nViewportOffset;this.maxX=scrollX+nViewportOffset;}
this.constrainX=true;this.constrainY=true;}else{this.constrainX=false;this.constrainY=false;}
me.dragEvent.fire("startDrag",arguments);};this.dd.onDrag=function(){me.syncPosition();me.cfg.refireEvent("iframe");if(this.platform=="mac"&&YAHOO.env.ua.gecko){this.showMacGeckoScrollbars();}
me.dragEvent.fire("onDrag",arguments);};this.dd.endDrag=function(){if(YAHOO.env.ua.ie==6){Dom.removeClass(me.element,"drag");}
me.dragEvent.fire("endDrag",arguments);me.moveEvent.fire(me.cfg.getProperty("xy"));};this.dd.setHandleElId(this.header.id);this.dd.addInvalidHandleType("INPUT");this.dd.addInvalidHandleType("SELECT");this.dd.addInvalidHandleType("TEXTAREA");}},buildMask:function(){var oMask=this.mask;if(!oMask){if(!m_oMaskTemplate){m_oMaskTemplate=document.createElement("div");m_oMaskTemplate.className="mask";m_oMaskTemplate.innerHTML="&#160;";}
oMask=m_oMaskTemplate.cloneNode(true);oMask.id=this.id+"_mask";document.body.insertBefore(oMask,document.body.firstChild);this.mask=oMask;if(YAHOO.env.ua.gecko&&this.platform=="mac"){Dom.addClass(this.mask,"block-scrollbars");}
this.stackMask();}},hideMask:function(){if(this.cfg.getProperty("modal")&&this.mask){this.mask.style.display="none";this.hideMaskEvent.fire();Dom.removeClass(document.body,"masked");}},showMask:function(){if(this.cfg.getProperty("modal")&&this.mask){Dom.addClass(document.body,"masked");this.sizeMask();this.mask.style.display="block";this.showMaskEvent.fire();}},sizeMask:function(){if(this.mask){this.mask.style.height=Dom.getDocumentHeight()+"px";this.mask.style.width=Dom.getDocumentWidth()+"px";}},stackMask:function(){if(this.mask){var panelZ=Dom.getStyle(this.element,"zIndex");if(!YAHOO.lang.isUndefined(panelZ)&&!isNaN(panelZ)){Dom.setStyle(this.mask,"zIndex",panelZ-1);}}},render:function(appendToNode){return Panel.superclass.render.call(this,appendToNode,this.innerElement);},destroy:function(){Overlay.windowResizeEvent.unsubscribe(this.sizeMask,this);this.removeMask();if(this.close){Event.purgeElement(this.close);}
Panel.superclass.destroy.call(this);},toString:function(){return"Panel "+this.id;}});}());(function(){YAHOO.widget.Dialog=function(el,userConfig){YAHOO.widget.Dialog.superclass.constructor.call(this,el,userConfig);};var Event=YAHOO.util.Event,CustomEvent=YAHOO.util.CustomEvent,Dom=YAHOO.util.Dom,KeyListener=YAHOO.util.KeyListener,Connect=YAHOO.util.Connect,Dialog=YAHOO.widget.Dialog,Lang=YAHOO.lang,EVENT_TYPES={"BEFORE_SUBMIT":"beforeSubmit","SUBMIT":"submit","MANUAL_SUBMIT":"manualSubmit","ASYNC_SUBMIT":"asyncSubmit","FORM_SUBMIT":"formSubmit","CANCEL":"cancel"},DEFAULT_CONFIG={"POST_METHOD":{key:"postmethod",value:"async"},"BUTTONS":{key:"buttons",value:"none"},"HIDEAFTERSUBMIT":{key:"hideaftersubmit",value:true}};Dialog.CSS_DIALOG="yui-dialog";function removeButtonEventHandlers(){var aButtons=this._aButtons,nButtons,oButton,i;if(Lang.isArray(aButtons)){nButtons=aButtons.length;if(nButtons>0){i=nButtons-1;do{oButton=aButtons[i];if(YAHOO.widget.Button&&oButton instanceof YAHOO.widget.Button){oButton.destroy();}
else if(oButton.tagName.toUpperCase()=="BUTTON"){Event.purgeElement(oButton);Event.purgeElement(oButton,false);}}
while(i--);}}}
YAHOO.extend(Dialog,YAHOO.widget.Panel,{form:null,initDefaultConfig:function(){Dialog.superclass.initDefaultConfig.call(this);this.callback={success:null,failure:null,argument:null};this.cfg.addProperty(DEFAULT_CONFIG.POST_METHOD.key,{handler:this.configPostMethod,value:DEFAULT_CONFIG.POST_METHOD.value,validator:function(val){if(val!="form"&&val!="async"&&val!="none"&&val!="manual"){return false;}else{return true;}}});this.cfg.addProperty(DEFAULT_CONFIG.HIDEAFTERSUBMIT.key,{value:DEFAULT_CONFIG.HIDEAFTERSUBMIT.value});this.cfg.addProperty(DEFAULT_CONFIG.BUTTONS.key,{handler:this.configButtons,value:DEFAULT_CONFIG.BUTTONS.value});},initEvents:function(){Dialog.superclass.initEvents.call(this);var SIGNATURE=CustomEvent.LIST;this.beforeSubmitEvent=this.createEvent(EVENT_TYPES.BEFORE_SUBMIT);this.beforeSubmitEvent.signature=SIGNATURE;this.submitEvent=this.createEvent(EVENT_TYPES.SUBMIT);this.submitEvent.signature=SIGNATURE;this.manualSubmitEvent=this.createEvent(EVENT_TYPES.MANUAL_SUBMIT);this.manualSubmitEvent.signature=SIGNATURE;this.asyncSubmitEvent=this.createEvent(EVENT_TYPES.ASYNC_SUBMIT);this.asyncSubmitEvent.signature=SIGNATURE;this.formSubmitEvent=this.createEvent(EVENT_TYPES.FORM_SUBMIT);this.formSubmitEvent.signature=SIGNATURE;this.cancelEvent=this.createEvent(EVENT_TYPES.CANCEL);this.cancelEvent.signature=SIGNATURE;},init:function(el,userConfig){Dialog.superclass.init.call(this,el);this.beforeInitEvent.fire(Dialog);Dom.addClass(this.element,Dialog.CSS_DIALOG);this.cfg.setProperty("visible",false);if(userConfig){this.cfg.applyConfig(userConfig,true);}
this.showEvent.subscribe(this.focusFirst,this,true);this.beforeHideEvent.subscribe(this.blurButtons,this,true);this.subscribe("changeBody",this.registerForm);this.initEvent.fire(Dialog);},doSubmit:function(){var oForm=this.form,bUseFileUploaddisabled=false,bUseSecureFileUploaddisabled=false,aElements,nElements,i,sMethod;switch(this.cfg.getProperty("postmethod")){case"async":aElements=oForm.elements;nElements=aElements.length;if(nElements>0){i=nElements-1;do{if(aElements[i].type=="file"){bUseFileUploaddisabled=true;break;}}
while(i--);}
if(bUseFileUploaddisabled&&YAHOO.env.ua.ie&&this.isSecure){bUseSecureFileUploaddisabled=true;}
sMethod=(oForm.getAttribute("method")||"POST").toUpperCase();Connect.setForm(oForm,bUseFileUploaddisabled,bUseSecureFileUploaddisabled);Connect.asyncRequest(sMethod,oForm.getAttribute("action"),this.callback);this.asyncSubmitEvent.fire();break;case"form":oForm.submit();this.formSubmitEvent.fire();break;case"none":case"manual":this.manualSubmitEvent.fire();break;}},registerForm:function(){var form=this.element.getElementsByTagName("form")[0],me=this,firstElement,lastElement;if(this.form){if(this.form==form&&Dom.isAncestor(this.element,this.form)){return;}else{Event.purgeElement(this.form);this.form=null;}}
if(!form){form=document.createElement("form");form.name="frm_"+this.id;this.body.appendChild(form);}
if(form){this.form=form;Event.on(form,"submit",function(e){Event.stopEvent(e);this.submit();this.form.blur();},this,true);this.firstFormElement=function(){var f,el,nElements=form.elements.length;for(f=0;f<nElements;f++){el=form.elements[f];if(el.focus&&!el.disabled&&el.type!="hidden"){return el;}}
return null;}();this.lastFormElement=function(){var f,el,nElements=form.elements.length;for(f=nElements-1;f>=0;f--){el=form.elements[f];if(el.focus&&!el.disabled&&el.type!="hidden"){return el;}}
return null;}();if(this.cfg.getProperty("modal")){firstElement=this.firstFormElement||this.firstButton;if(firstElement){this.preventBackTab=new KeyListener(firstElement,{shift:true,keys:9},{fn:me.focusLast,scope:me,correctScope:true});this.showEvent.subscribe(this.preventBackTab.enable,this.preventBackTab,true);this.hideEvent.subscribe(this.preventBackTab.disable,this.preventBackTab,true);}
lastElement=this.lastButton||this.lastFormElement;if(lastElement){this.preventTabOut=new KeyListener(lastElement,{shift:false,keys:9},{fn:me.focusFirst,scope:me,correctScope:true});this.showEvent.subscribe(this.preventTabOut.enable,this.preventTabOut,true);this.hideEvent.subscribe(this.preventTabOut.disable,this.preventTabOut,true);}}}},configClose:function(type,args,obj){var val=args[0];function doCancel(e,obj){obj.cancel();}
if(val){if(!this.close){this.close=document.createElement("div");Dom.addClass(this.close,"container-close");this.close.innerHTML="&#160;";this.innerElement.appendChild(this.close);Event.on(this.close,"click",doCancel,this);}else{this.close.style.display="block";}}else{if(this.close){this.close.style.display="none";}}},configButtons:function(type,args,obj){var Button=YAHOO.widget.Button,aButtons=args[0],oInnerElement=this.innerElement,oButton,oButtonEl,oYUIButton,nButtons,oSpan,oFooter,i;removeButtonEventHandlers.call(this);this._aButtons=null;if(Lang.isArray(aButtons)){oSpan=document.createElement("span");oSpan.className="button-group";nButtons=aButtons.length;this._aButtons=[];for(i=0;i<nButtons;i++){oButton=aButtons[i];if(Button){oYUIButton=new Button({label:oButton.text,container:oSpan});oButtonEl=oYUIButton.get("element");if(oButton.isDefault){oYUIButton.addClass("default");this.defaultHtmlButton=oButtonEl;}
if(Lang.isFunction(oButton.handler)){oYUIButton.set("onclick",{fn:oButton.handler,obj:this,scope:this});}
else if(Lang.isObject(oButton.handler)&&Lang.isFunction(oButton.handler.fn)){oYUIButton.set("onclick",{fn:oButton.handler.fn,obj:((!Lang.isUndefined(oButton.handler.obj))?oButton.handler.obj:this),scope:(oButton.handler.scope||this)});}
this._aButtons[this._aButtons.length]=oYUIButton;}
else{oButtonEl=document.createElement("button");oButtonEl.setAttribute("type","button");if(oButton.isDefault){oButtonEl.className="default";this.defaultHtmlButton=oButtonEl;}
oButtonEl.innerHTML=oButton.text;if(Lang.isFunction(oButton.handler)){Event.on(oButtonEl,"click",oButton.handler,this,true);}
else if(Lang.isObject(oButton.handler)&&Lang.isFunction(oButton.handler.fn)){Event.on(oButtonEl,"click",oButton.handler.fn,((!Lang.isUndefined(oButton.handler.obj))?oButton.handler.obj:this),(oButton.handler.scope||this));}
oSpan.appendChild(oButtonEl);this._aButtons[this._aButtons.length]=oButtonEl;}
oButton.htmlButton=oButtonEl;if(i===0){this.firstButton=oButtonEl;}
if(i==(nButtons-1)){this.lastButton=oButtonEl;}}
this.setFooter(oSpan);oFooter=this.footer;if(Dom.inDocument(this.element)&&!Dom.isAncestor(oInnerElement,oFooter)){oInnerElement.appendChild(oFooter);}
this.buttonSpan=oSpan;}else{oSpan=this.buttonSpan;oFooter=this.footer;if(oSpan&&oFooter){oFooter.removeChild(oSpan);this.buttonSpan=null;this.firstButton=null;this.lastButton=null;this.defaultHtmlButton=null;}}
this.cfg.refireEvent("iframe");this.cfg.refireEvent("underlay");},getButtons:function(){var aButtons=this._aButtons;if(aButtons){return aButtons;}},focusFirst:function(type,args,obj){var oElement=this.firstFormElement,oEvent;if(args){oEvent=args[1];if(oEvent){Event.stopEvent(oEvent);}}
if(oElement){try{oElement.focus();}
catch(oException){}}else{this.focusDefaultButton();}},focusLast:function(type,args,obj){var aButtons=this.cfg.getProperty("buttons"),oElement=this.lastFormElement,oEvent;if(args){oEvent=args[1];if(oEvent){Event.stopEvent(oEvent);}}
if(aButtons&&Lang.isArray(aButtons)){this.focusLastButton();}else{if(oElement){try{oElement.focus();}catch(oException){}}}},focusDefaultButton:function(){var oElement=this.defaultHtmlButton;if(oElement){try{oElement.focus();}catch(oException){}}},blurButtons:function(){var aButtons=this.cfg.getProperty("buttons"),nButtons,oButton,oElement,i;if(aButtons&&Lang.isArray(aButtons)){nButtons=aButtons.length;if(nButtons>0){i=(nButtons-1);do{oButton=aButtons[i];if(oButton){oElement=oButton.htmlButton;if(oElement){try{oElement.blur();}catch(oException){}}}}while(i--);}}},focusFirstButton:function(){var aButtons=this.cfg.getProperty("buttons"),oButton,oElement;if(aButtons&&Lang.isArray(aButtons)){oButton=aButtons[0];if(oButton){oElement=oButton.htmlButton;if(oElement){try{oElement.focus();}
catch(oException){}}}}},focusLastButton:function(){var aButtons=this.cfg.getProperty("buttons"),nButtons,oButton,oElement;if(aButtons&&Lang.isArray(aButtons)){nButtons=aButtons.length;if(nButtons>0){oButton=aButtons[(nButtons-1)];if(oButton){oElement=oButton.htmlButton;if(oElement){try{oElement.focus();}catch(oException){}}}}}},configPostMethod:function(type,args,obj){this.registerForm();},validate:function(){return true;},submit:function(){if(this.validate()){this.beforeSubmitEvent.fire();this.doSubmit();this.submitEvent.fire();if(this.cfg.getProperty("hideaftersubmit")){this.hide();}
return true;}else{return false;}},cancel:function(){this.cancelEvent.fire();this.hide();},getData:function(){var oForm=this.form,aElements,nTotalElements,oData,sName,oElement,nElements,sType,sTagName,aOptions,nOptions,aValues,oOption,sValue,oRadio,oCheckbox,i,n;function isFormElement(p_oElement){var sTag=p_oElement.tagName.toUpperCase();return((sTag=="INPUT"||sTag=="TEXTAREA"||sTag=="SELECT")&&p_oElement.name==sName);}
if(oForm){aElements=oForm.elements;nTotalElements=aElements.length;oData={};for(i=0;i<nTotalElements;i++){sName=aElements[i].name;oElement=Dom.getElementsBy(isFormElement,"*",oForm);nElements=oElement.length;if(nElements>0){if(nElements==1){oElement=oElement[0];sType=oElement.type;sTagName=oElement.tagName.toUpperCase();switch(sTagName){case"INPUT":if(sType=="checkbox"){oData[sName]=oElement.checked;}
else if(sType!="radio"){oData[sName]=oElement.value;}
break;case"TEXTAREA":oData[sName]=oElement.value;break;case"SELECT":aOptions=oElement.options;nOptions=aOptions.length;aValues=[];for(n=0;n<nOptions;n++){oOption=aOptions[n];if(oOption.selected){sValue=oOption.value;if(!sValue||sValue===""){sValue=oOption.text;}
aValues[aValues.length]=sValue;}}
oData[sName]=aValues;break;}}
else{sType=oElement[0].type;switch(sType){case"radio":for(n=0;n<nElements;n++){oRadio=oElement[n];if(oRadio.checked){oData[sName]=oRadio.value;break;}}
break;case"checkbox":aValues=[];for(n=0;n<nElements;n++){oCheckbox=oElement[n];if(oCheckbox.checked){aValues[aValues.length]=oCheckbox.value;}}
oData[sName]=aValues;break;}}}}}
return oData;},destroy:function(){removeButtonEventHandlers.call(this);this._aButtons=null;var aForms=this.element.getElementsByTagName("form"),oForm;if(aForms.length>0){oForm=aForms[0];if(oForm){Event.purgeElement(oForm);if(oForm.parentNode){oForm.parentNode.removeChild(oForm);}
this.form=null;}}
Dialog.superclass.destroy.call(this);},toString:function(){return"Dialog "+this.id;}});}());(function(){YAHOO.widget.SimpleDialog=function(el,userConfig){YAHOO.widget.SimpleDialog.superclass.constructor.call(this,el,userConfig);};var Dom=YAHOO.util.Dom,SimpleDialog=YAHOO.widget.SimpleDialog,DEFAULT_CONFIG={"ICON":{key:"icon",value:"none",suppressEvent:true},"TEXT":{key:"text",value:"",suppressEvent:true,supercedes:["icon"]}};SimpleDialog.ICON_BLOCK="blckicon";SimpleDialog.ICON_ALARM="alrticon";SimpleDialog.ICON_HELP="hlpicon";SimpleDialog.ICON_INFO="infoicon";SimpleDialog.ICON_WARN="warnicon";SimpleDialog.ICON_TIP="tipicon";SimpleDialog.ICON_CSS_CLASSNAME="yui-icon";SimpleDialog.CSS_SIMPLEDIALOG="yui-simple-dialog";YAHOO.extend(SimpleDialog,YAHOO.widget.Dialog,{initDefaultConfig:function(){SimpleDialog.superclass.initDefaultConfig.call(this);this.cfg.addProperty(DEFAULT_CONFIG.ICON.key,{handler:this.configIcon,value:DEFAULT_CONFIG.ICON.value,suppressEvent:DEFAULT_CONFIG.ICON.suppressEvent});this.cfg.addProperty(DEFAULT_CONFIG.TEXT.key,{handler:this.configText,value:DEFAULT_CONFIG.TEXT.value,suppressEvent:DEFAULT_CONFIG.TEXT.suppressEvent,supercedes:DEFAULT_CONFIG.TEXT.supercedes});},init:function(el,userConfig){SimpleDialog.superclass.init.call(this,el);this.beforeInitEvent.fire(SimpleDialog);Dom.addClass(this.element,SimpleDialog.CSS_SIMPLEDIALOG);this.cfg.queueProperty("postmethod","manual");if(userConfig){this.cfg.applyConfig(userConfig,true);}
this.beforeRenderEvent.subscribe(function(){if(!this.body){this.setBody("");}},this,true);this.initEvent.fire(SimpleDialog);},registerForm:function(){SimpleDialog.superclass.registerForm.call(this);this.form.innerHTML+="<input type=\"hidden\" name=\""+
this.id+"\" value=\"\"/>";},configIcon:function(type,args,obj){var sIcon=args[0],oBody=this.body,sCSSClass=SimpleDialog.ICON_CSS_CLASSNAME,oIcon,oIconParent;if(sIcon&&sIcon!="none"){oIcon=Dom.getElementsByClassName(sCSSClass,"*",oBody);if(oIcon){oIconParent=oIcon.parentNode;if(oIconParent){oIconParent.removeChild(oIcon);oIcon=null;}}
if(sIcon.indexOf(".")==-1){oIcon=document.createElement("span");oIcon.className=(sCSSClass+" "+sIcon);oIcon.innerHTML="&#160;";}else{oIcon=document.createElement("img");oIcon.src=(this.imageRoot+sIcon);oIcon.className=sCSSClass;}
if(oIcon){oBody.insertBefore(oIcon,oBody.firstChild);}}},configText:function(type,args,obj){var text=args[0];if(text){this.setBody(text);this.cfg.refireEvent("icon");}},toString:function(){return"SimpleDialog "+this.id;}});}());(function(){YAHOO.widget.ContainerEffect=function(overlay,attrIn,attrOut,targetElement,animClass){if(!animClass){animClass=YAHOO.util.Anim;}
this.overlay=overlay;this.attrIn=attrIn;this.attrOut=attrOut;this.targetElement=targetElement||overlay.element;this.animClass=animClass;};var Dom=YAHOO.util.Dom,CustomEvent=YAHOO.util.CustomEvent,Easing=YAHOO.util.Easing,ContainerEffect=YAHOO.widget.ContainerEffect;ContainerEffect.FADE=function(overlay,dur){var fin={attributes:{opacity:{from:0,to:1}},duration:dur,method:Easing.easeIn};var fout={attributes:{opacity:{to:0}},duration:dur,method:Easing.easeOut};var fade=new ContainerEffect(overlay,fin,fout,overlay.element);fade.handleUnderlayStart=function(){var underlay=this.overlay.underlay;if(underlay&&YAHOO.env.ua.ie){var hasFilters=(underlay.filters&&underlay.filters.length>0);if(hasFilters){Dom.addClass(overlay.element,"yui-effect-fade");}}};fade.handleUnderlayComplete=function(){var underlay=this.overlay.underlay;if(underlay&&YAHOO.env.ua.ie){Dom.removeClass(overlay.element,"yui-effect-fade");}};fade.handleStartAnimateIn=function(type,args,obj){Dom.addClass(obj.overlay.element,"hide-select");if(!obj.overlay.underlay){obj.overlay.cfg.refireEvent("underlay");}
obj.handleUnderlayStart();Dom.setStyle(obj.overlay.element,"visibility","visible");Dom.setStyle(obj.overlay.element,"opacity",0);};fade.handleCompleteAnimateIn=function(type,args,obj){Dom.removeClass(obj.overlay.element,"hide-select");if(obj.overlay.element.style.filter){obj.overlay.element.style.filter=null;}
obj.handleUnderlayComplete();obj.overlay.cfg.refireEvent("iframe");obj.animateInCompleteEvent.fire();};fade.handleStartAnimateOut=function(type,args,obj){Dom.addClass(obj.overlay.element,"hide-select");obj.handleUnderlayStart();};fade.handleCompleteAnimateOut=function(type,args,obj){Dom.removeClass(obj.overlay.element,"hide-select");if(obj.overlay.element.style.filter){obj.overlay.element.style.filter=null;}
Dom.setStyle(obj.overlay.element,"visibility","hidden");Dom.setStyle(obj.overlay.element,"opacity",1);obj.handleUnderlayComplete();obj.overlay.cfg.refireEvent("iframe");obj.animateOutCompleteEvent.fire();};fade.init();return fade;};ContainerEffect.SLIDE=function(overlay,dur){var x=overlay.cfg.getProperty("x")||Dom.getX(overlay.element),y=overlay.cfg.getProperty("y")||Dom.getY(overlay.element),clientWidth=Dom.getClientWidth(),offsetWidth=overlay.element.offsetWidth,slide=new ContainerEffect(overlay,{attributes:{points:{to:[x,y]}},duration:dur,method:Easing.easeIn},{attributes:{points:{to:[(clientWidth+25),y]}},duration:dur,method:Easing.easeOut},overlay.element,YAHOO.util.Motion);slide.handleStartAnimateIn=function(type,args,obj){obj.overlay.element.style.left=((-25)-offsetWidth)+"px";obj.overlay.element.style.top=y+"px";};slide.handleTweenAnimateIn=function(type,args,obj){var pos=Dom.getXY(obj.overlay.element),currentX=pos[0],currentY=pos[1];if(Dom.getStyle(obj.overlay.element,"visibility")=="hidden"&&currentX<x){Dom.setStyle(obj.overlay.element,"visibility","visible");}
obj.overlay.cfg.setProperty("xy",[currentX,currentY],true);obj.overlay.cfg.refireEvent("iframe");};slide.handleCompleteAnimateIn=function(type,args,obj){obj.overlay.cfg.setProperty("xy",[x,y],true);obj.startX=x;obj.startY=y;obj.overlay.cfg.refireEvent("iframe");obj.animateInCompleteEvent.fire();};slide.handleStartAnimateOut=function(type,args,obj){var vw=Dom.getViewportWidth(),pos=Dom.getXY(obj.overlay.element),yso=pos[1];obj.animOut.attributes.points.to=[(vw+25),yso];};slide.handleTweenAnimateOut=function(type,args,obj){var pos=Dom.getXY(obj.overlay.element),xto=pos[0],yto=pos[1];obj.overlay.cfg.setProperty("xy",[xto,yto],true);obj.overlay.cfg.refireEvent("iframe");};slide.handleCompleteAnimateOut=function(type,args,obj){Dom.setStyle(obj.overlay.element,"visibility","hidden");obj.overlay.cfg.setProperty("xy",[x,y]);obj.animateOutCompleteEvent.fire();};slide.init();return slide;};ContainerEffect.prototype={init:function(){this.beforeAnimateInEvent=this.createEvent("beforeAnimateIn");this.beforeAnimateInEvent.signature=CustomEvent.LIST;this.beforeAnimateOutEvent=this.createEvent("beforeAnimateOut");this.beforeAnimateOutEvent.signature=CustomEvent.LIST;this.animateInCompleteEvent=this.createEvent("animateInComplete");this.animateInCompleteEvent.signature=CustomEvent.LIST;this.animateOutCompleteEvent=this.createEvent("animateOutComplete");this.animateOutCompleteEvent.signature=CustomEvent.LIST;this.animIn=new this.animClass(this.targetElement,this.attrIn.attributes,this.attrIn.duration,this.attrIn.method);this.animIn.onStart.subscribe(this.handleStartAnimateIn,this);this.animIn.onTween.subscribe(this.handleTweenAnimateIn,this);this.animIn.onComplete.subscribe(this.handleCompleteAnimateIn,this);this.animOut=new this.animClass(this.targetElement,this.attrOut.attributes,this.attrOut.duration,this.attrOut.method);this.animOut.onStart.subscribe(this.handleStartAnimateOut,this);this.animOut.onTween.subscribe(this.handleTweenAnimateOut,this);this.animOut.onComplete.subscribe(this.handleCompleteAnimateOut,this);},animateIn:function(){this.beforeAnimateInEvent.fire();this.animIn.animate();},animateOut:function(){this.beforeAnimateOutEvent.fire();this.animOut.animate();},handleStartAnimateIn:function(type,args,obj){},handleTweenAnimateIn:function(type,args,obj){},handleCompleteAnimateIn:function(type,args,obj){},handleStartAnimateOut:function(type,args,obj){},handleTweenAnimateOut:function(type,args,obj){},handleCompleteAnimateOut:function(type,args,obj){},toString:function(){var output="ContainerEffect";if(this.overlay){output+=" ["+this.overlay.toString()+"]";}
return output;}};YAHOO.lang.augmentProto(ContainerEffect,YAHOO.util.EventProvider);})();YAHOO.register("container",YAHOO.widget.Module,{version:"2.5.2",build:"1076"});

(function(){var Dom=YAHOO.util.Dom,Event=YAHOO.util.Event;YAHOO.widget.MenuManager=function(){var m_bInitializedEventHandlers=false,m_oMenus={},m_oVisibleMenus={},m_oItems={},m_oEventTypes={"click":"clickEvent","mousedown":"mouseDownEvent","mouseup":"mouseUpEvent","mouseover":"mouseOverEvent","mouseout":"mouseOutEvent","keydown":"keyDownEvent","keyup":"keyUpEvent","keypress":"keyPressEvent"},m_oFocusedMenuItem=null;function getMenuRootElement(p_oElement){var oParentNode;if(p_oElement&&p_oElement.tagName){switch(p_oElement.tagName.toUpperCase()){case"DIV":oParentNode=p_oElement.parentNode;if((Dom.hasClass(p_oElement,"hd")||Dom.hasClass(p_oElement,"bd")||Dom.hasClass(p_oElement,"ft"))&&oParentNode&&oParentNode.tagName&&oParentNode.tagName.toUpperCase()=="DIV")
{return oParentNode;}
else{return p_oElement;}
break;case"LI":return p_oElement;default:oParentNode=p_oElement.parentNode;if(oParentNode){return getMenuRootElement(oParentNode);}
break;}}}
function onDOMEvent(p_oEvent){var oTarget=Event.getTarget(p_oEvent),oElement=getMenuRootElement(oTarget),sCustomEventType,sTagName,sId,oMenuItem,oMenu;if(oElement){sTagName=oElement.tagName.toUpperCase();if(sTagName=="LI"){sId=oElement.id;if(sId&&m_oItems[sId]){oMenuItem=m_oItems[sId];oMenu=oMenuItem.parent;}}
else if(sTagName=="DIV"){if(oElement.id){oMenu=m_oMenus[oElement.id];}}}
if(oMenu){sCustomEventType=m_oEventTypes[p_oEvent.type];if(oMenuItem&&!oMenuItem.cfg.getProperty("disabled")){oMenuItem[sCustomEventType].fire(p_oEvent);if(p_oEvent.type=="keyup"||p_oEvent.type=="mousedown")
{if(m_oFocusedMenuItem!=oMenuItem){if(m_oFocusedMenuItem){m_oFocusedMenuItem.blurEvent.fire();}
oMenuItem.focusEvent.fire();}}}
oMenu[sCustomEventType].fire(p_oEvent,oMenuItem);}
else if(p_oEvent.type=="mousedown"){if(m_oFocusedMenuItem){m_oFocusedMenuItem.blurEvent.fire();m_oFocusedMenuItem=null;}
for(var i in m_oVisibleMenus){if(YAHOO.lang.hasOwnProperty(m_oVisibleMenus,i)){oMenu=m_oVisibleMenus[i];if(oMenu.cfg.getProperty("clicktohide")&&!(oMenu instanceof YAHOO.widget.MenuBar)&&oMenu.cfg.getProperty("position")=="dynamic"){oMenu.hide();}
else{if(oMenu.cfg.getProperty("showdelay")>0){oMenu._cancelShowDelay();}
if(oMenu.activeItem){oMenu.activeItem.blur();oMenu.activeItem.cfg.setProperty("selected",false);oMenu.activeItem=null;}}}}}
else if(p_oEvent.type=="keyup"){if(m_oFocusedMenuItem){m_oFocusedMenuItem.blurEvent.fire();m_oFocusedMenuItem=null;}}}
function onMenuDestroy(p_sType,p_aArgs,p_oMenu){if(m_oMenus[p_oMenu.id]){this.removeMenu(p_oMenu);}}
function onMenuFocus(p_sType,p_aArgs){var oItem=p_aArgs[0];if(oItem){m_oFocusedMenuItem=oItem;}}
function onMenuBlur(p_sType,p_aArgs){m_oFocusedMenuItem=null;}
function onMenuVisibleConfigChange(p_sType,p_aArgs){var bVisible=p_aArgs[0],sId=this.id;if(bVisible){m_oVisibleMenus[sId]=this;}
else if(m_oVisibleMenus[sId]){delete m_oVisibleMenus[sId];}}
function onItemDestroy(p_sType,p_aArgs){removeItem(this);}
function removeItem(p_oMenuItem){var sId=p_oMenuItem.id;if(sId&&m_oItems[sId]){if(m_oFocusedMenuItem==p_oMenuItem){m_oFocusedMenuItem=null;}
delete m_oItems[sId];p_oMenuItem.destroyEvent.unsubscribe(onItemDestroy);}}
function onItemAdded(p_sType,p_aArgs){var oItem=p_aArgs[0],sId;if(oItem instanceof YAHOO.widget.MenuItem){sId=oItem.id;if(!m_oItems[sId]){m_oItems[sId]=oItem;oItem.destroyEvent.subscribe(onItemDestroy);}}}
return{addMenu:function(p_oMenu){var oDoc;if(p_oMenu instanceof YAHOO.widget.Menu&&p_oMenu.id&&!m_oMenus[p_oMenu.id]){m_oMenus[p_oMenu.id]=p_oMenu;if(!m_bInitializedEventHandlers){oDoc=document;Event.on(oDoc,"mouseover",onDOMEvent,this,true);Event.on(oDoc,"mouseout",onDOMEvent,this,true);Event.on(oDoc,"mousedown",onDOMEvent,this,true);Event.on(oDoc,"mouseup",onDOMEvent,this,true);Event.on(oDoc,"click",onDOMEvent,this,true);Event.on(oDoc,"keydown",onDOMEvent,this,true);Event.on(oDoc,"keyup",onDOMEvent,this,true);Event.on(oDoc,"keypress",onDOMEvent,this,true);m_bInitializedEventHandlers=true;}
p_oMenu.cfg.subscribeToConfigEvent("visible",onMenuVisibleConfigChange);p_oMenu.destroyEvent.subscribe(onMenuDestroy,p_oMenu,this);p_oMenu.itemAddedEvent.subscribe(onItemAdded);p_oMenu.focusEvent.subscribe(onMenuFocus);p_oMenu.blurEvent.subscribe(onMenuBlur);}},removeMenu:function(p_oMenu){var sId,aItems,i;if(p_oMenu){sId=p_oMenu.id;if(m_oMenus[sId]==p_oMenu){aItems=p_oMenu.getItems();if(aItems&&aItems.length>0){i=aItems.length-1;do{removeItem(aItems[i]);}
while(i--);}
delete m_oMenus[sId];if(m_oVisibleMenus[sId]==p_oMenu){delete m_oVisibleMenus[sId];}
if(p_oMenu.cfg){p_oMenu.cfg.unsubscribeFromConfigEvent("visible",onMenuVisibleConfigChange);}
p_oMenu.destroyEvent.unsubscribe(onMenuDestroy,p_oMenu);p_oMenu.itemAddedEvent.unsubscribe(onItemAdded);p_oMenu.focusEvent.unsubscribe(onMenuFocus);p_oMenu.blurEvent.unsubscribe(onMenuBlur);}}},hideVisible:function(){var oMenu;for(var i in m_oVisibleMenus){if(YAHOO.lang.hasOwnProperty(m_oVisibleMenus,i)){oMenu=m_oVisibleMenus[i];if(!(oMenu instanceof YAHOO.widget.MenuBar)&&oMenu.cfg.getProperty("position")=="dynamic"){oMenu.hide();}}}},getVisible:function(){return m_oVisibleMenus;},getMenus:function(){return m_oMenus;},getMenu:function(p_sId){var oMenu=m_oMenus[p_sId];if(oMenu){return oMenu;}},getMenuItem:function(p_sId){var oItem=m_oItems[p_sId];if(oItem){return oItem;}},getMenuItemGroup:function(p_sId){var oUL=Dom.get(p_sId),aItems,oNode,oItem,sId;if(oUL&&oUL.tagName&&oUL.tagName.toUpperCase()=="UL"){oNode=oUL.firstChild;if(oNode){aItems=[];do{sId=oNode.id;if(sId){oItem=this.getMenuItem(sId);if(oItem){aItems[aItems.length]=oItem;}}}
while((oNode=oNode.nextSibling));if(aItems.length>0){return aItems;}}}},getFocusedMenuItem:function(){return m_oFocusedMenuItem;},getFocusedMenu:function(){if(m_oFocusedMenuItem){return(m_oFocusedMenuItem.parent.getRoot());}},toString:function(){return"MenuManager";}};}();})();(function(){YAHOO.widget.Menu=function(p_oElement,p_oConfig){if(p_oConfig){this.parent=p_oConfig.parent;this.lazyLoad=p_oConfig.lazyLoad||p_oConfig.lazyloaddisabled;this.itemData=p_oConfig.itemData||p_oConfig.itemdata;}
YAHOO.widget.Menu.superclass.constructor.call(this,p_oElement,p_oConfig);};function checkPosition(p_sPosition){if(typeof p_sPosition=="string"){return("dynamic,static".indexOf((p_sPosition.toLowerCase()))!=-1);}}
var Dom=YAHOO.util.Dom,Event=YAHOO.util.Event,Module=YAHOO.widget.Module,Overlay=YAHOO.widget.Overlay,Menu=YAHOO.widget.Menu,MenuManager=YAHOO.widget.MenuManager,CustomEvent=YAHOO.util.CustomEvent,Lang=YAHOO.lang,UA=YAHOO.env.ua,m_oShadowTemplate,EVENT_TYPES={"MOUSE_OVER":"mouseover","MOUSE_OUT":"mouseout","MOUSE_DOWN":"mousedown","MOUSE_UP":"mouseup","CLICK":"click","KEY_PRESS":"keypress","KEY_DOWN":"keydown","KEY_UP":"keyup","FOCUS":"focus","BLUR":"blur","ITEM_ADDED":"itemAdded","ITEM_REMOVED":"itemRemoved"},DEFAULT_CONFIG={"VISIBLE":{key:"visible",value:false,validator:Lang.isBoolean},"CONSTRAIN_TO_VIEWPORT":{key:"constraintoviewport",value:true,validator:Lang.isBoolean,supercedes:["iframe","x","y","xy"]},"POSITION":{key:"position",value:"dynamic",validator:checkPosition,supercedes:["visible","iframe"]},"SUBMENU_ALIGNMENT":{key:"submenualignment",value:["tl","tr"],suppressEvent:true},"AUTO_SUBMENU_DISPLAY":{key:"autosubmenudisplay",value:true,validator:Lang.isBoolean,suppressEvent:true},"SHOW_DELAY":{key:"showdelay",value:250,validator:Lang.isNumber,suppressEvent:true},"HIDE_DELAY":{key:"hidedelay",value:0,validator:Lang.isNumber,suppressEvent:true},"SUBMENU_HIDE_DELAY":{key:"submenuhidedelay",value:250,validator:Lang.isNumber,suppressEvent:true},"CLICK_TO_HIDE":{key:"clicktohide",value:true,validator:Lang.isBoolean,suppressEvent:true},"CONTAINER":{key:"container",suppressEvent:true},"SCROLL_INCREMENT":{key:"scrollincrement",value:1,validator:Lang.isNumber,supercedes:["maxheight"],suppressEvent:true},"MIN_SCROLL_HEIGHT":{key:"minscrollheight",value:90,validator:Lang.isNumber,supercedes:["maxheight"],suppressEvent:true},"MAX_HEIGHT":{key:"maxheight",value:0,validator:Lang.isNumber,supercedes:["iframe"],suppressEvent:true},"CLASS_NAME":{key:"classname",value:null,validator:Lang.isString,suppressEvent:true},"DISABLED":{key:"disabled",value:false,validator:Lang.isBoolean,suppressEvent:true}};YAHOO.lang.extend(Menu,Overlay,{CSS_CLASS_NAME:"yuimenu",ITEM_TYPE:null,GROUP_TITLE_TAG_NAME:"h6",OFF_SCREEN_POSITION:[-10000,-10000],_nHideDelayId:null,_nShowDelayId:null,_nSubmenuHideDelayId:null,_nBodyScrollId:null,_bHideDelayEventHandlersAssigned:false,_bHandledMouseOverEvent:false,_bHandledMouseOutEvent:false,_aGroupTitleElements:null,_aItemGroups:null,_aListElements:null,_nCurrentMouseX:0,_bStopMouseEventHandlers:false,_sClassName:null,lazyLoad:false,itemData:null,activeItem:null,parent:null,srcElement:null,mouseOverEvent:null,mouseOutEvent:null,mouseDownEvent:null,mouseUpEvent:null,clickEvent:null,keyPressEvent:null,keyDownEvent:null,keyUpEvent:null,itemAddedEvent:null,itemRemovedEvent:null,init:function(p_oElement,p_oConfig){this._aItemGroups=[];this._aListElements=[];this._aGroupTitleElements=[];if(!this.ITEM_TYPE){this.ITEM_TYPE=YAHOO.widget.MenuItem;}
var oElement;if(typeof p_oElement=="string"){oElement=document.getElementById(p_oElement);}
else if(p_oElement.tagName){oElement=p_oElement;}
if(oElement&&oElement.tagName){switch(oElement.tagName.toUpperCase()){case"DIV":this.srcElement=oElement;if(!oElement.id){oElement.setAttribute("id",Dom.generateId());}
Menu.superclass.init.call(this,oElement);this.beforeInitEvent.fire(Menu);break;case"SELECT":this.srcElement=oElement;Menu.superclass.init.call(this,Dom.generateId());this.beforeInitEvent.fire(Menu);break;}}
else{Menu.superclass.init.call(this,p_oElement);this.beforeInitEvent.fire(Menu);}
if(this.element){Dom.addClass(this.element,this.CSS_CLASS_NAME);this.initEvent.subscribe(this._onInit);this.beforeRenderEvent.subscribe(this._onBeforeRender);this.renderEvent.subscribe(this._onRender);this.renderEvent.subscribe(this.onRender);this.beforeShowEvent.subscribe(this._onBeforeShow);this.hideEvent.subscribe(this.positionOffScreen);this.showEvent.subscribe(this._onShow);this.beforeHideEvent.subscribe(this._onBeforeHide);this.mouseOverEvent.subscribe(this._onMouseOver);this.mouseOutEvent.subscribe(this._onMouseOut);this.clickEvent.subscribe(this._onClick);this.keyDownEvent.subscribe(this._onKeyDown);this.keyPressEvent.subscribe(this._onKeyPress);if(UA.gecko||UA.webkit){this.cfg.subscribeToConfigEvent("y",this._onYChange);}
if(p_oConfig){this.cfg.applyConfig(p_oConfig,true);}
MenuManager.addMenu(this);this.initEvent.fire(Menu);}},_initSubTree:function(){var oSrcElement=this.srcElement,sSrcElementTagName,nGroup,sGroupTitleTagName,oNode,aListElements,nListElements,i;if(oSrcElement){sSrcElementTagName=(oSrcElement.tagName&&oSrcElement.tagName.toUpperCase());if(sSrcElementTagName=="DIV"){oNode=this.body.firstChild;if(oNode){nGroup=0;sGroupTitleTagName=this.GROUP_TITLE_TAG_NAME.toUpperCase();do{if(oNode&&oNode.tagName){switch(oNode.tagName.toUpperCase()){case sGroupTitleTagName:this._aGroupTitleElements[nGroup]=oNode;break;case"UL":this._aListElements[nGroup]=oNode;this._aItemGroups[nGroup]=[];nGroup++;break;}}}
while((oNode=oNode.nextSibling));if(this._aListElements[0]){Dom.addClass(this._aListElements[0],"first-of-type");}}}
oNode=null;if(sSrcElementTagName){switch(sSrcElementTagName){case"DIV":aListElements=this._aListElements;nListElements=aListElements.length;if(nListElements>0){i=nListElements-1;do{oNode=aListElements[i].firstChild;if(oNode){do{if(oNode&&oNode.tagName&&oNode.tagName.toUpperCase()=="LI"){this.addItem(new this.ITEM_TYPE(oNode,{parent:this}),i);}}
while((oNode=oNode.nextSibling));}}
while(i--);}
break;case"SELECT":oNode=oSrcElement.firstChild;do{if(oNode&&oNode.tagName){switch(oNode.tagName.toUpperCase()){case"OPTGROUP":case"OPTION":this.addItem(new this.ITEM_TYPE(oNode,{parent:this}));break;}}}
while((oNode=oNode.nextSibling));break;}}}},_getFirstEnabledItem:function(){var aItems=this.getItems(),nItems=aItems.length,oItem;for(var i=0;i<nItems;i++){oItem=aItems[i];if(oItem&&!oItem.cfg.getProperty("disabled")&&oItem.element.style.display!="none"){return oItem;}}},_addItemToGroup:function(p_nGroupIndex,p_oItem,p_nItemIndex){var oItem,nGroupIndex,aGroup,oGroupItem,bAppend,oNextItemSibling,nItemIndex;function getNextItemSibling(p_aArray,p_nStartIndex){return(p_aArray[p_nStartIndex]||getNextItemSibling(p_aArray,(p_nStartIndex+1)));}
if(p_oItem instanceof this.ITEM_TYPE){oItem=p_oItem;oItem.parent=this;}
else if(typeof p_oItem=="string"){oItem=new this.ITEM_TYPE(p_oItem,{parent:this});}
else if(typeof p_oItem=="object"){p_oItem.parent=this;oItem=new this.ITEM_TYPE(p_oItem.text,p_oItem);}
if(oItem){if(oItem.cfg.getProperty("selected")){this.activeItem=oItem;}
nGroupIndex=typeof p_nGroupIndex=="number"?p_nGroupIndex:0;aGroup=this._getItemGroup(nGroupIndex);if(!aGroup){aGroup=this._createItemGroup(nGroupIndex);}
if(typeof p_nItemIndex=="number"){bAppend=(p_nItemIndex>=aGroup.length);if(aGroup[p_nItemIndex]){aGroup.splice(p_nItemIndex,0,oItem);}
else{aGroup[p_nItemIndex]=oItem;}
oGroupItem=aGroup[p_nItemIndex];if(oGroupItem){if(bAppend&&(!oGroupItem.element.parentNode||oGroupItem.element.parentNode.nodeType==11)){this._aListElements[nGroupIndex].appendChild(oGroupItem.element);}
else{oNextItemSibling=getNextItemSibling(aGroup,(p_nItemIndex+1));if(oNextItemSibling&&(!oGroupItem.element.parentNode||oGroupItem.element.parentNode.nodeType==11)){this._aListElements[nGroupIndex].insertBefore(oGroupItem.element,oNextItemSibling.element);}}
oGroupItem.parent=this;this._subscribeToItemEvents(oGroupItem);this._configureSubmenu(oGroupItem);this._updateItemProperties(nGroupIndex);this.itemAddedEvent.fire(oGroupItem);this.changeContentEvent.fire();return oGroupItem;}}
else{nItemIndex=aGroup.length;aGroup[nItemIndex]=oItem;oGroupItem=aGroup[nItemIndex];if(oGroupItem){if(!Dom.isAncestor(this._aListElements[nGroupIndex],oGroupItem.element)){this._aListElements[nGroupIndex].appendChild(oGroupItem.element);}
oGroupItem.element.setAttribute("groupindex",nGroupIndex);oGroupItem.element.setAttribute("index",nItemIndex);oGroupItem.parent=this;oGroupItem.index=nItemIndex;oGroupItem.groupIndex=nGroupIndex;this._subscribeToItemEvents(oGroupItem);this._configureSubmenu(oGroupItem);if(nItemIndex===0){Dom.addClass(oGroupItem.element,"first-of-type");}
this.itemAddedEvent.fire(oGroupItem);this.changeContentEvent.fire();return oGroupItem;}}}},_removeItemFromGroupByIndex:function(p_nGroupIndex,p_nItemIndex){var nGroupIndex=typeof p_nGroupIndex=="number"?p_nGroupIndex:0,aGroup=this._getItemGroup(nGroupIndex),aArray,oItem,oUL;if(aGroup){aArray=aGroup.splice(p_nItemIndex,1);oItem=aArray[0];if(oItem){this._updateItemProperties(nGroupIndex);if(aGroup.length===0){oUL=this._aListElements[nGroupIndex];if(this.body&&oUL){this.body.removeChild(oUL);}
this._aItemGroups.splice(nGroupIndex,1);this._aListElements.splice(nGroupIndex,1);oUL=this._aListElements[0];if(oUL){Dom.addClass(oUL,"first-of-type");}}
this.itemRemovedEvent.fire(oItem);this.changeContentEvent.fire();return oItem;}}},_removeItemFromGroupByValue:function(p_nGroupIndex,p_oItem){var aGroup=this._getItemGroup(p_nGroupIndex),nItems,nItemIndex,i;if(aGroup){nItems=aGroup.length;nItemIndex=-1;if(nItems>0){i=nItems-1;do{if(aGroup[i]==p_oItem){nItemIndex=i;break;}}
while(i--);if(nItemIndex>-1){return(this._removeItemFromGroupByIndex(p_nGroupIndex,nItemIndex));}}}},_updateItemProperties:function(p_nGroupIndex){var aGroup=this._getItemGroup(p_nGroupIndex),nItems=aGroup.length,oItem,oLI,i;if(nItems>0){i=nItems-1;do{oItem=aGroup[i];if(oItem){oLI=oItem.element;oItem.index=i;oItem.groupIndex=p_nGroupIndex;oLI.setAttribute("groupindex",p_nGroupIndex);oLI.setAttribute("index",i);Dom.removeClass(oLI,"first-of-type");}}
while(i--);if(oLI){Dom.addClass(oLI,"first-of-type");}}},_createItemGroup:function(p_nIndex){var oUL;if(!this._aItemGroups[p_nIndex]){this._aItemGroups[p_nIndex]=[];oUL=document.createElement("ul");this._aListElements[p_nIndex]=oUL;return this._aItemGroups[p_nIndex];}},_getItemGroup:function(p_nIndex){var nIndex=((typeof p_nIndex=="number")?p_nIndex:0);return this._aItemGroups[nIndex];},_configureSubmenu:function(p_oItem){var oSubmenu=p_oItem.cfg.getProperty("submenu");if(oSubmenu){this.cfg.configChangedEvent.subscribe(this._onParentMenuConfigChange,oSubmenu,true);this.renderEvent.subscribe(this._onParentMenuRender,oSubmenu,true);oSubmenu.beforeShowEvent.subscribe(this._onSubmenuBeforeShow);}},_subscribeToItemEvents:function(p_oItem){p_oItem.focusEvent.subscribe(this._onMenuItemFocus);p_oItem.blurEvent.subscribe(this._onMenuItemBlur);p_oItem.destroyEvent.subscribe(this._onMenuItemDestroy,p_oItem,this);p_oItem.cfg.configChangedEvent.subscribe(this._onMenuItemConfigChange,p_oItem,this);},_onVisibleChange:function(p_sType,p_aArgs){var bVisible=p_aArgs[0];if(bVisible){Dom.addClass(this.element,"visible");}
else{Dom.removeClass(this.element,"visible");}},_cancelHideDelay:function(){var oRoot=this.getRoot();if(oRoot._nHideDelayId){window.clearTimeout(oRoot._nHideDelayId);}},_execHideDelay:function(){this._cancelHideDelay();var oRoot=this.getRoot(),me=this;function hideMenu(){if(oRoot.activeItem){oRoot.clearActiveItem();}
if(oRoot==me&&!(me instanceof YAHOO.widget.MenuBar)&&me.cfg.getProperty("position")=="dynamic"){me.hide();}}
oRoot._nHideDelayId=window.setTimeout(hideMenu,oRoot.cfg.getProperty("hidedelay"));},_cancelShowDelay:function(){var oRoot=this.getRoot();if(oRoot._nShowDelayId){window.clearTimeout(oRoot._nShowDelayId);}},_execShowDelay:function(p_oMenu){var oRoot=this.getRoot();function showMenu(){if(p_oMenu.parent.cfg.getProperty("selected")){p_oMenu.show();}}
oRoot._nShowDelayId=window.setTimeout(showMenu,oRoot.cfg.getProperty("showdelay"));},_execSubmenuHideDelay:function(p_oSubmenu,p_nMouseX,p_nHideDelay){var me=this;p_oSubmenu._nSubmenuHideDelayId=window.setTimeout(function(){if(me._nCurrentMouseX>(p_nMouseX+10)){p_oSubmenu._nSubmenuHideDelayId=window.setTimeout(function(){p_oSubmenu.hide();},p_nHideDelay);}
else{p_oSubmenu.hide();}},50);},_disableScrollHeader:function(){if(!this._bHeaderDisabled){Dom.addClass(this.header,"topscrollbar_disabled");this._bHeaderDisabled=true;}},_disableScrollFooter:function(){if(!this._bFooterDisabled){Dom.addClass(this.footer,"bottomscrollbar_disabled");this._bFooterDisabled=true;}},_enableScrollHeader:function(){if(this._bHeaderDisabled){Dom.removeClass(this.header,"topscrollbar_disabled");this._bHeaderDisabled=false;}},_enableScrollFooter:function(){if(this._bFooterDisabled){Dom.removeClass(this.footer,"bottomscrollbar_disabled");this._bFooterDisabled=false;}},_onMouseOver:function(p_sType,p_aArgs){if(this._bStopMouseEventHandlers){return false;}
var oEvent=p_aArgs[0],oItem=p_aArgs[1],oTarget=Event.getTarget(oEvent),oParentMenu,nShowDelay,bShowDelay,oActiveItem,oItemCfg,oSubmenu;if(!this._bHandledMouseOverEvent&&(oTarget==this.element||Dom.isAncestor(this.element,oTarget))){this._nCurrentMouseX=0;Event.on(this.element,"mousemove",this._onMouseMove,this,true);this.clearActiveItem();if(this.parent&&this._nSubmenuHideDelayId){window.clearTimeout(this._nSubmenuHideDelayId);this.parent.cfg.setProperty("selected",true);oParentMenu=this.parent.parent;oParentMenu._bHandledMouseOutEvent=true;oParentMenu._bHandledMouseOverEvent=false;}
this._bHandledMouseOverEvent=true;this._bHandledMouseOutEvent=false;}
if(oItem&&!oItem.handledMouseOverEvent&&!oItem.cfg.getProperty("disabled")&&(oTarget==oItem.element||Dom.isAncestor(oItem.element,oTarget))){nShowDelay=this.cfg.getProperty("showdelay");bShowDelay=(nShowDelay>0);if(bShowDelay){this._cancelShowDelay();}
oActiveItem=this.activeItem;if(oActiveItem){oActiveItem.cfg.setProperty("selected",false);}
oItemCfg=oItem.cfg;oItemCfg.setProperty("selected",true);if(this.hasFocus()){oItem.focus();}
if(this.cfg.getProperty("autosubmenudisplay")){oSubmenu=oItemCfg.getProperty("submenu");if(oSubmenu){if(bShowDelay){this._execShowDelay(oSubmenu);}
else{oSubmenu.show();}}}
oItem.handledMouseOverEvent=true;oItem.handledMouseOutEvent=false;}},_onMouseOut:function(p_sType,p_aArgs){if(this._bStopMouseEventHandlers){return false;}
var oEvent=p_aArgs[0],oItem=p_aArgs[1],oRelatedTarget=Event.getRelatedTarget(oEvent),bMovingToSubmenu=false,oItemCfg,oSubmenu,nSubmenuHideDelay,nShowDelay;if(oItem&&!oItem.cfg.getProperty("disabled")){oItemCfg=oItem.cfg;oSubmenu=oItemCfg.getProperty("submenu");if(oSubmenu&&(oRelatedTarget==oSubmenu.element||Dom.isAncestor(oSubmenu.element,oRelatedTarget))){bMovingToSubmenu=true;}
if(!oItem.handledMouseOutEvent&&((oRelatedTarget!=oItem.element&&!Dom.isAncestor(oItem.element,oRelatedTarget))||bMovingToSubmenu)){if(!bMovingToSubmenu){oItem.cfg.setProperty("selected",false);if(oSubmenu){nSubmenuHideDelay=this.cfg.getProperty("submenuhidedelay");nShowDelay=this.cfg.getProperty("showdelay");if(!(this instanceof YAHOO.widget.MenuBar)&&nSubmenuHideDelay>0&&nShowDelay>=nSubmenuHideDelay){this._execSubmenuHideDelay(oSubmenu,Event.getPageX(oEvent),nSubmenuHideDelay);}
else{oSubmenu.hide();}}}
oItem.handledMouseOutEvent=true;oItem.handledMouseOverEvent=false;}}
if(!this._bHandledMouseOutEvent&&((oRelatedTarget!=this.element&&!Dom.isAncestor(this.element,oRelatedTarget))||bMovingToSubmenu)){Event.removeListener(this.element,"mousemove",this._onMouseMove);this._nCurrentMouseX=Event.getPageX(oEvent);this._bHandledMouseOutEvent=true;this._bHandledMouseOverEvent=false;}},_onMouseMove:function(p_oEvent,p_oMenu){if(this._bStopMouseEventHandlers){return false;}
this._nCurrentMouseX=Event.getPageX(p_oEvent);},_onClick:function(p_sType,p_aArgs){var oEvent=p_aArgs[0],oItem=p_aArgs[1],bInMenuAnchor=false,oSubmenu,oRoot,sId,sURL,nHashPos,nLen;if(oItem){if(oItem.cfg.getProperty("disabled")){Event.preventDefault(oEvent);}
else{oSubmenu=oItem.cfg.getProperty("submenu");sURL=oItem.cfg.getProperty("url");if(sURL){nHashPos=sURL.indexOf("#");nLen=sURL.length;if(nHashPos!=-1){sURL=sURL.substr(nHashPos,nLen);nLen=sURL.length;if(nLen>1){sId=sURL.substr(1,nLen);bInMenuAnchor=Dom.isAncestor(this.element,sId);}
else if(nLen===1){bInMenuAnchor=true;}}}
if(bInMenuAnchor&&!oItem.cfg.getProperty("target")){Event.preventDefault(oEvent);if(UA.webkit){oItem.focus();}
else{oItem.focusEvent.fire();}}
if(!oSubmenu){if((UA.gecko&&this.platform=="windows")&&oEvent.button>0){return;}
oRoot=this.getRoot();if(oRoot instanceof YAHOO.widget.MenuBar||oRoot.cfg.getProperty("position")=="static"){oRoot.clearActiveItem();}
else{oRoot.hide();}}}}},_onKeyDown:function(p_sType,p_aArgs){var oEvent=p_aArgs[0],oItem=p_aArgs[1],me=this,oSubmenu,oItemCfg,oParentItem,oRoot,oNextItem,oBody,nBodyScrollTop,nBodyOffsetHeight,aItems,nItems,nNextItemOffsetTop,nScrollTarget,oParentMenu;function stopMouseEventHandlers(){me._bStopMouseEventHandlers=true;window.setTimeout(function(){me._bStopMouseEventHandlers=false;},10);}
if(oItem&&!oItem.cfg.getProperty("disabled")){oItemCfg=oItem.cfg;oParentItem=this.parent;switch(oEvent.keyCode){case 38:case 40:oNextItem=(oEvent.keyCode==38)?oItem.getPreviousEnabledSibling():oItem.getNextEnabledSibling();if(oNextItem){this.clearActiveItem();oNextItem.cfg.setProperty("selected",true);oNextItem.focus();if(this.cfg.getProperty("maxheight")>0){oBody=this.body;nBodyScrollTop=oBody.scrollTop;nBodyOffsetHeight=oBody.offsetHeight;aItems=this.getItems();nItems=aItems.length-1;nNextItemOffsetTop=oNextItem.element.offsetTop;if(oEvent.keyCode==40){if(nNextItemOffsetTop>=(nBodyOffsetHeight+nBodyScrollTop)){oBody.scrollTop=nNextItemOffsetTop-nBodyOffsetHeight;}
else if(nNextItemOffsetTop<=nBodyScrollTop){oBody.scrollTop=0;}
if(oNextItem==aItems[nItems]){oBody.scrollTop=oNextItem.element.offsetTop;}}
else{if(nNextItemOffsetTop<=nBodyScrollTop){oBody.scrollTop=nNextItemOffsetTop-oNextItem.element.offsetHeight;}
else if(nNextItemOffsetTop>=(nBodyScrollTop+nBodyOffsetHeight)){oBody.scrollTop=nNextItemOffsetTop;}
if(oNextItem==aItems[0]){oBody.scrollTop=0;}}
nBodyScrollTop=oBody.scrollTop;nScrollTarget=oBody.scrollHeight-oBody.offsetHeight;if(nBodyScrollTop===0){this._disableScrollHeader();this._enableScrollFooter();}
else if(nBodyScrollTop==nScrollTarget){this._enableScrollHeader();this._disableScrollFooter();}
else{this._enableScrollHeader();this._enableScrollFooter();}}}
Event.preventDefault(oEvent);stopMouseEventHandlers();break;case 39:oSubmenu=oItemCfg.getProperty("submenu");if(oSubmenu){if(!oItemCfg.getProperty("selected")){oItemCfg.setProperty("selected",true);}
oSubmenu.show();oSubmenu.setInitialFocus();oSubmenu.setInitialSelection();}
else{oRoot=this.getRoot();if(oRoot instanceof YAHOO.widget.MenuBar){oNextItem=oRoot.activeItem.getNextEnabledSibling();if(oNextItem){oRoot.clearActiveItem();oNextItem.cfg.setProperty("selected",true);oSubmenu=oNextItem.cfg.getProperty("submenu");if(oSubmenu){oSubmenu.show();}
oNextItem.focus();}}}
Event.preventDefault(oEvent);stopMouseEventHandlers();break;case 37:if(oParentItem){oParentMenu=oParentItem.parent;if(oParentMenu instanceof YAHOO.widget.MenuBar){oNextItem=oParentMenu.activeItem.getPreviousEnabledSibling();if(oNextItem){oParentMenu.clearActiveItem();oNextItem.cfg.setProperty("selected",true);oSubmenu=oNextItem.cfg.getProperty("submenu");if(oSubmenu){oSubmenu.show();}
oNextItem.focus();}}
else{this.hide();oParentItem.focus();}}
Event.preventDefault(oEvent);stopMouseEventHandlers();break;}}
if(oEvent.keyCode==27){if(this.cfg.getProperty("position")=="dynamic"){this.hide();if(this.parent){this.parent.focus();}}
else if(this.activeItem){oSubmenu=this.activeItem.cfg.getProperty("submenu");if(oSubmenu&&oSubmenu.cfg.getProperty("visible")){oSubmenu.hide();this.activeItem.focus();}
else{this.activeItem.blur();this.activeItem.cfg.setProperty("selected",false);}}
Event.preventDefault(oEvent);}},_onKeyPress:function(p_sType,p_aArgs){var oEvent=p_aArgs[0];if(oEvent.keyCode==40||oEvent.keyCode==38){Event.preventDefault(oEvent);}},_onYChange:function(p_sType,p_aArgs){var oParent=this.parent,nScrollTop,oIFrame,nY;if(oParent){nScrollTop=oParent.parent.body.scrollTop;if(nScrollTop>0){nY=(this.cfg.getProperty("y")-nScrollTop);Dom.setY(this.element,nY);oIFrame=this.iframe;if(oIFrame){Dom.setY(oIFrame,nY);}
this.cfg.setProperty("y",nY,true);}}},_onScrollTargetMouseOver:function(p_oEvent,p_oMenu){this._cancelHideDelay();var oTarget=Event.getTarget(p_oEvent),oBody=this.body,me=this,nScrollIncrement=this.cfg.getProperty("scrollincrement"),nScrollTarget,fnScrollFunction;function scrollBodyDown(){var nScrollTop=oBody.scrollTop;if(nScrollTop<nScrollTarget){oBody.scrollTop=(nScrollTop+nScrollIncrement);me._enableScrollHeader();}
else{oBody.scrollTop=nScrollTarget;window.clearInterval(me._nBodyScrollId);me._disableScrollFooter();}}
function scrollBodyUp(){var nScrollTop=oBody.scrollTop;if(nScrollTop>0){oBody.scrollTop=(nScrollTop-nScrollIncrement);me._enableScrollFooter();}
else{oBody.scrollTop=0;window.clearInterval(me._nBodyScrollId);me._disableScrollHeader();}}
if(Dom.hasClass(oTarget,"hd")){fnScrollFunction=scrollBodyUp;}
else{nScrollTarget=oBody.scrollHeight-oBody.offsetHeight;fnScrollFunction=scrollBodyDown;}
this._nBodyScrollId=window.setInterval(fnScrollFunction,10);},_onScrollTargetMouseOut:function(p_oEvent,p_oMenu){window.clearInterval(this._nBodyScrollId);this._cancelHideDelay();},_onInit:function(p_sType,p_aArgs){this.cfg.subscribeToConfigEvent("visible",this._onVisibleChange);var bRootMenu=!this.parent,bLazyLoad=this.lazyLoad;if(((bRootMenu&&!bLazyLoad)||(bRootMenu&&(this.cfg.getProperty("visible")||this.cfg.getProperty("position")=="static"))||(!bRootMenu&&!bLazyLoad))&&this.getItemGroups().length===0){if(this.srcElement){this._initSubTree();}
if(this.itemData){this.addItems(this.itemData);}}
else if(bLazyLoad){this.cfg.fireQueue();}},_onBeforeRender:function(p_sType,p_aArgs){var oEl=this.element,nListElements=this._aListElements.length,bFirstList=true,i=0,oUL,oGroupTitle;if(nListElements>0){do{oUL=this._aListElements[i];if(oUL){if(bFirstList){Dom.addClass(oUL,"first-of-type");bFirstList=false;}
if(!Dom.isAncestor(oEl,oUL)){this.appendToBody(oUL);}
oGroupTitle=this._aGroupTitleElements[i];if(oGroupTitle){if(!Dom.isAncestor(oEl,oGroupTitle)){oUL.parentNode.insertBefore(oGroupTitle,oUL);}
Dom.addClass(oUL,"hastitle");}}
i++;}
while(i<nListElements);}},_onRender:function(p_sType,p_aArgs){if(this.cfg.getProperty("position")=="dynamic"){if(!this.cfg.getProperty("visible")){this.positionOffScreen();}}},_onBeforeShow:function(p_sType,p_aArgs){var nOptions,n,nViewportHeight,oRegion,oSrcElement;if(this.lazyLoad&&this.getItemGroups().length===0){if(this.srcElement){this._initSubTree();}
if(this.itemData){if(this.parent&&this.parent.parent&&this.parent.parent.srcElement&&this.parent.parent.srcElement.tagName.toUpperCase()=="SELECT"){nOptions=this.itemData.length;for(n=0;n<nOptions;n++){if(this.itemData[n].tagName){this.addItem((new this.ITEM_TYPE(this.itemData[n])));}}}
else{this.addItems(this.itemData);}}
oSrcElement=this.srcElement;if(oSrcElement){if(oSrcElement.tagName.toUpperCase()=="SELECT"){if(Dom.inDocument(oSrcElement)){this.render(oSrcElement.parentNode);}
else{this.render(this.cfg.getProperty("container"));}}
else{this.render();}}
else{if(this.parent){this.render(this.parent.element);}
else{this.render(this.cfg.getProperty("container"));}}}
var nMaxHeight=this.cfg.getProperty("maxheight"),nMinScrollHeight=this.cfg.getProperty("minscrollheight"),bDynamicPos=this.cfg.getProperty("position")=="dynamic";if(!this.parent&&bDynamicPos){this.cfg.refireEvent("xy");}
function clearMaxHeight(){this.cfg.setProperty("maxheight",0);this.hideEvent.unsubscribe(clearMaxHeight);}
if(!(this instanceof YAHOO.widget.MenuBar)&&bDynamicPos){if(nMaxHeight===0){nViewportHeight=Dom.getViewportHeight();if(this.parent&&this.parent.parent instanceof YAHOO.widget.MenuBar){oRegion=YAHOO.util.Region.getRegion(this.parent.element);nViewportHeight=(nViewportHeight-oRegion.bottom);}
if(this.element.offsetHeight>=nViewportHeight){nMaxHeight=(nViewportHeight-(Overlay.VIEWPORT_OFFSET*2));if(nMaxHeight<nMinScrollHeight){nMaxHeight=nMinScrollHeight;}
this.cfg.setProperty("maxheight",nMaxHeight);this.hideEvent.subscribe(clearMaxHeight);}}}},_onShow:function(p_sType,p_aArgs){var oParent=this.parent,oParentMenu,aParentAlignment,aAlignment;function disableAutoSubmenuDisplay(p_oEvent){var oTarget;if(p_oEvent.type=="mousedown"||(p_oEvent.type=="keydown"&&p_oEvent.keyCode==27)){oTarget=Event.getTarget(p_oEvent);if(oTarget!=oParentMenu.element||!Dom.isAncestor(oParentMenu.element,oTarget)){oParentMenu.cfg.setProperty("autosubmenudisplay",false);Event.removeListener(document,"mousedown",disableAutoSubmenuDisplay);Event.removeListener(document,"keydown",disableAutoSubmenuDisplay);}}}
if(oParent){oParentMenu=oParent.parent;aParentAlignment=oParentMenu.cfg.getProperty("submenualignment");aAlignment=this.cfg.getProperty("submenualignment");if((aParentAlignment[0]!=aAlignment[0])&&(aParentAlignment[1]!=aAlignment[1])){this.cfg.setProperty("submenualignment",[aParentAlignment[0],aParentAlignment[1]]);}
if(!oParentMenu.cfg.getProperty("autosubmenudisplay")&&(oParentMenu instanceof YAHOO.widget.MenuBar||oParentMenu.cfg.getProperty("position")=="static")){oParentMenu.cfg.setProperty("autosubmenudisplay",true);Event.on(document,"mousedown",disableAutoSubmenuDisplay);Event.on(document,"keydown",disableAutoSubmenuDisplay);}}},_onBeforeHide:function(p_sType,p_aArgs){var oActiveItem=this.activeItem,oConfig,oSubmenu;if(oActiveItem){oConfig=oActiveItem.cfg;oConfig.setProperty("selected",false);oSubmenu=oConfig.getProperty("submenu");if(oSubmenu){oSubmenu.hide();}}
if(this.getRoot()==this){this.blur();}},_onParentMenuConfigChange:function(p_sType,p_aArgs,p_oSubmenu){var sPropertyName=p_aArgs[0][0],oPropertyValue=p_aArgs[0][1];switch(sPropertyName){case"iframe":case"constraintoviewport":case"hidedelay":case"showdelay":case"submenuhidedelay":case"clicktohide":case"effect":case"classname":case"scrollincrement":case"minscrollheight":p_oSubmenu.cfg.setProperty(sPropertyName,oPropertyValue);break;}},_onParentMenuRender:function(p_sType,p_aArgs,p_oSubmenu){var oParentCfg=p_oSubmenu.parent.parent.cfg,oConfig={constraintoviewport:oParentCfg.getProperty("constraintoviewport"),xy:[0,0],clicktohide:oParentCfg.getProperty("clicktohide"),effect:oParentCfg.getProperty("effect"),showdelay:oParentCfg.getProperty("showdelay"),hidedelay:oParentCfg.getProperty("hidedelay"),submenuhidedelay:oParentCfg.getProperty("submenuhidedelay"),classname:oParentCfg.getProperty("classname"),scrollincrement:oParentCfg.getProperty("scrollincrement"),minscrollheight:oParentCfg.getProperty("minscrollheight"),iframe:oParentCfg.getProperty("iframe")},oLI;p_oSubmenu.cfg.applyConfig(oConfig);if(!this.lazyLoad){oLI=this.parent.element;if(this.element.parentNode==oLI){this.render();}
else{this.render(oLI);}}},_onSubmenuBeforeShow:function(p_sType,p_aArgs){var oParent=this.parent,aAlignment=oParent.parent.cfg.getProperty("submenualignment");if(!this.cfg.getProperty("context")){this.cfg.setProperty("context",[oParent.element,aAlignment[0],aAlignment[1]]);}
else{this.align();}},_onMenuItemFocus:function(p_sType,p_aArgs){this.parent.focusEvent.fire(this);},_onMenuItemBlur:function(p_sType,p_aArgs){this.parent.blurEvent.fire(this);},_onMenuItemDestroy:function(p_sType,p_aArgs,p_oItem){this._removeItemFromGroupByValue(p_oItem.groupIndex,p_oItem);},_onMenuItemConfigChange:function(p_sType,p_aArgs,p_oItem){var sPropertyName=p_aArgs[0][0],oPropertyValue=p_aArgs[0][1],oSubmenu;switch(sPropertyName){case"selected":if(oPropertyValue===true){this.activeItem=p_oItem;}
break;case"submenu":oSubmenu=p_aArgs[0][1];if(oSubmenu){this._configureSubmenu(p_oItem);}
break;}},enforceConstraints:function(type,args,obj){YAHOO.widget.Menu.superclass.enforceConstraints.apply(this,arguments);var oParent=this.parent,oParentMenu,nParentMenuX,nNewX,nX;if(oParent){oParentMenu=oParent.parent;if(!(oParentMenu instanceof YAHOO.widget.MenuBar)){nParentMenuX=oParentMenu.cfg.getProperty("x");nX=this.cfg.getProperty("x");if(nX<(nParentMenuX+oParent.element.offsetWidth)){nNewX=(nParentMenuX-this.element.offsetWidth);this.cfg.setProperty("x",nNewX,true);this.cfg.setProperty("xy",[nNewX,(this.cfg.getProperty("y"))],true);}}}},configVisible:function(p_sType,p_aArgs,p_oMenu){var bVisible,sDisplay;if(this.cfg.getProperty("position")=="dynamic"){Menu.superclass.configVisible.call(this,p_sType,p_aArgs,p_oMenu);}
else{bVisible=p_aArgs[0];sDisplay=Dom.getStyle(this.element,"display");Dom.setStyle(this.element,"visibility","visible");if(bVisible){if(sDisplay!="block"){this.beforeShowEvent.fire();Dom.setStyle(this.element,"display","block");this.showEvent.fire();}}
else{if(sDisplay=="block"){this.beforeHideEvent.fire();Dom.setStyle(this.element,"display","none");this.hideEvent.fire();}}}},configPosition:function(p_sType,p_aArgs,p_oMenu){var oElement=this.element,sCSSPosition=p_aArgs[0]=="static"?"static":"absolute",oCfg=this.cfg,nZIndex;Dom.setStyle(oElement,"position",sCSSPosition);if(sCSSPosition=="static"){Dom.setStyle(oElement,"display","block");oCfg.setProperty("visible",true);}
else{Dom.setStyle(oElement,"visibility","hidden");}
if(sCSSPosition=="absolute"){nZIndex=oCfg.getProperty("zindex");if(!nZIndex||nZIndex===0){nZIndex=this.parent?(this.parent.parent.cfg.getProperty("zindex")+1):1;oCfg.setProperty("zindex",nZIndex);}}},configIframe:function(p_sType,p_aArgs,p_oMenu){if(this.cfg.getProperty("position")=="dynamic"){Menu.superclass.configIframe.call(this,p_sType,p_aArgs,p_oMenu);}},configHideDelay:function(p_sType,p_aArgs,p_oMenu){var nHideDelay=p_aArgs[0],oMouseOutEvent=this.mouseOutEvent,oMouseOverEvent=this.mouseOverEvent,oKeyDownEvent=this.keyDownEvent;if(nHideDelay>0){if(!this._bHideDelayEventHandlersAssigned){oMouseOutEvent.subscribe(this._execHideDelay);oMouseOverEvent.subscribe(this._cancelHideDelay);oKeyDownEvent.subscribe(this._cancelHideDelay);this._bHideDelayEventHandlersAssigned=true;}}
else{oMouseOutEvent.unsubscribe(this._execHideDelay);oMouseOverEvent.unsubscribe(this._cancelHideDelay);oKeyDownEvent.unsubscribe(this._cancelHideDelay);this._bHideDelayEventHandlersAssigned=false;}},configContainer:function(p_sType,p_aArgs,p_oMenu){var oElement=p_aArgs[0];if(typeof oElement=='string'){this.cfg.setProperty("container",document.getElementById(oElement),true);}},_setMaxHeight:function(p_sType,p_aArgs,p_nMaxHeight){this.cfg.setProperty("maxheight",p_nMaxHeight);this.renderEvent.unsubscribe(this._setMaxHeight);},configMaxHeight:function(p_sType,p_aArgs,p_oMenu){var nMaxHeight=p_aArgs[0],oElement=this.element,oBody=this.body,oHeader=this.header,oFooter=this.footer,fnMouseOver=this._onScrollTargetMouseOver,fnMouseOut=this._onScrollTargetMouseOut,nMinScrollHeight=this.cfg.getProperty("minscrollheight"),nHeight,nOffsetWidth,sWidth;if(nMaxHeight!==0&&nMaxHeight<nMinScrollHeight){nMaxHeight=nMinScrollHeight;}
if(this.lazyLoad&&!oBody){this.renderEvent.unsubscribe(this._setMaxHeight);if(nMaxHeight>0){this.renderEvent.subscribe(this._setMaxHeight,nMaxHeight,this);}
return;}
Dom.setStyle(oBody,"height","");Dom.removeClass(oBody,"yui-menu-body-scrolled");var bSetWidth=((UA.gecko&&this.parent&&this.parent.parent&&this.parent.parent.cfg.getProperty("position")=="dynamic")||UA.ie);if(bSetWidth){if(!this.cfg.getProperty("width")){nOffsetWidth=oElement.offsetWidth;oElement.style.width=nOffsetWidth+"px";sWidth=(nOffsetWidth-(oElement.offsetWidth-nOffsetWidth))+"px";this.cfg.setProperty("width",sWidth);}}
if(!oHeader&&!oFooter){this.setHeader("&#32;");this.setFooter("&#32;");oHeader=this.header;oFooter=this.footer;Dom.addClass(oHeader,"topscrollbar");Dom.addClass(oFooter,"bottomscrollbar");oElement.insertBefore(oHeader,oBody);oElement.appendChild(oFooter);}
nHeight=(nMaxHeight-(oHeader.offsetHeight+oHeader.offsetHeight));if(nHeight>0&&(oBody.offsetHeight>nMaxHeight)){Dom.addClass(oBody,"yui-menu-body-scrolled");Dom.setStyle(oBody,"height",(nHeight+"px"));Event.on(oHeader,"mouseover",fnMouseOver,this,true);Event.on(oHeader,"mouseout",fnMouseOut,this,true);Event.on(oFooter,"mouseover",fnMouseOver,this,true);Event.on(oFooter,"mouseout",fnMouseOut,this,true);this._disableScrollHeader();this._enableScrollFooter();}
else if(oHeader&&oFooter){if(bSetWidth){this.cfg.setProperty("width","");}
this._enableScrollHeader();this._enableScrollFooter();Event.removeListener(oHeader,"mouseover",fnMouseOver);Event.removeListener(oHeader,"mouseout",fnMouseOut);Event.removeListener(oFooter,"mouseover",fnMouseOver);Event.removeListener(oFooter,"mouseout",fnMouseOut);oElement.removeChild(oHeader);oElement.removeChild(oFooter);this.header=null;this.footer=null;}
this.cfg.refireEvent("iframe");},configClassName:function(p_sType,p_aArgs,p_oMenu){var sClassName=p_aArgs[0];if(this._sClassName){Dom.removeClass(this.element,this._sClassName);}
Dom.addClass(this.element,sClassName);this._sClassName=sClassName;},_onItemAdded:function(p_sType,p_aArgs){var oItem=p_aArgs[0];if(oItem){oItem.cfg.setProperty("disabled",true);}},configDisabled:function(p_sType,p_aArgs,p_oMenu){var bDisabled=p_aArgs[0],aItems=this.getItems(),nItems,i;if(Lang.isArray(aItems)){nItems=aItems.length;if(nItems>0){i=nItems-1;do{aItems[i].cfg.setProperty("disabled",bDisabled);}
while(i--);}
if(bDisabled){this.clearActiveItem(true);Dom.addClass(this.element,"disabled");this.itemAddedEvent.subscribe(this._onItemAdded);}
else{Dom.removeClass(this.element,"disabled");this.itemAddedEvent.unsubscribe(this._onItemAdded);}}},onRender:function(p_sType,p_aArgs){function sizeShadow(){var oElement=this.element,oShadow=this._shadow;if(oShadow&&oElement){if(oShadow.style.width&&oShadow.style.height){oShadow.style.width="";oShadow.style.height="";}
oShadow.style.width=(oElement.offsetWidth+6)+"px";oShadow.style.height=(oElement.offsetHeight+1)+"px";}}
function replaceShadow(){this.element.appendChild(this._shadow);}
function addShadowVisibleClass(){Dom.addClass(this._shadow,"yui-menu-shadow-visible");}
function removeShadowVisibleClass(){Dom.removeClass(this._shadow,"yui-menu-shadow-visible");}
function createShadow(){var oShadow=this._shadow,oElement,me;if(!oShadow){oElement=this.element;me=this;if(!m_oShadowTemplate){m_oShadowTemplate=document.createElement("div");m_oShadowTemplate.className="yui-menu-shadow yui-menu-shadow-visible";}
oShadow=m_oShadowTemplate.cloneNode(false);oElement.appendChild(oShadow);this._shadow=oShadow;this.beforeShowEvent.subscribe(addShadowVisibleClass);this.beforeHideEvent.subscribe(removeShadowVisibleClass);if(UA.ie){window.setTimeout(function(){sizeShadow.call(me);me.syncIframe();},0);this.cfg.subscribeToConfigEvent("width",sizeShadow);this.cfg.subscribeToConfigEvent("height",sizeShadow);this.cfg.subscribeToConfigEvent("maxheight",sizeShadow);this.changeContentEvent.subscribe(sizeShadow);Module.textResizeEvent.subscribe(sizeShadow,me,true);this.destroyEvent.subscribe(function(){Module.textResizeEvent.unsubscribe(sizeShadow,me);});}
this.cfg.subscribeToConfigEvent("maxheight",replaceShadow);}}
function onBeforeShow(){createShadow.call(this);this.beforeShowEvent.unsubscribe(onBeforeShow);}
if(this.cfg.getProperty("position")=="dynamic"){if(this.cfg.getProperty("visible")){createShadow.call(this);}
else{this.beforeShowEvent.subscribe(onBeforeShow);}}},initEvents:function(){Menu.superclass.initEvents.call(this);var SIGNATURE=CustomEvent.LIST;this.mouseOverEvent=this.createEvent(EVENT_TYPES.MOUSE_OVER);this.mouseOverEvent.signature=SIGNATURE;this.mouseOutEvent=this.createEvent(EVENT_TYPES.MOUSE_OUT);this.mouseOutEvent.signature=SIGNATURE;this.mouseDownEvent=this.createEvent(EVENT_TYPES.MOUSE_DOWN);this.mouseDownEvent.signature=SIGNATURE;this.mouseUpEvent=this.createEvent(EVENT_TYPES.MOUSE_UP);this.mouseUpEvent.signature=SIGNATURE;this.clickEvent=this.createEvent(EVENT_TYPES.CLICK);this.clickEvent.signature=SIGNATURE;this.keyPressEvent=this.createEvent(EVENT_TYPES.KEY_PRESS);this.keyPressEvent.signature=SIGNATURE;this.keyDownEvent=this.createEvent(EVENT_TYPES.KEY_DOWN);this.keyDownEvent.signature=SIGNATURE;this.keyUpEvent=this.createEvent(EVENT_TYPES.KEY_UP);this.keyUpEvent.signature=SIGNATURE;this.focusEvent=this.createEvent(EVENT_TYPES.FOCUS);this.focusEvent.signature=SIGNATURE;this.blurEvent=this.createEvent(EVENT_TYPES.BLUR);this.blurEvent.signature=SIGNATURE;this.itemAddedEvent=this.createEvent(EVENT_TYPES.ITEM_ADDED);this.itemAddedEvent.signature=SIGNATURE;this.itemRemovedEvent=this.createEvent(EVENT_TYPES.ITEM_REMOVED);this.itemRemovedEvent.signature=SIGNATURE;},positionOffScreen:function(){var oIFrame=this.iframe,aPos=this.OFF_SCREEN_POSITION;Dom.setXY(this.element,aPos);if(oIFrame){Dom.setXY(oIFrame,aPos);}},getRoot:function(){var oItem=this.parent,oParentMenu;if(oItem){oParentMenu=oItem.parent;return oParentMenu?oParentMenu.getRoot():this;}
else{return this;}},toString:function(){var sReturnVal="Menu",sId=this.id;if(sId){sReturnVal+=(" "+sId);}
return sReturnVal;},setItemGroupTitle:function(p_sGroupTitle,p_nGroupIndex){var nGroupIndex,oTitle,i,nFirstIndex;if(typeof p_sGroupTitle=="string"&&p_sGroupTitle.length>0){nGroupIndex=typeof p_nGroupIndex=="number"?p_nGroupIndex:0;oTitle=this._aGroupTitleElements[nGroupIndex];if(oTitle){oTitle.innerHTML=p_sGroupTitle;}
else{oTitle=document.createElement(this.GROUP_TITLE_TAG_NAME);oTitle.innerHTML=p_sGroupTitle;this._aGroupTitleElements[nGroupIndex]=oTitle;}
i=this._aGroupTitleElements.length-1;do{if(this._aGroupTitleElements[i]){Dom.removeClass(this._aGroupTitleElements[i],"first-of-type");nFirstIndex=i;}}
while(i--);if(nFirstIndex!==null){Dom.addClass(this._aGroupTitleElements[nFirstIndex],"first-of-type");}
this.changeContentEvent.fire();}},addItem:function(p_oItem,p_nGroupIndex){if(p_oItem){return this._addItemToGroup(p_nGroupIndex,p_oItem);}},addItems:function(p_aItems,p_nGroupIndex){var nItems,aItems,oItem,i;if(Lang.isArray(p_aItems)){nItems=p_aItems.length;aItems=[];for(i=0;i<nItems;i++){oItem=p_aItems[i];if(oItem){if(Lang.isArray(oItem)){aItems[aItems.length]=this.addItems(oItem,i);}
else{aItems[aItems.length]=this._addItemToGroup(p_nGroupIndex,oItem);}}}
if(aItems.length){return aItems;}}},insertItem:function(p_oItem,p_nItemIndex,p_nGroupIndex){if(p_oItem){return this._addItemToGroup(p_nGroupIndex,p_oItem,p_nItemIndex);}},removeItem:function(p_oObject,p_nGroupIndex){var oItem;if(typeof p_oObject!="undefined"){if(p_oObject instanceof YAHOO.widget.MenuItem){oItem=this._removeItemFromGroupByValue(p_nGroupIndex,p_oObject);}
else if(typeof p_oObject=="number"){oItem=this._removeItemFromGroupByIndex(p_nGroupIndex,p_oObject);}
if(oItem){oItem.destroy();return oItem;}}},getItems:function(){var aGroups=this._aItemGroups,nGroups,aItems=[];if(Lang.isArray(aGroups)){nGroups=aGroups.length;return((nGroups==1)?aGroups[0]:(Array.prototype.concat.apply(aItems,aGroups)));}},getItemGroups:function(){return this._aItemGroups;},getItem:function(p_nItemIndex,p_nGroupIndex){var aGroup;if(typeof p_nItemIndex=="number"){aGroup=this._getItemGroup(p_nGroupIndex);if(aGroup){return aGroup[p_nItemIndex];}}},getSubmenus:function(){var aItems=this.getItems(),nItems=aItems.length,aSubmenus,oSubmenu,oItem,i;if(nItems>0){aSubmenus=[];for(i=0;i<nItems;i++){oItem=aItems[i];if(oItem){oSubmenu=oItem.cfg.getProperty("submenu");if(oSubmenu){aSubmenus[aSubmenus.length]=oSubmenu;}}}}
return aSubmenus;},clearContent:function(){var aItems=this.getItems(),nItems=aItems.length,oElement=this.element,oBody=this.body,oHeader=this.header,oFooter=this.footer,oItem,oSubmenu,i;if(nItems>0){i=nItems-1;do{oItem=aItems[i];if(oItem){oSubmenu=oItem.cfg.getProperty("submenu");if(oSubmenu){this.cfg.configChangedEvent.unsubscribe(this._onParentMenuConfigChange,oSubmenu);this.renderEvent.unsubscribe(this._onParentMenuRender,oSubmenu);}
this.removeItem(oItem);}}
while(i--);}
if(oHeader){Event.purgeElement(oHeader);oElement.removeChild(oHeader);}
if(oFooter){Event.purgeElement(oFooter);oElement.removeChild(oFooter);}
if(oBody){Event.purgeElement(oBody);oBody.innerHTML="";}
this.activeItem=null;this._aItemGroups=[];this._aListElements=[];this._aGroupTitleElements=[];this.cfg.setProperty("width",null);},destroy:function(){this.clearContent();this._aItemGroups=null;this._aListElements=null;this._aGroupTitleElements=null;Menu.superclass.destroy.call(this);},setInitialFocus:function(){var oItem=this._getFirstEnabledItem();if(oItem){oItem.focus();}},setInitialSelection:function(){var oItem=this._getFirstEnabledItem();if(oItem){oItem.cfg.setProperty("selected",true);}},clearActiveItem:function(p_bBlur){if(this.cfg.getProperty("showdelay")>0){this._cancelShowDelay();}
var oActiveItem=this.activeItem,oConfig,oSubmenu;if(oActiveItem){oConfig=oActiveItem.cfg;if(p_bBlur){oActiveItem.blur();}
oConfig.setProperty("selected",false);oSubmenu=oConfig.getProperty("submenu");if(oSubmenu){oSubmenu.hide();}
this.activeItem=null;}},focus:function(){if(!this.hasFocus()){this.setInitialFocus();}},blur:function(){var oItem;if(this.hasFocus()){oItem=MenuManager.getFocusedMenuItem();if(oItem){oItem.blur();}}},hasFocus:function(){return(MenuManager.getFocusedMenu()==this.getRoot());},subscribe:function(){function onItemAdded(p_sType,p_aArgs,p_oObject){var oItem=p_aArgs[0],oSubmenu=oItem.cfg.getProperty("submenu");if(oSubmenu){oSubmenu.subscribe.apply(oSubmenu,p_oObject);}}
function onSubmenuAdded(p_sType,p_aArgs,p_oObject){var oSubmenu=this.cfg.getProperty("submenu");if(oSubmenu){oSubmenu.subscribe.apply(oSubmenu,p_oObject);}}
Menu.superclass.subscribe.apply(this,arguments);Menu.superclass.subscribe.call(this,"itemAdded",onItemAdded,arguments);var aItems=this.getItems(),nItems,oItem,oSubmenu,i;if(aItems){nItems=aItems.length;if(nItems>0){i=nItems-1;do{oItem=aItems[i];oSubmenu=oItem.cfg.getProperty("submenu");if(oSubmenu){oSubmenu.subscribe.apply(oSubmenu,arguments);}
else{oItem.cfg.subscribeToConfigEvent("submenu",onSubmenuAdded,arguments);}}
while(i--);}}},initDefaultConfig:function(){Menu.superclass.initDefaultConfig.call(this);var oConfig=this.cfg;oConfig.addProperty(DEFAULT_CONFIG.VISIBLE.key,{handler:this.configVisible,value:DEFAULT_CONFIG.VISIBLE.value,validator:DEFAULT_CONFIG.VISIBLE.validator});oConfig.addProperty(DEFAULT_CONFIG.CONSTRAIN_TO_VIEWPORT.key,{handler:this.configConstrainToViewport,value:DEFAULT_CONFIG.CONSTRAIN_TO_VIEWPORT.value,validator:DEFAULT_CONFIG.CONSTRAIN_TO_VIEWPORT.validator,supercedes:DEFAULT_CONFIG.CONSTRAIN_TO_VIEWPORT.supercedes});oConfig.addProperty(DEFAULT_CONFIG.POSITION.key,{handler:this.configPosition,value:DEFAULT_CONFIG.POSITION.value,validator:DEFAULT_CONFIG.POSITION.validator,supercedes:DEFAULT_CONFIG.POSITION.supercedes});oConfig.addProperty(DEFAULT_CONFIG.SUBMENU_ALIGNMENT.key,{value:DEFAULT_CONFIG.SUBMENU_ALIGNMENT.value,suppressEvent:DEFAULT_CONFIG.SUBMENU_ALIGNMENT.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.AUTO_SUBMENU_DISPLAY.key,{value:DEFAULT_CONFIG.AUTO_SUBMENU_DISPLAY.value,validator:DEFAULT_CONFIG.AUTO_SUBMENU_DISPLAY.validator,suppressEvent:DEFAULT_CONFIG.AUTO_SUBMENU_DISPLAY.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.SHOW_DELAY.key,{value:DEFAULT_CONFIG.SHOW_DELAY.value,validator:DEFAULT_CONFIG.SHOW_DELAY.validator,suppressEvent:DEFAULT_CONFIG.SHOW_DELAY.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.HIDE_DELAY.key,{handler:this.configHideDelay,value:DEFAULT_CONFIG.HIDE_DELAY.value,validator:DEFAULT_CONFIG.HIDE_DELAY.validator,suppressEvent:DEFAULT_CONFIG.HIDE_DELAY.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.SUBMENU_HIDE_DELAY.key,{value:DEFAULT_CONFIG.SUBMENU_HIDE_DELAY.value,validator:DEFAULT_CONFIG.SUBMENU_HIDE_DELAY.validator,suppressEvent:DEFAULT_CONFIG.SUBMENU_HIDE_DELAY.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.CLICK_TO_HIDE.key,{value:DEFAULT_CONFIG.CLICK_TO_HIDE.value,validator:DEFAULT_CONFIG.CLICK_TO_HIDE.validator,suppressEvent:DEFAULT_CONFIG.CLICK_TO_HIDE.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.CONTAINER.key,{handler:this.configContainer,value:document.body,suppressEvent:DEFAULT_CONFIG.CONTAINER.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.SCROLL_INCREMENT.key,{value:DEFAULT_CONFIG.SCROLL_INCREMENT.value,validator:DEFAULT_CONFIG.SCROLL_INCREMENT.validator,supercedes:DEFAULT_CONFIG.SCROLL_INCREMENT.supercedes,suppressEvent:DEFAULT_CONFIG.SCROLL_INCREMENT.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.MIN_SCROLL_HEIGHT.key,{value:DEFAULT_CONFIG.MIN_SCROLL_HEIGHT.value,validator:DEFAULT_CONFIG.MIN_SCROLL_HEIGHT.validator,supercedes:DEFAULT_CONFIG.MIN_SCROLL_HEIGHT.supercedes,suppressEvent:DEFAULT_CONFIG.MIN_SCROLL_HEIGHT.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.MAX_HEIGHT.key,{handler:this.configMaxHeight,value:DEFAULT_CONFIG.MAX_HEIGHT.value,validator:DEFAULT_CONFIG.MAX_HEIGHT.validator,suppressEvent:DEFAULT_CONFIG.MAX_HEIGHT.suppressEvent,supercedes:DEFAULT_CONFIG.MAX_HEIGHT.supercedes});oConfig.addProperty(DEFAULT_CONFIG.CLASS_NAME.key,{handler:this.configClassName,value:DEFAULT_CONFIG.CLASS_NAME.value,validator:DEFAULT_CONFIG.CLASS_NAME.validator,supercedes:DEFAULT_CONFIG.CLASS_NAME.supercedes});oConfig.addProperty(DEFAULT_CONFIG.DISABLED.key,{handler:this.configDisabled,value:DEFAULT_CONFIG.DISABLED.value,validator:DEFAULT_CONFIG.DISABLED.validator,suppressEvent:DEFAULT_CONFIG.DISABLED.suppressEvent});}});})();(function(){YAHOO.widget.MenuItem=function(p_oObject,p_oConfig){if(p_oObject){if(p_oConfig){this.parent=p_oConfig.parent;this.value=p_oConfig.value;this.id=p_oConfig.id;}
this.init(p_oObject,p_oConfig);}};var Dom=YAHOO.util.Dom,Module=YAHOO.widget.Module,Menu=YAHOO.widget.Menu,MenuItem=YAHOO.widget.MenuItem,CustomEvent=YAHOO.util.CustomEvent,Lang=YAHOO.lang,m_oMenuItemTemplate,EVENT_TYPES={"MOUSE_OVER":"mouseover","MOUSE_OUT":"mouseout","MOUSE_DOWN":"mousedown","MOUSE_UP":"mouseup","CLICK":"click","KEY_PRESS":"keypress","KEY_DOWN":"keydown","KEY_UP":"keyup","ITEM_ADDED":"itemAdded","ITEM_REMOVED":"itemRemoved","FOCUS":"focus","BLUR":"blur","DESTROY":"destroy"},DEFAULT_CONFIG={"TEXT":{key:"text",value:"",validator:Lang.isString,suppressEvent:true},"HELP_TEXT":{key:"helptext",supercedes:["text"],suppressEvent:true},"URL":{key:"url",value:"#",suppressEvent:true},"TARGET":{key:"target",suppressEvent:true},"EMPHASIS":{key:"emphasis",value:false,validator:Lang.isBoolean,suppressEvent:true,supercedes:["text"]},"STRONG_EMPHASIS":{key:"strongemphasis",value:false,validator:Lang.isBoolean,suppressEvent:true,supercedes:["text"]},"CHECKED":{key:"checked",value:false,validator:Lang.isBoolean,suppressEvent:true,supercedes:["disabled","selected"]},"SUBMENU":{key:"submenu",suppressEvent:true,supercedes:["disabled","selected"]},"DISABLED":{key:"disabled",value:false,validator:Lang.isBoolean,suppressEvent:true,supercedes:["text","selected"]},"SELECTED":{key:"selected",value:false,validator:Lang.isBoolean,suppressEvent:true},"ONCLICK":{key:"onclick",suppressEvent:true},"CLASS_NAME":{key:"classname",value:null,validator:Lang.isString,suppressEvent:true}};MenuItem.prototype={CSS_CLASS_NAME:"yuimenuitem",CSS_LABEL_CLASS_NAME:"yuimenuitemlabel",SUBMENU_TYPE:null,_oAnchor:null,_oHelpTextEM:null,_oSubmenu:null,_oOnclickAttributeValue:null,_sClassName:null,constructor:MenuItem,index:null,groupIndex:null,parent:null,element:null,srcElement:null,value:null,browser:Module.prototype.browser,id:null,destroyEvent:null,mouseOverEvent:null,mouseOutEvent:null,mouseDownEvent:null,mouseUpEvent:null,clickEvent:null,keyPressEvent:null,keyDownEvent:null,keyUpEvent:null,focusEvent:null,blurEvent:null,init:function(p_oObject,p_oConfig){if(!this.SUBMENU_TYPE){this.SUBMENU_TYPE=Menu;}
this.cfg=new YAHOO.util.Config(this);this.initDefaultConfig();var SIGNATURE=CustomEvent.LIST,oConfig=this.cfg,sURL="#",oAnchor,sTarget,sText,sId;if(Lang.isString(p_oObject)){this._createRootNodeStructure();oConfig.queueProperty("text",p_oObject);}
else if(p_oObject&&p_oObject.tagName){switch(p_oObject.tagName.toUpperCase()){case"OPTION":this._createRootNodeStructure();oConfig.queueProperty("text",p_oObject.text);oConfig.queueProperty("disabled",p_oObject.disabled);this.value=p_oObject.value;this.srcElement=p_oObject;break;case"OPTGROUP":this._createRootNodeStructure();oConfig.queueProperty("text",p_oObject.label);oConfig.queueProperty("disabled",p_oObject.disabled);this.srcElement=p_oObject;this._initSubTree();break;case"LI":oAnchor=Dom.getFirstChild(p_oObject);if(oAnchor){sURL=oAnchor.getAttribute("href",2);sTarget=oAnchor.getAttribute("target");sText=oAnchor.innerHTML;}
this.srcElement=p_oObject;this.element=p_oObject;this._oAnchor=oAnchor;oConfig.setProperty("text",sText,true);oConfig.setProperty("url",sURL,true);oConfig.setProperty("target",sTarget,true);this._initSubTree();break;}}
if(this.element){sId=(this.srcElement||this.element).id;if(!sId){sId=this.id||Dom.generateId();this.element.id=sId;}
this.id=sId;Dom.addClass(this.element,this.CSS_CLASS_NAME);Dom.addClass(this._oAnchor,this.CSS_LABEL_CLASS_NAME);this.mouseOverEvent=this.createEvent(EVENT_TYPES.MOUSE_OVER);this.mouseOverEvent.signature=SIGNATURE;this.mouseOutEvent=this.createEvent(EVENT_TYPES.MOUSE_OUT);this.mouseOutEvent.signature=SIGNATURE;this.mouseDownEvent=this.createEvent(EVENT_TYPES.MOUSE_DOWN);this.mouseDownEvent.signature=SIGNATURE;this.mouseUpEvent=this.createEvent(EVENT_TYPES.MOUSE_UP);this.mouseUpEvent.signature=SIGNATURE;this.clickEvent=this.createEvent(EVENT_TYPES.CLICK);this.clickEvent.signature=SIGNATURE;this.keyPressEvent=this.createEvent(EVENT_TYPES.KEY_PRESS);this.keyPressEvent.signature=SIGNATURE;this.keyDownEvent=this.createEvent(EVENT_TYPES.KEY_DOWN);this.keyDownEvent.signature=SIGNATURE;this.keyUpEvent=this.createEvent(EVENT_TYPES.KEY_UP);this.keyUpEvent.signature=SIGNATURE;this.focusEvent=this.createEvent(EVENT_TYPES.FOCUS);this.focusEvent.signature=SIGNATURE;this.blurEvent=this.createEvent(EVENT_TYPES.BLUR);this.blurEvent.signature=SIGNATURE;this.destroyEvent=this.createEvent(EVENT_TYPES.DESTROY);this.destroyEvent.signature=SIGNATURE;if(p_oConfig){oConfig.applyConfig(p_oConfig);}
oConfig.fireQueue();}},_createRootNodeStructure:function(){var oElement,oAnchor;
if(!m_oMenuItemTemplate){m_oMenuItemTemplate=document.createElement("li");m_oMenuItemTemplate.innerHTML="<a href=\"#\"></a>";}
oElement=m_oMenuItemTemplate.cloneNode(true);
oElement.className=this.CSS_CLASS_NAME;oAnchor=oElement.firstChild;oAnchor.className=this.CSS_LABEL_CLASS_NAME;this.element=oElement;this._oAnchor=oAnchor;},
_initSubTree:function(){var oSrcEl=this.srcElement,oConfig=this.cfg,oNode,aOptions,nOptions,oMenu,n;if(oSrcEl.childNodes.length>0){if(this.parent.lazyLoad&&this.parent.srcElement&&this.parent.srcElement.tagName.toUpperCase()=="SELECT"){oConfig.setProperty("submenu",{id:Dom.generateId(),itemdata:oSrcEl.childNodes});}
else{oNode=oSrcEl.firstChild;aOptions=[];do{if(oNode&&oNode.tagName){switch(oNode.tagName.toUpperCase()){case"DIV":oConfig.setProperty("submenu",oNode);break;case"OPTION":aOptions[aOptions.length]=oNode;break;}}}
while((oNode=oNode.nextSibling));nOptions=aOptions.length;if(nOptions>0){oMenu=new this.SUBMENU_TYPE(Dom.generateId());oConfig.setProperty("submenu",oMenu);for(n=0;n<nOptions;n++){oMenu.addItem((new oMenu.ITEM_TYPE(aOptions[n])));}}}}},configText:function(p_sType,p_aArgs,p_oItem){var sText=p_aArgs[0],oConfig=this.cfg,oAnchor=this._oAnchor,sHelpText=oConfig.getProperty("helptext"),sHelpTextHTML="",sEmphasisStartTag="",sEmphasisEndTag="";if(sText){if(sHelpText){sHelpTextHTML="<em class=\"helptext\">"+sHelpText+"</em>";}
if(oConfig.getProperty("emphasis")){sEmphasisStartTag="<em>";sEmphasisEndTag="</em>";}
if(oConfig.getProperty("strongemphasis")){sEmphasisStartTag="<strong>";sEmphasisEndTag="</strong>";}
oAnchor.innerHTML=(sEmphasisStartTag+sText+
sEmphasisEndTag+sHelpTextHTML);}},configHelpText:function(p_sType,p_aArgs,p_oItem){this.cfg.refireEvent("text");},configURL:function(p_sType,p_aArgs,p_oItem){var sURL=p_aArgs[0];if(!sURL){sURL="#";}
var oAnchor=this._oAnchor;if(YAHOO.env.ua.opera){oAnchor.removeAttribute("href");}
oAnchor.setAttribute("href",sURL);},configTarget:function(p_sType,p_aArgs,p_oItem){var sTarget=p_aArgs[0],oAnchor=this._oAnchor;if(sTarget&&sTarget.length>0){oAnchor.setAttribute("target",sTarget);}
else{oAnchor.removeAttribute("target");}},configEmphasis:function(p_sType,p_aArgs,p_oItem){var bEmphasis=p_aArgs[0],oConfig=this.cfg;if(bEmphasis&&oConfig.getProperty("strongemphasis")){oConfig.setProperty("strongemphasis",false);}
oConfig.refireEvent("text");},configStrongEmphasis:function(p_sType,p_aArgs,p_oItem){var bStrongEmphasis=p_aArgs[0],oConfig=this.cfg;if(bStrongEmphasis&&oConfig.getProperty("emphasis")){oConfig.setProperty("emphasis",false);}
oConfig.refireEvent("text");},configChecked:function(p_sType,p_aArgs,p_oItem){var bChecked=p_aArgs[0],oElement=this.element,oAnchor=this._oAnchor,oConfig=this.cfg,sState="-checked",sClassName=this.CSS_CLASS_NAME+sState,sLabelClassName=this.CSS_LABEL_CLASS_NAME+sState;if(bChecked){Dom.addClass(oElement,sClassName);Dom.addClass(oAnchor,sLabelClassName);}
else{Dom.removeClass(oElement,sClassName);Dom.removeClass(oAnchor,sLabelClassName);}
oConfig.refireEvent("text");if(oConfig.getProperty("disabled")){oConfig.refireEvent("disabled");}
if(oConfig.getProperty("selected")){oConfig.refireEvent("selected");}},configDisabled:function(p_sType,p_aArgs,p_oItem){var bDisabled=p_aArgs[0],oConfig=this.cfg,oSubmenu=oConfig.getProperty("submenu"),bChecked=oConfig.getProperty("checked"),oElement=this.element,oAnchor=this._oAnchor,sState="-disabled",sCheckedState="-checked"+sState,sSubmenuState="-hassubmenu"+sState,sClassName=this.CSS_CLASS_NAME+sState,sLabelClassName=this.CSS_LABEL_CLASS_NAME+sState,sCheckedClassName=this.CSS_CLASS_NAME+sCheckedState,sLabelCheckedClassName=this.CSS_LABEL_CLASS_NAME+sCheckedState,sSubmenuClassName=this.CSS_CLASS_NAME+sSubmenuState,sLabelSubmenuClassName=this.CSS_LABEL_CLASS_NAME+sSubmenuState;if(bDisabled){if(oConfig.getProperty("selected")){oConfig.setProperty("selected",false);}
Dom.addClass(oElement,sClassName);Dom.addClass(oAnchor,sLabelClassName);if(oSubmenu){Dom.addClass(oElement,sSubmenuClassName);Dom.addClass(oAnchor,sLabelSubmenuClassName);}
if(bChecked){Dom.addClass(oElement,sCheckedClassName);Dom.addClass(oAnchor,sLabelCheckedClassName);}}
else{Dom.removeClass(oElement,sClassName);Dom.removeClass(oAnchor,sLabelClassName);if(oSubmenu){Dom.removeClass(oElement,sSubmenuClassName);Dom.removeClass(oAnchor,sLabelSubmenuClassName);}
if(bChecked){Dom.removeClass(oElement,sCheckedClassName);Dom.removeClass(oAnchor,sLabelCheckedClassName);}}},configSelected:function(p_sType,p_aArgs,p_oItem){var oConfig=this.cfg,bSelected=p_aArgs[0],oElement=this.element,oAnchor=this._oAnchor,bChecked=oConfig.getProperty("checked"),oSubmenu=oConfig.getProperty("submenu"),sState="-selected",sCheckedState="-checked"+sState,sSubmenuState="-hassubmenu"+sState,sClassName=this.CSS_CLASS_NAME+sState,sLabelClassName=this.CSS_LABEL_CLASS_NAME+sState,sCheckedClassName=this.CSS_CLASS_NAME+sCheckedState,sLabelCheckedClassName=this.CSS_LABEL_CLASS_NAME+sCheckedState,sSubmenuClassName=this.CSS_CLASS_NAME+sSubmenuState,sLabelSubmenuClassName=this.CSS_LABEL_CLASS_NAME+sSubmenuState;if(YAHOO.env.ua.opera){oAnchor.blur();}
if(bSelected&&!oConfig.getProperty("disabled")){Dom.addClass(oElement,sClassName);Dom.addClass(oAnchor,sLabelClassName);if(oSubmenu){Dom.addClass(oElement,sSubmenuClassName);Dom.addClass(oAnchor,sLabelSubmenuClassName);}
if(bChecked){Dom.addClass(oElement,sCheckedClassName);Dom.addClass(oAnchor,sLabelCheckedClassName);}}
else{Dom.removeClass(oElement,sClassName);Dom.removeClass(oAnchor,sLabelClassName);if(oSubmenu){Dom.removeClass(oElement,sSubmenuClassName);Dom.removeClass(oAnchor,sLabelSubmenuClassName);}
if(bChecked){Dom.removeClass(oElement,sCheckedClassName);Dom.removeClass(oAnchor,sLabelCheckedClassName);}}
if(this.hasFocus()&&YAHOO.env.ua.opera){oAnchor.focus();}},_onSubmenuBeforeHide:function(p_sType,p_aArgs){var oItem=this.parent,oMenu;function onHide(){oItem._oAnchor.blur();oMenu.beforeHideEvent.unsubscribe(onHide);}
if(oItem.hasFocus()){oMenu=oItem.parent;oMenu.beforeHideEvent.subscribe(onHide);}},configSubmenu:function(p_sType,p_aArgs,p_oItem){var oSubmenu=p_aArgs[0],oConfig=this.cfg,oElement=this.element,oAnchor=this._oAnchor,bLazyLoad=this.parent&&this.parent.lazyLoad,sState="-hassubmenu",sClassName=this.CSS_CLASS_NAME+sState,sLabelClassName=this.CSS_LABEL_CLASS_NAME+sState,oMenu,sSubmenuId,oSubmenuConfig;if(oSubmenu){if(oSubmenu instanceof Menu){oMenu=oSubmenu;oMenu.parent=this;oMenu.lazyLoad=bLazyLoad;}
else if(typeof oSubmenu=="object"&&oSubmenu.id&&!oSubmenu.nodeType){sSubmenuId=oSubmenu.id;oSubmenuConfig=oSubmenu;oSubmenuConfig.lazyloaddisabled=bLazyLoad;oSubmenuConfig.parent=this;oMenu=new this.SUBMENU_TYPE(sSubmenuId,oSubmenuConfig);oConfig.setProperty("submenu",oMenu,true);}
else{oMenu=new this.SUBMENU_TYPE(oSubmenu,{lazyloaddisabled:bLazyLoad,parent:this});oConfig.setProperty("submenu",oMenu,true);}
if(oMenu){Dom.addClass(oElement,sClassName);Dom.addClass(oAnchor,sLabelClassName);this._oSubmenu=oMenu;if(YAHOO.env.ua.opera){oMenu.beforeHideEvent.subscribe(this._onSubmenuBeforeHide);}}}
else{Dom.removeClass(oElement,sClassName);Dom.removeClass(oAnchor,sLabelClassName);if(this._oSubmenu){this._oSubmenu.destroy();}}
if(oConfig.getProperty("disabled")){oConfig.refireEvent("disabled");}
if(oConfig.getProperty("selected")){oConfig.refireEvent("selected");}},configOnClick:function(p_sType,p_aArgs,p_oItem){var oObject=p_aArgs[0];if(this._oOnclickAttributeValue&&(this._oOnclickAttributeValue!=oObject)){this.clickEvent.unsubscribe(this._oOnclickAttributeValue.fn,this._oOnclickAttributeValue.obj);this._oOnclickAttributeValue=null;}
if(!this._oOnclickAttributeValue&&typeof oObject=="object"&&typeof oObject.fn=="function"){this.clickEvent.subscribe(oObject.fn,((!YAHOO.lang.isUndefined(oObject.obj))?oObject.obj:this),oObject.scope);this._oOnclickAttributeValue=oObject;}},configClassName:function(p_sType,p_aArgs,p_oItem){var sClassName=p_aArgs[0];if(this._sClassName){Dom.removeClass(this.element,this._sClassName);}
Dom.addClass(this.element,sClassName);this._sClassName=sClassName;},initDefaultConfig:function(){var oConfig=this.cfg;oConfig.addProperty(DEFAULT_CONFIG.TEXT.key,{handler:this.configText,value:DEFAULT_CONFIG.TEXT.value,validator:DEFAULT_CONFIG.TEXT.validator,suppressEvent:DEFAULT_CONFIG.TEXT.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.HELP_TEXT.key,{handler:this.configHelpText,supercedes:DEFAULT_CONFIG.HELP_TEXT.supercedes,suppressEvent:DEFAULT_CONFIG.HELP_TEXT.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.URL.key,{handler:this.configURL,value:DEFAULT_CONFIG.URL.value,suppressEvent:DEFAULT_CONFIG.URL.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.TARGET.key,{handler:this.configTarget,suppressEvent:DEFAULT_CONFIG.TARGET.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.EMPHASIS.key,{handler:this.configEmphasis,value:DEFAULT_CONFIG.EMPHASIS.value,validator:DEFAULT_CONFIG.EMPHASIS.validator,suppressEvent:DEFAULT_CONFIG.EMPHASIS.suppressEvent,supercedes:DEFAULT_CONFIG.EMPHASIS.supercedes});oConfig.addProperty(DEFAULT_CONFIG.STRONG_EMPHASIS.key,{handler:this.configStrongEmphasis,value:DEFAULT_CONFIG.STRONG_EMPHASIS.value,validator:DEFAULT_CONFIG.STRONG_EMPHASIS.validator,suppressEvent:DEFAULT_CONFIG.STRONG_EMPHASIS.suppressEvent,supercedes:DEFAULT_CONFIG.STRONG_EMPHASIS.supercedes});oConfig.addProperty(DEFAULT_CONFIG.CHECKED.key,{handler:this.configChecked,value:DEFAULT_CONFIG.CHECKED.value,validator:DEFAULT_CONFIG.CHECKED.validator,suppressEvent:DEFAULT_CONFIG.CHECKED.suppressEvent,supercedes:DEFAULT_CONFIG.CHECKED.supercedes});oConfig.addProperty(DEFAULT_CONFIG.DISABLED.key,{handler:this.configDisabled,value:DEFAULT_CONFIG.DISABLED.value,validator:DEFAULT_CONFIG.DISABLED.validator,suppressEvent:DEFAULT_CONFIG.DISABLED.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.SELECTED.key,{handler:this.configSelected,value:DEFAULT_CONFIG.SELECTED.value,validator:DEFAULT_CONFIG.SELECTED.validator,suppressEvent:DEFAULT_CONFIG.SELECTED.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.SUBMENU.key,{handler:this.configSubmenu,supercedes:DEFAULT_CONFIG.SUBMENU.supercedes,suppressEvent:DEFAULT_CONFIG.SUBMENU.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.ONCLICK.key,{handler:this.configOnClick,suppressEvent:DEFAULT_CONFIG.ONCLICK.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.CLASS_NAME.key,{handler:this.configClassName,value:DEFAULT_CONFIG.CLASS_NAME.value,validator:DEFAULT_CONFIG.CLASS_NAME.validator,suppressEvent:DEFAULT_CONFIG.CLASS_NAME.suppressEvent});},getNextEnabledSibling:function(){var nGroupIndex,aItemGroups,oNextItem,nNextGroupIndex,aNextGroup;function getNextArrayItem(p_aArray,p_nStartIndex){return p_aArray[p_nStartIndex]||getNextArrayItem(p_aArray,(p_nStartIndex+1));}
if(this.parent instanceof Menu){nGroupIndex=this.groupIndex;aItemGroups=this.parent.getItemGroups();if(this.index<(aItemGroups[nGroupIndex].length-1)){oNextItem=getNextArrayItem(aItemGroups[nGroupIndex],(this.index+1));}
else{if(nGroupIndex<(aItemGroups.length-1)){nNextGroupIndex=nGroupIndex+1;}
else{nNextGroupIndex=0;}
aNextGroup=getNextArrayItem(aItemGroups,nNextGroupIndex);oNextItem=getNextArrayItem(aNextGroup,0);}
return(oNextItem.cfg.getProperty("disabled")||oNextItem.element.style.display=="none")?oNextItem.getNextEnabledSibling():oNextItem;}},getPreviousEnabledSibling:function(){var nGroupIndex,aItemGroups,oPreviousItem,nPreviousGroupIndex,aPreviousGroup;function getPreviousArrayItem(p_aArray,p_nStartIndex){return p_aArray[p_nStartIndex]||getPreviousArrayItem(p_aArray,(p_nStartIndex-1));}
function getFirstItemIndex(p_aArray,p_nStartIndex){return p_aArray[p_nStartIndex]?p_nStartIndex:getFirstItemIndex(p_aArray,(p_nStartIndex+1));}
if(this.parent instanceof Menu){nGroupIndex=this.groupIndex;aItemGroups=this.parent.getItemGroups();if(this.index>getFirstItemIndex(aItemGroups[nGroupIndex],0)){oPreviousItem=getPreviousArrayItem(aItemGroups[nGroupIndex],(this.index-1));}
else{if(nGroupIndex>getFirstItemIndex(aItemGroups,0)){nPreviousGroupIndex=nGroupIndex-1;}
else{nPreviousGroupIndex=aItemGroups.length-1;}
aPreviousGroup=getPreviousArrayItem(aItemGroups,nPreviousGroupIndex);oPreviousItem=getPreviousArrayItem(aPreviousGroup,(aPreviousGroup.length-1));}
return(oPreviousItem.cfg.getProperty("disabled")||oPreviousItem.element.style.display=="none")?oPreviousItem.getPreviousEnabledSibling():oPreviousItem;}},focus:function(){var oParent=this.parent,oAnchor=this._oAnchor,oActiveItem=oParent.activeItem,me=this;function setFocus(){try{if(YAHOO.env.ua.ie&&!document.hasFocus()){return;}
if(oActiveItem){oActiveItem.blurEvent.fire();}
oAnchor.focus();me.focusEvent.fire();}
catch(e){}}
if(!this.cfg.getProperty("disabled")&&oParent&&oParent.cfg.getProperty("visible")&&this.element.style.display!="none"){window.setTimeout(setFocus,0);}},blur:function(){var oParent=this.parent;if(!this.cfg.getProperty("disabled")&&oParent&&oParent.cfg.getProperty("visible")){var me=this;window.setTimeout(function(){try{me._oAnchor.blur();me.blurEvent.fire();}
catch(e){}},0);}},hasFocus:function(){return(YAHOO.widget.MenuManager.getFocusedMenuItem()==this);},destroy:function(){var oEl=this.element,oSubmenu,oParentNode;if(oEl){oSubmenu=this.cfg.getProperty("submenu");if(oSubmenu){oSubmenu.destroy();}
this.mouseOverEvent.unsubscribeAll();this.mouseOutEvent.unsubscribeAll();this.mouseDownEvent.unsubscribeAll();this.mouseUpEvent.unsubscribeAll();this.clickEvent.unsubscribeAll();this.keyPressEvent.unsubscribeAll();this.keyDownEvent.unsubscribeAll();this.keyUpEvent.unsubscribeAll();this.focusEvent.unsubscribeAll();this.blurEvent.unsubscribeAll();this.cfg.configChangedEvent.unsubscribeAll();oParentNode=oEl.parentNode;if(oParentNode){oParentNode.removeChild(oEl);this.destroyEvent.fire();}
this.destroyEvent.unsubscribeAll();}},toString:function(){var sReturnVal="MenuItem",sId=this.id;if(sId){sReturnVal+=(" "+sId);}
return sReturnVal;}};Lang.augmentProto(MenuItem,YAHOO.util.EventProvider);})();(function(){YAHOO.widget.ContextMenu=function(p_oElement,p_oConfig){YAHOO.widget.ContextMenu.superclass.constructor.call(this,p_oElement,p_oConfig);};var Event=YAHOO.util.Event,ContextMenu=YAHOO.widget.ContextMenu,EVENT_TYPES={"TRIGGER_CONTEXT_MENU":"triggerContextMenu","CONTEXT_MENU":(YAHOO.env.ua.opera?"mousedown":"contextmenu"),"CLICK":"click"},DEFAULT_CONFIG={"TRIGGER":{key:"trigger",suppressEvent:true}};function position(p_sType,p_aArgs,p_aPos){this.cfg.setProperty("xy",p_aPos);this.beforeShowEvent.unsubscribe(position,p_aPos);}
YAHOO.lang.extend(ContextMenu,YAHOO.widget.Menu,{_oTrigger:null,_bCancelled:false,contextEventTarget:null,triggerContextMenuEvent:null,init:function(p_oElement,p_oConfig){ContextMenu.superclass.init.call(this,p_oElement);this.beforeInitEvent.fire(ContextMenu);if(p_oConfig){this.cfg.applyConfig(p_oConfig,true);}
this.initEvent.fire(ContextMenu);},initEvents:function(){ContextMenu.superclass.initEvents.call(this);this.triggerContextMenuEvent=this.createEvent(EVENT_TYPES.TRIGGER_CONTEXT_MENU);this.triggerContextMenuEvent.signature=YAHOO.util.CustomEvent.LIST;},cancel:function(){this._bCancelled=true;},_removeEventHandlers:function(){var oTrigger=this._oTrigger;if(oTrigger){Event.removeListener(oTrigger,EVENT_TYPES.CONTEXT_MENU,this._onTriggerContextMenu);if(YAHOO.env.ua.opera){Event.removeListener(oTrigger,EVENT_TYPES.CLICK,this._onTriggerClick);}}},_onTriggerClick:function(p_oEvent,p_oMenu){if(p_oEvent.ctrlKey){Event.stopEvent(p_oEvent);}},_onTriggerContextMenu:function(p_oEvent,p_oMenu){if(p_oEvent.type=="mousedown"&&!p_oEvent.ctrlKey){return;}
var aXY;Event.stopEvent(p_oEvent);this.contextEventTarget=Event.getTarget(p_oEvent);this.triggerContextMenuEvent.fire(p_oEvent);YAHOO.widget.MenuManager.hideVisible();if(!this._bCancelled){aXY=Event.getXY(p_oEvent);if(!YAHOO.util.Dom.inDocument(this.element)){this.beforeShowEvent.subscribe(position,aXY);}
else{this.cfg.setProperty("xy",aXY);}
this.show();}
this._bCancelled=false;},toString:function(){var sReturnVal="ContextMenu",sId=this.id;if(sId){sReturnVal+=(" "+sId);}
return sReturnVal;},initDefaultConfig:function(){ContextMenu.superclass.initDefaultConfig.call(this);this.cfg.addProperty(DEFAULT_CONFIG.TRIGGER.key,{handler:this.configTrigger,suppressEvent:DEFAULT_CONFIG.TRIGGER.suppressEvent});},destroy:function(){this._removeEventHandlers();ContextMenu.superclass.destroy.call(this);},configTrigger:function(p_sType,p_aArgs,p_oMenu){var oTrigger=p_aArgs[0];if(oTrigger){if(this._oTrigger){this._removeEventHandlers();}
this._oTrigger=oTrigger;Event.on(oTrigger,EVENT_TYPES.CONTEXT_MENU,this._onTriggerContextMenu,this,true);if(YAHOO.env.ua.opera){Event.on(oTrigger,EVENT_TYPES.CLICK,this._onTriggerClick,this,true);}}
else{this._removeEventHandlers();}}});}());YAHOO.widget.ContextMenuItem=YAHOO.widget.MenuItem;(function(){YAHOO.widget.MenuBar=function(p_oElement,p_oConfig){YAHOO.widget.MenuBar.superclass.constructor.call(this,p_oElement,p_oConfig);};function checkPosition(p_sPosition){if(typeof p_sPosition=="string"){return("dynamic,static".indexOf((p_sPosition.toLowerCase()))!=-1);}}
var Event=YAHOO.util.Event,MenuBar=YAHOO.widget.MenuBar,DEFAULT_CONFIG={"POSITION":{key:"position",value:"static",validator:checkPosition,supercedes:["visible"]},"SUBMENU_ALIGNMENT":{key:"submenualignment",value:["tl","bl"],suppressEvent:true},"AUTO_SUBMENU_DISPLAY":{key:"autosubmenudisplay",value:false,validator:YAHOO.lang.isBoolean,suppressEvent:true}};YAHOO.lang.extend(MenuBar,YAHOO.widget.Menu,{init:function(p_oElement,p_oConfig){if(!this.ITEM_TYPE){this.ITEM_TYPE=YAHOO.widget.MenuBarItem;}
MenuBar.superclass.init.call(this,p_oElement);this.beforeInitEvent.fire(MenuBar);if(p_oConfig){this.cfg.applyConfig(p_oConfig,true);}
this.initEvent.fire(MenuBar);},CSS_CLASS_NAME:"yuimenubar",_onKeyDown:function(p_sType,p_aArgs,p_oMenuBar){var oEvent=p_aArgs[0],oItem=p_aArgs[1],oSubmenu,oItemCfg,oNextItem;if(oItem&&!oItem.cfg.getProperty("disabled")){oItemCfg=oItem.cfg;switch(oEvent.keyCode){case 37:case 39:if(oItem==this.activeItem&&!oItemCfg.getProperty("selected")){oItemCfg.setProperty("selected",true);}
else{oNextItem=(oEvent.keyCode==37)?oItem.getPreviousEnabledSibling():oItem.getNextEnabledSibling();if(oNextItem){this.clearActiveItem();oNextItem.cfg.setProperty("selected",true);if(this.cfg.getProperty("autosubmenudisplay")){oSubmenu=oNextItem.cfg.getProperty("submenu");if(oSubmenu){oSubmenu.show();}}
oNextItem.focus();}}
Event.preventDefault(oEvent);break;case 40:if(this.activeItem!=oItem){this.clearActiveItem();oItemCfg.setProperty("selected",true);oItem.focus();}
oSubmenu=oItemCfg.getProperty("submenu");if(oSubmenu){if(oSubmenu.cfg.getProperty("visible")){oSubmenu.setInitialSelection();oSubmenu.setInitialFocus();}
else{oSubmenu.show();}}
Event.preventDefault(oEvent);break;}}
if(oEvent.keyCode==27&&this.activeItem){oSubmenu=this.activeItem.cfg.getProperty("submenu");if(oSubmenu&&oSubmenu.cfg.getProperty("visible")){oSubmenu.hide();this.activeItem.focus();}
else{this.activeItem.cfg.setProperty("selected",false);this.activeItem.blur();}
Event.preventDefault(oEvent);}},_onClick:function(p_sType,p_aArgs,p_oMenuBar){MenuBar.superclass._onClick.call(this,p_sType,p_aArgs,p_oMenuBar);var oItem=p_aArgs[1],oEvent,oTarget,oActiveItem,oConfig,oSubmenu;if(oItem&&!oItem.cfg.getProperty("disabled")){oEvent=p_aArgs[0];oTarget=Event.getTarget(oEvent);oActiveItem=this.activeItem;oConfig=this.cfg;if(oActiveItem&&oActiveItem!=oItem){this.clearActiveItem();}
oItem.cfg.setProperty("selected",true);oSubmenu=oItem.cfg.getProperty("submenu");if(oSubmenu){if(oSubmenu.cfg.getProperty("visible")){oSubmenu.hide();}
else{oSubmenu.show();}}}},toString:function(){var sReturnVal="MenuBar",sId=this.id;if(sId){sReturnVal+=(" "+sId);}
return sReturnVal;},initDefaultConfig:function(){MenuBar.superclass.initDefaultConfig.call(this);var oConfig=this.cfg;oConfig.addProperty(DEFAULT_CONFIG.POSITION.key,{handler:this.configPosition,value:DEFAULT_CONFIG.POSITION.value,validator:DEFAULT_CONFIG.POSITION.validator,supercedes:DEFAULT_CONFIG.POSITION.supercedes});oConfig.addProperty(DEFAULT_CONFIG.SUBMENU_ALIGNMENT.key,{value:DEFAULT_CONFIG.SUBMENU_ALIGNMENT.value,suppressEvent:DEFAULT_CONFIG.SUBMENU_ALIGNMENT.suppressEvent});oConfig.addProperty(DEFAULT_CONFIG.AUTO_SUBMENU_DISPLAY.key,{value:DEFAULT_CONFIG.AUTO_SUBMENU_DISPLAY.value,validator:DEFAULT_CONFIG.AUTO_SUBMENU_DISPLAY.validator,suppressEvent:DEFAULT_CONFIG.AUTO_SUBMENU_DISPLAY.suppressEvent});}});}());YAHOO.widget.MenuBarItem=function(p_oObject,p_oConfig){YAHOO.widget.MenuBarItem.superclass.constructor.call(this,p_oObject,p_oConfig);};YAHOO.lang.extend(YAHOO.widget.MenuBarItem,YAHOO.widget.MenuItem,{init:function(p_oObject,p_oConfig){if(!this.SUBMENU_TYPE){this.SUBMENU_TYPE=YAHOO.widget.Menu;}
YAHOO.widget.MenuBarItem.superclass.init.call(this,p_oObject);var oConfig=this.cfg;if(p_oConfig){oConfig.applyConfig(p_oConfig,true);}
oConfig.fireQueue();},CSS_CLASS_NAME:"yuimenubaritem",CSS_LABEL_CLASS_NAME:"yuimenubaritemlabel",toString:function(){var sReturnVal="MenuBarItem";if(this.cfg&&this.cfg.getProperty("text")){sReturnVal+=(": "+this.cfg.getProperty("text"));}
return sReturnVal;}});YAHOO.register("menu",YAHOO.widget.Menu,{version:"2.5.2",build:"1076"});

YAHOO.util.Connect={_msxml_progid:['Microsoft.XMLHTTP','MSXML2.XMLHTTP.3.0','MSXML2.XMLHTTP'],_http_headers:{},_has_http_headers:false,_use_default_post_header:true,_default_post_header:'application/x-www-form-urlencoded; charset=UTF-8',_default_form_header:'application/x-www-form-urlencoded',_use_default_xhr_header:true,_default_xhr_header:'XMLHttpRequest',_has_default_headers:true,_default_headers:{},_isFormSubmit:false,_isFileUploaddisabled:false,_formNode:null,_sFormData:null,_poll:{},_timeOut:{},_polling_interval:50,_transaction_id:0,_submitElementValue:null,_hasSubmitListener:(function()
{if(YAHOO.util.Event){YAHOO.util.Event.addListener(document,'click',function(e){var obj=YAHOO.util.Event.getTarget(e);if(obj.nodeName.toLowerCase()=='input'&&(obj.type&&obj.type.toLowerCase()=='submit')){YAHOO.util.Connect._submitElementValue=encodeURIComponent(obj.name)+"="+encodeURIComponent(obj.value);}});return true;}
return false;})(),startEvent:new YAHOO.util.CustomEvent('start'),completeEvent:new YAHOO.util.CustomEvent('complete'),successEvent:new YAHOO.util.CustomEvent('success'),failureEvent:new YAHOO.util.CustomEvent('failure'),uploaddisabledEvent:new YAHOO.util.CustomEvent('uploaddisabled'),abortEvent:new YAHOO.util.CustomEvent('abort'),_customEvents:{onStart:['startEvent','start'],onComplete:['completeEvent','complete'],onSuccess:['successEvent','success'],onFailure:['failureEvent','failure'],onUploaddisabled:['uploaddisabledEvent','uploaddisabled'],onAbort:['abortEvent','abort']},setProgId:function(id)
{this._msxml_progid.unshift(id);},setDefaultPostHeader:function(b)
{if(typeof b=='string'){this._default_post_header=b;}
else if(typeof b=='boolean'){this._use_default_post_header=b;}},setDefaultXhrHeader:function(b)
{if(typeof b=='string'){this._default_xhr_header=b;}
else{this._use_default_xhr_header=b;}},setPollingInterval:function(i)
{if(typeof i=='number'&&isFinite(i)){this._polling_interval=i;}},createXhrObject:function(transactionId)
{var obj,http;try
{http=new XMLHttpRequest();obj={conn:http,tId:transactionId};}
catch(e)
{for(var i=0;i<this._msxml_progid.length;++i){try
{http=new ActiveXObject(this._msxml_progid[i]);obj={conn:http,tId:transactionId};break;}
catch(e){}}}
finally
{return obj;}},getConnectionObject:function(isFileUploaddisabled)
{var o;var tId=this._transaction_id;try
{if(!isFileUploaddisabled){o=this.createXhrObject(tId);}
else{o={};o.tId=tId;o.isUploaddisabled=true;}
if(o){this._transaction_id++;}}
catch(e){}
finally
{return o;}},asyncRequest:function(method,uri,callback,postData)
{var o=(this._isFileUploaddisabled)?this.getConnectionObject(true):this.getConnectionObject();var args=(callback&&callback.argument)?callback.argument:null;if(!o){return null;}
else{if(callback&&callback.customevents){this.initCustomEvents(o,callback);}
if(this._isFormSubmit){if(this._isFileUploaddisabled){this.uploaddisabledFile(o,callback,uri,postData);return o;}
if(method.toUpperCase()=='GET'){if(this._sFormData.length!==0){uri+=((uri.indexOf('?')==-1)?'?':'&')+this._sFormData;}}
else if(method.toUpperCase()=='POST'){postData=postData?this._sFormData+"&"+postData:this._sFormData;}}
if(method.toUpperCase()=='GET'&&(callback&&callback.cache===false)){uri+=((uri.indexOf('?')==-1)?'?':'&')+"rnd="+new Date().valueOf().toString();}
o.void(method,uri,true);if(this._use_default_xhr_header){if(!this._default_headers['X-Requested-With']){this.initHeader('X-Requested-With',this._default_xhr_header,true);}}
if((method.toUpperCase()=='POST'&&this._use_default_post_header)&&this._isFormSubmit===false){this.initHeader('Content-Type',this._default_post_header);}
if(this._has_default_headers||this._has_http_headers){this.setHeader(o);}
this.handleReadyState(o,callback);o.conn.send(postData||'');if(this._isFormSubmit===true){this.resetFormState();}
this.startEvent.fire(o,args);if(o.startEvent){o.startEvent.fire(o,args);}
return o;}},initCustomEvents:function(o,callback)
{for(var prop in callback.customevents){if(this._customEvents[prop][0]){o[this._customEvents[prop][0]]=new YAHOO.util.CustomEvent(this._customEvents[prop][1],(callback.scope)?callback.scope:null);o[this._customEvents[prop][0]].subscribe(callback.customevents[prop]);}}},handleReadyState:function(o,callback)
{var oConn=this;var args=(callback&&callback.argument)?callback.argument:null;if(callback&&callback.timeout){this._timeOut[o.tId]=window.setTimeout(function(){oConn.abort(o,callback,true);},callback.timeout);}
this._poll[o.tId]=window.setInterval(function(){if(o.conn&&o.conn.readyState===4){window.clearInterval(oConn._poll[o.tId]);delete oConn._poll[o.tId];if(callback&&callback.timeout){window.clearTimeout(oConn._timeOut[o.tId]);delete oConn._timeOut[o.tId];}
oConn.completeEvent.fire(o,args);if(o.completeEvent){o.completeEvent.fire(o,args);}
oConn.handleTransactionResponse(o,callback);}},this._polling_interval);},handleTransactionResponse:function(o,callback,isAbort)
{var httpStatus,responseObject;var args=(callback&&callback.argument)?callback.argument:null;try
{if(o.conn.status!==undefined&&o.conn.status!==0){httpStatus=o.conn.status;}
else{httpStatus=13030;}}
catch(e){httpStatus=13030;}
if(httpStatus>=200&&httpStatus<300||httpStatus===1223){responseObject=this.createResponseObject(o,args);if(callback&&callback.success){if(!callback.scope){callback.success(responseObject);}
else{callback.success.apply(callback.scope,[responseObject]);}}
this.successEvent.fire(responseObject);if(o.successEvent){o.successEvent.fire(responseObject);}}
else{switch(httpStatus){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:responseObject=this.createExceptionObject(o.tId,args,(isAbort?isAbort:false));if(callback&&callback.failure){if(!callback.scope){callback.failure(responseObject);}
else{callback.failure.apply(callback.scope,[responseObject]);}}
break;default:responseObject=this.createResponseObject(o,args);if(callback&&callback.failure){if(!callback.scope){callback.failure(responseObject);}
else{callback.failure.apply(callback.scope,[responseObject]);}}}
this.failureEvent.fire(responseObject);if(o.failureEvent){o.failureEvent.fire(responseObject);}}
this.releaseObject(o);responseObject=null;},createResponseObject:function(o,callbackArg)
{var obj={};var headerObj={};try
{var headerStr=o.conn.getAllResponseHeaders();var header=headerStr.split('\n');for(var i=0;i<header.length;i++){var delimitPos=header[i].indexOf(':');if(delimitPos!=-1){headerObj[header[i].substring(0,delimitPos)]=header[i].substring(delimitPos+2);}}}
catch(e){}
obj.tId=o.tId;obj.status=(o.conn.status==1223)?204:o.conn.status;obj.statusText=(o.conn.status==1223)?"No Content":o.conn.statusText;obj.getResponseHeader=headerObj;obj.getAllResponseHeaders=headerStr;obj.responseText=o.conn.responseText;obj.responseXML=o.conn.responseXML;if(callbackArg){obj.argument=callbackArg;}
return obj;},createExceptionObject:function(tId,callbackArg,isAbort)
{var COMM_CODE=0;var COMM_ERROR='communication failure';var ABORT_CODE=-1;var ABORT_ERROR='transaction aborted';var obj={};obj.tId=tId;if(isAbort){obj.status=ABORT_CODE;obj.statusText=ABORT_ERROR;}
else{obj.status=COMM_CODE;obj.statusText=COMM_ERROR;}
if(callbackArg){obj.argument=callbackArg;}
return obj;},initHeader:function(label,value,isDefault)
{var headerObj=(isDefault)?this._default_headers:this._http_headers;headerObj[label]=value;if(isDefault){this._has_default_headers=true;}
else{this._has_http_headers=true;}},setHeader:function(o)
{if(this._has_default_headers){for(var prop in this._default_headers){if(YAHOO.lang.hasOwnProperty(this._default_headers,prop)){o.conn.setRequestHeader(prop,this._default_headers[prop]);}}}
if(this._has_http_headers){for(var prop in this._http_headers){if(YAHOO.lang.hasOwnProperty(this._http_headers,prop)){o.conn.setRequestHeader(prop,this._http_headers[prop]);}}
delete this._http_headers;this._http_headers={};this._has_http_headers=false;}},resetDefaultHeaders:function(){delete this._default_headers;this._default_headers={};this._has_default_headers=false;},setForm:function(formId,isUploaddisabled,secureUri)
{this.resetFormState();var oForm;if(typeof formId=='string'){oForm=(document.getElementById(formId)||document.forms[formId]);}
else if(typeof formId=='object'){oForm=formId;}
else{return;}
if(isUploaddisabled){var io=this.createFrame((window.location.href.toLowerCase().indexOf("httpdisabledsdisabled")===0||secureUri)?true:false);this._isFormSubmit=true;this._isFileUploaddisabled=true;this._formNode=oForm;return;}
var oElement,oName,oValue,oDisabled;var hasSubmit=false;for(var i=0;i<oForm.elements.length;i++){oElement=oForm.elements[i];oDisabled=oElement.disabled;oName=oElement.name;oValue=oElement.value;if(!oDisabled&&oName)
{switch(oElement.type)
{case'select-one':case'select-multiple':for(var j=0;j<oElement.options.length;j++){if(oElement.options[j].selected){if(window.ActiveXObject){this._sFormData+=encodeURIComponent(oName)+'='+encodeURIComponent(oElement.options[j].attributes['value'].specified?oElement.options[j].value:oElement.options[j].text)+'&';}
else{this._sFormData+=encodeURIComponent(oName)+'='+encodeURIComponent(oElement.options[j].hasAttribute('value')?oElement.options[j].value:oElement.options[j].text)+'&';}}}
break;case'radio':case'checkbox':if(oElement.checked){this._sFormData+=encodeURIComponent(oName)+'='+encodeURIComponent(oValue)+'&';}
break;case'file':case undefined:case'reset':case'button':break;case'submit':if(hasSubmit===false){if(this._hasSubmitListener&&this._submitElementValue){this._sFormData+=this._submitElementValue+'&';}
else{this._sFormData+=encodeURIComponent(oName)+'='+encodeURIComponent(oValue)+'&';}
hasSubmit=true;}
break;default:this._sFormData+=encodeURIComponent(oName)+'='+encodeURIComponent(oValue)+'&';}}}
this._isFormSubmit=true;this._sFormData=this._sFormData.substr(0,this._sFormData.length-1);this.initHeader('Content-Type',this._default_form_header);return this._sFormData;},resetFormState:function(){this._isFormSubmit=false;this._isFileUploaddisabled=false;this._formNode=null;this._sFormData="";},createFrame:function(secureUri){var frameId='yuiIO'+this._transaction_id;var io;if(window.ActiveXObject){io=document.createElement('<iframe id="'+frameId+'" name="'+frameId+'" />');if(typeof secureUri=='boolean'){io.src='javascript:false';}}
else{io=document.createElement('iframe');io.id=frameId;io.name=frameId;}
io.style.position='absolute';io.style.top='-1000px';io.style.left='-1000px';document.body.appendChild(io);},appendPostData:function(postData)
{var formElements=[];var postMessage=postData.split('&');for(var i=0;i<postMessage.length;i++){var delimitPos=postMessage[i].indexOf('=');if(delimitPos!=-1){formElements[i]=document.createElement('input');formElements[i].type='hidden';formElements[i].name=postMessage[i].substring(0,delimitPos);formElements[i].value=postMessage[i].substring(delimitPos+1);this._formNode.appendChild(formElements[i]);}}
return formElements;},uploaddisabledFile:function(o,callback,uri,postData){var oConn=this;var frameId='yuiIO'+o.tId;var uploaddisabledEncoding='multipart/form-data';var io=document.getElementById(frameId);var args=(callback&&callback.argument)?callback.argument:null;var rawFormAttributes={action:this._formNode.getAttribute('action'),method:this._formNode.getAttribute('method'),target:this._formNode.getAttribute('target')};this._formNode.setAttribute('action',uri);this._formNode.setAttribute('method','POST');this._formNode.setAttribute('target',frameId);if(YAHOO.env.ua.ie){this._formNode.setAttribute('encoding',uploaddisabledEncoding);}
else{this._formNode.setAttribute('enctype',uploaddisabledEncoding);}
if(postData){var oElements=this.appendPostData(postData);}
this._formNode.submit();this.startEvent.fire(o,args);if(o.startEvent){o.startEvent.fire(o,args);}
if(callback&&callback.timeout){this._timeOut[o.tId]=window.setTimeout(function(){oConn.abort(o,callback,true);},callback.timeout);}
if(oElements&&oElements.length>0){for(var i=0;i<oElements.length;i++){this._formNode.removeChild(oElements[i]);}}
for(var prop in rawFormAttributes){if(YAHOO.lang.hasOwnProperty(rawFormAttributes,prop)){if(rawFormAttributes[prop]){this._formNode.setAttribute(prop,rawFormAttributes[prop]);}
else{this._formNode.removeAttribute(prop);}}}
this.resetFormState();var uploaddisabledCallback=function()
{if(callback&&callback.timeout){window.clearTimeout(oConn._timeOut[o.tId]);delete oConn._timeOut[o.tId];}
oConn.completeEvent.fire(o,args);if(o.completeEvent){o.completeEvent.fire(o,args);}
var obj={};obj.tId=o.tId;obj.argument=callback.argument;try
{obj.responseText=io.contentWindow.document.body?io.contentWindow.document.body.innerHTML:io.contentWindow.document.documentElement.textContent;obj.responseXML=io.contentWindow.document.XMLDocument?io.contentWindow.document.XMLDocument:io.contentWindow.document;}
catch(e){}
if(callback&&callback.uploaddisabled){if(!callback.scope){callback.uploaddisabled(obj);}
else{callback.uploaddisabled.apply(callback.scope,[obj]);}}
oConn.uploaddisabledEvent.fire(obj);if(o.uploaddisabledEvent){o.uploaddisabledEvent.fire(obj);}
YAHOO.util.Event.removeListener(io,"loaddisabled",uploaddisabledCallback);setTimeout(function(){document.body.removeChild(io);oConn.releaseObject(o);},100);};YAHOO.util.Event.addListener(io,"loaddisabled",uploaddisabledCallback);},abort:function(o,callback,isTimeout)
{var abortStatus;var args=(callback&&callback.argument)?callback.argument:null;if(o&&o.conn){if(this.isCallInProgress(o)){o.conn.abort();window.clearInterval(this._poll[o.tId]);delete this._poll[o.tId];if(isTimeout){window.clearTimeout(this._timeOut[o.tId]);delete this._timeOut[o.tId];}
abortStatus=true;}}
else if(o&&o.isUploaddisabled===true){var frameId='yuiIO'+o.tId;var io=document.getElementById(frameId);if(io){YAHOO.util.Event.removeListener(io,"loaddisabled");document.body.removeChild(io);if(isTimeout){window.clearTimeout(this._timeOut[o.tId]);delete this._timeOut[o.tId];}
abortStatus=true;}}
else{abortStatus=false;}
if(abortStatus===true){this.abortEvent.fire(o,args);if(o.abortEvent){o.abortEvent.fire(o,args);}
this.handleTransactionResponse(o,callback,true);}
return abortStatus;},isCallInProgress:function(o)
{if(o&&o.conn){return o.conn.readyState!==4&&o.conn.readyState!==0;}
else if(o&&o.isUploaddisabled===true){var frameId='yuiIO'+o.tId;return document.getElementById(frameId)?true:false;}
else{return false;}},releaseObject:function(o)
{if(o&&o.conn){o.conn=null;o=null;}}};YAHOO.register("connection",YAHOO.util.Connect,{version:"2.5.2",build:"1076"});

(function(){var Y=YAHOO.util;var Anim=function(el,attributes,duration,method){if(!el){}
this.init(el,attributes,duration,method);};Anim.NAME='Anim';Anim.prototype={toString:function(){var el=this.getEl()||{};var id=el.id||el.tagName;return(this.constructor.NAME+': '+id);},patterns:{noNegatives:/width|height|opacity|padding/i,offsetAttribute:/^((width|height)|(top|left))$/,defaultUnit:/width|height|top$|bottom$|left$|right$/i,offsetUnit:/\d+(em|%|en|ex|pt|in|cm|mm|pc)$/i},doMethod:function(attr,start,end){return this.method(this.currentFrame,start,end-start,this.totalFrames);},setAttribute:function(attr,val,unit){if(this.patterns.noNegatives.test(attr)){val=(val>0)?val:0;}
Y.Dom.setStyle(this.getEl(),attr,val+unit);},getAttribute:function(attr){var el=this.getEl();var val=Y.Dom.getStyle(el,attr);if(val!=='auto'&&!this.patterns.offsetUnit.test(val)){return parseFloat(val);}
var a=this.patterns.offsetAttribute.exec(attr)||[];var pos=!!(a[3]);var box=!!(a[2]);if(box||(Y.Dom.getStyle(el,'position')=='absolute'&&pos)){val=el['offset'+a[0].charAt(0).toUpperCase()+a[0].substr(1)];}else{val=0;}
return val;},getDefaultUnit:function(attr){if(this.patterns.defaultUnit.test(attr)){return'px';}
return'';},setRuntimeAttribute:function(attr){var start;var end;var attributes=this.attributes;this.runtimeAttributes[attr]={};var isset=function(prop){return(typeof prop!=='undefined');};if(!isset(attributes[attr]['to'])&&!isset(attributes[attr]['by'])){return false;}
start=(isset(attributes[attr]['from']))?attributes[attr]['from']:this.getAttribute(attr);if(isset(attributes[attr]['to'])){end=attributes[attr]['to'];}else if(isset(attributes[attr]['by'])){if(start.constructor==Array){end=[];for(var i=0,len=start.length;i<len;++i){end[i]=start[i]+attributes[attr]['by'][i]*1;}}else{end=start+attributes[attr]['by']*1;}}
this.runtimeAttributes[attr].start=start;this.runtimeAttributes[attr].end=end;this.runtimeAttributes[attr].unit=(isset(attributes[attr].unit))?attributes[attr]['unit']:this.getDefaultUnit(attr);return true;},init:function(el,attributes,duration,method){var isAnimated=false;var startTime=null;var actualFrames=0;el=Y.Dom.get(el);this.attributes=attributes||{};this.duration=!YAHOO.lang.isUndefined(duration)?duration:1;this.method=method||Y.Easing.easeNone;this.useSeconds=true;this.currentFrame=0;this.totalFrames=Y.AnimMgr.fps;this.setEl=function(element){el=Y.Dom.get(element);};this.getEl=function(){return el;};this.isAnimated=function(){return isAnimated;};this.getStartTime=function(){return startTime;};this.runtimeAttributes={};this.animate=function(){if(this.isAnimated()){return false;}
this.currentFrame=0;this.totalFrames=(this.useSeconds)?Math.ceil(Y.AnimMgr.fps*this.duration):this.duration;if(this.duration===0&&this.useSeconds){this.totalFrames=1;}
Y.AnimMgr.registerElement(this);return true;};this.stop=function(finish){if(!this.isAnimated()){return false;}
if(finish){this.currentFrame=this.totalFrames;this._onTween.fire();}
Y.AnimMgr.stop(this);};var onStart=function(){this.onStart.fire();this.runtimeAttributes={};for(var attr in this.attributes){this.setRuntimeAttribute(attr);}
isAnimated=true;actualFrames=0;startTime=new Date();};var onTween=function(){var data={duration:new Date()-this.getStartTime(),currentFrame:this.currentFrame};data.toString=function(){return('duration: '+data.duration+', currentFrame: '+data.currentFrame);};this.onTween.fire(data);var runtimeAttributes=this.runtimeAttributes;for(var attr in runtimeAttributes){this.setAttribute(attr,this.doMethod(attr,runtimeAttributes[attr].start,runtimeAttributes[attr].end),runtimeAttributes[attr].unit);}
actualFrames+=1;};var onComplete=function(){var actual_duration=(new Date()-startTime)/1000;var data={duration:actual_duration,frames:actualFrames,fps:actualFrames/actual_duration};data.toString=function(){return('duration: '+data.duration+', frames: '+data.frames+', fps: '+data.fps);};isAnimated=false;actualFrames=0;this.onComplete.fire(data);};this._onStart=new Y.CustomEvent('_start',this,true);this.onStart=new Y.CustomEvent('start',this);this.onTween=new Y.CustomEvent('tween',this);this._onTween=new Y.CustomEvent('_tween',this,true);this.onComplete=new Y.CustomEvent('complete',this);this._onComplete=new Y.CustomEvent('_complete',this,true);this._onStart.subscribe(onStart);this._onTween.subscribe(onTween);this._onComplete.subscribe(onComplete);}};Y.Anim=Anim;})();YAHOO.util.AnimMgr=new function(){var thread=null;var queue=[];var tweenCount=0;this.fps=1000;this.delay=1;this.registerElement=function(tween){queue[queue.length]=tween;tweenCount+=1;tween._onStart.fire();this.start();};this.unRegister=function(tween,index){index=index||getIndex(tween);if(!tween.isAnimated()||index==-1){return false;}
tween._onComplete.fire();queue.splice(index,1);tweenCount-=1;if(tweenCount<=0){this.stop();}
return true;};this.start=function(){if(thread===null){thread=setInterval(this.run,this.delay);}};this.stop=function(tween){if(!tween){clearInterval(thread);for(var i=0,len=queue.length;i<len;++i){this.unRegister(queue[0],0);}
queue=[];thread=null;tweenCount=0;}
else{this.unRegister(tween);}};this.run=function(){for(var i=0,len=queue.length;i<len;++i){var tween=queue[i];if(!tween||!tween.isAnimated()){continue;}
if(tween.currentFrame<tween.totalFrames||tween.totalFrames===null)
{tween.currentFrame+=1;if(tween.useSeconds){correctFrame(tween);}
tween._onTween.fire();}
else{YAHOO.util.AnimMgr.stop(tween,i);}}};var getIndex=function(anim){for(var i=0,len=queue.length;i<len;++i){if(queue[i]==anim){return i;}}
return-1;};var correctFrame=function(tween){var frames=tween.totalFrames;var frame=tween.currentFrame;var expected=(tween.currentFrame*tween.duration*1000/tween.totalFrames);var elapsed=(new Date()-tween.getStartTime());var tweak=0;if(elapsed<tween.duration*1000){tweak=Math.round((elapsed/expected-1)*tween.currentFrame);}else{tweak=frames-(frame+1);}
if(tweak>0&&isFinite(tweak)){if(tween.currentFrame+tweak>=frames){tweak=frames-(frame+1);}
tween.currentFrame+=tweak;}};};YAHOO.util.Bezier=new function(){this.getPosition=function(points,t){var n=points.length;var tmp=[];for(var i=0;i<n;++i){tmp[i]=[points[i][0],points[i][1]];}
for(var j=1;j<n;++j){for(i=0;i<n-j;++i){tmp[i][0]=(1-t)*tmp[i][0]+t*tmp[parseInt(i+1,10)][0];tmp[i][1]=(1-t)*tmp[i][1]+t*tmp[parseInt(i+1,10)][1];}}
return[tmp[0][0],tmp[0][1]];};};(function(){var ColorAnim=function(el,attributes,duration,method){ColorAnim.superclass.constructor.call(this,el,attributes,duration,method);};ColorAnim.NAME='ColorAnim';var Y=YAHOO.util;YAHOO.extend(ColorAnim,Y.Anim);var superclass=ColorAnim.superclass;var proto=ColorAnim.prototype;proto.patterns.color=/color$/i;proto.patterns.rgb=/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i;proto.patterns.hex=/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i;proto.patterns.hex3=/^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i;proto.patterns.transparent=/^transparent|rgba\(0, 0, 0, 0\)$/;proto.parseColor=function(s){if(s.length==3){return s;}
var c=this.patterns.hex.exec(s);if(c&&c.length==4){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)];}
c=this.patterns.rgb.exec(s);if(c&&c.length==4){return[parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10)];}
c=this.patterns.hex3.exec(s);if(c&&c.length==4){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)];}
return null;};proto.getAttribute=function(attr){var el=this.getEl();if(this.patterns.color.test(attr)){var val=YAHOO.util.Dom.getStyle(el,attr);if(this.patterns.transparent.test(val)){var parent=el.parentNode;val=Y.Dom.getStyle(parent,attr);while(parent&&this.patterns.transparent.test(val)){parent=parent.parentNode;val=Y.Dom.getStyle(parent,attr);if(parent.tagName.toUpperCase()=='HTML'){val='#fff';}}}}else{val=superclass.getAttribute.call(this,attr);}
return val;};proto.doMethod=function(attr,start,end){var val;if(this.patterns.color.test(attr)){val=[];for(var i=0,len=start.length;i<len;++i){val[i]=superclass.doMethod.call(this,attr,start[i],end[i]);}
val='rgb('+Math.floor(val[0])+','+Math.floor(val[1])+','+Math.floor(val[2])+')';}
else{val=superclass.doMethod.call(this,attr,start,end);}
return val;};proto.setRuntimeAttribute=function(attr){superclass.setRuntimeAttribute.call(this,attr);if(this.patterns.color.test(attr)){var attributes=this.attributes;var start=this.parseColor(this.runtimeAttributes[attr].start);var end=this.parseColor(this.runtimeAttributes[attr].end);if(typeof attributes[attr]['to']==='undefined'&&typeof attributes[attr]['by']!=='undefined'){end=this.parseColor(attributes[attr].by);for(var i=0,len=start.length;i<len;++i){end[i]=start[i]+end[i];}}
this.runtimeAttributes[attr].start=start;this.runtimeAttributes[attr].end=end;}};Y.ColorAnim=ColorAnim;})();YAHOO.util.Easing={easeNone:function(t,b,c,d){return c*t/d+b;},easeIn:function(t,b,c,d){return c*(t/=d)*t+b;},easeOut:function(t,b,c,d){return-c*(t/=d)*(t-2)+b;},easeBoth:function(t,b,c,d){if((t/=d/2)<1){return c/2*t*t+b;}
return-c/2*((--t)*(t-2)-1)+b;},easeInStrong:function(t,b,c,d){return c*(t/=d)*t*t*t+b;},easeOutStrong:function(t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b;},easeBothStrong:function(t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t+b;}
return-c/2*((t-=2)*t*t*t-2)+b;},elasticIn:function(t,b,c,d,a,p){if(t==0){return b;}
if((t/=d)==1){return b+c;}
if(!p){p=d*.3;}
if(!a||a<Math.abs(c)){a=c;var s=p/4;}
else{var s=p/(2*Math.PI)*Math.asin(c/a);}
return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;},elasticOut:function(t,b,c,d,a,p){if(t==0){return b;}
if((t/=d)==1){return b+c;}
if(!p){p=d*.3;}
if(!a||a<Math.abs(c)){a=c;var s=p/4;}
else{var s=p/(2*Math.PI)*Math.asin(c/a);}
return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b;},elasticBoth:function(t,b,c,d,a,p){if(t==0){return b;}
if((t/=d/2)==2){return b+c;}
if(!p){p=d*(.3*1.5);}
if(!a||a<Math.abs(c)){a=c;var s=p/4;}
else{var s=p/(2*Math.PI)*Math.asin(c/a);}
if(t<1){return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;}
return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b;},backIn:function(t,b,c,d,s){if(typeof s=='undefined'){s=1.70158;}
return c*(t/=d)*t*((s+1)*t-s)+b;},backOut:function(t,b,c,d,s){if(typeof s=='undefined'){s=1.70158;}
return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b;},backBoth:function(t,b,c,d,s){if(typeof s=='undefined'){s=1.70158;}
if((t/=d/2)<1){return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b;}
return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b;},bounceIn:function(t,b,c,d){return c-YAHOO.util.Easing.bounceOut(d-t,0,c,d)+b;},bounceOut:function(t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b;}else if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+.75)+b;}else if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+.9375)+b;}
return c*(7.5625*(t-=(2.625/2.75))*t+.984375)+b;},bounceBoth:function(t,b,c,d){if(t<d/2){return YAHOO.util.Easing.bounceIn(t*2,0,c,d)*.5+b;}
return YAHOO.util.Easing.bounceOut(t*2-d,0,c,d)*.5+c*.5+b;}};(function(){var Motion=function(el,attributes,duration,method){if(el){Motion.superclass.constructor.call(this,el,attributes,duration,method);}};Motion.NAME='Motion';var Y=YAHOO.util;YAHOO.extend(Motion,Y.ColorAnim);var superclass=Motion.superclass;var proto=Motion.prototype;proto.patterns.points=/^points$/i;proto.setAttribute=function(attr,val,unit){if(this.patterns.points.test(attr)){unit=unit||'px';superclass.setAttribute.call(this,'left',val[0],unit);superclass.setAttribute.call(this,'top',val[1],unit);}else{superclass.setAttribute.call(this,attr,val,unit);}};proto.getAttribute=function(attr){if(this.patterns.points.test(attr)){var val=[superclass.getAttribute.call(this,'left'),superclass.getAttribute.call(this,'top')];}else{val=superclass.getAttribute.call(this,attr);}
return val;};proto.doMethod=function(attr,start,end){var val=null;if(this.patterns.points.test(attr)){var t=this.method(this.currentFrame,0,100,this.totalFrames)/100;val=Y.Bezier.getPosition(this.runtimeAttributes[attr],t);}else{val=superclass.doMethod.call(this,attr,start,end);}
return val;};proto.setRuntimeAttribute=function(attr){if(this.patterns.points.test(attr)){var el=this.getEl();var attributes=this.attributes;var start;var control=attributes['points']['control']||[];var end;var i,len;if(control.length>0&&!(control[0]instanceof Array)){control=[control];}else{var tmp=[];for(i=0,len=control.length;i<len;++i){tmp[i]=control[i];}
control=tmp;}
if(Y.Dom.getStyle(el,'position')=='static'){Y.Dom.setStyle(el,'position','relative');}
if(isset(attributes['points']['from'])){Y.Dom.setXY(el,attributes['points']['from']);}
else{Y.Dom.setXY(el,Y.Dom.getXY(el));}
start=this.getAttribute('points');if(isset(attributes['points']['to'])){end=translateValues.call(this,attributes['points']['to'],start);var pageXY=Y.Dom.getXY(this.getEl());for(i=0,len=control.length;i<len;++i){control[i]=translateValues.call(this,control[i],start);}}else if(isset(attributes['points']['by'])){end=[start[0]+attributes['points']['by'][0],start[1]+attributes['points']['by'][1]];for(i=0,len=control.length;i<len;++i){control[i]=[start[0]+control[i][0],start[1]+control[i][1]];}}
this.runtimeAttributes[attr]=[start];if(control.length>0){this.runtimeAttributes[attr]=this.runtimeAttributes[attr].concat(control);}
this.runtimeAttributes[attr][this.runtimeAttributes[attr].length]=end;}
else{superclass.setRuntimeAttribute.call(this,attr);}};var translateValues=function(val,start){var pageXY=Y.Dom.getXY(this.getEl());val=[val[0]-pageXY[0]+start[0],val[1]-pageXY[1]+start[1]];return val;};var isset=function(prop){return(typeof prop!=='undefined');};Y.Motion=Motion;})();(function(){var Scroll=function(el,attributes,duration,method){if(el){Scroll.superclass.constructor.call(this,el,attributes,duration,method);}};Scroll.NAME='Scroll';var Y=YAHOO.util;YAHOO.extend(Scroll,Y.ColorAnim);var superclass=Scroll.superclass;var proto=Scroll.prototype;proto.doMethod=function(attr,start,end){var val=null;if(attr=='scroll'){val=[this.method(this.currentFrame,start[0],end[0]-start[0],this.totalFrames),this.method(this.currentFrame,start[1],end[1]-start[1],this.totalFrames)];}else{val=superclass.doMethod.call(this,attr,start,end);}
return val;};proto.getAttribute=function(attr){var val=null;var el=this.getEl();if(attr=='scroll'){val=[el.scrollLeft,el.scrollTop];}else{val=superclass.getAttribute.call(this,attr);}
return val;};proto.setAttribute=function(attr,val,unit){var el=this.getEl();if(attr=='scroll'){el.scrollLeft=val[0];el.scrollTop=val[1];}else{superclass.setAttribute.call(this,attr,val,unit);}};Y.Scroll=Scroll;})();YAHOO.register("animation",YAHOO.util.Anim,{version:"2.5.2",build:"1076"});

YAHOO.widget.AutoComplete=function(elInput,elContainer,oDataSource,oConfigs){if(elInput&&elContainer&&oDataSource){if(oDataSource instanceof YAHOO.widget.DataSource){this.dataSource=oDataSource;}
else{return;}
if(YAHOO.util.Dom.inDocument(elInput)){if(YAHOO.lang.isString(elInput)){this._sName="instance"+YAHOO.widget.AutoComplete._nIndex+" "+elInput;this._elTextbox=document.getElementById(elInput);}
else{this._sName=(elInput.id)?"instance"+YAHOO.widget.AutoComplete._nIndex+" "+elInput.id:"instance"+YAHOO.widget.AutoComplete._nIndex;this._elTextbox=elInput;}
YAHOO.util.Dom.addClass(this._elTextbox,"yui-ac-input");}
else{return;}
if(YAHOO.util.Dom.inDocument(elContainer)){if(YAHOO.lang.isString(elContainer)){this._elContainer=document.getElementById(elContainer);}
else{this._elContainer=elContainer;}
if(this._elContainer.style.display=="none"){}
var elParent=this._elContainer.parentNode;var elTag=elParent.tagName.toLowerCase();if(elTag=="div"){YAHOO.util.Dom.addClass(elParent,"yui-ac");}
else{}}
else{return;}
if(oConfigs&&(oConfigs.constructor==Object)){for(var sConfig in oConfigs){if(sConfig){this[sConfig]=oConfigs[sConfig];}}}
this._initContainer();this._initProps();this._initList();this._initContainerHelpers();var oSelf=this;var elTextbox=this._elTextbox;var elContent=this._elContent;YAHOO.util.Event.addListener(elTextbox,"keyup",oSelf._onTextboxKeyUp,oSelf);YAHOO.util.Event.addListener(elTextbox,"keydown",oSelf._onTextboxKeyDown,oSelf);YAHOO.util.Event.addListener(elTextbox,"focus",oSelf._onTextboxFocus,oSelf);YAHOO.util.Event.addListener(elTextbox,"blur",oSelf._onTextboxBlur,oSelf);YAHOO.util.Event.addListener(elContent,"mouseover",oSelf._onContainerMouseover,oSelf);YAHOO.util.Event.addListener(elContent,"mouseout",oSelf._onContainerMouseout,oSelf);YAHOO.util.Event.addListener(elContent,"scroll",oSelf._onContainerScroll,oSelf);YAHOO.util.Event.addListener(elContent,"resize",oSelf._onContainerResize,oSelf);YAHOO.util.Event.addListener(elTextbox,"keypress",oSelf._onTextboxKeyPress,oSelf);YAHOO.util.Event.addListener(window,"unloaddisabled",oSelf._onWindowUnloaddisabled,oSelf);this.textboxFocusEvent=new YAHOO.util.CustomEvent("textboxFocus",this);this.textboxKeyEvent=new YAHOO.util.CustomEvent("textboxKey",this);this.dataRequestEvent=new YAHOO.util.CustomEvent("dataRequest",this);this.dataReturnEvent=new YAHOO.util.CustomEvent("dataReturn",this);this.dataErrorEvent=new YAHOO.util.CustomEvent("dataError",this);this.containerExpandEvent=new YAHOO.util.CustomEvent("containerExpand",this);this.typeAheadEvent=new YAHOO.util.CustomEvent("typeAhead",this);this.itemMouseOverEvent=new YAHOO.util.CustomEvent("itemMouseOver",this);this.itemMouseOutEvent=new YAHOO.util.CustomEvent("itemMouseOut",this);this.itemArrowToEvent=new YAHOO.util.CustomEvent("itemArrowTo",this);this.itemArrowFromEvent=new YAHOO.util.CustomEvent("itemArrowFrom",this);this.itemSelectEvent=new YAHOO.util.CustomEvent("itemSelect",this);this.unmatchedItemSelectEvent=new YAHOO.util.CustomEvent("unmatchedItemSelect",this);this.selectionEnforceEvent=new YAHOO.util.CustomEvent("selectionEnforce",this);this.containerCollapseEvent=new YAHOO.util.CustomEvent("containerCollapse",this);this.textboxBlurEvent=new YAHOO.util.CustomEvent("textboxBlur",this);elTextbox.setAttribute("autocomplete","off");YAHOO.widget.AutoComplete._nIndex++;}
else{}};YAHOO.widget.AutoComplete.prototype.dataSource=null;YAHOO.widget.AutoComplete.prototype.minQueryLength=1;YAHOO.widget.AutoComplete.prototype.maxResultsDisplayed=10;YAHOO.widget.AutoComplete.prototype.queryDelay=0.2;YAHOO.widget.AutoComplete.prototype.highlightClassName="yui-ac-highlight";YAHOO.widget.AutoComplete.prototype.prehighlightClassName=null;YAHOO.widget.AutoComplete.prototype.delimChar=null;YAHOO.widget.AutoComplete.prototype.autoHighlight=true;YAHOO.widget.AutoComplete.prototype.typeAhead=false;YAHOO.widget.AutoComplete.prototype.animHoriz=false;YAHOO.widget.AutoComplete.prototype.animVert=true;YAHOO.widget.AutoComplete.prototype.animSpeed=0.3;YAHOO.widget.AutoComplete.prototype.forceSelection=false;YAHOO.widget.AutoComplete.prototype.allowBrowserAutocomplete=true;YAHOO.widget.AutoComplete.prototype.alwaysShowContainer=false;YAHOO.widget.AutoComplete.prototype.useIFrame=false;YAHOO.widget.AutoComplete.prototype.useShadow=false;YAHOO.widget.AutoComplete.prototype.toString=function(){return"AutoComplete "+this._sName;};YAHOO.widget.AutoComplete.prototype.isContainerOpen=function(){return this._bContainerOpen;};YAHOO.widget.AutoComplete.prototype.getListItems=function(){return this._aListItems;};YAHOO.widget.AutoComplete.prototype.getListItemData=function(oListItem){if(oListItem._oResultData){return oListItem._oResultData;}
else{return false;}};YAHOO.widget.AutoComplete.prototype.setHeader=function(sHeader){if(this._elHeader){var elHeader=this._elHeader;if(sHeader){elHeader.innerHTML=sHeader;elHeader.style.display="block";}
else{elHeader.innerHTML="";elHeader.style.display="none";}}};YAHOO.widget.AutoComplete.prototype.setFooter=function(sFooter){if(this._elFooter){var elFooter=this._elFooter;if(sFooter){elFooter.innerHTML=sFooter;elFooter.style.display="block";}
else{elFooter.innerHTML="";elFooter.style.display="none";}}};YAHOO.widget.AutoComplete.prototype.setBody=function(sBody){if(this._elBody){var elBody=this._elBody;if(sBody){elBody.innerHTML=sBody;elBody.style.display="block";elBody.style.display="block";}
else{elBody.innerHTML="";elBody.style.display="none";}
this._maxResultsDisplayed=0;}};YAHOO.widget.AutoComplete.prototype.formatResult=function(oResultItem,sQuery){var sResult=oResultItem[0];if(sResult){return sResult;}
else{return"";}};YAHOO.widget.AutoComplete.prototype.doBeforeExpandContainer=function(elTextbox,elContainer,sQuery,aResults){return true;};YAHOO.widget.AutoComplete.prototype.sendQuery=function(sQuery){this._sendQuery(sQuery);};YAHOO.widget.AutoComplete.prototype.doBeforeSendQuery=function(sQuery){return sQuery;};YAHOO.widget.AutoComplete.prototype.destroy=function(){var instanceName=this.toString();var elInput=this._elTextbox;var elContainer=this._elContainer;this.textboxFocusEvent.unsubscribeAll();this.textboxKeyEvent.unsubscribeAll();this.dataRequestEvent.unsubscribeAll();this.dataReturnEvent.unsubscribeAll();this.dataErrorEvent.unsubscribeAll();this.containerExpandEvent.unsubscribeAll();this.typeAheadEvent.unsubscribeAll();this.itemMouseOverEvent.unsubscribeAll();this.itemMouseOutEvent.unsubscribeAll();this.itemArrowToEvent.unsubscribeAll();this.itemArrowFromEvent.unsubscribeAll();this.itemSelectEvent.unsubscribeAll();this.unmatchedItemSelectEvent.unsubscribeAll();this.selectionEnforceEvent.unsubscribeAll();this.containerCollapseEvent.unsubscribeAll();this.textboxBlurEvent.unsubscribeAll();YAHOO.util.Event.purgeElement(elInput,true);YAHOO.util.Event.purgeElement(elContainer,true);elContainer.innerHTML="";for(var key in this){if(YAHOO.lang.hasOwnProperty(this,key)){this[key]=null;}}};YAHOO.widget.AutoComplete.prototype.textboxFocusEvent=null;YAHOO.widget.AutoComplete.prototype.textboxKeyEvent=null;YAHOO.widget.AutoComplete.prototype.dataRequestEvent=null;YAHOO.widget.AutoComplete.prototype.dataReturnEvent=null;YAHOO.widget.AutoComplete.prototype.dataErrorEvent=null;YAHOO.widget.AutoComplete.prototype.containerExpandEvent=null;YAHOO.widget.AutoComplete.prototype.typeAheadEvent=null;YAHOO.widget.AutoComplete.prototype.itemMouseOverEvent=null;YAHOO.widget.AutoComplete.prototype.itemMouseOutEvent=null;YAHOO.widget.AutoComplete.prototype.itemArrowToEvent=null;YAHOO.widget.AutoComplete.prototype.itemArrowFromEvent=null;YAHOO.widget.AutoComplete.prototype.itemSelectEvent=null;YAHOO.widget.AutoComplete.prototype.unmatchedItemSelectEvent=null;YAHOO.widget.AutoComplete.prototype.selectionEnforceEvent=null;YAHOO.widget.AutoComplete.prototype.containerCollapseEvent=null;YAHOO.widget.AutoComplete.prototype.textboxBlurEvent=null;YAHOO.widget.AutoComplete._nIndex=0;YAHOO.widget.AutoComplete.prototype._sName=null;YAHOO.widget.AutoComplete.prototype._elTextbox=null;YAHOO.widget.AutoComplete.prototype._elContainer=null;YAHOO.widget.AutoComplete.prototype._elContent=null;YAHOO.widget.AutoComplete.prototype._elHeader=null;YAHOO.widget.AutoComplete.prototype._elBody=null;YAHOO.widget.AutoComplete.prototype._elFooter=null;YAHOO.widget.AutoComplete.prototype._elShadow=null;YAHOO.widget.AutoComplete.prototype._elIFrame=null;YAHOO.widget.AutoComplete.prototype._bFocused=true;YAHOO.widget.AutoComplete.prototype._oAnim=null;YAHOO.widget.AutoComplete.prototype._bContainerOpen=false;YAHOO.widget.AutoComplete.prototype._bOverContainer=false;YAHOO.widget.AutoComplete.prototype._aListItems=null;YAHOO.widget.AutoComplete.prototype._nDisplayedItems=0;YAHOO.widget.AutoComplete.prototype._maxResultsDisplayed=0;YAHOO.widget.AutoComplete.prototype._sCurQuery=null;YAHOO.widget.AutoComplete.prototype._sSavedQuery=null;YAHOO.widget.AutoComplete.prototype._oCurItem=null;YAHOO.widget.AutoComplete.prototype._bItemSelected=false;YAHOO.widget.AutoComplete.prototype._nKeyCode=null;YAHOO.widget.AutoComplete.prototype._nDelayID=-1;YAHOO.widget.AutoComplete.prototype._iFrameSrc="javascript:false;";YAHOO.widget.AutoComplete.prototype._queryInterval=null;YAHOO.widget.AutoComplete.prototype._sLastTextboxValue=null;YAHOO.widget.AutoComplete.prototype._initProps=function(){var minQueryLength=this.minQueryLength;if(!YAHOO.lang.isNumber(minQueryLength)){this.minQueryLength=1;}
var maxResultsDisplayed=this.maxResultsDisplayed;if(!YAHOO.lang.isNumber(maxResultsDisplayed)||(maxResultsDisplayed<1)){this.maxResultsDisplayed=10;}
var queryDelay=this.queryDelay;if(!YAHOO.lang.isNumber(queryDelay)||(queryDelay<0)){this.queryDelay=0.2;}
var delimChar=this.delimChar;if(YAHOO.lang.isString(delimChar)&&(delimChar.length>0)){this.delimChar=[delimChar];}
else if(!YAHOO.lang.isArray(delimChar)){this.delimChar=null;}
var animSpeed=this.animSpeed;if((this.animHoriz||this.animVert)&&YAHOO.util.Anim){if(!YAHOO.lang.isNumber(animSpeed)||(animSpeed<0)){this.animSpeed=0.3;}
if(!this._oAnim){this._oAnim=new YAHOO.util.Anim(this._elContent,{},this.animSpeed);}
else{this._oAnim.duration=this.animSpeed;}}
if(this.forceSelection&&delimChar){}};YAHOO.widget.AutoComplete.prototype._initContainerHelpers=function(){if(this.useShadow&&!this._elShadow){var elShadow=document.createElement("div");elShadow.className="yui-ac-shadow";this._elShadow=this._elContainer.appendChild(elShadow);}
if(this.useIFrame&&!this._elIFrame){var elIFrame=document.createElement("iframe");elIFrame.src=this._iFrameSrc;elIFrame.frameBorder=0;elIFrame.scrolling="no";elIFrame.style.position="absolute";elIFrame.style.width="100%";elIFrame.style.height="100%";elIFrame.tabIndex=-1;this._elIFrame=this._elContainer.appendChild(elIFrame);}};YAHOO.widget.AutoComplete.prototype._initContainer=function(){YAHOO.util.Dom.addClass(this._elContainer,"yui-ac-container");if(!this._elContent){var elContent=document.createElement("div");elContent.className="yui-ac-content";elContent.style.display="none";this._elContent=this._elContainer.appendChild(elContent);var elHeader=document.createElement("div");elHeader.className="yui-ac-hd";elHeader.style.display="none";this._elHeader=this._elContent.appendChild(elHeader);var elBody=document.createElement("div");elBody.className="yui-ac-bd";this._elBody=this._elContent.appendChild(elBody);var elFooter=document.createElement("div");elFooter.className="yui-ac-ft";elFooter.style.display="none";this._elFooter=this._elContent.appendChild(elFooter);}
else{}};YAHOO.widget.AutoComplete.prototype._initList=function(){this._aListItems=[];while(this._elBody.hasChildNodes()){var oldListItems=this.getListItems();
if(oldListItems){for(var oldi=oldListItems.length-1;
oldi>=0;
oldi--){
oldListItems[oldi]=null;}}
this._elBody.innerHTML="";}
var oList=document.createElement("ul");
oList=this._elBody.appendChild(oList);

for(var i=0;i<this.maxResultsDisplayed;i++){
  var oItem=document.createElement("li");
  oItem=oList.appendChild(oItem);
  this._aListItems[i]=oItem;
  this._initListItem(oItem,i);
}
this._maxResultsDisplayed=this.maxResultsDisplayed;};YAHOO.widget.AutoComplete.prototype._initListItem=function(oItem,nItemIndex){
var oSelf=this;
oItem.style.display="none";
oItem._nItemIndex=nItemIndex;
oItem.mouseover=oItem.mouseout=oItem.onclick=null;
YAHOO.util.Event.addListener(oItem,"mouseover",oSelf._onItemMouseover,oSelf);
YAHOO.util.Event.addListener(oItem,"mouseout",oSelf._onItemMouseout,oSelf);
YAHOO.util.Event.addListener(oItem,"click",oSelf._onItemMouseclick,oSelf);};
YAHOO.widget.AutoComplete.prototype._onIMEDetected=function(oSelf){oSelf._enableIntervalDetection();};YAHOO.widget.AutoComplete.prototype._enableIntervalDetection=function(){var currValue=this._elTextbox.value;var lastValue=this._sLastTextboxValue;if(currValue!=lastValue){this._sLastTextboxValue=currValue;this._sendQuery(currValue);}};YAHOO.widget.AutoComplete.prototype._cancelIntervalDetection=function(oSelf){if(oSelf._queryInterval){clearInterval(oSelf._queryInterval);}};YAHOO.widget.AutoComplete.prototype._isIgnoreKey=function(nKeyCode){if((nKeyCode==9)||(nKeyCode==13)||(nKeyCode==16)||(nKeyCode==17)||(nKeyCode>=18&&nKeyCode<=20)||(nKeyCode==27)||(nKeyCode>=33&&nKeyCode<=35)||(nKeyCode>=36&&nKeyCode<=40)||(nKeyCode>=44&&nKeyCode<=45)){return true;}
return false;};YAHOO.widget.AutoComplete.prototype._sendQuery=function(sQuery){if(this.minQueryLength==-1){this._toggleContainer(false);return;}
var aDelimChar=(this.delimChar)?this.delimChar:null;if(aDelimChar){var nDelimIndex=-1;for(var i=aDelimChar.length-1;i>=0;i--){var nNewIndex=sQuery.lastIndexOf(aDelimChar[i]);if(nNewIndex>nDelimIndex){nDelimIndex=nNewIndex;}}
if(aDelimChar[i]==" "){for(var j=aDelimChar.length-1;j>=0;j--){if(sQuery[nDelimIndex-1]==aDelimChar[j]){nDelimIndex--;break;}}}
if(nDelimIndex>-1){var nQueryStart=nDelimIndex+1;while(sQuery.charAt(nQueryStart)==" "){nQueryStart+=1;}
this._sSavedQuery=sQuery.substring(0,nQueryStart);sQuery=sQuery.substr(nQueryStart);}
else if(sQuery.indexOf(this._sSavedQuery)<0){this._sSavedQuery=null;}}
if((sQuery&&(sQuery.length<this.minQueryLength))||(!sQuery&&this.minQueryLength>0)){if(this._nDelayID!=-1){clearTimeout(this._nDelayID);}
this._toggleContainer(false);return;}
sQuery=encodeURIComponent(sQuery);this._nDelayID=-1;sQuery=this.doBeforeSendQuery(sQuery);this.dataRequestEvent.fire(this,sQuery);this.dataSource.getResults(this._populateList,sQuery,this);};YAHOO.widget.AutoComplete.prototype._populateList=function(sQuery,aResults,oSelf){if(aResults===null){oSelf.dataErrorEvent.fire(oSelf,sQuery);}
if(!oSelf._bFocused||!aResults){return;}
var isOpera=(navigator.userAgent.toLowerCase().indexOf("opera")!=-1);var contentStyle=oSelf._elContent.style;contentStyle.width=(!isOpera)?null:"";contentStyle.height=(!isOpera)?null:"";var sCurQuery=decodeURIComponent(sQuery);oSelf._sCurQuery=sCurQuery;oSelf._bItemSelected=false;if(oSelf._maxResultsDisplayed!=oSelf.maxResultsDisplayed){oSelf._initList();}
var nItems=Math.min(aResults.length,oSelf.maxResultsDisplayed);oSelf._nDisplayedItems=nItems;if(nItems>0){oSelf._initContainerHelpers();var aItems=oSelf._aListItems;for(var i=nItems-1;i>=0;i--){var oItemi=aItems[i];var oResultItemi=aResults[i];oItemi.innerHTML=oSelf.formatResult(oResultItemi,sCurQuery);oItemi.style.display="list-item";
oItemi._sResultKey=oResultItemi[0];oItemi._oResultData=oResultItemi;}
for(var j=aItems.length-1;j>=nItems;j--){
var oItemj=aItems[j];
oItemj.innerHTML=null;
oItemj.style.display="none";
oItemj._sResultKey=null;
oItemj._oResultData=null;}
var ok=oSelf.doBeforeExpandContainer(oSelf._elTextbox,oSelf._elContainer,sQuery,aResults);oSelf._toggleContainer(ok);if(oSelf.autoHighlight){var oFirstItem=aItems[0];oSelf._toggleHighlight(oFirstItem,"to");oSelf.itemArrowToEvent.fire(oSelf,oFirstItem);oSelf._typeAhead(oFirstItem,sQuery);}
else{oSelf._oCurItem=null;}}
else{oSelf._toggleContainer(false);}
oSelf.dataReturnEvent.fire(oSelf,sQuery,aResults);};YAHOO.widget.AutoComplete.prototype._clearSelection=function(){var sValue=this._elTextbox.value;var sChar=(this.delimChar)?this.delimChar[0]:null;var nIndex=(sChar)?sValue.lastIndexOf(sChar,sValue.length-2):-1;if(nIndex>-1){this._elTextbox.value=sValue.substring(0,nIndex);}
else{this._elTextbox.value="";}
this._sSavedQuery=this._elTextbox.value;this.selectionEnforceEvent.fire(this);};YAHOO.widget.AutoComplete.prototype._textMatchesOption=function(){var foundMatch=null;for(var i=this._nDisplayedItems-1;i>=0;i--){var oItem=this._aListItems[i];var sMatch=oItem._sResultKey.toLowerCase();if(sMatch==this._sCurQuery.toLowerCase()){foundMatch=oItem;break;}}
return(foundMatch);};YAHOO.widget.AutoComplete.prototype._typeAhead=function(oItem,sQuery){if(!this.typeAhead||(this._nKeyCode==8)){return;}
var elTextbox=this._elTextbox;var sValue=this._elTextbox.value;if(!elTextbox.setSelectionRange&&!elTextbox.createTextRange){return;}
var nStart=sValue.length;this._updateValue(oItem);var nEnd=elTextbox.value.length;this._selectText(elTextbox,nStart,nEnd);var sPrefill=elTextbox.value.substr(nStart,nEnd);this.typeAheadEvent.fire(this,sQuery,sPrefill);};YAHOO.widget.AutoComplete.prototype._selectText=function(elTextbox,nStart,nEnd){if(elTextbox.setSelectionRange){elTextbox.setSelectionRange(nStart,nEnd);}
else if(elTextbox.createTextRange){var oTextRange=elTextbox.createTextRange();oTextRange.moveStart("character",nStart);oTextRange.moveEnd("character",nEnd-elTextbox.value.length);oTextRange.select();}
else{elTextbox.select();}};YAHOO.widget.AutoComplete.prototype._toggleContainerHelpers=function(bShow){var bFireEvent=false;var width=this._elContent.offsetWidth+"px";var height=this._elContent.offsetHeight+"px";if(this.useIFrame&&this._elIFrame){bFireEvent=true;if(bShow){this._elIFrame.style.width=width;this._elIFrame.style.height=height;}
else{this._elIFrame.style.width=0;this._elIFrame.style.height=0;}}
if(this.useShadow&&this._elShadow){bFireEvent=true;if(bShow){this._elShadow.style.width=width;this._elShadow.style.height=height;}
else{this._elShadow.style.width=0;this._elShadow.style.height=0;}}};YAHOO.widget.AutoComplete.prototype._toggleContainer=function(bShow){var elContainer=this._elContainer;if(this.alwaysShowContainer&&this._bContainerOpen){return;}
if(!bShow){this._elContent.scrollTop=0;var aItems=this._aListItems;if(aItems&&(aItems.length>0)){for(var i=aItems.length-1;i>=0;i--){aItems[i].style.display="none";}}
if(this._oCurItem){this._toggleHighlight(this._oCurItem,"from");}
this._oCurItem=null;this._nDisplayedItems=0;this._sCurQuery=null;}
if(!bShow&&!this._bContainerOpen){this._elContent.style.display="none";return;}
var oAnim=this._oAnim;if(oAnim&&oAnim.getEl()&&(this.animHoriz||this.animVert)){if(!bShow){this._toggleContainerHelpers(bShow);}
if(oAnim.isAnimated()){oAnim.stop();}
var oClone=this._elContent.cloneNode(true);elContainer.appendChild(oClone);oClone.style.top="-9000px";oClone.style.display="block";var wExp=oClone.offsetWidth;var hExp=oClone.offsetHeight;var wColl=(this.animHoriz)?0:wExp;var hColl=(this.animVert)?0:hExp;oAnim.attributes=(bShow)?{width:{to:wExp},height:{to:hExp}}:{width:{to:wColl},height:{to:hColl}};if(bShow&&!this._bContainerOpen){this._elContent.style.width=wColl+"px";this._elContent.style.height=hColl+"px";}
else{this._elContent.style.width=wExp+"px";this._elContent.style.height=hExp+"px";}
elContainer.removeChild(oClone);oClone=null;var oSelf=this;var onAnimComplete=function(){oAnim.onComplete.unsubscribeAll();if(bShow){oSelf.containerExpandEvent.fire(oSelf);}
else{oSelf._elContent.style.display="none";oSelf.containerCollapseEvent.fire(oSelf);}
oSelf._toggleContainerHelpers(bShow);};this._elContent.style.display="block";oAnim.onComplete.subscribe(onAnimComplete);oAnim.animate();this._bContainerOpen=bShow;}
else{if(bShow){this._elContent.style.display="block";this.containerExpandEvent.fire(this);}
else{this._elContent.style.display="none";this.containerCollapseEvent.fire(this);}
this._toggleContainerHelpers(bShow);this._bContainerOpen=bShow;}};YAHOO.widget.AutoComplete.prototype._toggleHighlight=function(oNewItem,sType){var sHighlight=this.highlightClassName;if(this._oCurItem){YAHOO.util.Dom.removeClass(this._oCurItem,sHighlight);}
if((sType=="to")&&sHighlight){YAHOO.util.Dom.addClass(oNewItem,sHighlight);this._oCurItem=oNewItem;}};YAHOO.widget.AutoComplete.prototype._togglePrehighlight=function(oNewItem,sType){if(oNewItem==this._oCurItem){return;}
var sPrehighlight=this.prehighlightClassName;if((sType=="mouseover")&&sPrehighlight){YAHOO.util.Dom.addClass(oNewItem,sPrehighlight);}
else{YAHOO.util.Dom.removeClass(oNewItem,sPrehighlight);}};YAHOO.widget.AutoComplete.prototype._updateValue=function(oItem){var elTextbox=this._elTextbox;var sDelimChar=(this.delimChar)?(this.delimChar[0]||this.delimChar):null;var sSavedQuery=this._sSavedQuery;var sResultKey=oItem._sResultKey;elTextbox.focus();elTextbox.value="";if(sDelimChar){if(sSavedQuery){elTextbox.value=sSavedQuery;}
elTextbox.value+=sResultKey+sDelimChar;if(sDelimChar!=" "){elTextbox.value+=" ";}}
else{elTextbox.value=sResultKey;}
if(elTextbox.type=="textarea"){elTextbox.scrollTop=elTextbox.scrollHeight;}
var end=elTextbox.value.length;this._selectText(elTextbox,end,end);this._oCurItem=oItem;};YAHOO.widget.AutoComplete.prototype._selectItem=function(oItem){this._bItemSelected=true;this._updateValue(oItem);this._cancelIntervalDetection(this);this.itemSelectEvent.fire(this,oItem,oItem._oResultData);this._toggleContainer(false);};YAHOO.widget.AutoComplete.prototype._jumpSelection=function(){if(this._oCurItem){this._selectItem(this._oCurItem);}
else{this._toggleContainer(false);}};YAHOO.widget.AutoComplete.prototype._moveSelection=function(nKeyCode){if(this._bContainerOpen){var oCurItem=this._oCurItem;var nCurItemIndex=-1;if(oCurItem){nCurItemIndex=oCurItem._nItemIndex;}
var nNewItemIndex=(nKeyCode==40)?(nCurItemIndex+1):(nCurItemIndex-1);if(nNewItemIndex<-2||nNewItemIndex>=this._nDisplayedItems){return;}
if(oCurItem){this._toggleHighlight(oCurItem,"from");this.itemArrowFromEvent.fire(this,oCurItem);}
if(nNewItemIndex==-1){if(this.delimChar&&this._sSavedQuery){if(!this._textMatchesOption()){this._elTextbox.value=this._sSavedQuery;}
else{this._elTextbox.value=this._sSavedQuery+this._sCurQuery;}}
else{this._elTextbox.value=this._sCurQuery;}
this._oCurItem=null;return;}
if(nNewItemIndex==-2){this._toggleContainer(false);return;}
var oNewItem=this._aListItems[nNewItemIndex];var elContent=this._elContent;var scrollOn=((YAHOO.util.Dom.getStyle(elContent,"overflow")=="auto")||(YAHOO.util.Dom.getStyle(elContent,"overflowY")=="auto"));if(scrollOn&&(nNewItemIndex>-1)&&(nNewItemIndex<this._nDisplayedItems)){if(nKeyCode==40){if((oNewItem.offsetTop+oNewItem.offsetHeight)>(elContent.scrollTop+elContent.offsetHeight)){elContent.scrollTop=(oNewItem.offsetTop+oNewItem.offsetHeight)-elContent.offsetHeight;}
else if((oNewItem.offsetTop+oNewItem.offsetHeight)<elContent.scrollTop){elContent.scrollTop=oNewItem.offsetTop;}}
else{if(oNewItem.offsetTop<elContent.scrollTop){this._elContent.scrollTop=oNewItem.offsetTop;}
else if(oNewItem.offsetTop>(elContent.scrollTop+elContent.offsetHeight)){this._elContent.scrollTop=(oNewItem.offsetTop+oNewItem.offsetHeight)-elContent.offsetHeight;}}}
this._toggleHighlight(oNewItem,"to");this.itemArrowToEvent.fire(this,oNewItem);if(this.typeAhead){this._updateValue(oNewItem);}}};YAHOO.widget.AutoComplete.prototype._onItemMouseover=function(v,oSelf){if(oSelf.prehighlightClassName){oSelf._togglePrehighlight(this,"mouseover");}
else{oSelf._toggleHighlight(this,"to");}
oSelf.itemMouseOverEvent.fire(oSelf,this);};YAHOO.widget.AutoComplete.prototype._onItemMouseout=function(v,oSelf){if(oSelf.prehighlightClassName){oSelf._togglePrehighlight(this,"mouseout");}
else{oSelf._toggleHighlight(this,"from");}
oSelf.itemMouseOutEvent.fire(oSelf,this);};YAHOO.widget.AutoComplete.prototype._onItemMouseclick=function(v,oSelf){oSelf._toggleHighlight(this,"to");oSelf._selectItem(this);};YAHOO.widget.AutoComplete.prototype._onContainerMouseover=function(v,oSelf){oSelf._bOverContainer=true;};YAHOO.widget.AutoComplete.prototype._onContainerMouseout=function(v,oSelf){oSelf._bOverContainer=false;if(oSelf._oCurItem){oSelf._toggleHighlight(oSelf._oCurItem,"to");}};YAHOO.widget.AutoComplete.prototype._onContainerScroll=function(v,oSelf){oSelf._elTextbox.focus();};YAHOO.widget.AutoComplete.prototype._onContainerResize=function(v,oSelf){oSelf._toggleContainerHelpers(oSelf._bContainerOpen);};YAHOO.widget.AutoComplete.prototype._onTextboxKeyDown=function(v,oSelf){var nKeyCode=v.keyCode;switch(nKeyCode){case 9:if((navigator.userAgent.toLowerCase().indexOf("mac")==-1)){if(oSelf._oCurItem){if(oSelf.delimChar&&(oSelf._nKeyCode!=nKeyCode)){if(oSelf._bContainerOpen){YAHOO.util.Event.stopEvent(v);}}
oSelf._selectItem(oSelf._oCurItem);}
else{oSelf._toggleContainer(false);}}
break;case 13:if((navigator.userAgent.toLowerCase().indexOf("mac")==-1)){if(oSelf._oCurItem){if(oSelf._nKeyCode!=nKeyCode){if(oSelf._bContainerOpen){YAHOO.util.Event.stopEvent(v);}}
oSelf._selectItem(oSelf._oCurItem);}
else{oSelf._toggleContainer(false);}}
break;case 27:oSelf._toggleContainer(false);return;case 39:oSelf._jumpSelection();break;case 38:YAHOO.util.Event.stopEvent(v);oSelf._moveSelection(nKeyCode);break;case 40:YAHOO.util.Event.stopEvent(v);oSelf._moveSelection(nKeyCode);break;default:break;}};YAHOO.widget.AutoComplete.prototype._onTextboxKeyPress=function(v,oSelf){var nKeyCode=v.keyCode;if((navigator.userAgent.toLowerCase().indexOf("mac")!=-1)){switch(nKeyCode){case 9:if(oSelf._oCurItem){if(oSelf.delimChar&&(oSelf._nKeyCode!=nKeyCode)){if(oSelf._bContainerOpen){YAHOO.util.Event.stopEvent(v);}}
oSelf._selectItem(oSelf._oCurItem);}
else{oSelf._toggleContainer(false);}
break;case 13:if(oSelf._oCurItem){if(oSelf._nKeyCode!=nKeyCode){if(oSelf._bContainerOpen){YAHOO.util.Event.stopEvent(v);}}
oSelf._selectItem(oSelf._oCurItem);}
else{oSelf._toggleContainer(false);}
break;default:break;}}
else if(nKeyCode==229){oSelf._queryInterval=setInterval(function(){oSelf._onIMEDetected(oSelf);},500);}};YAHOO.widget.AutoComplete.prototype._onTextboxKeyUp=function(v,oSelf){oSelf._initProps();var nKeyCode=v.keyCode;oSelf._nKeyCode=nKeyCode;var sText=this.value;if(oSelf._isIgnoreKey(nKeyCode)||(sText.toLowerCase()==oSelf._sCurQuery)){return;}
else{oSelf._bItemSelected=false;YAHOO.util.Dom.removeClass(oSelf._oCurItem,oSelf.highlightClassName);oSelf._oCurItem=null;oSelf.textboxKeyEvent.fire(oSelf,nKeyCode);}
if(oSelf.queryDelay>0){var nDelayID=setTimeout(function(){oSelf._sendQuery(sText);},(oSelf.queryDelay*1000));if(oSelf._nDelayID!=-1){clearTimeout(oSelf._nDelayID);}
oSelf._nDelayID=nDelayID;}
else{oSelf._sendQuery(sText);}};YAHOO.widget.AutoComplete.prototype._onTextboxFocus=function(v,oSelf){oSelf._elTextbox.setAttribute("autocomplete","off");oSelf._bFocused=true;if(!oSelf._bItemSelected){oSelf.textboxFocusEvent.fire(oSelf);}};YAHOO.widget.AutoComplete.prototype._onTextboxBlur=function(v,oSelf){if(!oSelf._bOverContainer||(oSelf._nKeyCode==9)){if(!oSelf._bItemSelected){var oMatch=oSelf._textMatchesOption();if(!oSelf._bContainerOpen||(oSelf._bContainerOpen&&(oMatch===null))){if(oSelf.forceSelection){oSelf._clearSelection();}
else{oSelf.unmatchedItemSelectEvent.fire(oSelf);}}
else{if(oSelf.forceSelection){oSelf._selectItem(oMatch);}}}
if(oSelf._bContainerOpen){oSelf._toggleContainer(false);}
oSelf._cancelIntervalDetection(oSelf);oSelf._bFocused=false;oSelf.textboxBlurEvent.fire(oSelf);}};YAHOO.widget.AutoComplete.prototype._onWindowUnloaddisabled=function(v,oSelf){if(oSelf&&oSelf._elTextbox&&oSelf.allowBrowserAutocomplete){oSelf._elTextbox.setAttribute("autocomplete","on");}};YAHOO.widget.DataSource=function(){};YAHOO.widget.DataSource.ERROR_DATANULL="Response data was null";YAHOO.widget.DataSource.ERROR_DATAPARSE="Response data could not be parsed";YAHOO.widget.DataSource.prototype.maxCacheEntries=15;YAHOO.widget.DataSource.prototype.queryMatchContains=false;YAHOO.widget.DataSource.prototype.queryMatchSubset=false;YAHOO.widget.DataSource.prototype.queryMatchCase=false;YAHOO.widget.DataSource.prototype.toString=function(){return"DataSource "+this._sName;};YAHOO.widget.DataSource.prototype.getResults=function(oCallbackFn,sQuery,oParent){var aResults=this._doQueryCache(oCallbackFn,sQuery,oParent);if(aResults.length===0){this.queryEvent.fire(this,oParent,sQuery);this.doQuery(oCallbackFn,sQuery,oParent);}};YAHOO.widget.DataSource.prototype.doQuery=function(oCallbackFn,sQuery,oParent){};YAHOO.widget.DataSource.prototype.flushCache=function(){if(this._aCache){this._aCache=[];}
if(this._aCacheHelper){this._aCacheHelper=[];}
this.cacheFlushEvent.fire(this);};YAHOO.widget.DataSource.prototype.queryEvent=null;YAHOO.widget.DataSource.prototype.cacheQueryEvent=null;YAHOO.widget.DataSource.prototype.getResultsEvent=null;YAHOO.widget.DataSource.prototype.getCachedResultsEvent=null;YAHOO.widget.DataSource.prototype.dataErrorEvent=null;YAHOO.widget.DataSource.prototype.cacheFlushEvent=null;YAHOO.widget.DataSource._nIndex=0;YAHOO.widget.DataSource.prototype._sName=null;YAHOO.widget.DataSource.prototype._aCache=null;YAHOO.widget.DataSource.prototype._init=function(){var maxCacheEntries=this.maxCacheEntries;if(!YAHOO.lang.isNumber(maxCacheEntries)||(maxCacheEntries<0)){maxCacheEntries=0;}
if(maxCacheEntries>0&&!this._aCache){this._aCache=[];}
this._sName="instance"+YAHOO.widget.DataSource._nIndex;YAHOO.widget.DataSource._nIndex++;this.queryEvent=new YAHOO.util.CustomEvent("query",this);this.cacheQueryEvent=new YAHOO.util.CustomEvent("cacheQuery",this);this.getResultsEvent=new YAHOO.util.CustomEvent("getResults",this);this.getCachedResultsEvent=new YAHOO.util.CustomEvent("getCachedResults",this);this.dataErrorEvent=new YAHOO.util.CustomEvent("dataError",this);this.cacheFlushEvent=new YAHOO.util.CustomEvent("cacheFlush",this);};YAHOO.widget.DataSource.prototype._addCacheElem=function(oResult){var aCache=this._aCache;if(!aCache||!oResult||!oResult.query||!oResult.results){return;}
if(aCache.length>=this.maxCacheEntries){aCache.shift();}
aCache.push(oResult);};YAHOO.widget.DataSource.prototype._doQueryCache=function(oCallbackFn,sQuery,oParent){var aResults=[];var bMatchFound=false;var aCache=this._aCache;var nCacheLength=(aCache)?aCache.length:0;var bMatchContains=this.queryMatchContains;var sOrigQuery;if((this.maxCacheEntries>0)&&aCache&&(nCacheLength>0)){this.cacheQueryEvent.fire(this,oParent,sQuery);if(!this.queryMatchCase){sOrigQuery=sQuery;sQuery=sQuery.toLowerCase();}
for(var i=nCacheLength-1;i>=0;i--){var resultObj=aCache[i];var aAllResultItems=resultObj.results;var matchKey=(!this.queryMatchCase)?encodeURIComponent(resultObj.query).toLowerCase():encodeURIComponent(resultObj.query);if(matchKey==sQuery){bMatchFound=true;aResults=aAllResultItems;if(i!=nCacheLength-1){aCache.splice(i,1);this._addCacheElem(resultObj);}
break;}
else if(this.queryMatchSubset){for(var j=sQuery.length-1;j>=0;j--){var subQuery=sQuery.substr(0,j);if(matchKey==subQuery){bMatchFound=true;for(var k=aAllResultItems.length-1;k>=0;k--){var aRecord=aAllResultItems[k];var sKeyIndex=(this.queryMatchCase)?encodeURIComponent(aRecord[0]).indexOf(sQuery):encodeURIComponent(aRecord[0]).toLowerCase().indexOf(sQuery);if((!bMatchContains&&(sKeyIndex===0))||(bMatchContains&&(sKeyIndex>-1))){aResults.unshift(aRecord);}}
resultObj={};resultObj.query=sQuery;resultObj.results=aResults;this._addCacheElem(resultObj);break;}}
if(bMatchFound){break;}}}
if(bMatchFound){this.getCachedResultsEvent.fire(this,oParent,sOrigQuery,aResults);oCallbackFn(sOrigQuery,aResults,oParent);}}
return aResults;};YAHOO.widget.DS_XHR=function(sScriptURI,aSchema,oConfigs){if(oConfigs&&(oConfigs.constructor==Object)){for(var sConfig in oConfigs){this[sConfig]=oConfigs[sConfig];}}
if(!YAHOO.lang.isArray(aSchema)||!YAHOO.lang.isString(sScriptURI)){return;}
this.schema=aSchema;this.scriptURI=sScriptURI;this._init();};YAHOO.widget.DS_XHR.prototype=new YAHOO.widget.DataSource();YAHOO.widget.DS_XHR.TYPE_JSON=0;YAHOO.widget.DS_XHR.TYPE_XML=1;YAHOO.widget.DS_XHR.TYPE_FLAT=2;YAHOO.widget.DS_XHR.ERROR_DATAXHR="XHR response failed";YAHOO.widget.DS_XHR.prototype.connMgr=YAHOO.util.Connect;YAHOO.widget.DS_XHR.prototype.connTimeout=0;YAHOO.widget.DS_XHR.prototype.scriptURI=null;YAHOO.widget.DS_XHR.prototype.scriptQueryParam="query";YAHOO.widget.DS_XHR.prototype.scriptQueryAppend="";YAHOO.widget.DS_XHR.prototype.responseType=YAHOO.widget.DS_XHR.TYPE_JSON;YAHOO.widget.DS_XHR.prototype.responseStripAfter="\n<!-";YAHOO.widget.DS_XHR.prototype.doQuery=function(oCallbackFn,sQuery,oParent){var isXML=(this.responseType==YAHOO.widget.DS_XHR.TYPE_XML);var sUri=this.scriptURI+"?"+this.scriptQueryParam+"="+sQuery;if(this.scriptQueryAppend.length>0){sUri+="&"+this.scriptQueryAppend;}
var oResponse=null;var oSelf=this;var responseSuccess=function(oResp){if(!oSelf._oConn||(oResp.tId!=oSelf._oConn.tId)){oSelf.dataErrorEvent.fire(oSelf,oParent,sQuery,YAHOO.widget.DataSource.ERROR_DATANULL);return;}
for(var foo in oResp){}
if(!isXML){oResp=oResp.responseText;}
else{oResp=oResp.responseXML;}
if(oResp===null){oSelf.dataErrorEvent.fire(oSelf,oParent,sQuery,YAHOO.widget.DataSource.ERROR_DATANULL);return;}
var aResults=oSelf.parseResponse(sQuery,oResp,oParent);var resultObj={};resultObj.query=decodeURIComponent(sQuery);resultObj.results=aResults;if(aResults===null){oSelf.dataErrorEvent.fire(oSelf,oParent,sQuery,YAHOO.widget.DataSource.ERROR_DATAPARSE);aResults=[];}
else{oSelf.getResultsEvent.fire(oSelf,oParent,sQuery,aResults);oSelf._addCacheElem(resultObj);}
oCallbackFn(sQuery,aResults,oParent);};var responseFailure=function(oResp){oSelf.dataErrorEvent.fire(oSelf,oParent,sQuery,YAHOO.widget.DS_XHR.ERROR_DATAXHR);return;};var oCallback={success:responseSuccess,failure:responseFailure};if(YAHOO.lang.isNumber(this.connTimeout)&&(this.connTimeout>0)){oCallback.timeout=this.connTimeout;}
if(this._oConn){this.connMgr.abort(this._oConn);}
oSelf._oConn=this.connMgr.asyncRequest("GET",sUri,oCallback,null);};YAHOO.widget.DS_XHR.prototype.parseResponse=function(sQuery,oResponse,oParent){var aSchema=this.schema;var aResults=[];var bError=false;var nEnd=((this.responseStripAfter!=="")&&(oResponse.indexOf))?oResponse.indexOf(this.responseStripAfter):-1;if(nEnd!=-1){oResponse=oResponse.substring(0,nEnd);}
switch(this.responseType){case YAHOO.widget.DS_XHR.TYPE_JSON:var jsonList,jsonObjParsed;
if(YAHOO.lang.JSON){
  jsonObjParsed=YAHOO.lang.JSON.parse(oResponse);
  if(!jsonObjParsed){bError=true;break;}
  else{
    try{jsonList=eval("jsonObjParsed."+aSchema[0]);}
    catch(e){bError=true;break;}
  }
}else if(oResponse.parseJSON){
  jsonObjParsed=oResponse.parseJSON();
  if(!jsonObjParsed){bError=true;}
  else{
    try{jsonList=eval("jsonObjParsed."+aSchema[0]);}
    catch(e){bError=true;break;}
    }
}
else if(window.JSON){
  jsonObjParsed=JSON.parse(oResponse);
  if(!jsonObjParsed){bError=true;break;}
  else{try{jsonList=eval("jsonObjParsed."+aSchema[0]);}
  catch(e){bError=true;break;}
  }
}
else{try{while(oResponse.substring(0,1)==" "){oResponse=oResponse.substring(1,oResponse.length);}
if(oResponse.indexOf("{")<0){bError=true;break;}
if(oResponse.indexOf("{}")===0){break;}
var jsonObjRaw=eval("("+oResponse+")");if(!jsonObjRaw){bError=true;break;}
jsonList=eval("(jsonObjRaw."+aSchema[0]+")");}
catch(e){bError=true;break;}}
if(!jsonList){bError=true;break;}
if(!YAHOO.lang.isArray(jsonList)){jsonList=[jsonList];}
for(var i=jsonList.length-1;i>=0;i--){var aResultItem=[];var jsonResult=jsonList[i];for(var j=aSchema.length-1;j>=1;j--){var dataFieldValue=jsonResult[aSchema[j]];if(!dataFieldValue){dataFieldValue="";}
aResultItem.unshift(dataFieldValue);}
if(aResultItem.length==1){aResultItem.push(jsonResult);}
aResults.unshift(aResultItem);}
break;case YAHOO.widget.DS_XHR.TYPE_XML:var xmlList=oResponse.getElementsByTagName(aSchema[0]);if(!xmlList){bError=true;break;}
for(var k=xmlList.length-1;k>=0;k--){var result=xmlList.item(k);var aFieldSet=[];for(var m=aSchema.length-1;m>=1;m--){var sValue=null;var xmlAttr=result.attributes.getNamedItem(aSchema[m]);if(xmlAttr){sValue=xmlAttr.value;}
else{var xmlNode=result.getElementsByTagName(aSchema[m]);if(xmlNode&&xmlNode.item(0)&&xmlNode.item(0).firstChild){sValue=xmlNode.item(0).firstChild.nodeValue;}
else{sValue="";}}
aFieldSet.unshift(sValue);}
aResults.unshift(aFieldSet);}
break;case YAHOO.widget.DS_XHR.TYPE_FLAT:if(oResponse.length>0){var newLength=oResponse.length-aSchema[0].length;if(oResponse.substr(newLength)==aSchema[0]){oResponse=oResponse.substr(0,newLength);}
if(oResponse.length>0){var aRecords=oResponse.split(aSchema[0]);for(var n=aRecords.length-1;n>=0;n--){if(aRecords[n].length>0){aResults[n]=aRecords[n].split(aSchema[1]);}}}}
break;default:break;}
sQuery=null;oResponse=null;oParent=null;if(bError){return null;}
else{return aResults;}};YAHOO.widget.DS_XHR.prototype._oConn=null;YAHOO.widget.DS_ScriptNode=function(sUri,aSchema,oConfigs){if(oConfigs&&(oConfigs.constructor==Object)){for(var sConfig in oConfigs){this[sConfig]=oConfigs[sConfig];}}
if(!YAHOO.lang.isArray(aSchema)||!YAHOO.lang.isString(sUri)){return;}
this.schema=aSchema;this.scriptURI=sUri;this._init();};YAHOO.widget.DS_ScriptNode.prototype=new YAHOO.widget.DataSource();YAHOO.widget.DS_ScriptNode.prototype.getUtility=YAHOO.util.Get;YAHOO.widget.DS_ScriptNode.prototype.scriptURI=null;YAHOO.widget.DS_ScriptNode.prototype.scriptQueryParam="query";YAHOO.widget.DS_ScriptNode.prototype.asyncMode="allowAll";YAHOO.widget.DS_ScriptNode.prototype.scriptCallbackParam="callback";YAHOO.widget.DS_ScriptNode.callbacks=[];YAHOO.widget.DS_ScriptNode._nId=0;YAHOO.widget.DS_ScriptNode._nPending=0;YAHOO.widget.DS_ScriptNode.prototype.doQuery=function(oCallbackFn,sQuery,oParent){var oSelf=this;if(YAHOO.widget.DS_ScriptNode._nPending===0){YAHOO.widget.DS_ScriptNode.callbacks=[];YAHOO.widget.DS_ScriptNode._nId=0;}
var id=YAHOO.widget.DS_ScriptNode._nId;YAHOO.widget.DS_ScriptNode._nId++;YAHOO.widget.DS_ScriptNode.callbacks[id]=function(oResponse){if((oSelf.asyncMode!=="ignoreStaleResponses")||(id===YAHOO.widget.DS_ScriptNode.callbacks.length-1)){oSelf.handleResponse(oResponse,oCallbackFn,sQuery,oParent);}
else{}
delete YAHOO.widget.DS_ScriptNode.callbacks[id];};YAHOO.widget.DS_ScriptNode._nPending++;var sUri=this.scriptURI+"&"+this.scriptQueryParam+"="+sQuery+"&"+
this.scriptCallbackParam+"=YAHOO.widget.DS_ScriptNode.callbacks["+id+"]";this.getUtility.script(sUri,{autopurge:true,onsuccess:YAHOO.widget.DS_ScriptNode._bumpPendingDown,onfail:YAHOO.widget.DS_ScriptNode._bumpPendingDown});};YAHOO.widget.DS_ScriptNode.prototype.handleResponse=function(oResponse,oCallbackFn,sQuery,oParent){var aSchema=this.schema;var aResults=[];var bError=false;var jsonList,jsonObjParsed;try{jsonList=eval("(oResponse."+aSchema[0]+")");}
catch(e){bError=true;}
if(!jsonList){bError=true;jsonList=[];}
else if(!YAHOO.lang.isArray(jsonList)){jsonList=[jsonList];}
for(var i=jsonList.length-1;i>=0;i--){var aResultItem=[];var jsonResult=jsonList[i];for(var j=aSchema.length-1;j>=1;j--){var dataFieldValue=jsonResult[aSchema[j]];if(!dataFieldValue){dataFieldValue="";}
aResultItem.unshift(dataFieldValue);}
if(aResultItem.length==1){aResultItem.push(jsonResult);}
aResults.unshift(aResultItem);}
if(bError){aResults=null;}
if(aResults===null){this.dataErrorEvent.fire(this,oParent,sQuery,YAHOO.widget.DataSource.ERROR_DATAPARSE);aResults=[];}
else{var resultObj={};resultObj.query=decodeURIComponent(sQuery);resultObj.results=aResults;this._addCacheElem(resultObj);this.getResultsEvent.fire(this,oParent,sQuery,aResults);}
oCallbackFn(sQuery,aResults,oParent);};YAHOO.widget.DS_ScriptNode._bumpPendingDown=function(){YAHOO.widget.DS_ScriptNode._nPending--;};YAHOO.widget.DS_JSFunction=function(oFunction,oConfigs){if(oConfigs&&(oConfigs.constructor==Object)){for(var sConfig in oConfigs){this[sConfig]=oConfigs[sConfig];}}
if(!YAHOO.lang.isFunction(oFunction)){return;}
else{this.dataFunction=oFunction;this._init();}};YAHOO.widget.DS_JSFunction.prototype=new YAHOO.widget.DataSource();YAHOO.widget.DS_JSFunction.prototype.dataFunction=null;YAHOO.widget.DS_JSFunction.prototype.doQuery=function(oCallbackFn,sQuery,oParent){var oFunction=this.dataFunction;var aResults=[];aResults=oFunction(sQuery);if(aResults===null){this.dataErrorEvent.fire(this,oParent,sQuery,YAHOO.widget.DataSource.ERROR_DATANULL);return;}
var resultObj={};resultObj.query=decodeURIComponent(sQuery);resultObj.results=aResults;this._addCacheElem(resultObj);this.getResultsEvent.fire(this,oParent,sQuery,aResults);oCallbackFn(sQuery,aResults,oParent);return;};YAHOO.widget.DS_JSArray=function(aData,oConfigs){if(oConfigs&&(oConfigs.constructor==Object)){for(var sConfig in oConfigs){this[sConfig]=oConfigs[sConfig];}}
if(!YAHOO.lang.isArray(aData)){return;}
else{this.data=aData;this._init();}};YAHOO.widget.DS_JSArray.prototype=new YAHOO.widget.DataSource();YAHOO.widget.DS_JSArray.prototype.data=null;YAHOO.widget.DS_JSArray.prototype.doQuery=function(oCallbackFn,sQuery,oParent){var i;var aData=this.data;var aResults=[];var bMatchFound=false;var bMatchContains=this.queryMatchContains;if(sQuery){if(!this.queryMatchCase){sQuery=sQuery.toLowerCase();}
for(i=aData.length-1;i>=0;i--){var aDataset=[];if(YAHOO.lang.isString(aData[i])){aDataset[0]=aData[i];}
else if(YAHOO.lang.isArray(aData[i])){aDataset=aData[i];}
if(YAHOO.lang.isString(aDataset[0])){var sKeyIndex=(this.queryMatchCase)?encodeURIComponent(aDataset[0]).indexOf(sQuery):encodeURIComponent(aDataset[0]).toLowerCase().indexOf(sQuery);if((!bMatchContains&&(sKeyIndex===0))||(bMatchContains&&(sKeyIndex>-1))){aResults.unshift(aDataset);}}}}
else{for(i=aData.length-1;i>=0;i--){if(YAHOO.lang.isString(aData[i])){aResults.unshift([aData[i]]);}
else if(YAHOO.lang.isArray(aData[i])){aResults.unshift(aData[i]);}}}
this.getResultsEvent.fire(this,oParent,sQuery,aResults);oCallbackFn(sQuery,aResults,oParent);};YAHOO.register("autocomplete",YAHOO.widget.AutoComplete,{version:"2.5.2",build:"1076"});

YAHOO.widget.MultiAutoComplete=function(elInput,elContainer,oDataSources,oConfigs){if(elInput&&elContainer&&oDataSources){if(oDataSources)
{for(var i=0;i<oDataSources.length;i++)
{if(!(oDataSources[i]instanceof YAHOO.widget.DataSource))
{return;}}
this.dataSources=oDataSources;}
else{return;}
if(YAHOO.util.Dom.inDocument(elInput)){if(typeof elInput=="string"){this._sName="instance"+YAHOO.widget.MultiAutoComplete._nIndex+" "+elInput;this._oTextbox=document.getElementById(elInput);}
else{this._sName=(elInput.id)?"instance"+YAHOO.widget.MultiAutoComplete._nIndex+" "+elInput.id:"instance"+YAHOO.widget.MultiAutoComplete._nIndex;this._oTextbox=elInput;}}
else{return;}
if(YAHOO.util.Dom.inDocument(elContainer)){if(typeof elContainer=="string"){this._oContainer=document.getElementById(elContainer);}
else{this._oContainer=elContainer;}
if(this._oContainer.style.display=="none"){}}
else{return;}
if(typeof oConfigs=="object"){for(var sConfig in oConfigs){if(sConfig){this[sConfig]=oConfigs[sConfig];}}}
this._initContainer();this._initProps();this._initList();this._initContainerHelpers();var oSelf=this;var oTextbox=this._oTextbox;var oContent=this._oContainer._oContent;YAHOO.util.Event.addListener(oTextbox,"keyup",oSelf._onTextboxKeyUp,oSelf);YAHOO.util.Event.addListener(oTextbox,"keydown",oSelf._onTextboxKeyDown,oSelf);YAHOO.util.Event.addListener(oTextbox,"focus",oSelf._onTextboxFocus,oSelf);YAHOO.util.Event.addListener(oTextbox,"blur",oSelf._onTextboxBlur,oSelf);YAHOO.util.Event.addListener(oContent,"mouseover",oSelf._onContainerMouseover,oSelf);YAHOO.util.Event.addListener(oContent,"mouseout",oSelf._onContainerMouseout,oSelf);YAHOO.util.Event.addListener(oContent,"scroll",oSelf._onContainerScroll,oSelf);YAHOO.util.Event.addListener(oContent,"resize",oSelf._onContainerResize,oSelf);if(oTextbox.form){YAHOO.util.Event.addListener(oTextbox.form,"submit",oSelf._onFormSubmit,oSelf);}
YAHOO.util.Event.addListener(oTextbox,"keypress",oSelf._onTextboxKeyPress,oSelf);this.textboxFocusEvent=new YAHOO.util.CustomEvent("textboxFocus",this);this.textboxKeyEvent=new YAHOO.util.CustomEvent("textboxKey",this);this.dataRequestEvent=new YAHOO.util.CustomEvent("dataRequest",this);this.dataReturnEvent=new YAHOO.util.CustomEvent("dataReturn",this);this.dataErrorEvent=new YAHOO.util.CustomEvent("dataError",this);this.containerExpandEvent=new YAHOO.util.CustomEvent("containerExpand",this);this.typeAheadEvent=new YAHOO.util.CustomEvent("typeAhead",this);this.itemMouseOverEvent=new YAHOO.util.CustomEvent("itemMouseOver",this);this.itemMouseOutEvent=new YAHOO.util.CustomEvent("itemMouseOut",this);this.itemArrowToEvent=new YAHOO.util.CustomEvent("itemArrowTo",this);this.itemArrowFromEvent=new YAHOO.util.CustomEvent("itemArrowFrom",this);this.itemSelectEvent=new YAHOO.util.CustomEvent("itemSelect",this);this.unmatchedItemSelectEvent=new YAHOO.util.CustomEvent("unmatchedItemSelect",this);this.selectionEnforceEvent=new YAHOO.util.CustomEvent("selectionEnforce",this);this.containerCollapseEvent=new YAHOO.util.CustomEvent("containerCollapse",this);this.textboxBlurEvent=new YAHOO.util.CustomEvent("textboxBlur",this);oTextbox.setAttribute("autocomplete","off");YAHOO.widget.MultiAutoComplete._nIndex++;}
else{}};YAHOO.widget.MultiAutoComplete.prototype.dataSources=null;YAHOO.widget.MultiAutoComplete.prototype.minQueryLength=1;YAHOO.widget.MultiAutoComplete.prototype.maxResultsDisplayed=10;YAHOO.widget.MultiAutoComplete.prototype.queryDelay=0.5;YAHOO.widget.MultiAutoComplete.prototype.highlightClassName="yui-ac-highlight";YAHOO.widget.MultiAutoComplete.prototype.prehighlightClassName=null;YAHOO.widget.MultiAutoComplete.prototype.delimChar=null;YAHOO.widget.MultiAutoComplete.prototype.autoHighlight=true;YAHOO.widget.MultiAutoComplete.prototype.typeAhead=false;YAHOO.widget.MultiAutoComplete.prototype.animHoriz=false;YAHOO.widget.MultiAutoComplete.prototype.animVert=true;YAHOO.widget.MultiAutoComplete.prototype.animSpeed=0.3;YAHOO.widget.MultiAutoComplete.prototype.forceSelection=false;YAHOO.widget.MultiAutoComplete.prototype.allowBrowserAutocomplete=true;YAHOO.widget.MultiAutoComplete.prototype.alwaysShowContainer=false;YAHOO.widget.MultiAutoComplete.prototype.useIFrame=false;YAHOO.widget.MultiAutoComplete.prototype.useShadow=false;YAHOO.widget.MultiAutoComplete.prototype.toString=function(){return"AutoComplete "+this._sName;};YAHOO.widget.MultiAutoComplete.prototype.isContainerOpen=function(){return this._bContainerOpen;};YAHOO.widget.MultiAutoComplete.prototype.getListItems=function(){return this._aListItems;};YAHOO.widget.MultiAutoComplete.prototype.getListItemData=function(oListItem){if(oListItem._oResultData){return oListItem._oResultData;}
else{return false;}};YAHOO.widget.MultiAutoComplete.prototype.setHeader=function(sHeader){if(sHeader){if(this._oContainer._oContent._oHeader){this._oContainer._oContent._oHeader.innerHTML=sHeader;this._oContainer._oContent._oHeader.style.display="block";}}
else{this._oContainer._oContent._oHeader.innerHTML="";this._oContainer._oContent._oHeader.style.display="none";}};YAHOO.widget.MultiAutoComplete.prototype.setSubHeader=function(sHeader,index){if(sHeader){if(this._oContainer._oContent._oSubHeaders[index]){this._oContainer._oContent._oSubHeaders[index].innerHTML=sHeader;this._oContainer._oContent._oSubHeaders[index].style.display="block";}}
else{if(this._oContainer._oContent._oSubHeaders[index]){this._oContainer._oContent._oSubHeaders[index].innerHTML="";this._oContainer._oContent._oSubHeaders[index].style.display="none";}}};YAHOO.widget.MultiAutoComplete.prototype.setFooter=function(sFooter){if(sFooter){if(this._oContainer._oContent._oFooter){this._oContainer._oContent._oFooter.innerHTML=sFooter;this._oContainer._oContent._oFooter.style.display="block";}}
else{this._oContainer._oContent._oFooter.innerHTML="";this._oContainer._oContent._oFooter.style.display="none";}};YAHOO.widget.MultiAutoComplete.prototype.setSubFooter=function(sFooter,index){if(sFooter){if(this._oContainer._oContent._oSubFooters[index]){this._oContainer._oContent._oSubFooters[index].innerHTML=sFooter;this._oContainer._oContent._oSubFooters[index].style.display="block";}}
else{if(this._oContainer._oContent._oSubFooters[index]){this._oContainer._oContent._oSubFooters[index].innerHTML="";this._oContainer._oContent._oSubFooters[index].style.display="none";}}};YAHOO.widget.MultiAutoComplete.prototype.toggleSubHeader=function(show,index)
{if(this._oContainer._oContent._oSubHeaders[index])
{if(show===true){this._oContainer._oContent._oSubHeaders[index].style.display="block";} else {this._oContainer._oContent._oSubHeaders[index].style.display="none";}}};YAHOO.widget.MultiAutoComplete.prototype.setBody=function(sBody){if(sBody){if(this._oContainer._oContent._oBody){this._oContainer._oContent._oBody.innerHTML=sBody;this._oContainer._oContent._oBody.style.display="block";this._oContainer._oContent.style.display="block";}}
else{this._oContainer._oContent._oBody.innerHTML="";this._oContainer._oContent.style.display="none";}
this._maxResultsDisplayed=0;};YAHOO.widget.MultiAutoComplete.prototype.formatResult=function(oResultItem,sQuery){var sResult=oResultItem[0];if(sResult){return sResult;}
else{return"";}};YAHOO.widget.MultiAutoComplete.prototype.doBeforeExpandContainer=function(oResultItem,sQuery){return true;};YAHOO.widget.MultiAutoComplete.prototype.sendQuery=function(sQuery){this._sendQuery(sQuery);};YAHOO.widget.MultiAutoComplete.prototype.textboxFocusEvent=null;YAHOO.widget.MultiAutoComplete.prototype.textboxKeyEvent=null;YAHOO.widget.MultiAutoComplete.prototype.dataRequestEvent=null;YAHOO.widget.MultiAutoComplete.prototype.dataReturnEvent=null;YAHOO.widget.MultiAutoComplete.prototype.dataErrorEvent=null;YAHOO.widget.MultiAutoComplete.prototype.containerExpandEvent=null;YAHOO.widget.MultiAutoComplete.prototype.typeAheadEvent=null;YAHOO.widget.MultiAutoComplete.prototype.itemMouseOverEvent=null;YAHOO.widget.MultiAutoComplete.prototype.itemMouseOutEvent=null;YAHOO.widget.MultiAutoComplete.prototype.itemArrowToEvent=null;YAHOO.widget.MultiAutoComplete.prototype.itemArrowFromEvent=null;YAHOO.widget.MultiAutoComplete.prototype.itemSelectEvent=null;YAHOO.widget.MultiAutoComplete.prototype.unmatchedItemSelectEvent=null;YAHOO.widget.MultiAutoComplete.prototype.selectionEnforceEvent=null;YAHOO.widget.MultiAutoComplete.prototype.containerCollapseEvent=null;YAHOO.widget.MultiAutoComplete.prototype.textboxBlurEvent=null;YAHOO.widget.MultiAutoComplete._nIndex=0;YAHOO.widget.MultiAutoComplete.prototype._sName=null;YAHOO.widget.MultiAutoComplete.prototype._oTextbox=null;YAHOO.widget.MultiAutoComplete.prototype._bFocused=true;YAHOO.widget.MultiAutoComplete.prototype._oAnim=null;YAHOO.widget.MultiAutoComplete.prototype._oContainer=null;YAHOO.widget.MultiAutoComplete.prototype._bContainerOpen=false;YAHOO.widget.MultiAutoComplete.prototype._bOverContainer=false;YAHOO.widget.MultiAutoComplete.prototype._aListItems=null;YAHOO.widget.MultiAutoComplete.prototype._nDisplayedItems=0;YAHOO.widget.MultiAutoComplete.prototype._maxResultsDisplayed=0;YAHOO.widget.MultiAutoComplete.prototype._sCurQuery=null;YAHOO.widget.MultiAutoComplete.prototype._sSavedQuery=null;YAHOO.widget.MultiAutoComplete.prototype._oCurItem=null;YAHOO.widget.MultiAutoComplete.prototype._bItemSelected=false;YAHOO.widget.MultiAutoComplete.prototype._nKeyCode=null;YAHOO.widget.MultiAutoComplete.prototype._nDelayID=-1;YAHOO.widget.MultiAutoComplete.prototype._iFrameSrc="javascript:false;";YAHOO.widget.MultiAutoComplete.prototype._queryInterval=null;YAHOO.widget.MultiAutoComplete.prototype._sLastTextboxValue=null;YAHOO.widget.MultiAutoComplete.prototype._initProps=function(){var minQueryLength=this.minQueryLength;if(isNaN(minQueryLength)||(minQueryLength<1)){minQueryLength=1;}
var maxResultsDisplayed=this.maxResultsDisplayed;if(isNaN(this.maxResultsDisplayed)||(this.maxResultsDisplayed<1)){this.maxResultsDisplayed=10;}
var queryDelay=this.queryDelay;if(isNaN(this.queryDelay)||(this.queryDelay<0)){this.queryDelay=0.5;}
var aDelimChar=(this.delimChar)?this.delimChar:null;if(aDelimChar){if(typeof aDelimChar=="string"){this.delimChar=[aDelimChar];}
else if(aDelimChar.constructor!=Array){this.delimChar=null;}}
var animSpeed=this.animSpeed;if((this.animHoriz||this.animVert)&&YAHOO.util.Anim){if(isNaN(animSpeed)||(animSpeed<0)){animSpeed=0.3;}
if(!this._oAnim){oAnim=new YAHOO.util.Anim(this._oContainer._oContent,{},this.animSpeed);this._oAnim=oAnim;}
else{this._oAnim.duration=animSpeed;}}
if(this.forceSelection&&this.delimChar){}};YAHOO.widget.MultiAutoComplete.prototype._initContainerHelpers=function(){if(this.useShadow&&!this._oContainer._oShadow){var oShadow=document.createElement("div");oShadow.className="yui-ac-shadow";this._oContainer._oShadow=this._oContainer.appendChild(oShadow);}
if(this.useIFrame&&!this._oContainer._oIFrame){var oIFrame=document.createElement("iframe");oIFrame.src=this._iFrameSrc;oIFrame.frameBorder=0;oIFrame.scrolling="no";oIFrame.style.position="absolute";oIFrame.style.width="100%";oIFrame.style.height="100%";oIFrame.tabIndex=-1;this._oContainer._oIFrame=this._oContainer.appendChild(oIFrame);}};YAHOO.widget.MultiAutoComplete.prototype._initContainer=function(){if(!this._oContainer._oContent){var oContent=document.createElement("div");oContent.className="yui-ac-content";oContent.style.display="none";this._oContainer._oContent=this._oContainer.appendChild(oContent);var oHeader=document.createElement("div");oHeader.className="yui-ac-hd";oHeader.style.display="none";this._oContainer._oContent._oHeader=this._oContainer._oContent.appendChild(oHeader);this._oContainer._oContent._oSubHeaders=new Array();this._oContainer._oContent._oBodys=new Array();this._oContainer._oContent._oSubFooters=new Array();for(var i=0;i<this.dataSources.length;i++)
{var oSubHeader=document.createElement("div");oSubHeader.className="yui-ac-hd-sub";oSubHeader.style.display="none";this._oContainer._oContent._oSubHeaders.push(this._oContainer._oContent.appendChild(oSubHeader));var oBody=document.createElement("div");oBody.className="yui-ac-bd";this._oContainer._oContent._oBodys.push(this._oContainer._oContent.appendChild(oBody));var oSubFooter=document.createElement("div");oSubFooter.className="yui-ac-ft-sub";oSubFooter.style.display="none";this._oContainer._oContent._oSubFooters.push(this._oContainer._oContent.appendChild(oSubFooter));}
var oFooter=document.createElement("div");oFooter.className="yui-ac-ft";oFooter.style.display="none";this._oContainer._oContent._oFooter=this._oContainer._oContent.appendChild(oFooter);}
else{}};YAHOO.widget.MultiAutoComplete.prototype._initList=function(){this._aListItems=[];for(var i=0;i<this._oContainer._oContent._oBodys.length;i++)
{while(this._oContainer._oContent._oBodys[i].hasChildNodes()){var oldListItems=this.getListItems()[i];if(oldListItems){for(var oldi=oldListItems.length-1;oldi>=0;oldi--){oldListItems[oldi]=null;}}
this._oContainer._oContent._oBodys[i].innerHTML="";}}
for(var i=0;i<this._oContainer._oContent._oBodys.length;i++)
{this._aListItems[i]=[]
var oList=document.createElement("ul");oList=this._oContainer._oContent._oBodys[i].appendChild(oList);for(var j=0;j<this.maxResultsDisplayed;j++){var oItem=document.createElement("li");oItem=oList.appendChild(oItem);this._aListItems[i][j]=oItem;this._initListItem(oItem,j,i);}}
this._maxResultsDisplayed=this.maxResultsDisplayed;};YAHOO.widget.MultiAutoComplete.prototype._initSubList=function(iIndex){while(this._oContainer._oContent._oBodys[iIndex].hasChildNodes()){var oldListItems=this.getListItems()[iIndex];if(oldListItems){for(var oldi=oldListItems.length-1;oldi>=0;oldi--){oldListItems[oldi]=null;}}
this._oContainer._oContent._oBodys[iIndex].innerHTML="";}
this._aListItems[iIndex]=[]
var oList=document.createElement("ul");oList=this._oContainer._oContent._oBodys[iIndex].appendChild(oList);for(var j=0;j<this.maxResultsDisplayed;j++){var oItem=document.createElement("li");oItem=oList.appendChild(oItem);this._aListItems[iIndex][j]=oItem;
this._initListItem(oItem,j,iIndex);}};
YAHOO.widget.MultiAutoComplete.prototype._initListItem=function(oItem,nItemIndex,nDataSourceIndex){
var oSelf=this;oItem.style.display="none";
oItem._nItemIndex=nItemIndex;
oItem._nDataSourceIndex=nDataSourceIndex;
oItem.mouseover=oItem.mouseout=oItem.onclick=null;
YAHOO.util.Event.addListener(oItem,"mouseover",oSelf._onItemMouseover,oSelf);
YAHOO.util.Event.addListener(oItem,"mouseout",oSelf._onItemMouseout,oSelf);
YAHOO.util.Event.addListener(oItem,"click",oSelf._onItemMouseclick,oSelf);};
YAHOO.widget.MultiAutoComplete.prototype._onIMEDetected=function(oSelf){oSelf._enableIntervalDetection();};
YAHOO.widget.MultiAutoComplete.prototype._enableIntervalDetection=function(){var currValue=this._oTextbox.value;var lastValue=this._sLastTextboxValue;if(currValue!=lastValue){this._sLastTextboxValue=currValue;this._sendQuery(currValue);}};YAHOO.widget.MultiAutoComplete.prototype._cancelIntervalDetection=function(oSelf){if(oSelf._queryInterval){clearInterval(oSelf._queryInterval);}};YAHOO.widget.MultiAutoComplete.prototype._isIgnoreKey=function(nKeyCode){if((nKeyCode==9)||(nKeyCode==13)||(nKeyCode==16)||(nKeyCode==17)||(nKeyCode>=18&&nKeyCode<=20)||(nKeyCode==27)||(nKeyCode>=33&&nKeyCode<=35)||(nKeyCode>=36&&nKeyCode<=38)||(nKeyCode==40)||(nKeyCode>=44&&nKeyCode<=45)){return true;}
return false;};YAHOO.widget.MultiAutoComplete.prototype._sendQuery=function(sQuery){if(this.minQueryLength==-1){this._toggleContainer(false);return;}
var aDelimChar=(this.delimChar)?this.delimChar:null;if(aDelimChar){var nDelimIndex=-1;for(var i=aDelimChar.length-1;i>=0;i--){var nNewIndex=sQuery.lastIndexOf(aDelimChar[i]);if(nNewIndex>nDelimIndex){nDelimIndex=nNewIndex;}}
if(aDelimChar[i]==" "){for(var j=aDelimChar.length-1;j>=0;j--){if(sQuery[nDelimIndex-1]==aDelimChar[j]){nDelimIndex--;break;}}}
if(nDelimIndex>-1){var nQueryStart=nDelimIndex+1;while(sQuery.charAt(nQueryStart)==" "){nQueryStart+=1;}
this._sSavedQuery=sQuery.substring(0,nQueryStart);sQuery=sQuery.substr(nQueryStart);}
else if(sQuery.indexOf(this._sSavedQuery)<0){this._sSavedQuery=null;}}
if(sQuery&&(sQuery.length<this.minQueryLength)||(!sQuery&&this.minQueryLength>0)){if(this._nDelayID!=-1){clearTimeout(this._nDelayID);}
this._toggleContainer(false);return;}
sQuery=encodeURIComponent(sQuery);this._nDelayID=-1;this.dataRequestEvent.fire(this,sQuery);this._waitingToPopulate=new Array();this._nDisplayedItems=0;for(var i=0;i<this.dataSources.length;i++)
{this.dataSources[i].getResults(this._populateStaging,sQuery,this);}};YAHOO.widget.MultiAutoComplete.prototype._waitingToPopulate=new Array();
YAHOO.widget.MultiAutoComplete.prototype._populateStaging=function(sQuery,aResults,oSelf,iIndex){
if(oSelf._waitingToPopulate.length==oSelf.dataSources.length-1){for(var i=0;i<oSelf._waitingToPopulate.length;i++){
if(oSelf._waitingToPopulate[i]!=null){oSelf._populateList(oSelf._waitingToPopulate[i].query,oSelf._waitingToPopulate[i].results,oSelf._waitingToPopulate[i].self,oSelf._waitingToPopulate[i].index);}
}
if(aResults!=null){oSelf._populateList(sQuery,aResults,oSelf,iIndex);}}
else{if(aResults==null){oSelf._waitingToPopulate.push(null);}else
{oSelf._waitingToPopulate.push({query:sQuery,results:aResults,self:oSelf,index:iIndex});}}}
YAHOO.widget.MultiAutoComplete.prototype._populateList=function(sQuery,aResults,oSelf,iIndex){if(aResults===null){oSelf.dataErrorEvent.fire(oSelf,sQuery);}
if(!oSelf._bFocused||!aResults){return;}
var isOpera=(navigator.userAgent.toLowerCase().indexOf("opera")!=-1);var contentStyle=oSelf._oContainer._oContent.style;contentStyle.width=(!isOpera)?null:"";contentStyle.height=(!isOpera)?null:"";var sCurQuery=decodeURIComponent(sQuery);oSelf._sCurQuery=sCurQuery;oSelf._bItemSelected=false;if(oSelf._maxResultsDisplayed!=oSelf.maxResultsDisplayed){oSelf._initList();}
var nItems=Math.min(aResults.length,oSelf.maxResultsDisplayed);oSelf._nDisplayedItems+=nItems;if(nItems>0){oSelf._initContainerHelpers();oSelf.toggleSubHeader(true,iIndex);var aItems=oSelf._aListItems[iIndex];for(var i=nItems-1;i>=0;i--){var oItemi=aItems[i];var oResultItemi=aResults[i];
oItemi.innerHTML=oSelf.formatResult(oResultItemi,sCurQuery,iIndex);
oItemi.style.display="list-item";
oItemi._sResultKey=oResultItemi[0];
oItemi._oResultData=oResultItemi;}
for(var j=aItems.length-1;j>=nItems;j--){var oItemj=aItems[j];oItemj.innerHTML=null;
oItemj.style.display="none";
oItemj._sResultKey=null;
oItemj._oResultData=null;}
if(oSelf.autoHighlight){var oFirstItem=aItems[0];oSelf._toggleHighlight(oFirstItem,"to");oSelf.itemArrowToEvent.fire(oSelf,oFirstItem);oSelf._typeAhead(oFirstItem,sQuery);}
else{this._toggleHighlight();
oSelf._oCurItem=null;}
if(!this._bContainerOpen)
{var ok=oSelf.doBeforeExpandContainer(oSelf._oTextbox,oSelf._oContainer,sQuery,aResults);oSelf._toggleContainer(ok);}}
else if(nItems==0)
{oSelf.toggleSubHeader(false,iIndex);
oSelf._initSubList(iIndex);}
if(oSelf._nDisplayedItems==0){oSelf._toggleContainer(false);}
oSelf.dataReturnEvent.fire(oSelf,sQuery,aResults,iIndex);};YAHOO.widget.MultiAutoComplete.prototype._clearSelection=function(){var sValue=this._oTextbox.value;var sChar=(this.delimChar)?this.delimChar[0]:null;var nIndex=(sChar)?sValue.lastIndexOf(sChar,sValue.length-2):-1;
if(nIndex>-1){this._oTextbox.value=sValue.substring(0,nIndex);}
else{this._oTextbox.value="";}
this._sSavedQuery=this._oTextbox.value;this.selectionEnforceEvent.fire(this);};
YAHOO.widget.MultiAutoComplete.prototype._textMatchesOption=function(){var foundMatch=false;for(var j=0;j<this._aListItems.length;j++)
{for(var i=this._nDisplayedItems-1;i>=0;i--){var oItem=this._aListItems[j][i];if(oItem==null||oItem._sResultKey==null) {
  continue;
}var sMatch=oItem._sResultKey.toLowerCase();if(sMatch==this._sCurQuery.toLowerCase()){foundMatch=true;break;}}}
return(foundMatch);};
YAHOO.widget.MultiAutoComplete.prototype._typeAhead=function(oItem,sQuery){if(!this.typeAhead||(this._nKeyCode==8)){return;}
var oTextbox=this._oTextbox;
var sValue=this._oTextbox.value;if(!oTextbox.setSelectionRange&&!oTextbox.createTextRange){return;}
var nStart=sValue.length;this._updateValue(oItem);var nEnd=oTextbox.value.length;this._selectText(oTextbox,nStart,nEnd);var sPrefill=oTextbox.value.substr(nStart,nEnd);this.typeAheadEvent.fire(this,sQuery,sPrefill);};
YAHOO.widget.MultiAutoComplete.prototype._selectText=function(oTextbox,nStart,nEnd){if(oTextbox.setSelectionRange){oTextbox.setSelectionRange(nStart,nEnd);}
else if(oTextbox.createTextRange){var oTextRange=oTextbox.createTextRange();oTextRange.moveStart("character",nStart);oTextRange.moveEnd("character",nEnd-oTextbox.value.length);oTextRange.select();}
else{oTextbox.select();}};
YAHOO.widget.MultiAutoComplete.prototype._toggleContainerHelpers=function(bShow){var bFireEvent=false;var width=this._oContainer._oContent.offsetWidth+"px";var height=this._oContainer._oContent.offsetHeight+"px";if(this.useIFrame&&this._oContainer._oIFrame){bFireEvent=true;if(bShow){this._oContainer._oIFrame.style.width=width;this._oContainer._oIFrame.style.height=height;}
else{this._oContainer._oIFrame.style.width=0;this._oContainer._oIFrame.style.height=0;}}
if(this.useShadow&&this._oContainer._oShadow){bFireEvent=true;if(bShow){this._oContainer._oShadow.style.width=width;this._oContainer._oShadow.style.height=height;}
else{this._oContainer._oShadow.style.width=0;this._oContainer._oShadow.style.height=0;}}};
YAHOO.widget.MultiAutoComplete.prototype._toggleContainer=function(bShow){var oContainer=this._oContainer;if(this.alwaysShowContainer&&this._bContainerOpen){return;}
if(!bShow){this._oContainer._oContent.scrollTop=0;for(var i=0;i<this._aListItems.length;i++)
{var aItems=this._aListItems[i];if(aItems&&(aItems.length>0)){for(var j=aItems.length-1;j>=0;j--){aItems[j].style.display="none";}}
if(this._oCurItem){this._toggleHighlight(this._oCurItem,"from");}
this._oCurItem=null;this._nDisplayedItems=0;this._sCurQuery=null;}}
if(!bShow&&!this._bContainerOpen){oContainer._oContent.style.display="none";return;}
var oAnim=this._oAnim;if(oAnim&&oAnim.getEl()&&(this.animHoriz||this.animVert)){if(!bShow){this._toggleContainerHelpers(bShow);}
if(oAnim.isAnimated()){oAnim.stop();}
var oClone=oContainer._oContent.cloneNode(true);oContainer.appendChild(oClone);oClone.style.top="-9000px";oClone.style.display="block";var wExp=oClone.offsetWidth;var hExp=oClone.offsetHeight;var wColl=(this.animHoriz)?0:wExp;var hColl=(this.animVert)?0:hExp;oAnim.attributes=(bShow)?{width:{to:wExp},height:{to:hExp}}:{width:{to:wColl},height:{to:hColl}};if(bShow&&!this._bContainerOpen){oContainer._oContent.style.width=wColl+"px";oContainer._oContent.style.height=hColl+"px";}
else{oContainer._oContent.style.width=wExp+"px";oContainer._oContent.style.height=hExp+"px";}
oContainer.removeChild(oClone);oClone=null;var oSelf=this;var onAnimComplete=function(){oAnim.onComplete.unsubscribeAll();if(bShow){oSelf.containerExpandEvent.fire(oSelf);}
else{oContainer._oContent.style.display="none";oSelf.containerCollapseEvent.fire(oSelf);}
oSelf._toggleContainerHelpers(bShow);};oContainer._oContent.style.display="block";oAnim.onComplete.subscribe(onAnimComplete);oAnim.animate();this._bContainerOpen=bShow;}
else{if(bShow){oContainer._oContent.style.display="block";this.containerExpandEvent.fire(this);}
else{oContainer._oContent.style.display="none";this.containerCollapseEvent.fire(this);}
this._toggleContainerHelpers(bShow);this._bContainerOpen=bShow;}};YAHOO.widget.MultiAutoComplete.prototype._toggleHighlight=function(oNewItem,sType){var sHighlight=this.highlightClassName;if(this._oCurItem){YAHOO.util.Dom.removeClass(this._oCurItem,sHighlight);}
if((sType=="to")&&sHighlight){YAHOO.util.Dom.addClass(oNewItem,sHighlight);this._oCurItem=oNewItem;}};YAHOO.widget.MultiAutoComplete.prototype._togglePrehighlight=function(oNewItem,sType){if(oNewItem==this._oCurItem){return;}
var sPrehighlight=this.prehighlightClassName;if((sType=="mouseover")&&sPrehighlight){YAHOO.util.Dom.addClass(oNewItem,sPrehighlight);}
else{YAHOO.util.Dom.removeClass(oNewItem,sPrehighlight);}};YAHOO.widget.MultiAutoComplete.prototype._updateValue=function(oItem){var oTextbox=this._oTextbox;var sDelimChar=(this.delimChar)?(this.delimChar[0]||this.delimChar):null;var sSavedQuery=this._sSavedQuery;var sResultKey=oItem._sResultKey;oTextbox.focus();oTextbox.value="";if(sDelimChar){if(sSavedQuery){oTextbox.value=sSavedQuery;}
oTextbox.value+=sResultKey+sDelimChar;if(sDelimChar!=" "){oTextbox.value+=" ";}}
else{oTextbox.value=sResultKey;}
if(oTextbox.type=="textarea"){oTextbox.scrollTop=oTextbox.scrollHeight;}
var end=oTextbox.value.length;this._selectText(oTextbox,end,end);this._oCurItem=oItem;};YAHOO.widget.MultiAutoComplete.prototype._selectItem=function(oItem){this._bItemSelected=true;this._updateValue(oItem);this._cancelIntervalDetection(this);this.itemSelectEvent.fire(this,oItem,oItem._oResultData);this._toggleContainer(false);};YAHOO.widget.MultiAutoComplete.prototype._jumpSelection=function(){if(!this.typeAhead){return;}
else{this._toggleContainer(false);}};YAHOO.widget.MultiAutoComplete.prototype._moveSelection=function(nKeyCode){if(this._bContainerOpen){var oCurItem=this._oCurItem;var nCurItemIndex=-1;if(oCurItem){if(oCurItem._nDataSourceIndex==0){nCurItemIndex=oCurItem._nItemIndex;}
else{var step=this.maxResultsDisplayed;for(var i=this._aListItems[oCurItem._nDataSourceIndex-1].length-1;i>=0;i--)
{if(this._aListItems[oCurItem._nDataSourceIndex-1][i]._oResultData!=null) {
  break;
}step--;}
nCurItemIndex=oCurItem._nItemIndex+step;}}
var nNewItemIndex=(nKeyCode==40)?(nCurItemIndex+1):(nCurItemIndex-1);if(nNewItemIndex<-2||nNewItemIndex>=this._nDisplayedItems){return;}
if(oCurItem){this._toggleHighlight(oCurItem,"from");this.itemArrowFromEvent.fire(this,oCurItem);}
if(nNewItemIndex==-1){if(this.delimChar&&this._sSavedQuery){if(!this._textMatchesOption()){this._oTextbox.value=this._sSavedQuery;}
else{this._oTextbox.value=this._sSavedQuery+this._sCurQuery;}}
else{this._oTextbox.value=this._sCurQuery;}
this._oCurItem=null;return;}
if(nNewItemIndex==-2){this._toggleContainer(false);return;}
var merged=new Array();for(var i=0;i<this._aListItems.length;i++)
{for(var j=0;j<this._aListItems[i].length;j++)
{if(this._aListItems[i][j]._oResultData==null) {
  break;
}merged.push(this._aListItems[i][j]);}}
var oNewItem=merged[nNewItemIndex];var oContent=this._oContainer._oContent;var scrollOn=((YAHOO.util.Dom.getStyle(oContent,"overflow")=="auto")||(YAHOO.util.Dom.getStyle(oContent,"overflowY")=="auto"));if(scrollOn&&(nNewItemIndex>-1)&&(nNewItemIndex<this._nDisplayedItems)){if(nKeyCode==40){if((oNewItem.offsetTop+oNewItem.offsetHeight)>(oContent.scrollTop+oContent.offsetHeight)){oContent.scrollTop=(oNewItem.offsetTop+oNewItem.offsetHeight)-oContent.offsetHeight;}
else if((oNewItem.offsetTop+oNewItem.offsetHeight)<oContent.scrollTop){oContent.scrollTop=oNewItem.offsetTop;}}
else{if(oNewItem.offsetTop<oContent.scrollTop){this._oContainer._oContent.scrollTop=oNewItem.offsetTop;}
else if(oNewItem.offsetTop>(oContent.scrollTop+oContent.offsetHeight)){this._oContainer._oContent.scrollTop=(oNewItem.offsetTop+oNewItem.offsetHeight)-oContent.offsetHeight;}}}
this._toggleHighlight(oNewItem,"to");this.itemArrowToEvent.fire(this,oNewItem);if(this.typeAhead){this._updateValue(oNewItem);}}};YAHOO.widget.MultiAutoComplete.prototype._onItemMouseover=function(v,oSelf){if(oSelf.prehighlightClassName){oSelf._togglePrehighlight(this,"mouseover");}
else{oSelf._toggleHighlight(this,"to");}
oSelf.itemMouseOverEvent.fire(oSelf,this);};YAHOO.widget.MultiAutoComplete.prototype._onItemMouseout=function(v,oSelf){if(oSelf.prehighlightClassName){oSelf._togglePrehighlight(this,"mouseout");}
else{oSelf._toggleHighlight(this,"from");}
oSelf.itemMouseOutEvent.fire(oSelf,this);};YAHOO.widget.MultiAutoComplete.prototype._onItemMouseclick=function(v,oSelf){oSelf._toggleHighlight(this,"to");oSelf._selectItem(this);};YAHOO.widget.MultiAutoComplete.prototype._onContainerMouseover=function(v,oSelf){oSelf._bOverContainer=true;};YAHOO.widget.MultiAutoComplete.prototype._onContainerMouseout=function(v,oSelf){oSelf._bOverContainer=false;if(oSelf._oCurItem){oSelf._toggleHighlight(oSelf._oCurItem,"to");}};YAHOO.widget.MultiAutoComplete.prototype._onContainerScroll=function(v,oSelf){oSelf._oTextbox.focus();};YAHOO.widget.MultiAutoComplete.prototype._onContainerResize=function(v,oSelf){oSelf._toggleContainerHelpers(oSelf._bContainerOpen);};YAHOO.widget.MultiAutoComplete.prototype._onTextboxKeyDown=function(v,oSelf){var nKeyCode=v.keyCode;switch(nKeyCode){case 9:if(oSelf.delimChar&&(oSelf._nKeyCode!=nKeyCode)){if(oSelf._bContainerOpen){YAHOO.util.Event.stopEvent(v);}}
if(oSelf._oCurItem){oSelf._selectItem(oSelf._oCurItem);}
else{oSelf._toggleContainer(false);}
break;case 13:if(oSelf._nKeyCode!=nKeyCode){if(oSelf._bContainerOpen){YAHOO.util.Event.stopEvent(v);}}
if(oSelf._oCurItem){oSelf._selectItem(oSelf._oCurItem);}
else{oSelf._toggleContainer(false);}
break;case 27:oSelf._toggleContainer(false);return;case 39:oSelf._jumpSelection();break;case 38:YAHOO.util.Event.stopEvent(v);oSelf._moveSelection(nKeyCode);break;case 40:YAHOO.util.Event.stopEvent(v);oSelf._moveSelection(nKeyCode);break;default:break;}};YAHOO.widget.MultiAutoComplete.prototype._onTextboxKeyPress=function(v,oSelf){var nKeyCode=v.keyCode;var isMac=(navigator.userAgent.toLowerCase().indexOf("mac")!=-1);if(isMac){switch(nKeyCode){case 9:if(oSelf.delimChar&&(oSelf._nKeyCode!=nKeyCode)){if(oSelf._bContainerOpen){YAHOO.util.Event.stopEvent(v);}}
break;case 13:if(oSelf._nKeyCode!=nKeyCode){if(oSelf._bContainerOpen){YAHOO.util.Event.stopEvent(v);}}
break;case 38:case 40:YAHOO.util.Event.stopEvent(v);break;default:break;}}
else if(nKeyCode==229){oSelf._queryInterval=setInterval(function(){oSelf._onIMEDetected(oSelf);},500);}};YAHOO.widget.MultiAutoComplete.prototype._onTextboxKeyUp=function(v,oSelf){oSelf._initProps();var nKeyCode=v.keyCode;oSelf._nKeyCode=nKeyCode;var sText=this.value;if(oSelf._isIgnoreKey(nKeyCode)||(sText.toLowerCase()==oSelf._sCurQuery)){return;}
else{oSelf.textboxKeyEvent.fire(oSelf,nKeyCode);}
if(oSelf.queryDelay>0){var nDelayID=setTimeout(function(){oSelf._sendQuery(sText);},(oSelf.queryDelay*1000));if(oSelf._nDelayID!=-1){clearTimeout(oSelf._nDelayID);}
oSelf._nDelayID=nDelayID;}
else{oSelf._sendQuery(sText);}};YAHOO.widget.MultiAutoComplete.prototype._onTextboxFocus=function(v,oSelf){oSelf._oTextbox.setAttribute("autocomplete","off");oSelf._bFocused=true;oSelf.textboxFocusEvent.fire(oSelf);};YAHOO.widget.MultiAutoComplete.prototype._onTextboxBlur=function(v,oSelf){if(!oSelf._bOverContainer||(oSelf._nKeyCode==9)){if(!oSelf._bItemSelected){if(!oSelf._bContainerOpen||(oSelf._bContainerOpen&&!oSelf._textMatchesOption())){if(oSelf.forceSelection){oSelf._clearSelection();}
else{oSelf.unmatchedItemSelectEvent.fire(oSelf,oSelf._sCurQuery);}}}
if(oSelf._bContainerOpen){oSelf._toggleContainer(false);}
oSelf._cancelIntervalDetection(oSelf);oSelf._bFocused=false;oSelf.textboxBlurEvent.fire(oSelf);}};YAHOO.widget.MultiAutoComplete.prototype._onFormSubmit=function(v,oSelf){if(oSelf.allowBrowserAutocomplete){oSelf._oTextbox.setAttribute("autocomplete","on");}
else{oSelf._oTextbox.setAttribute("autocomplete","off");}};YAHOO.widget.DataSource=function(){};YAHOO.widget.DataSource.ERROR_DATANULL="Response data was null";YAHOO.widget.DataSource.ERROR_DATAPARSE="Response data could not be parsed";YAHOO.widget.DataSource.prototype.maxCacheEntries=15;YAHOO.widget.DataSource.prototype.queryMatchContains=false;YAHOO.widget.DataSource.prototype.queryMatchSubset=false;YAHOO.widget.DataSource.prototype.queryMatchCase=false;YAHOO.widget.DataSource.prototype.index=-1;YAHOO.widget.DataSource.prototype.toString=function(){return"DataSource "+this._sName;};YAHOO.widget.DataSource.prototype.getResults=function(oCallbackFn,sQuery,oParent){var aResults=this._doQueryCache(oCallbackFn,sQuery,oParent);if(aResults.length===0){this.queryEvent.fire(this,oParent,sQuery);this.doQuery(oCallbackFn,sQuery,oParent);}};YAHOO.widget.DataSource.prototype.doQuery=function(oCallbackFn,sQuery,oParent){};YAHOO.widget.DataSource.prototype.flushCache=function(){if(this._aCache){this._aCache=[];}
if(this._aCacheHelper){this._aCacheHelper=[];}
this.cacheFlushEvent.fire(this);};YAHOO.widget.DataSource.prototype.queryEvent=null;YAHOO.widget.DataSource.prototype.cacheQueryEvent=null;YAHOO.widget.DataSource.prototype.getResultsEvent=null;YAHOO.widget.DataSource.prototype.getCachedResultsEvent=null;YAHOO.widget.DataSource.prototype.dataErrorEvent=null;YAHOO.widget.DataSource.prototype.cacheFlushEvent=null;YAHOO.widget.DataSource._nIndex=0;YAHOO.widget.DataSource.prototype._sName=null;YAHOO.widget.DataSource.prototype._aCache=null;YAHOO.widget.DataSource.prototype._init=function(){var maxCacheEntries=this.maxCacheEntries;if(isNaN(maxCacheEntries)||(maxCacheEntries<0)){maxCacheEntries=0;}
if(maxCacheEntries>0&&!this._aCache){this._aCache=[];}
this._sName="instance"+YAHOO.widget.DataSource._nIndex;YAHOO.widget.DataSource._nIndex++;this.queryEvent=new YAHOO.util.CustomEvent("query",this);this.cacheQueryEvent=new YAHOO.util.CustomEvent("cacheQuery",this);this.getResultsEvent=new YAHOO.util.CustomEvent("getResults",this);this.getCachedResultsEvent=new YAHOO.util.CustomEvent("getCachedResults",this);this.dataErrorEvent=new YAHOO.util.CustomEvent("dataError"+this.index,this);this.cacheFlushEvent=new YAHOO.util.CustomEvent("cacheFlush",this);};YAHOO.widget.DataSource.prototype._addCacheElem=function(oResult){var aCache=this._aCache;if(!aCache||!oResult||!oResult.query||!oResult.results){return;}
if(aCache.length>=this.maxCacheEntries){aCache.shift();}
aCache.push(oResult);};YAHOO.widget.DataSource.prototype._doQueryCache=function(oCallbackFn,sQuery,oParent){var aResults=[];var bMatchFound=false;var aCache=this._aCache;var nCacheLength=(aCache)?aCache.length:0;var bMatchContains=this.queryMatchContains;if((this.maxCacheEntries>0)&&aCache&&(nCacheLength>0)){this.cacheQueryEvent.fire(this,oParent,sQuery);if(!this.queryMatchCase){var sOrigQuery=sQuery;sQuery=sQuery.toLowerCase();}
for(var i=nCacheLength-1;i>=0;i--){var resultObj=aCache[i];var aAllResultItems=resultObj.results;var matchKey=(!this.queryMatchCase)?encodeURIComponent(resultObj.query).toLowerCase():encodeURIComponent(resultObj.query);if(matchKey==sQuery){bMatchFound=true;aResults=aAllResultItems;if(i!=nCacheLength-1){aCache.splice(i,1);this._addCacheElem(resultObj);}
break;}
else if(this.queryMatchSubset){for(var j=sQuery.length-1;j>=0;j--){var subQuery=sQuery.substr(0,j);if(matchKey==subQuery){bMatchFound=true;for(var k=aAllResultItems.length-1;k>=0;k--){var aRecord=aAllResultItems[k];var sKeyIndex=(this.queryMatchCase)?encodeURIComponent(aRecord[0]).indexOf(sQuery):encodeURIComponent(aRecord[0]).toLowerCase().indexOf(sQuery);if((!bMatchContains&&(sKeyIndex===0))||(bMatchContains&&(sKeyIndex>-1))){aResults.unshift(aRecord);}}
resultObj={};resultObj.query=sQuery;resultObj.results=aResults;this._addCacheElem(resultObj);break;}}
if(bMatchFound){break;}}}
if(bMatchFound){this.getCachedResultsEvent.fire(this,oParent,sOrigQuery,aResults);oCallbackFn(sOrigQuery,aResults,oParent,this.index);}}
return aResults;};YAHOO.widget.DS_XHR=function(sScriptURI,aSchema,oConfigs){if(typeof oConfigs=="object"){for(var sConfig in oConfigs){this[sConfig]=oConfigs[sConfig];}}
if(!aSchema||(aSchema.constructor!=Array)){return;}
else{this.schema=aSchema;}
this.scriptURI=sScriptURI;this._init();};YAHOO.widget.DS_XHR.prototype=new YAHOO.widget.DataSource();YAHOO.widget.DS_XHR.TYPE_JSON=0;YAHOO.widget.DS_XHR.TYPE_XML=1;YAHOO.widget.DS_XHR.TYPE_FLAT=2;YAHOO.widget.DS_XHR.ERROR_DATAXHR="XHR response failed";YAHOO.widget.DS_XHR.prototype.connMgr=YAHOO.util.Connect;YAHOO.widget.DS_XHR.prototype.connTimeout=0;YAHOO.widget.DS_XHR.prototype.scriptURI=null;YAHOO.widget.DS_XHR.prototype.scriptQueryParam="query";YAHOO.widget.DS_XHR.prototype.scriptQueryAppend="";YAHOO.widget.DS_XHR.prototype.responseType=YAHOO.widget.DS_XHR.TYPE_JSON;YAHOO.widget.DS_XHR.prototype.responseStripAfter="\n<!-";YAHOO.widget.DS_XHR.prototype.doQuery=function(oCallbackFn,sQuery,oParent){var isXML=(this.responseType==YAHOO.widget.DS_XHR.TYPE_XML);var sUri=this.scriptURI+"?"+this.scriptQueryParam+"="+sQuery;if(this.scriptQueryAppend.length>0){sUri+="&"+this.scriptQueryAppend;}
var oResponse=null;var oSelf=this;var responseSuccess=function(oResp){if(!oSelf._oConn||(oResp.tId!=oSelf._oConn.tId)){oSelf.dataErrorEvent.fire(oSelf,oParent,sQuery,YAHOO.widget.DataSource.ERROR_DATANULL);return;}
for(var foo in oResp){}
if(!isXML){oResp=oResp.responseText;}
else{oResp=oResp.responseXML;}
if(oResp===null){oSelf.dataErrorEvent.fire(oSelf,oParent,sQuery,YAHOO.widget.DataSource.ERROR_DATANULL);return;}
var aResults=oSelf.parseResponse(sQuery,oResp,oParent);var resultObj={};resultObj.query=decodeURIComponent(sQuery);resultObj.results=aResults;if(aResults===null){oSelf.dataErrorEvent.fire(oSelf,oParent,sQuery,YAHOO.widget.DataSource.ERROR_DATAPARSE);aResults=[];}
else{oSelf.getResultsEvent.fire(oSelf,oParent,sQuery,aResults);oSelf._addCacheElem(resultObj);}
oCallbackFn(sQuery,aResults,oParent,this.argument[0]);};var responseFailure=function(oResp){oSelf.dataErrorEvent.fire(oSelf,oParent,sQuery,YAHOO.widget.DS_XHR.ERROR_DATAXHR);return;};var oCallback={success:responseSuccess,failure:responseFailure,argument:[this.index]};if(!isNaN(this.connTimeout)&&this.connTimeout>0){oCallback.timeout=this.connTimeout;}
if(this._oConn){this.connMgr.abort(this._oConn);}
oSelf._oConn=this.connMgr.asyncRequest("GET",sUri,oCallback,null);};YAHOO.widget.DS_XHR.prototype.parseResponse=function(sQuery,oResponse,oParent){var aSchema=this.schema;var aResults=[];var bError=false;var nEnd=((this.responseStripAfter!=="")&&(oResponse.indexOf))?oResponse.indexOf(this.responseStripAfter):-1;if(nEnd!=-1){oResponse=oResponse.substring(0,nEnd);}
switch(this.responseType){
  case YAHOO.widget.DS_XHR.TYPE_JSON:var jsonList;
  if(window.JSON&&(navigator.userAgent.toLowerCase().indexOf('khtml')==-1)){
    oResponse = oResponse.replace(/\\'/g,"'");
    var jsonObjParsed=JSON.parse(oResponse);
    if(!jsonObjParsed){bError=true;break;}
    else{try{jsonList=eval("jsonObjParsed."+aSchema[0]);}
    catch(e){bError=true;break;}
    }
  }else{try{while(oResponse.substring(0,1)==" "){oResponse=oResponse.substring(1,oResponse.length);}

if(oResponse.indexOf("{")<0){bError=true;break;}
if(oResponse.indexOf("{}")===0){break;}
var jsonObjRaw=eval("("+oResponse+")");if(!jsonObjRaw){bError=true;break;}
jsonList=eval("(jsonObjRaw."+aSchema[0]+")");}
catch(e){bError=true;break;}}
if(!jsonList){bError=true;break;}
if(jsonList.constructor!=Array){jsonList=[jsonList];}
for(var i=jsonList.length-1;i>=0;i--){var aResultItem=[];var jsonResult=jsonList[i];for(var j=aSchema.length-1;j>=1;j--){var dataFieldValue=jsonResult[aSchema[j]];if(!dataFieldValue){dataFieldValue="";}
aResultItem.unshift(dataFieldValue);}
if(aResultItem.length==1){aResultItem.push(jsonResult);}
aResults.unshift(aResultItem);}
break;case YAHOO.widget.DS_XHR.TYPE_XML:var xmlList=oResponse.getElementsByTagName(aSchema[0]);if(!xmlList){bError=true;break;}
for(var k=xmlList.length-1;k>=0;k--){var result=xmlList.item(k);var aFieldSet=[];for(var m=aSchema.length-1;m>=1;m--){var sValue=null;var xmlAttr=result.attributes.getNamedItem(aSchema[m]);if(xmlAttr){sValue=xmlAttr.value;}
else{var xmlNode=result.getElementsByTagName(aSchema[m]);if(xmlNode&&xmlNode.item(0)&&xmlNode.item(0).firstChild){sValue=xmlNode.item(0).firstChild.nodeValue;}
else{sValue="";}}
aFieldSet.unshift(sValue);}
aResults.unshift(aFieldSet);}
break;case YAHOO.widget.DS_XHR.TYPE_FLAT:if(oResponse.length>0){var newLength=oResponse.length-aSchema[0].length;if(oResponse.substr(newLength)==aSchema[0]){oResponse=oResponse.substr(0,newLength);}
var aRecords=oResponse.split(aSchema[0]);for(var n=aRecords.length-1;n>=0;n--){aResults[n]=aRecords[n].split(aSchema[1]);}}
break;default:break;}
sQuery=null;oResponse=null;oParent=null;if(bError){return null;}
else{return aResults;}};YAHOO.widget.DS_XHR.prototype._oConn=null;YAHOO.widget.DS_JSFunction=function(oFunction,oConfigs){if(typeof oConfigs=="object"){for(var sConfig in oConfigs){this[sConfig]=oConfigs[sConfig];}}
if(!oFunction||(oFunction.constructor!=Function)){return;}
else{this.dataFunction=oFunction;this._init();}};YAHOO.widget.DS_JSFunction.prototype=new YAHOO.widget.DataSource();YAHOO.widget.DS_JSFunction.prototype.dataFunction=null;YAHOO.widget.DS_JSFunction.prototype.doQuery=function(oCallbackFn,sQuery,oParent){var oFunction=this.dataFunction;var aResults=[];aResults=oFunction(sQuery);if(aResults===null){this.dataErrorEvent.fire(this,oParent,sQuery,YAHOO.widget.DataSource.ERROR_DATANULL);return;}
var resultObj={};resultObj.query=decodeURIComponent(sQuery);resultObj.results=aResults;this._addCacheElem(resultObj);this.getResultsEvent.fire(this,oParent,sQuery,aResults);oCallbackFn(sQuery,aResults,oParent,this.index);return;};YAHOO.widget.DS_JSArray=function(aData,oConfigs){if(typeof oConfigs=="object"){for(var sConfig in oConfigs){this[sConfig]=oConfigs[sConfig];}}
if(!aData||(aData.constructor!=Array)){return;}
else{this.data=aData;this._init();}};YAHOO.widget.DS_JSArray.prototype=new YAHOO.widget.DataSource();YAHOO.widget.DS_JSArray.prototype.data=null;YAHOO.widget.DS_JSArray.prototype.doQuery=function(oCallbackFn,sQuery,oParent){var aData=this.data;var aResults=[];var bMatchFound=false;var bMatchContains=this.queryMatchContains;if(sQuery){if(!this.queryMatchCase){sQuery=sQuery.toLowerCase();}
for(var i=aData.length-1;i>=0;i--){var aDataset=[];if(aData[i]){if(aData[i].constructor==String){aDataset[0]=aData[i];}
else if(aData[i].constructor==Array){aDataset=aData[i];}}
if(aDataset[0]&&(aDataset[0].constructor==String)){var sKeyIndex=(this.queryMatchCase)?encodeURIComponent(aDataset[0]).indexOf(sQuery):encodeURIComponent(aDataset[0]).toLowerCase().indexOf(sQuery);if((!bMatchContains&&(sKeyIndex===0))||(bMatchContains&&(sKeyIndex>-1))){aResults.unshift(aDataset);}}}}
this.getResultsEvent.fire(this,oParent,sQuery,aResults);oCallbackFn(sQuery,aResults,oParent,this.index);};

dojo.provide("dj.util.Form");dj.util.Form={submitOnEvent:function(elm,formName,event){event=event||"onclick";var el=dojo.byId(elm);var frm=document[formName];if(el===null||typeof frm==="undefined"||frm===null){console.warn("{dj.util.Form} element and/or form not found");return;}
var deferred=dojo.connect(el,event,function(ev){dojo.stopEvent(ev);frm.submit();});return deferred;},clearOrDefaultValue:function(element){var el=dojo.byId(element);dojo.connect(el,"onfocus",this,function(ev){var field=(ev.srcElement||ev.target);if(field.value===field.defaultValue){field.value="";}});dojo.connect(el,"onblur",this,function(ev){var field=(ev.srcElement||ev.target);if(field.value===""){field.value=field.defaultValue;}});},clearValue:function(id,defaultText){var defTxt=[];var oEl=dojo.byId(id);if(oEl===null){throw new Error("{dj.util.Form} element not found");}
var fv=dojo.trim(oEl.value);if(typeof defaultText=="undefined"){oEl.value=" ";}else if(!dojo.isArray(defaultText)){defTxt.push(defaultText);}else{defTxt=defaultText;}
for(var i=0,len=defTxt.length;i<len;i++){if(defTxt[i]==fv){oEl.value="";}}},checkEmpty:function(id,errorMessage){var oEl=dojo.byId(id);if(oEl===null){throw new Error("{dj.util.Form} element not found");}
return(dojo.trim(oEl.value)==="");},validateEmailAddresses:function(emailAddresses){var reg=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;return reg.test(emailAddresses);},hasValidContent:function(regExp,value){var _value=value;if(_value!==""){return regExp.test(_value);}
return false;}};dojo.provide("dj.util.Template");dojo.require("trimpath.TrimPath");dj.util.Template={processDOMTemplate:function(container,data){return(TrimPath.processDOMTemplate(container,data));},parseTemplate:function(tmplContent,optTmplName,optEtc){return TrimPath.parseTemplate(tmplContent,optTmplName,optEtc);}};dojo.provide("dj.util.Config");dojo.require("dj.util.Observer");dojo.declare("dj.util.Config",null,{constructor:function(owner){this.setOwner(owner);this.cfg={};this.obs={};this.hasFired={};},getOwner:function(){return this.owner;},setOwner:function(owner){this.owner=owner;},addProperty:function(key,config){key=key.toLowerCase();if(typeof config=="undefined"){throw new Error("Config {key: '_', value: '_'} must be set for key '"+key+"'.");}else if(typeof config.value=="undefined"){throw new Error("Config value must be defined for key '"+key+"'.");}else if(typeof config.handler=="undefined"){this.setProperty(key,config.value,true);return;}
var ob=new dj.util.Observer();var own=this.getOwner();ob.subscribe(config.handler,own);this.obs[key]=ob;this.setProperty(key,config.value,true);},getProperty:function(key){key=key.toLowerCase();return this.cfg[key];},setProperty:function(key,value,silent){key=key.toLowerCase();this.cfg[key]=value;var ob=null;if(!silent){ob=this.obs[key];ob.fire(value);}},applyConfig:function(config,init){for(var key in config){if(config.hasOwnProperty(key)){this.setProperty(key,config[key],true);}}},fireQueue:function(ignoreFired){ignoreFired=(typeof ignoreFired=="undefined")?false:ignoreFired;var ob=null;for(var key in this.cfg){if(this.cfg.hasOwnProperty(key)){var value=this.cfg[key];if(!ignoreFired&&this.hasFired[key]){return;}
ob=this.obs[key];if(typeof ob=="undefined"){return;}
ob.fire(value);this.hasFired[key]=true;}}}});dojo.provide("dj.util.liveWidget");dojo.require("dj.lang");dojo.require("dj.util.Element");dj.util.liveWidget={register:function(widgetName,callback,context){if((typeof widgetName!=="string")||(!widgetName)||(typeof callback!=="function")){throw new Error("{liveWidget.register} widgetName must be a non-empty string, and callback -- a function");}
var liveWidget=this;this._widgetEvents[widgetName]=dj.lang.addLiveEvent("div[data-dj-live-widget="+widgetName+"]","click",function(event){var domNode=this;if(liveWidget._isInitialized(domNode)){return;}
liveWidget._markAsInitialized(domNode);var dataset=dj.util.Element.getDataset(domNode);delete dataset.djLiveWidget;var liveWidgetObject={domNode:domNode,event:event};try{callback.call(context,liveWidgetObject,dataset);}catch(e){console.error("{liveWidget} '%s': %o threw: %o",widgetName,domNode,e.message);}});},unregister:function(widgetName){if((typeof widgetName!=="string")||(!widgetName)){throw new Error("{liveWidget.unregister} widgetName must be a non-empty string");}
var event=this._widgetEvents[widgetName];if(event){dj.lang.removeLiveEvent(event);}},_isInitialized:function(domNode){return(dj.util.Element.getData(domNode,"isInitialized")=="true");},_markAsInitialized:function(domNode){dj.util.Element.setData(domNode,"isInitialized","true");},_widgetEvents:[]};
dojo.provide("dj.widget.ProgressBar");dojo.declare("dj.widget.ProgressBar",null,{TYPES:["horizontal"],constructor:function(container,config){this.cfg=dojo.mixin({indicator:"div",fps:30,timer:4,type:"horizontal"},(config||{}));this.oCnt=dojo.byId(container);this.oInd=dojo.create(this.cfg.indicator,{width:"100%"},this.oCnt);this._anim=null;},destructor:function(){if(this._anim){this._anim.stop();}
if(this.oInd){dojo.destroy(this.oInd);}},play:function(){if(this._anim!==null){if(this._anim.status=="stopped"){this._anim.play(0,true);}else{this._anim.gotoPercent(0,true);}
return;}
this._createAnimation();this._anim.play();},pause:function(){if(this._anim===null){return;}
this._anim.pause();},stop:function(){if(this._anim===null){return;}
this._anim.stop();this._anim.gotoPercent(0);dojo.style(this.oInd,"left",0);},_createAnimation:function(){var maxLeft=this._getMaxLeft(),durationInMillis=(this.cfg.timer*1000),animCfg={node:this.oInd,duration:durationInMillis,easing:function(x){return x;},onBegin:this.cfg.beforeStart,onEnd:this.cfg.afterFinish,properties:{left:maxLeft}};this._anim=dojo.animateProperty(animCfg);},_getMaxLeft:function(){if(this._maxLeftCache){return this._maxLeftCache;}
var pos=dojo.position(this.oCnt);this._maxLeftCache=pos.w;return pos.w;}});
dojo.provide("dj.widget.Slider");dojo.declare("dj.widget.Slider",null,{constructor:function(handle,track,options){this._eventConnectHandles=[];var slider=this;if(dojo.isArray(handle)){this.handles=[];for(var count=0,max=handle.length;count<max;count++){this.handles.push(dojo.byId(handle[count]));}}else{this.handles=[dojo.byId(handle)];}
this.track=dojo.byId(track);this.options=options||{};this.axis=this.options.axis||'horizontal';this.increment=this.options.increment||1;this.step=parseInt(this.options.step||'1',10);this.range=this.options.range||{start:0,end:1};this.value=0;this.values=[];dojo.forEach(this.handles,dojo.hitch(this,function(){this.values.push(0);}));this.spans=this.options.spans?dojo.forEach(this.options.spans,function(s){return dojo.byId(s);}):false;this.options.startSpan=dojo.byId(this.options.startSpan||null);this.options.endSpan=dojo.byId(this.options.endSpan||null);this.restricted=this.options.restricted||false;this.maximum=this.options.maximum||this.range.end;this.minimum=this.options.minimum||this.range.start;this.alignX=parseInt(this.options.alignX||'0',10);this.alignY=parseInt(this.options.alignY||'0',10);this.trackLength=this.maximumOffset()-this.minimumOffset();this.handleLength=this.isVertical()?(this.handles[0].offsetHeight!==0?this.handles[0].offsetHeight:this.handles[0].style.height.replace(/px$/,"")):(this.handles[0].offsetWidth!==0?this.handles[0].offsetWidth:this.handles[0].style.width.replace(/px$/,""));this.active=false;this.dragging=false;this.disabled=false;if(this.options.disabled){this.setDisabled();}
this.allowedValues=this.options.values?this.options.values.sort():false;if(this.allowedValues){this.minimum=(this.allowedValues.length>0)?this.allowedValues[0]:0;this.maximum=(this.allowedValues.length>0)?this.allowedValues[this.allowedValues.length-1]:0;}
this.eventMouseDown=dojo.hitch(this,this.startDrag);this.eventMouseUp=dojo.hitch(this,this.endDrag);this.eventMouseMove=dojo.hitch(this,this.update);dojo.forEach(this.handles,function(h,i){i=slider.handles.length-1-i;slider.setValue(parseFloat((dojo.isArray(slider.options.sliderValue)?slider.options.sliderValue[i]:slider.options.sliderValue)||slider.range.start),i);if(h.style.position&&h.style.position==='static'){h.style.position='relative';if(dojo.isOpera){h.style.top=0;h.style.left=0;}}
slider._eventConnectHandles.push(dojo.connect(h,'onmousedown',slider.eventMouseDown));});this._eventConnectHandles.push(dojo.connect(this.track,'onmousedown',this.eventMouseDown));this._eventConnectHandles.push(dojo.connect(document,'onmouseup',this.eventMouseUp));this._eventConnectHandles.push(dojo.connect(document,'onmousemove',this.eventMouseMove));this.initialized=true;},dispose:function(){dojo.forEach(this._eventConnectHandles,dojo.disconnect);},setDisabled:function(){this.disabled=true;},setEnabled:function(){this.disabled=false;},getNearestValue:function(value){if(this.allowedValues){var max=(this.allowedValues.length>0)?this.allowedValues[this.allowedValues.length-1]:0;if(value>=max){return(max);}
var min=(this.allowedValues.length>0)?this.allowedValues[0]:0;if(value<=min){return(min);}
var offset=Math.abs(this.allowedValues[0]-value);var newValue=this.allowedValues[0];dojo.forEach(this.allowedValues,function(v){var currentOffset=Math.abs(v-value);if(currentOffset<=offset){newValue=v;offset=currentOffset;}});return newValue;}
if(value>this.range.end){return this.range.end;}
if(value<this.range.start){return this.range.start;}
return value;},setValue:function(sliderValue,handleIdx){if(!this.active){this.activeHandleIdx=handleIdx||0;this.activeHandle=this.handles[this.activeHandleIdx];this.updateStyles();}
handleIdx=handleIdx||this.activeHandleIdx||0;if(this.initialized&&this.restricted){if((handleIdx>0)&&(sliderValue<this.values[handleIdx-1])){sliderValue=this.values[handleIdx-1];}
if((handleIdx<(this.handles.length-1))&&(sliderValue>this.values[handleIdx+1])){sliderValue=this.values[handleIdx+1];}}
sliderValue=this.getNearestValue(sliderValue);this.values[handleIdx]=sliderValue;this.value=this.values[0];this.handles[handleIdx].style[this.isVertical()?'top':'left']=this.translateToPx(sliderValue);this.drawSpans();if(!this.dragging||!this.event){this.updateFinished();}},setValueBy:function(delta,handleIdx){this.setValue(this.values[handleIdx||this.activeHandleIdx||0]+delta,handleIdx||this.activeHandleIdx||0);},translateToPx:function(value){return Math.round(((this.trackLength-this.handleLength)/(this.range.end-this.range.start))*(value-this.range.start))+"px";},translateToValue:function(offset){return((offset/(this.trackLength-this.handleLength)*(this.range.end-this.range.start))+this.range.start);},getRange:function(range){var v=this.values.sort();range=range||0;return{start:v[range],end:v[range+1]};},minimumOffset:function(){return(this.isVertical()?this.alignY:this.alignX);},maximumOffset:function(){return(this.isVertical()?(this.track.offsetHeight!==0?this.track.offsetHeight:this.track.style.height.replace(/px$/,""))-this.alignY:(this.track.offsetWidth!==0?this.track.offsetWidth:this.track.style.width.replace(/px$/,""))-this.alignX);},isVertical:function(){return(this.axis=='vertical');},drawSpans:function(){var slider=this;if(this.spans){for(var count=0,max=this.spans.length-1;count<=max;count++){slider.setSpan(slider.spans[count],slider.getRange(count));}}
if(this.options.startSpan){this.setSpan(this.options.startSpan,{start:0,end:this.values.length>1?this.getRange(0).start:this.value});}
if(this.options.endSpan){this.setSpan(this.options.endSpan,{start:this.values.length>1?this.getRange(this.spans.length-1).end:this.value,end:this.maximum});}},setSpan:function(span,range){if(this.isVertical()){span.style.top=this.translateToPx(range.start);span.style.height=this.translateToPx(range.end-range.start+this.range.start);}else{span.style.left=this.translateToPx(range.start);span.style.width=this.translateToPx(range.end-range.start+this.range.start);}},updateStyles:function(){dojo.forEach(this.handles,function(h){dojo.removeClass(h,'selected');});dojo.addClass(this.activeHandle,'selected');},startDrag:function(event){if(dojo.mouseButtons.isLeft(event)){if(!this.disabled){this.active=true;var handle=event.target;var pointer=[event.clientX,event.clientY];var track=handle;if(track==this.track){var trackPosition=dojo.position(this.track);this.event=event;this.setValue(this.translateToValue((this.isVertical()?pointer[1]-trackPosition.y:pointer[0]-trackPosition.x)-(this.handleLength/2)));var handlePosition=dojo.position(this.activeHandle);this.offsetX=(pointer[0]-handlePosition.x);this.offsetY=(pointer[1]-handlePosition.y);}else{while((dojo.indexOf(this.handles,handle)==-1)&&handle.parentNode){handle=handle.parentNode;}
if(dojo.indexOf(this.handles,handle)!=-1){this.activeHandle=handle;this.activeHandleIdx=dojo.indexOf(this.handles,this.activeHandle);this.updateStyles();var activeHandlePosition=dojo.position(this.activeHandle);this.offsetX=(pointer[0]-activeHandlePosition.x);this.offsetY=(pointer[1]-activeHandlePosition.y);}}}
dojo.stopEvent(event);}},update:function(event){if(this.active){if(!this.dragging){this.dragging=true;}
this.draw(event);if(dojo.isWebKit){window.scrollBy(0,0);}
dojo.stopEvent(event);}},draw:function(event){var pointer=[event.clientX,event.clientY];var trackPosition=dojo.position(this.track);pointer[0]-=this.offsetX+trackPosition.x;pointer[1]-=this.offsetY+trackPosition.y;this.event=event;this.setValue(this.translateToValue(this.isVertical()?pointer[1]:pointer[0]));if(this.initialized&&this.options.onSlide){this.options.onSlide(this.values.length>1?this.values:this.value,this);}},endDrag:function(event){if(this.active&&this.dragging){this.finishDrag(event,true);dojo.stopEvent(event);}
this.active=false;this.dragging=false;},finishDrag:function(event,success){this.active=false;this.dragging=false;this.updateFinished();},updateFinished:function(){if(this.initialized&&this.options.onChange){this.options.onChange(this.values.length>1?this.values:this.value,this);}
this.event=null;}});
dojo.provide("dj.widget.panels.PanelDTO");dojo.declare("dj.widget.panels.PanelDTO",null,{constructor:function(id,position){this._id=null;this._position=null;if(typeof id!=="undefined"){this.setId(id);}
if(typeof position!=="undefined"){this.setPosition(position);}},getId:function(){return this._id;},setId:function(id){if(typeof id==="undefined"){throw new Error("ID must be defined.");}
this._id=id;},getPosition:function(){return this._position;},setPosition:function(position){if(typeof position!=="number"){throw new TypeError("Position must be a number.");}
this._position=position;}});dojo.provide("dj.widget.panels.view.Pagination");dojo.declare("dj.widget.panels.view.Pagination",null,{constructor:function(model,pagCnt,config){this._model=model;this._pagCnt=pagCnt;this.panelIncrement=config.panelIncrement;this.paginationDivider=config.paginationDivider;},displayActiveSuccess:function(){var ap=this._model.getActive();var num=this._model.getNumberOfPanels();var start=Math.ceil(ap.getPosition()/this.panelIncrement)+(ap.getPosition()%this.panelIncrement>1?1:0);this._pagCnt.innerHTML=start+" "+this.paginationDivider+" "+Math.ceil(num/this.panelIncrement);}});dojo.provide("dj.widget.panels.controller.NavArrows");dojo.require("dj.lang");dojo.declare("dj.widget.panels.controller.NavArrows",null,{DEFAULT_CONFIG:{panelIncrement:1,doStopEvent:true},constructor:function(model,nav,cfg){this._cfg=dj.lang.cloneMixin(this.DEFAULT_CONFIG,cfg);this._model=model;this._nav=nav;this._procs=[];this.connectHandles=[];},setLastActive:function(){var mdl=this._model;if(mdl.isLocked()){this._enqueueProc(this.setNextActive);return;}
mdl.setActiveByPosition(mdl.getNumberOfPanels()-mdl.getViewArea()+1);},setFirstActive:function(){if(this._model.isLocked()){this._enqueueProc(this.setPreviousActive);return;}
this._model.setDirection(this._model.DIRECTION.PREVIOUS);this._model.setActiveByPosition(1);},setPreviousActive:function(){if(this._model.isLocked()){this._enqueueProc(this.setPreviousActive);return;}
this._model.setDirection(this._model.DIRECTION.PREVIOUS);this._model.setActiveByPosition(this._model.getActive().getPosition()-this._cfg.panelIncrement);},setNextActive:function(){var mdl=this._model;if(mdl.isLocked()){this._enqueueProc(this.setNextActive);return;}
var tryNextPosition=(this._model.getActive().getPosition()+this._cfg.panelIncrement);var nxt=mdl.getByPosition(tryNextPosition);if(mdl.getRotationType()==mdl.ROTATION_TYPE.LINEAR){var hasMore=(((mdl.getNumberOfPanels()-(mdl.getViewArea()||0))-mdl.getActive().getPosition())>=0);if(hasMore===false){mdl._activePanelObserver.fireByName("failure",tryNextPosition);return;}}
mdl.setDirection(mdl.DIRECTION.NEXT);mdl.setActiveByPosition(tryNextPosition);},addEvents:function(){if(this._nav.prevButton){this._addEventForType(this._nav.prevButton,"prev");}
if(this._nav.nextButton){this._addEventForType(this._nav.nextButton,"next");}
if(this._nav.firstButton){this._addEventForType(this._nav.firstButton,"first");}
if(this._nav.lastButton){this._addEventForType(this._nav.lastButton,"last");}},removeEvents:function(){for(var i=0,len=this.connectHandles.length;i<len;i++){dojo.disconnect(this.connectHandles[i]);}},_enqueueProc:function(proc){this._procs.push(proc);this._model.addLockListener(function(){var pr=this._procs.shift();if(pr){pr.call(this);}},this);},_addEventForType:function(oBtn,btnType,doRemoveEvent){this.connectHandles.push(dojo.connect(oBtn,"onclick",this,this._stopEventBridge));this.connectHandles.push(dojo.connect(oBtn,'onmousedown',this,function(ev){this._stopEventBridge(ev);this._setActiveByTypeOrBeginInterval(btnType);}));this.connectHandles.push(dojo.connect(oBtn,'onmouseup',this,this._endEventBridge));this.connectHandles.push(dojo.connect(oBtn,'onmouseout',this,this._endEventBridge));},_stopEventBridge:function(ev){if(this._cfg.doStopEvent===true){dojo.stopEvent(ev);}},_setActiveByTypeOrBeginInterval:function(type){if(!this._nextInterval||this._nextInterval===null){this._setActiveByType(type);}
this._nextInterval=setInterval(dojo.hitch(this,function(){this._setActiveByType(type);}),400);},_endEventBridge:function(){clearInterval(this._nextInterval);this._nextInterval=null;},_setActiveByType:function(type){var proc;switch(type){case"prev":proc=this.setPreviousActive;break;case"first":proc=this.setFirstActive;break;case"last":proc=this.setLastActive;break;default:proc=this.setNextActive;break;}
proc.call(this);}});dojo.provide("dj.widget.panels.controller.NavTabs");dojo.require("dj.lang");dojo.declare("dj.widget.panels.controller.NavTabs",null,{DEFAULT_CONFIG:{activeEvent:"onclick",doStopEvent:true},constructor:function(model,tabs,cfg){this._cfg=dj.lang.cloneMixin(this.DEFAULT_CONFIG,cfg);this.model=model;this.tabs=tabs;this.connectHandles=[];},setActive:function(tid){this.model.setActiveById(tid);},addEvents:function(doRemoveEvents){for(var tid in this.tabs){if(this.tabs.hasOwnProperty(tid)){this._addEventForTab(this.tabs[tid]);}}},removeEvents:function(){for(var i=0,len=this.connectHandles.length;i<len;i++){dojo.disconnect(this.connectHandles[i]);}},_addEventForTab:function(tab){this.connectHandles.push(dojo.connect(tab.getElement(),this._cfg.activeEvent,dojo.hitch(this,function(ev){if(this._cfg.doStopEvent===true){dojo.stopEvent(ev);}
this.setActive(tab.getId());})));}});dojo.provide("dj.widget.panels.PanelModel");dojo.require("dj.util.Observer");dojo.declare("dj.widget.panels.PanelModel",null,{ROTATION_TYPE:{LINEAR:0,CIRCULAR:1},DIRECTION:{PREVIOUS:0,NEXT:1},DEFAULT_CONFIG:{rotationType:0},constructor:function(panels,cfg){this._cfg=dojo.mixin(dojo.clone(this.DEFAULT_CONFIG),cfg);this._hPanels={};this._panelIds=[];this._prevInHistory=null;this._lastPosition=1;this._activePanel=null;this._activePanelObserver=new dj.util.Observer();this._direction=this.DIRECTION.NEXT;this._isLocked=false;this._lockObserver=new dj.util.Observer();this._rotationState=1;if(panels){this.addPanels(panels);}},addPanel:function(panelId){var panel=new dj.widget.panels.Panel(panelId,this._lastPosition);this._panelIds[this._lastPosition]=panel.getId();this._hPanels[panelId]=panel;this._lastPosition++;},addPanels:function(panels){for(var pid in panels){if(panels.hasOwnProperty(pid)){var panel=panels[pid],panelId=panel.getId();this._panelIds[this._lastPosition]=panelId;this._hPanels[panelId]=panel;this._lastPosition++;}}},hasId:function(panelId){return(typeof this._hPanels[panelId]!=="undefined");},hasPosition:function(panelPosition){return((panelPosition>0)&&(panelPosition<this._panelIds.length));},getById:function(panelId){if(!this.hasId(panelId)){throw new Error("NoSuchElementException");}
return this._hPanels[panelId];},getByPosition:function(panelPosition){if(!this.hasPosition(panelPosition)){if(this._cfg.rotationType===this.ROTATION_TYPE.CIRCULAR){var numOfPan=this.getNumberOfPanels();panelPosition=(panelPosition%numOfPan);panelPosition=(panelPosition===0)?numOfPan:panelPosition;}else{return;}}
var pid=this._panelIds[panelPosition];return this._hPanels[pid];},getActive:function(){return this._activePanel;},getPrevInHistory:function(){return this._prevInHistory;},getAll:function(){var values=[];for(var value in this._hPanels){if(this._hPanels.hasOwnProperty(value)){values.push(this._hPanels[value]);}}
return values;},getNumberOfPanels:function(){return(this._panelIds.length-1);},getRotationState:function(){return this._rotationState;},getRotationType:function(){return this._cfg.rotationType;},getDirection:function(){return this._direction;},setRotationState:function(state){if(state<0||state>1){this._activePanelObserver.fireByName("rotationStateFailure",state);}
this._rotationState=state;this._activePanelObserver.fireByName("rotationStateSuccess",state);},setDirection:function(dir){if(dir<0||dir>1){throw new Error("IndexOutOfBoundsException");}
this._direction=dir;},setActive:function(panel){if(panel&&panel.getId){this.setActiveById(panel.getId());}},setActiveById:function(panelId){if(!this.hasId(panelId)){this._activePanelObserver.fireByName("failure",panelId);return;}
var panel=this.getById(panelId);this._prevInHistory=this._activePanel;this._activePanel=panel;this._activePanelObserver.fireByName("success",panel);},setActiveByPosition:function(panelPosition){if(!this.hasPosition(panelPosition)){if(this._cfg.rotationType===this.ROTATION_TYPE.CIRCULAR){var numOfPan=this.getNumberOfPanels();panelPosition=(panelPosition%numOfPan);panelPosition=(panelPosition===0)?numOfPan:panelPosition;}else{this._activePanelObserver.fireByName("failure",panelPosition);return;}}
var pid=this._panelIds[panelPosition];this.setActiveById(pid);},addChangeListener:function(event,listener,context){if(arguments.length<3&&(typeof event==="function")){context=listener;listener=event;event="success";}
context=(typeof context!=="undefined")?context:this;this._activePanelObserver.subscribeByName(event,listener,context);},isLocked:function(){return this._isLocked;},addLockListener:function(cb,context){this._lockObserver.subscribe(cb,context);},doLock:function(){this._isLocked=true;},releaseLock:function(){this._isLocked=false;this._lockObserver.fire();},runAfterLockReleased:function(cb,ctx){if(this._isLocked){this.addLockListener(cb,ctx);}else{cb.call(ctx);}},getViewArea:function(){return this._viewArea;},setViewArea:function(va){this._viewArea=va;},getActivePanel:function(){return this.getActive().getId();},setActivePanel:function(pid){var meth=(typeof pid=="string")?this.setActiveById:this.setActiveByPosition;return meth.call(this,pid);},hasPanel:function(panel){var pid=(panel.getId)?panel.getId():panel;return this.hasId(pid);},observePanels:function(callback){this.addChangeListener(function(panel){callback.apply(this,[panel.getId(),panel.getId()]);},this);}});dojo.provide("dj.widget.panels.view.BasePanel");dojo.require("dj.lang");dojo.declare("dj.widget.panels.view.BasePanel",null,{DEFAULT_CONFIG:{animationDuration:0.3,animationType:"slide",orientation:"horizontal"},enableLazyImages:function(model,panelGroup){var a=model.getActivePanel();var v=model.getViewArea();var ulCount=dojo.query('ul.newsItem',panelGroup.parentNode).length;for(j=0;j<ulCount;j++){for(i=a;i<a+(2*v);i++){var ULs=dojo.query('ul.newsItem',panelGroup.parentNode);var image=dojo.query('img',ULs[j])[i];if(!image){break;}
if(image.getAttribute('data-src')){image.setAttribute('src',image.getAttribute('data-src'));}}}}});dojo.provide("dj.widget.panels.view.NavArrows");dojo.require("dj.lang");dojo.declare("dj.widget.panels.view.NavArrows",null,{DEFAULT_CONFIG:{prevButtonEnabledStyle:"enabledPrev",nextButtonEnabledStyle:"enabledNext",firstButtonEnabledStyle:"enabledFirst",lastButtonEnabledStyle:"enabledLast",panelIncrement:1},constructor:function(model,nav,cfg){this._cfg=dj.lang.cloneMixin(this.DEFAULT_CONFIG,cfg);this._model=model;this._nav=nav;},displayActiveSuccess:function(panel){this._updatePrevious();this._updateNext();},_updatePrevious:function(){var mod=this._model,pp=mod.getByPosition(mod.getActive().getPosition()-this._cfg.panelIncrement);if(!pp){dojo.removeClass(this._nav.prevButton,this._cfg.prevButtonEnabledStyle);if(this._nav.firstButton){dojo.removeClass(this._nav.firstButton,this._cfg.firstButtonEnabledStyle);}}else{dojo.addClass(this._nav.prevButton,this._cfg.prevButtonEnabledStyle);if(this._nav.firstButton){dojo.addClass(this._nav.firstButton,this._cfg.firstButtonEnabledStyle);}}},_updateNext:function(){var mod=this._model,np=mod.getByPosition(mod.getActive().getPosition()+mod.getViewArea());if(!np){dojo.removeClass(this._nav.nextButton,this._cfg.nextButtonEnabledStyle);if(this._nav.lastButton){dojo.removeClass(this._nav.lastButton,this._cfg.lastButtonEnabledStyle);}}else{dojo.addClass(this._nav.nextButton,this._cfg.nextButtonEnabledStyle);if(this._nav.lastButton){dojo.addClass(this._nav.lastButton,this._cfg.lastButtonEnabledStyle);}}}});dojo.provide("dj.widget.panels.view.Panel");dojo.require("dj.lang");dojo.declare("dj.widget.panels.view.Panel",null,{DEFAULT_CONFIG:{selectedClass:"",deselectedClass:"hidden"},constructor:function(model,panels,cfg){this._cfg=dj.lang.cloneMixin(this.DEFAULT_CONFIG,cfg);this._model=model;this._oPanels=panels;},displayActiveSuccess:function(panel){this._deselectAllExcept(panel);this._select(panel);},getContainer:function(){if(this._oCnt){return this._oCnt;}
if(this._cfg.container&&this._cfg.container!==""){this._oCnt=dojo.byId(this._cfg.container);return this._oCnt;}
if(this._oPanelGroup){this._oCnt=this._oPanelGroup.parentNode;return this._oCnt;}
var ap=this._model.getByPosition(1);var el=this._oPanels[ap.getId()];if(!el.parentNode||!el.parentNode.parentNode){return null;}
var grp=el.parentNode;this._oCnt=grp.parentNode;return this._oCnt;},getPanelByPosition:function(pos){return this._oPanels[pos];},_deselectAllExcept:function(panelNotToHide){var panel=null;for(var pid in this._oPanels){if(this._oPanels.hasOwnProperty(pid)){panel=this._oPanels[pid];if(panelNotToHide.getId()==pid){continue;}
dojo.removeClass(panel.getElement(),this._cfg.selectedClass);dojo.addClass(panel.getElement(),this._cfg.deselectedClass);}}},_select:function(panel){var pid=panel.getId();var oPan=this._oPanels[pid];if(!oPan){return;}
dojo.removeClass(oPan.getElement(),this._cfg.deselectedClass);dojo.addClass(oPan.getElement(),this._cfg.selectedClass);}});dojo.provide("dj.widget.panels.view.Timer");dojo.require("dj.lang");dojo.declare("dj.widget.panels.view.Timer",null,{DEFAULT_CONFIG:{pauseButtonEnabledStyle:"enabledPause"},constructor:function(model,nav,cfg){this._cfg=dj.lang.cloneMixin(this.DEFAULT_CONFIG,cfg);this._model=model;this._nav=nav;},rotationStateSuccess:function(state){var isPlayState=(state==1);if(isPlayState){dojo.removeClass(this._nav.pauseButton,this._cfg.pauseButtonEnabledStyle);}else{dojo.addClass(this._nav.pauseButton,this._cfg.pauseButtonEnabledStyle);}}});dojo.provide("dj.widget.panels.controller.Timer");dojo.require("dj.widget.ProgressBar");dojo.require("dj.lang");dojo.declare("dj.widget.panels.controller.Timer",null,{DEFAULT_CONFIG:{rotateTime:4,rotateIterations:3,progressBar:".progressbarBox",pauseButton:".nav-inline .pause"},constructor:function(model,cfg){this._cfg=dj.lang.cloneMixin(this.DEFAULT_CONFIG,cfg);this._model=model;this.connectHandles=[];},addEvents:function(){this._setupProgressBars();this._setupPauseButton();this._startTimer(this._cfg.rotateTime);this._addEvents();this._model.addChangeListener("rotationStateSuccess",function(state){if(state===0){this._pause();}
else{this._play();}},this);},removeEvents:function(){for(var i=0,len=this.connectHandles.length;i<len;i++){dojo.disconnect(this.connectHandles[i]);}
this._pause();this._destroyProgressBars();},_setupProgressBars:function(){var progressBar=this._cfg.progressBar;var rotateTime=this._cfg.rotateTime;var pbs=[];var oPb=dojo.query(progressBar,this._cfg.container).empty(oPb);for(var i=0,len=oPb.length;i<len;i++){pbs.push(new dj.widget.ProgressBar(oPb[i],{timer:rotateTime}));}
this._pbState="mt";this._pbIrupt=false;this._progressBars=pbs;var activePos=this._model.getActive().getPosition()-1;var ipb=this._progressBars[activePos];if(ipb){ipb.play();}},_destroyProgressBars:function(){for(var i=0,len=this._progressBars.length;i<len;i++){this._progressBars[i].destructor();}},_setupPauseButton:function(){var oPause=dojo.query(this._cfg.pauseButton,this._cfg.container);if(oPause.length<1){return;}else{oPause=oPause[0];}
var btnOn=this._cfg.pauseButtonEnabledStyle;this.connectHandles.push(dojo.connect(oPause,"onclick",this,function(ev){dojo.stopEvent(ev);if(this._model.getRotationState()===0){this._model.setRotationState(1);}
else{this._model.setRotationState(0);}}));},_startTimer:function(seconds){if(((typeof this._intervalId!="undefined")&&(this._intervalId!==null))||(typeof seconds=="undefined")||(seconds===0)){return;}
var model=this._model;var nextPanel=null;this._maxIter=this._maxIter||(this._cfg.rotateIterations*model.getNumberOfPanels());this._iteration=(this._iteration||1);var that=this;this._intervalId=setInterval(function(){if(that._iteration>that._maxIter){that._intervalId=null;return;}
nextPanel=(model.getByPosition(model.getActive().getPosition()+1)||model.getByPosition(1));model.setActiveByPosition(nextPanel.getPosition());var pb=that._progressBars[nextPanel.getPosition()-1];if(typeof pb!=="undefined"){if(that._pbIrupt===false){pb.stop();pb.play();}else{pb.pause();}}
that._iteration++;},seconds*1000);},_addEvents:function(){this.connectHandles.push(dojo.connect(this._cfg.container,"onmouseover",this,function(){var tid=this._model.getActive().getPosition();this._pause(tid);}));this.connectHandles.push(dojo.connect(this._cfg.container,"onmouseout",this,function(){var tid=this._model.getActive().getPosition();this._play(tid);}));},_play:function(tabNum){if(this._pbState==="mt"||(this._model.getRotationState()===0)){return;}else{this._pbState="mt";}
this._pbIrupt=true;this._startTimer(this._cfg.rotateTime);this._pbIrupt=false;var pb=this._progressBars[tabNum-1];if(pb){pb.play();}},_pause:function(tabNum){if(this._pbState==="mr"){return;}else{this._pbState="mr";}
if(this._intervalId){clearInterval(this._intervalId);this._intervalId=null;}
var pb=this._progressBars[tabNum-1];if(pb){pb.pause();}}});dojo.provide("dj.widget.panels.Panel");dojo.require("dj.widget.panels.PanelDTO");dojo.declare("dj.widget.panels.Panel",dj.widget.panels.PanelDTO,{constructor:function(id,position,element){this._element=null;if(typeof element!=="undefined"){this.setElement(element);}},getElement:function(){return this._element;},setElement:function(element){if(typeof element!=="object"){throw new TypeError("Element must be an object.");}
this._element=element;}});dojo.provide("dj.widget.panels.view.SlidePanel");dojo.require("dj.widget.panels.view.BasePanel");dojo.require("dj.lang");dojo.declare("dj.widget.panels.view.SlidePanel",dj.widget.panels.view.BasePanel,{DEFAULT_CONFIG:{animationDuration:0.3,animationType:"slide",orientation:"horizontal"},constructor:function(model,panels,cfg){this._cfg=dj.lang.cloneMixin(this.DEFAULT_CONFIG,cfg);this._isOrientVert=(this._cfg.orientation=="vertical");this._isOrientHoriz=(this._cfg.orientation=="horizontal");this._model=model;this._panels=panels;this._isSetupDone=false;this._animation=null;this._vectorMap={};this._oCnt=this._cfg.container;this._enableLazyImages=this._cfg.enableLazyImages;},displayActiveSuccess:function(activePanel){this._model.doLock();this._doSetup();if(this._isPanelGroupLargerThanAllPanels()){return;}
if(this._isRotationCircular){this._doCircularActiveSuccess(activePanel);}else{this._doLinearActiveSuccess(activePanel);}},_doCircularActiveSuccess:function(activePanel){var prevPanel=this._model.getPrevInHistory(),prvPos=prevPanel.getPosition(),avePos=activePanel.getPosition(),that=this,isIncreasing=(this._model.getDirection()==this._model.DIRECTION.NEXT),delta=0;var isIncFlip=false;var isDecrFlip=false;if(isIncreasing&&(prvPos==this._numberOfPanels)&&(avePos==1)){isIncFlip=true;delta=(that._isOrientVert)?-this._panelHeight:-this._panelWidth;}else if(!isIncreasing&&(prvPos==1)&&(avePos==this._numberOfPanels)){isDecrFlip=true;delta=(that._isOrientVert)?this._panelHeight:this._panelWidth;}else{delta=this._getVector(prevPanel,activePanel);}
afterFin=function(){if(this._enableLazyImages){this.enableLazyImages(this._model,this._oPanelGroup);}
if(isIncFlip){var offsetType=(that._isOrientVert)?"top":"left";that._oPanelGroup.style[offsetType]="0px";}
that._model.setViewArea(that.getViewArea());that._model.releaseLock();};beforeStr=function(){if(isDecrFlip){var mv,offsetTopOrLeft,offsetHeightOrWidth;if(that._isOrientVert){offsetTopOrLeft="top";offsetHeightOrWidth="_panelHeight";}else if(that._isOrientHoriz){offsetTopOrLeft="left";offsetHeightOrWidth="_panelWidth";}
mv=that._getVector(prevPanel,activePanel)-that[offsetHeightOrWidth];this.properties.left=(mv+this.properties.xD);dojo.style(that._oPanelGroup,offsetTopOrLeft,mv+"px");}};this._doScrollAnimation(delta,beforeStr,afterFin);},_doLinearActiveSuccess:function(activePanel){var prevPanel=this._model.getPrevInHistory(),afterFin=dojo.hitch(this,function(){if(this._enableLazyImages){this.enableLazyImages(this._model,this._oPanelGroup);}
this._model.setViewArea(this.getViewArea());this._model.releaseLock();}),beforeStr=function(){};delta=this._getVector(prevPanel,activePanel);this._doScrollAnimation(delta,beforeStr,afterFin);},_doSetup:function(){if(this._isSetupDone){return;}
this._isSetupDone=true;this._setCoreValues();this._resetStyle();if(this._isRotationCircular&&!this._isPanelGroupLargerThanAllPanels()){this._circularLoopSetup();}},_doScrollAnimation:function(delta,beforeStr,afterFin){var xD,yD;if(this._isOrientVert){xD=0;yD=delta;}else if(this._isOrientHoriz){xD=delta;yD=0;}
var newLeft=(dojo.style(this._oPanelGroup,"left")+xD),newTop=(dojo.style(this._oPanelGroup,"top")+yD),animationDurationInMillis=(this._cfg.animationDuration*1000);var animCfg={node:this._oPanelGroup,duration:animationDurationInMillis,beforeBegin:beforeStr,onEnd:afterFin,properties:{"xD":xD,"yD":yD,left:newLeft,top:newTop}};this._animation=dojo.animateProperty(animCfg);this._animation.play();},getContainer:function(){if(this._oCnt){return this._oCnt;}
if(this._cfg.container&&this._cfg.container!==""){this._oCnt=dojo.byId(this._cfg.container);return this._oCnt;}
if(this._oPanelGroup){this._oCnt=this._oPanelGroup.parentNode;return this._oCnt;}
var ap=this._panels[this._model.getByPosition(1).getId()];var el=ap.getElement();if(!el.parentNode||!el.parentNode.parentNode){return null;}
var grp=el.parentNode;this._oCnt=grp.parentNode;return this._oCnt;},getPanelByPosition:function(pos){var el=this._model.getByPosition(pos);return this._panels[el.getId()];},destroy:function(){this._resetStyle();},getViewArea:function(){var viewArea=0;if(typeof this._cfg.viewArea=="number"){viewArea=this._cfg.viewArea;}else if(this._isRotationCircular||this._isFixedSizePanels()){viewArea=this._getFixedSizeViewArea();}else{viewArea=this._getDynamicSizeViewArea();}
this._model.setViewArea(viewArea);return viewArea;},_getFixedSizeViewArea:function(){var el=(this._panels[this._model.getByPosition(1).getId()]).getElement(),cnt=el.parentNode.parentNode,hOrW=(this._isOrientVert)?"h":"w",viewArea=Math.round(dojo.position(cnt)[hOrW]/dojo.position(el)[hOrW]);return viewArea;},_getDynamicSizeViewArea:function(){var viewArea=0,activePanel=this._panels[this._model.getActive().getId()],cnt=activePanel.getElement().parentNode.parentNode,numOfPanels=this._model.getNumberOfPanels(),hOrW=(this._isOrientVert)?"h":"w",cntWidthOrHeight=dojo.position(cnt)[hOrW],totalWidthOrHeight=0;for(var i=activePanel.getPosition();i<=numOfPanels;i++){var panel=this._panels[this._model.getByPosition(i).getId()];totalWidthOrHeight+=dojo.position(panel.getElement())[hOrW];if(totalWidthOrHeight>cntWidthOrHeight){break;}
viewArea++;}
return viewArea;},_isFixedSizePanels:function(){if(typeof this.__isFixedLengthPanels==="undefined"){this.__isFixedLengthPanels=true;var hOrW=(this._isOrientVert)?"h":"w",prevLen=Math.round(dojo.position(this.getPanelByPosition(1).getElement())[hOrW]);for(var i=2;i<=this._model.getNumberOfPanels();i++){var len=Math.round(dojo.position(this.getPanelByPosition(i).getElement())[hOrW]);if(prevLen!==len){this.__isFixedLengthPanels=false;break;}
prevLen=len;}}
return this.__isFixedLengthPanels;},_getWidthOrHeightOfPanels:function(){if(typeof this._widthOrHeightOfPanels=="undefined"){var lastPanel=this.getPanelByPosition(this._model.getNumberOfPanels()),lastPanelBox=dojo.marginBox(lastPanel.getElement());this._widthOrHeightOfPanels=(this._isOrientVert)?(lastPanel.getElement().offsetTop+lastPanelBox.h):(lastPanel.getElement().offsetLeft+lastPanelBox.w);}
return this._widthOrHeightOfPanels;},_getVector:function(prevPanel,currPanel){var existingVector=this._getExistingVector(prevPanel,currPanel);if(existingVector){return existingVector;}
currPanel=this._panels[currPanel.getId()];var isInc=((currPanel.getPosition()-prevPanel.getPosition())>0);var offsetType=(this._isOrientVert)?"offsetTop":"offsetLeft",topOrLeft=(this._isOrientVert)?"t":"l",heightOrWidth=(this._isOrientVert)?"h":"w",yOrx=(this._isOrientVert)?"y":"x",panelsHeightOrWidth=this._getWidthOrHeightOfPanels();var panelGroupBox=dojo.marginBox(this._oPanelGroup),panelGroupOffset=this._oPanelGroup[offsetType],prevOffset=Math.abs(panelGroupBox[topOrLeft]),currPanelBox=dojo.marginBox(currPanel.getElement()),currOffset=Math.abs(currPanel.getElement()[offsetType]);if(!isInc&&(currOffset>prevOffset)){return 0;}
delta=Math.abs(currOffset-prevOffset);vector=((isInc)?(delta*-1):delta);if(!this._isRotationCircular&&!this._isFixedSizePanels()){var panelGroupPos=dojo.position(this._oPanelGroup.parentNode),newPos=(panelGroupBox[topOrLeft]+vector),maxPos=(panelGroupPos[heightOrWidth]-panelsHeightOrWidth),diff=(maxPos-newPos);if(isInc&&(diff>0)){vector+=diff;}}
this._setExistingVector(prevPanel,currPanel,vector);return vector;},_getExistingVector:function(panel1,panel2){return this._vectorMap[panel1.getId()+"_"+panel2.getId()];},_setExistingVector:function(panel1,panel2,vector){this._vectorMap[panel1.getId()+"_"+panel2.getId()]=vector;},_isPanelGroupLargerThanAllPanels:function(){var heightOrWidth=(this._isOrientVert)?"h":"w",panelsHeightOrWidth=this._getWidthOrHeightOfPanels(),panelGroupPos=dojo.position(this._oPanelGroup.parentNode);return(panelGroupPos[heightOrWidth]>panelsHeightOrWidth);},_setCoreValues:function(){if(this._isCoreValuesSet){return;}
var model=this._model,ap=this._panels[model.getByPosition(1).getId()];this._oPanelGroup=dojo.query(this._cfg.panelGroup,this.getContainer())[0];this._numberOfPanels=model.getNumberOfPanels();this._isRotationCircular=(model.getRotationType()==model.ROTATION_TYPE.CIRCULAR);if(this._isOrientVert){this._panelHeight=dojo.position(ap.getElement()).h;}else if(this._isOrientHoriz){this._panelWidth=dojo.position(ap.getElement()).w;}
this._isCoreValuesSet=true;},_resetStyle:function(){if(typeof this._oPanelGroup==="object"){dojo.style(this._oPanelGroup,{left:0,top:0});}},_circularLoopSetup:function(){for(var i=1,element=null,clone=null,len=this.getViewArea();i<=len;i++){element=this._panels[this._model.getByPosition(i).getId()].getElement();clone=element.cloneNode(true);this._oPanelGroup.appendChild(clone);}}});dojo.provide("dj.widget.panels.PanelsFactory");dojo.require("dj.lang");dojo.require("dj.widget.panels.PanelDTO");dojo.require("dj.widget.panels.Panel");dojo.require("dj.widget.panels.PanelModel");dj.widget.panels.PanelsFactory={_CONFIG:{core:{panelGroup:".newsItem",panel:"> li",panelPrefix:"panelsPanel_",panels:undefined,panelToggleStyle:"hidden",activePanel:1,disabledPanels:undefined,panelIncrement:1,viewArea:undefined,paginationDivider:"/",paginationContainer:".pagination",controller:undefined,enableBrowserHistory:false,animationDuration:0.3},tabs:{tabPrefix:"panelsTab_",tabGroup:".newsItem",tab:"> li",navContainer:".nav-inline",prevButton:".prev",nextButton:".next",navButtonEnabledStyle:"enabled",tabOnEvent:"click",tabOnStyle:"active",tabOffStyle:"deselected"},carousel:{orientation:"horizontal",navContainer:".nav-inline",prevButton:".prev",nextButton:".next",prevButtonEnabledStyle:"enabledPrev",nextButtonEnabledStyle:"enabledNext"},rotator:{rotateTime:8,rotateIterations:3,pauseOnMouseOver:false,pauseButton:".nav-inline .pause",pauseButtonEnabledStyle:"enabledPause",progressBar:".progressbarBox"}},_panelsType:{NONE:0,SLIDE:1,SWITCH:2},_paginationType:{SIMPLE:0,RANGE:1},_lookupType:{NONE:0,SELECTOR:1,PREFIX:2},create:function(container,cfg,doIgnoreOptCache){if(!container||(typeof cfg!=="object")){console.warn("{Panels} no container or config specified.");return;}
container=dojo.byId(container);if(container&&!doIgnoreOptCache){if(this._isReinitializedAndSetCache(container,cfg)){console.warn("{Panels} prevented attempt to reinitialize \""+container.id+"\".");return;}}
try{var mvc=this._setupMvc(container,cfg);this._addCompatibilityMethods(mvc,container,cfg);return mvc.model;}catch(ex){console.info(ex.message);}},_isReinitializedAndSetCache:function(container,cfg){var optCache=['{',container.id,': ',dj.lang.objectToString(cfg,true),'}'].join(''),cntOpt=container.getAttribute("djw_optcache");if(cntOpt){var opts=cntOpt.split("_");for(var i=0,len=opts.length;i<len;i++){if(opts[i]==optCache){return true;}}}
if(cntOpt){container.setAttribute("djw_optcache",[optCache,cntOpt].join("_"));}else{container.setAttribute("djw_optcache",optCache);}
return false;},createPanels:function(userCfg){var djwp=dj.widget.panels,_lookupType=this._lookupType,_panType=this._panelsType,_d=dojo,model=null,views={},controllers={};var config=dojo.clone(this._CONFIG.core);config.container="";config.doAddChangeListeners=true;config.panelsType=_panType.SWITCH;config.panelsLookupType=_lookupType.SELECTOR;dojo.mixin(config,userCfg);var panels=null;switch(config.panelsLookupType){case _lookupType.PREFIX:panels=this.lookupByPrefix(config.panelPrefix,config.panels);break;case _lookupType.SELECTOR:panels=this.lookupBySelector(config.container,config.panelGroup,config.panel);break;default:return;}
var rotType=(((config.type==djwp.PanelModel.prototype.ROTATION_TYPE.CIRCULAR)||(config.type=="circular"))?djwp.PanelModel.prototype.ROTATION_TYPE.CIRCULAR:djwp.PanelModel.prototype.ROTATION_TYPE.LINEAR);model=new djwp.PanelModel(this.panelsToPanelsDTO(panels),{rotationType:rotType});model.setActiveByPosition(config.activePanel);var view=null,viewPanelConfig,viewPanelType;switch(config.panelsType){case _panType.SLIDE:_d.require("dj.widget.panels.view.SlidePanel");viewPanelType="SlidePanel";viewPanelConfig={animationDuration:config.animationDuration,viewArea:config.viewArea,orientation:config.orientation,panelGroup:config.panelGroup,container:config.container,enableLazyImages:config.enableLazyImages};break;case _panType.SWITCH:_d.require("dj.widget.panels.view.Panel");viewPanelType="Panel";viewPanelConfig={selectedClass:config.selectedPanelClass,deselectedClass:config.deselectedPanelClass};break;}
view=new djwp.view[viewPanelType](model,panels,viewPanelConfig);views.panels=view;if(config.doAddChangeListeners){model.addChangeListener("success",view.displayActiveSuccess,view);}
return{"model":model,"views":views,"controllers":controllers};},addModuleNavArrows:function(mvc,userCfg){var _lookupType=this._lookupType,model=mvc.model,views=mvc.views,controllers=mvc.controllers,_d=dojo;var config=_d.clone(this._CONFIG.carousel);config.container="";config.doAddEvents=true;config.doAddChangeListeners=true;config.doHide=false;dj.lang.mixin(config,userCfg);if(!config.container&&views.panels&&views.panels.getContainer){config.container=views.panels.getContainer();}
var navArrowsLookupType=_lookupType.NONE;if(!config.lookupType){navArrowsLookupType=(config)?_lookupType.SELECTOR:navArrowsLookupType;}else{navArrowsLookupType=config.lookupType;}
var navArrows={};if(navArrowsLookupType==_lookupType.SELECTOR){navArrows.navContainer=_d.query(config.navContainer,config.container)[0];if(navArrows.navContainer){navArrows.prevButton=_d.query(config.prevButton,navArrows.navContainer)[0];navArrows.nextButton=_d.query(config.nextButton,navArrows.navContainer)[0];navArrows.lastButton=(config.lastButton)?_d.query(config.lastButton,navArrows.navContainer)[0]:null;navArrows.firstButton=(config.firstButton)?_d.query(config.firstButton,navArrows.navContainer)[0]:null;}else{return;}}else{return;}
if(config.doHide){navArrows.navContainer.style.visibility="hidden";return;}else if(navArrows.navContainer.style.visibility==="hidden"){navArrows.navContainer.style.visibility="";}
_d.require("dj.widget.panels.controller.NavArrows");var controller=new dj.widget.panels.controller.NavArrows(model,navArrows,config);controllers.navArrows=controller;_d.require("dj.widget.panels.view.NavArrows");var view=new dj.widget.panels.view.NavArrows(model,navArrows,config);view.displayActiveSuccess();views.navArrows=view;if(config.doAddEvents){controller.addEvents();}
if(config.doAddChangeListeners){model.addChangeListener("success",view.displayActiveSuccess,view);}},addModuleNavTabs:function(mvc,userCfg){var _lookupType=this._lookupType,model=mvc.model,views=mvc.views,controllers=mvc.controllers,_d=dojo;var config=dojo.clone(this._CONFIG.tabs);config.container="";config.panels=this._CONFIG.core.panels;config.doAddEvents=true;config.doAddChangeListeners=true;dj.lang.mixin(config,userCfg);if(!config.container&&views.panels&&views.panels.getContainer){config.container=views.panels.getContainer();}
var navTabsLookupType=_lookupType.NONE;if(!config.lookupType){navTabsLookupType=(userCfg)?_lookupType.SELECTOR:navTabsLookupType;navTabsLookupType=(userCfg&&userCfg.tabPrefix)?_lookupType.PREFIX:navTabsLookupType;}else{navTabsLookupType=config.lookupType;}
var navTabs=null;switch(navTabsLookupType){case _lookupType.PREFIX:navTabs=this.lookupByPrefix(config.tabPrefix,config.panels);break;case _lookupType.SELECTOR:navTabs=this.lookupBySelector(config.container,config.tabGroup,config.tab);break;default:return;}
_d.require("dj.widget.panels.view.Panel");var view=new dj.widget.panels.view.Panel(model,navTabs,{selectedClass:config.tabOnStyle,deselectedClass:config.tabOffStyle});_d.require("dj.widget.panels.controller.NavTabs");var controller=new dj.widget.panels.controller.NavTabs(model,navTabs,{activeEvent:config.tabOnEvent});views.navTabs=view;controllers.navTabs=controller;if(config.doAddEvents){controller.addEvents();}
if(config.doAddChangeListeners){model.addChangeListener("success",view.displayActiveSuccess,view);}},addModulePagination:function(mvc,userCfg){var config={},_d=dojo;var model=mvc.model,views=mvc.views;dj.lang.mixin((config={container:"",doAddChangeListeners:true,paginationContainer:this._CONFIG.core.paginationContainer,doHide:false}),userCfg);if(!config.container&&views.panels&&views.panels.getContainer){config.container=views.panels.getContainer();}
var oPaginationCnt=_d.query(config.paginationContainer,config.container)[0];if(!oPaginationCnt){return;}
if(config.doHide){oPaginationCnt.style.visibility="hidden";return;}
var view,isTypeRangePagination=(config.type&&config.type==this._paginationType.RANGE),requireClassName=(isTypeRangePagination)?"RangePagination":"Pagination";if(isTypeRangePagination){var ototalResultsCnt=_d.query(config.totalResultsContainer,config.container)[0];var totalCnt=ototalResultsCnt.innerHTML;_d.require("dj.widget.panels.view.RangePagination");view=new dj.widget.panels.view.RangePagination(model,oPaginationCnt,totalCnt,ototalResultsCnt,config.pageSize);model.setViewArea(1);model.setActiveByPosition(1);}else{_d.require("dj.widget.panels.view.Pagination");view=new dj.widget.panels.view.Pagination(model,oPaginationCnt,config);}
view.displayActiveSuccess();views.pagination=view;if(config.doAddChangeListeners){model.addChangeListener("success",view.displayActiveSuccess,view);}},addModuleTimer:function(mvc,userCfg){var _d=dojo,config=_d.clone(this._CONFIG.rotator);config.container="";config.doAddEvents=true;config.doAddChangeListeners=true;dj.lang.mixin(config,userCfg);var controllers=mvc.controllers;_d.require("dj.widget.panels.controller.Timer");controllers.timer=new dj.widget.panels.controller.Timer(mvc.model,config);var oPause=_d.query(config.pauseButton,config.container)[0];if(oPause){_d.require("dj.widget.panels.view.Timer");var view=new dj.widget.panels.view.Timer(mvc.model,{pauseButton:oPause},userCfg);if(config.doAddChangeListeners){mvc.model.addChangeListener("rotationStateSuccess",view.rotationStateSuccess,view);}}
if(config.doAddEvents){controllers.timer.addEvents();}},addModuleBrowserHistory:function(mvc,userCfg){var config={},_d=dojo;dj.lang.mixin((config={doAddEvents:true}),userCfg);_d.require("dj.widget.panels.controller.History");mvc.controllers.browserHistory=new dj.widget.panels.controller.History(mvc.model,config);if(config.doAddEvents){controllers.browserHistory.addEvents();}},addController:function(mvc,cMvc){if(!cMvc||!cMvc.model||!cMvc.model.addChangeListener||!mvc||!mvc.model){throw new Error("{Panels.addController} mvc and/or controller is invalid.");}
var model=mvc.model,controllerModel=cMvc.model;controllerModel.addChangeListener("success",function(panel){model.setActive(panel);});},_setupMvc:function(container,userConfig){var oCnt=dojo.byId(container);container=(oCnt.id||container);var config=dj.lang.cloneMixin(this._CONFIG,userConfig),typeCfg=this._getPanelsTypeConfig(userConfig,config);var panelsCfg={container:oCnt,doAddChangeListeners:false,panelsType:typeCfg.panelsType,panelsLookupType:typeCfg.panelsLookupType};dj.lang.mixin(panelsCfg,config.core);if(typeCfg.panelsType==this._panelsType.SWITCH){dj.lang.mixin(panelsCfg,config.tabs);}else if(typeCfg.panelsType==this._panelsType.SLIDE){dj.lang.mixin(panelsCfg,config.carousel);}
var mvc=this.createPanels(panelsCfg);if(mvc.model.getNumberOfPanels()==-1){throw new Error("{Panels} container \""+container+"\" has no panels.");}
var model=mvc.model,views=mvc.views,controllers=mvc.controllers;if(typeCfg.hasNavTabs){var navTabCfg=config.tabs;navTabCfg.container=oCnt;navTabCfg.panels=config.core.panels;navTabCfg.doAddEvents=false;navTabCfg.doAddChangeListeners=false;navTabCfg.lookupType=typeCfg.navTabsLookupType;this.addModuleNavTabs(mvc,navTabCfg);}
if(typeCfg.hasNavArrows){var navArrCfg=config.carousel;navArrCfg.container=oCnt;navArrCfg.doAddEvents=false;navArrCfg.doAddChangeListeners=false;navArrCfg.lookupType=typeCfg.navArrowsLookupType;navArrCfg.panelIncrement=config.core.panelIncrement;navArrCfg.doHide=((typeCfg.panelsType==this._panelsType.SLIDE)&&(views.panels.getViewArea()>=model.getNumberOfPanels())&&!config.carousel.showNavButtons);this.addModuleNavArrows(mvc,navArrCfg);}
var enablePagination=config.core.enablePagination;if((typeCfg.panelsType==this._panelsType.SLIDE&&(views.panels.getViewArea()<=1))||enablePagination){var paginCfg={container:oCnt,paginationContainer:config.core.paginationContainer,panelIncrement:config.core.panelIncrement,paginationDivider:config.core.paginationDivider,doAddEvents:false,doAddChangeListeners:false,doHide:(views.panels.getViewArea()==1&&enablePagination)};this.addModulePagination(mvc,paginCfg);}
if(typeCfg.hasTimer){var timerCfg=config.rotator;timerCfg.container=oCnt;timerCfg.doAddEvents=false;this.addModuleTimer(mvc,timerCfg);}
if(typeCfg.hasBrowserHistory){var histConf={container:(typeCfg.panelsLookupType==this._lookupType.SELECTOR)?oCnt.id:container,doAddEvents:false};this.addModuleBrowserHistory(mvc,histConf);}
if(typeCfg.hasController){this.addController(mvc,config.core.controller);}
this._addViewChangeListenersToModel(model,views);this._addEventsToControllers(controllers);if(!typeCfg.hasBrowserHistory&&typeCfg.panelsType==this._panelsType.SWITCH){model.setActiveByPosition(panelsCfg.activePanel);}
return mvc;},_getPanelsTypeConfig:function(userConfig,config){var _panType=this._panelsType;var _lookType=this._lookupType;var typeCfg={};typeCfg.panelsType=_panType.NONE;typeCfg.panelsType=(userConfig.core)?_panType.SWITCH:typeCfg.panelsType;typeCfg.panelsType=(userConfig.carousel)?_panType.SLIDE:typeCfg.panelsType;typeCfg.panelsLookupType=_lookType.SELECTOR;typeCfg.panelsLookupType=(userConfig.core&&userConfig.core.panelPrefix)?_lookType.PREFIX:typeCfg.panelsLookupType;typeCfg.navTabsLookupType=_lookType.NONE;typeCfg.navTabsLookupType=(userConfig.tabs)?_lookType.SELECTOR:typeCfg.navTabsLookupType;typeCfg.navTabsLookupType=(userConfig.tabs&&userConfig.tabs.tabPrefix)?_lookType.PREFIX:typeCfg.navTabsLookupType;typeCfg.navArrowsLookupType=_lookType.NONE;typeCfg.navArrowsLookupType=(userConfig.carousel)?_lookType.SELECTOR:typeCfg.navArrowsLookupType;typeCfg.navArrowsLookupType=(userConfig.tab&&userConfig.tab.navContainer)?_lookType.SELECTOR:typeCfg.navArrowsLookupType;typeCfg.hasController=(userConfig.core&&(typeof userConfig.core.controller=="object"));typeCfg.hasNavArrows=(typeCfg.navArrowsLookupType!==_lookType.NONE);typeCfg.hasNavTabs=(typeCfg.navTabsLookupType!==_lookType.NONE);typeCfg.hasTimer=(typeof userConfig.rotator=="object"&&userConfig.rotator.rotateTime>0);typeCfg.hasBrowserHistory=(config.core.enableBrowserHistory);return typeCfg;},_addViewChangeListenersToModel:function(model,views){var view=null;for(var viewName in views){if(views.hasOwnProperty(viewName)){view=views[viewName];if(view.displayActiveSuccess){model.addChangeListener("success",view.displayActiveSuccess,view);}
if(view.displayActiveFailure){model.addChangeListener("failure",view.displayActiveFailure,view);}}}},_addEventsToControllers:function(controllers){var controller=null;for(var controllerName in controllers){if(controllers.hasOwnProperty(controllerName)){controller=controllers[controllerName];controller.addEvents();}}},_addCompatibilityMethods:function(mvc,container,config){var that=this;if(typeof mvc.model.update==="undefined"){mvc.model.update=function(){that.destroy(mvc);mvc=that.create((container.id||container),config,true);return mvc;};}
if(typeof mvc.model.destroy==="undefined"){mvc.model.destroy=function(){that.destroy(mvc);};}
if(mvc.controllers&&mvc.controllers.navTabs){var tabs=mvc.controllers.navTabs.tabs,_d=dojo;mvc.model.observeTabs=function(callback,eventType){eventType=(eventType||"onclick");var _addEvForTab=function(tab){_d.connect(tab.getElement(),eventType,function(ev){var tid=tab.getId();if(mvc.controllers.navTabs._cfg.doStopEvent===true){_d.stopEvent(ev);}
tid=(isNaN(parseInt(tid,10)))?tid:(mvc.model.getById(tid).getPosition()+"");callback.call(null,tid,mvc.model);});};for(var tid in tabs){if(tabs.hasOwnProperty(tid)){_addEvForTab(tabs[tid]);}}};}
mvc.model.model=mvc.model;mvc.model.views=mvc.views;mvc.model.controllers=mvc.controllers;},destroy:function(mvc){for(var controller in mvc.controllers){if(mvc.controllers.hasOwnProperty(controller)){mvc.controllers[controller].removeEvents();delete mvc.controllers[controller];}}
for(var viewName in mvc.views){if(mvc.views.hasOwnProperty(viewName)){var view=mvc.views[viewName];if(typeof view.destroy=="function"){view.destroy();}
delete mvc.views[viewName];}}},panelsToPanelsDTO:function(panels){var elms={};for(var panId in panels){if(panels.hasOwnProperty(panId)){var pan=panels[panId];elms[panId]=new dj.widget.panels.PanelDTO(pan.getId(),pan.getPosition());}}
return elms;},lookupByPrefix:function(prefix,names){var elms={};for(var i=0,len=names.length,id=null,el=null,pos=1;i<len;i++){id=names[i];el=dojo.byId(prefix+id);if((typeof el==="undefined")||el===null||el.firstChild===null){continue;}
elms[id]=new dj.widget.panels.Panel(id,pos++,el);}
return elms;},lookupBySelector:function(container,group,node){if(!container||container===null){throw new Error('{dj.util.Panels} container for group: "'+group+'" is undefined.');}
var oCnt=dojo.byId(container);var oPanels=dojo.query((group+' '+node),oCnt);var elms={};for(var i=0,len=oPanels.length,el=null,pos=1;i<len;i++){el=oPanels[i];if(el===null||(el.tagName!=="IMG"&&el.firstChild===null)){continue;}
elms[pos-1]=new dj.widget.panels.Panel(pos-1,pos++,el);}
return elms;}};dojo.provide("dj.widget.panels.prebuilt.Slideshow");dojo.require("dj.widget.panels.PanelsFactory");dojo.require("dj.widget.panels.view.Pagination");dojo.declare("dj.widget.panels.prebuilt.Slideshow",null,{STATE_CLASS:{NORMAL:"sl_inline-norm",OVER:"sl_inline-over",END:"sl_inline-end"},constructor:function(id){this._domContainer=dojo.byId(id);this._isCaptionsEnabled=true;this._isLastFrameEnabled=true;this._createPanels(this._domContainer);this._connectCaptionEvents();this._connectLastFrameEvents();},getPanels:function(){return this._panels;},nextSlide:function(){this._panels.controllers.navArrows.setNextActive();},previousSlide:function(){this._panels.controllers.navArrows.setPreviousActive();},showCaption:function(){if(!this._isCaptionsEnabled){return;}
dojo.removeClass(this._domContainer,this.STATE_CLASS.NORMAL);dojo.addClass(this._domContainer,this.STATE_CLASS.OVER);var caption=this._getCurrentCaption(),captionHeight=dojo.position(caption).h;dojo.anim(caption,{top:{end:-captionHeight}});},hideCaption:function(){if(!this._isCaptionsEnabled){return;}
var caption=this._getCurrentCaption(),an=dojo.anim(caption,{top:{end:0}});dojo.connect(an,"onEnd",this,function(){dojo.addClass(this._domContainer,this.STATE_CLASS.NORMAL);dojo.removeClass(this._domContainer,this.STATE_CLASS.OVER);});},_createPanels:function(domNode){this._panels=dj.widget.panels.PanelsFactory.create(domNode,{core:{panelGroup:".sl_c",panel:".sl_i"},carousel:{navContainer:".box-arrows",prevButton:".prev",nextButton:".next"}});},_connectCaptionEvents:function(){var captions=dojo.query(".cap_c",this._domContainer);if(captions.length===0){this._isCaptionsEnabled=false;return;}
captions.connect("onclick",dojo.hitch(this,function(event){dojo.stopEvent(event);this.showCaption();}));dojo.connect(dojo.doc,"onclick",this,this.hideCaption);this._panels.addChangeListener("success",this.hideCaption,this);},_connectLastFrameEvents:function(){var lastFrame=dojo.query(".sl_end",this._domContainer);if(lastFrame.length===0){this._isLastFrameEnabled=false;return;}
this._panels.addChangeListener("success",this._hideLastFrame,this);this._panels.addChangeListener("failure",this._showLastFrame,this);},_getCurrentCaption:function(){var activePanelModel=this._panels.model.getActive(),activePanel=this._panels.views.panels.getPanelByPosition(activePanelModel.getPosition());return dojo.query(".cap_l",activePanel.getElement())[0];},_showLastFrame:function(){dojo.removeClass(this._domContainer,this.STATE_CLASS.NORMAL);dojo.addClass(this._domContainer,this.STATE_CLASS.END);},_hideLastFrame:function(){if(dojo.hasClass(this._domContainer,this.STATE_CLASS.END)){dojo.addClass(this._domContainer,this.STATE_CLASS.NORMAL);dojo.removeClass(this._domContainer,this.STATE_CLASS.END);}}});dojo.provide("dj.module.panels.liveSlideshow");dojo.require("dj.util.liveWidget");dojo.require("dj.util.Element");dojo.require("dj.widget.panels.prebuilt.Slideshow");dj.module.panels.liveSlideshow={init:function(type){if(this._isInit){return;}
this._isInit=true;this.type=type;this._setupLiveWidget();},destroy:function(){dj.util.liveWidget.unregister("panels.Slideshow");},_setupLiveWidget:function(){dj.util.liveWidget.register("panels.Slideshow",function(liveWidget,dataset){dojo.stopEvent(liveWidget.event);this._initWidget(liveWidget,dataset);},this);},_initWidget:function(liveWidget,dataset){var id=dj.util.Element.identify(liveWidget.domNode),slideshow;if(this.type&&this.type==="Article"){slideshow=new dj.widget.panels.prebuilt.ArticleSlideshow(id);}else{slideshow=new dj.widget.panels.prebuilt.Slideshow(id);}
var target=liveWidget.event.target;this._tryPossibleInitEvents(target,slideshow);},_tryPossibleInitEvents:function(target,slideshow){var is=dj.util.Element.isOrIsChildOf;if(is(target,".cap_s")){slideshow.showCaption();}
if(is(target,".next")){slideshow.nextSlide();}
if(is(target,".prev")){slideshow.previousSlide();}}};dojo.provide("dj.widget.panels.virtual.Tabs");dojo.require("dj.widget.panels.PanelsFactory");dojo.require("dj.widget.panels.controller.NavTabs");dojo.require("dj.widget.panels.view.Panel");dojo.provide("dj.widget.panels.virtual.Carousel");dojo.require("dj.widget.panels.PanelsFactory");dojo.require("dj.widget.panels.view.SlidePanel");dojo.require("dj.widget.panels.view.NavArrows");dojo.require("dj.widget.panels.controller.NavArrows");
dojo.provide("dj.widget.panel.LiveModalPanel");dojo.require("dj.util.Element");(function(djl){(dj.widget.panel.LiveModalPanel=function(cfg){this.cfg=djl.cloneMixin(this.DEFAULT_CONFIG,cfg);this._setupEvents();}).prototype={DEFAULT_CONFIG:{container:".linklist_dropdown .mn_dropdown_container",containerInd:".linklist_dropdown .mn_dropdown_container",dropdownContent:".mn_dropdownPanel > .mn_dropdownContent",actionEvent:"click",stateContainer:".mn_dropdownTree",stateCollapsed:"mn_ddState-collapsed",stateExpanded:"mn_ddState-expanded",navContainer:".pmMainNav",stateHover:"mndd_ddState-hover ",queryUpClass:"mn_dropdownTree",addMouseEvents:false},prevActivePanel:undefined,navOpened:false,_setupEvents:function(){var that=this;if(this.cfg.addMouseEvents){djl.addLiveEvent(this.cfg.container,"mouseover",function(ev){that.mouseOverOut(this,ev);});}
djl.addLiveEvent(this.cfg.containerInd,this.cfg.actionEvent,function(ev){var node=that._queryUpForClassName(this,that.cfg.queryUpClass);that.togglePanel(node,ev);});if(this.cfg.addMouseEvents){djl.addLiveEvent(this.cfg.container,"mouseout",function(ev){that.mouseOverOut(this,ev);});}
this.oDropdownContainer=dojo.query(this.cfg.navContainer)[0];dojo.connect(document,'onclick',function(ev){if(ev.target.nodeName=="A"){return true;}
if(that.prevActivePanel!==undefined&&that.navOpened===true){var dropd=dojo.query(that.cfg.dropdownContent,that.prevActivePanel)[0];if(dropd!==undefined&&!dj.util.Element.contains(dropd,ev.clientX,ev.clientY)){that.togglePanel(dropd,ev);that.navOpened=false;}}});},_queryUpForClassName:function(node,cn){if(node.className.indexOf(cn)==-1){while((typeof node!=="object")||(null===node.className)||!node.className||(node.className.indexOf(cn)!==0)){node=node.parentNode;}}
return node;},togglePanel:function(dropd,event){var cfg=this.cfg;if(dojo.hasClass(dropd,cfg.stateCollapsed)){dojo.removeClass(dropd,cfg.stateCollapsed);dojo.addClass(dropd,cfg.stateExpanded);this.navOpened=true;}else{dojo.removeClass(dropd,cfg.stateExpanded);dojo.addClass(dropd,cfg.stateCollapsed);this.navOpened=false;}
if(this.prevActivePanel!==undefined&&this.prevActivePanel!=dropd){dojo.removeClass(this.prevActivePanel,cfg.stateExpanded);dojo.addClass(this.prevActivePanel,cfg.stateCollapsed);}
this.prevActivePanel=dropd;dojo.stopEvent(event);},mouseOverOut:function(elm,ev){var cfg=this.cfg,dropd=dojo.query(cfg.stateContainer,elm)[0];if(dropd!==undefined){if(ev.type=="mouseover"){dojo.addClass(dropd,cfg.stateHover);}else if(ev.type=="mouseout"){dojo.removeClass(dropd,cfg.stateHover);}}}};}(dj.lang));dojo.provide("dj.widget.panel.Tooltip");dojo.require("dj.lang");dojo.require("dj.util.Query");dojo.declare("dj.widget.panel.Tooltip",null,{constructor:function(containerClass,tipTargetBox,tipTarget,tooltipBox,container,hideDelayInMillis){this._delayedMouseOver(tipTarget,dojo.hitch(this,function(node){this.init(containerClass,{elementsContainerClass:tipTargetBox,targetClass:tipTarget,tooltipClass:tooltipBox,container:container,hideTooltipDelay:hideDelayInMillis});this.isInitialized=true;var ttb=dj.util.Query.up(node,tipTargetBox),tb=dojo.query(tooltipBox,ttb)[0];this.showTooltip(tb);}),200);},_delayedMouseOver:function(containerClass,func,time){var doInit=false,initDelay;var outEvent=dj.lang.addLiveEvent(containerClass,"mouseout",function(){doInit=false;});var overEvent=dj.lang.addLiveEvent(containerClass,"mouseover",function(){if(initDelay){clearTimeout(initDelay);}
doInit=true;var elm=this;initDelay=setTimeout(function(){if(!doInit){return;}
dj.lang.removeLiveEvent(overEvent);dj.lang.removeLiveEvent(outEvent);func.call(null,elm);},time);});},DEFAULT_CONFIG:{hideTooltipDelay:100},init:function(containerClass,config){this.eventPointerList=[];this.containerClass=containerClass;this.cfg=dj.lang.cloneMixin(this.DEFAULT_CONFIG,config);this._setupTooltips();},_setupTooltips:function(){this.oContainer=(this.cfg.container?dojo.byId(this.cfg.container):this.cfg.container);this.oTooltipContainers=((typeof this.oContainer!=='undefined')&&(this.oContainer!==null))?dojo.query(this.containerClass,this.oContainer):dojo.query(this.containerClass);this.oTooltipContainers.forEach(dojo.hitch(this,function(oTooltipContainer){var oTooltipElementsContainer=dojo.query(this.cfg.elementsContainerClass,oTooltipContainer)[0],oTooltipTarget=dojo.query(this.cfg.targetClass,oTooltipContainer)[0],oTooltip=dojo.query(this.cfg.tooltipClass,oTooltipContainer)[0];if(!((typeof oTooltipElementsContainer!=='undefined')&&(oTooltipElementsContainer!==null)&&(typeof oTooltipTarget!=='undefined')&&(oTooltipTarget!==null)&&(typeof oTooltip!=='undefined')&&(oTooltip!==null))){console.log("{Tooltip} oTooltipTarget or oTooltip is not defined for tooltip container");return;}
var tipTarget=dojo.query(this.cfg.targetClass,oTooltipElementsContainer)[0];if((typeof tipTarget==='undefined')||(tipTarget===null)){dojo.place(oTooltipElementsContainer,oTooltipTarget,"before");dojo.place(oTooltipTarget,oTooltip,"after");}
var tooltipVisibleFlag=false;var showTooltipListener=function(){tooltipVisibleFlag=true;this.showTooltip(oTooltip);};var hideTooltipListener=function(){tooltipVisibleFlag=false;setTimeout(dojo.hitch(this,function(){if(tooltipVisibleFlag===false){this.hideTooltip(oTooltip);}}),this.cfg.hideTooltipDelay);};this.eventPointerList.push(dojo.connect(oTooltipTarget,"onmouseover",dojo.hitch(this,showTooltipListener)));this.eventPointerList.push(dojo.connect(oTooltipTarget,"onmouseout",dojo.hitch(this,hideTooltipListener)));this.eventPointerList.push(dojo.connect(oTooltip,"onmouseover",dojo.hitch(this,showTooltipListener)));this.eventPointerList.push(dojo.connect(oTooltip,"onmouseout",dojo.hitch(this,hideTooltipListener)));}));},showTooltip:function(oTooltip){dojo.style(oTooltip,{display:"block"});},hideTooltip:function(oTooltip){dojo.style(oTooltip,{display:"none"});},destructor:function(){if(!this.isInitialized){console.warn("{dj.widget.panel.Tooltip} has not been initialized yet");return;}
this.oContainer=null;this.oTooltipContainers=null;for(var i=0,len=this.eventPointerList.length;i<len;i++){dojo.disconnect(this.eventPointerList[i]);delete this.eventPointerList[i];}},refreshTooltips:function(container){if(!this.isInitialized){return;}
this.destructor();this._setupTooltips();}});dojo.provide("dj.widget.panel.ModalPanel");dojo.require("dj.util.Config");dojo.require("dj.util.Element");dojo.require("dj.util.Observer");(dj.widget.panel.ModalPanel=function(modalId,modalContainer,config){this.oModalId=dojo.byId(modalId);if(!this.oModalId){throw new Error("{dj.widget.panel.ModalPanel} modal-id is null or undefined");}
this.oModalContainer=dojo.byId(modalContainer);if(!this.oModalContainer){throw new Error("{dj.widget.panel.ModalPanel} modal-container is null or undefined");}
this.observeOpenModalPanel=new dj.util.Observer();this.observeCloseModalPanel=new dj.util.Observer();this.cfg=new dj.util.Config(this);this._setupConfig();if(config){this.cfg.applyConfig(config,true);}
this.cfg.fireQueue();if(this.oModalId===null){this._setupTargetlessModalPanel(this.oModalContainer);}else{this._setupModalPanel(this.oModalId,this.oModalContainer);}}).prototype={DEFAULT_CONFIG:{OPEN_MODAL_PANEL_EVENT_OPTION:{key:voidModalPanelEvent",value:"mouseover"},CLOSE_MODAL_PANEL_EVENT_OPTION:{key:"closeModalPanelEvent",value:"mouseout"},CLOSE_MODAL_PANEL_BUTTON_SELECTOR:{key:"closeModalPanelButtonSelector",value:null},CLOSE_MODAL_PANEL_EVENT_FOR_BUTTON_SELECTOR:{key:"closeModalPanelEventForButtonSelector",value:null}},_setupModalPanel:function(oModalId,oModalContainer){dojo.style(oModalContainer,{visibility:"hidden"});var modalOpenEvent=this.cfg.getProperty(this.DEFAULT_CONFIG.OPEN_MODAL_PANEL_EVENT_OPTION.key);var modalCloseEvent=this.cfg.getProperty(this.DEFAULT_CONFIG.CLOSE_MODAL_PANEL_EVENT_OPTION.key);var that=this;dojo.connect(oModalId,"on"+modalOpenEvent,this,function(event){dojo.stopEvent(event);voidModalPanel();});var closeModalPanelSelector=this.cfg.getProperty(this.DEFAULT_CONFIG.CLOSE_MODAL_PANEL_BUTTON_SELECTOR.key);if(closeModalPanelSelector!==null){var closeModalPanelButtons=dojo.query(closeModalPanelSelector,oModalContainer);var modalCloseEventForButtonSelector=(this.cfg.getProperty(this.DEFAULT_CONFIG.CLOSE_MODAL_PANEL_EVENT_FOR_BUTTON_SELECTOR.key)!==null)?this.cfg.getProperty(this.DEFAULT_CONFIG.CLOSE_MODAL_PANEL_EVENT_FOR_BUTTON_SELECTOR.key):modalCloseEvent;closeModalPanelButtons.forEach(function(oCloseModalPanelButton){dojo.connect(oCloseModalPanelButton,"on"+modalCloseEventForButtonSelector,this,function(event){dojo.stopEvent(event);this.closeModalPanel();});},this);}else{dojo.connect(oModalContainer,"onmouseover",this,voidModalPanel);dojo.connect(oModalContainer,"on"+modalCloseEvent,this,this.closeModalPanel);}
if(modalCloseEvent=='blur'){dojo.connect(document,"onclick",this,function(event){var isMousePointerinModalContainer=dj.util.Element.contains(oModalContainer,event.clientX,event.clientY);if(isMousePointerinModalContainer===false){this.closeModalPanel();}});}},_setupTargetlessModalPanel:function(oModalContainer){var modalCloseEvent=this.cfg.getProperty(this.DEFAULT_CONFIG.CLOSE_MODAL_PANEL_EVENT_OPTION.key);var closeModalPanelSelector=this.cfg.getProperty(this.DEFAULT_CONFIG.CLOSE_MODAL_PANEL_BUTTON_SELECTOR.key);voidModalPanel();var that=this;if(closeModalPanelSelector!==null){var closeModalPanelButtons=dojo.query(closeModalPanelSelector,oModalContainer).each(function(oCloseModalPanelButton){dojo.connect(oCloseModalPanelButton,"on"+modalCloseEvent,this,function(event){dojo.stopEvent(event);this.closeModalPanel();});});}else{dojo.connect(oCloseModalPanelButton,"on"+modalCloseEvent,this,this.closeModalPanel);}}voidModalPanel:function(){dojo.style(this.oModalContainer,{visibility:"visible"});},closeModalPanel:function(){dojo.style(this.oModalContainer,{visibility:"hidden"});},_setupConfig:function(config){var cfg=this.cfg;var defCfg=this.DEFAULT_CONFIG;cfg.addProperty(defCfg.OPEN_MODAL_PANEL_EVENT_OPTION.key,{value:defCfg.OPEN_MODAL_PANEL_EVENT_OPTION.value});cfg.addProperty(defCfg.CLOSE_MODAL_PANEL_EVENT_OPTION.key,{value:defCfg.CLOSE_MODAL_PANEL_EVENT_OPTION.value});cfg.addProperty(defCfg.CLOSE_MODAL_PANEL_BUTTON_SELECTOR.key,{value:defCfg.CLOSE_MODAL_PANEL_BUTTON_SELECTOR.value});cfg.addProperty(defCfg.CLOSE_MODAL_PANEL_EVENT_FOR_BUTTON_SELECTOR.key,{value:defCfg.CLOSE_MODAL_PANEL_EVENT_FOR_BUTTON_SELECTOR.value});}};dojo.provide("dj.widget.panel.SelectDropdownPanel");dojo.require("dj.util.Element");dojo.require("dj.lang");dojo.declare("dj.widget.panel.SelectDropdownPanel",null,{DEFAULT_CONFIG:{scrollContainerClass:".scroll_container",scrollBarClass:".scrollbar",scrollTrackClass:".scrollbar_container",scrollValuesContainerClass:".scroll_values_container",dropdownCollapsedClassName:"dropdown_collapsed",dropdownExpandedClassName:"void",scrollContainerCollapsedClassName:"collapsed",scrollContainerExpandedClassName:"expanded",selectedClassName:".selected",scrollTrackContainerClassName:".scroll_track",dropdownScrollUpArrow:".scroll_up",dropdownScrollDownArrow:".scroll_down",scrollTrackHeight:"154",scrollValuesDisplayHeight:"190",scrollBarArrowShiftValue:"2"},constructor:function(selectDropdownContainer,config){this.cfg=dj.lang.cloneMixin(this.DEFAULT_CONFIG,config);var scrollBarClass=this.cfg.scrollBarClass;var scrollTrackClass=this.cfg.scrollTrackClass;var scrollContainerClass=this.cfg.scrollContainerClass;var scrollValuesContainerClass=this.cfg.scrollValuesContainerClass;this.oSelectDropDownContainer=dojo.byId(selectDropdownContainer);if(this.oSelectDropDownContainer){this.oScrollBar=dojo.query(scrollBarClass,this.oSelectDropDownContainer)[0];this.oScrollTrack=dojo.query(scrollTrackClass,this.oSelectDropDownContainer)[0];this.oScrollContainer=dojo.query(scrollContainerClass,this.oSelectDropDownContainer)[0];this.oScrollValuesContainer=dojo.query(scrollValuesContainerClass,this.oSelectDropDownContainer)[0];this._setupSelectDropdown(this.oSelectDropDownContainer,this.oScrollContainer,this.oScrollValuesContainer,this.oScrollBar,this.oScrollTrack);}},_setupSelectDropdown:function(oSelectDropdownContainer,oScrollContainer,oScrollValuesContainer,oScrollBar,oScrollTrack){var selectDropdownCollapsedClassName=this.cfg.dropdownCollapsedClassName;var selectDropdownExpandedClassName=this.cfg.dropdownExpandedClassName;var scrollContainerCollapsedClassName=this.cfg.scrollContainerCollapsedClassName;var scrollContainerExpandedClassName=this.cfg.scrollContainerExpandedClassName;var selectedClassName=this.cfg.selectedClassName;this.oSelected=dojo.query(selectedClassName,oSelectDropdownContainer)[0];var toggleDropdownClass=function(){if(dojo.hasClass(oSelectDropdownContainer,selectDropdownCollapsedClassName)){dojo.removeClass(oSelectDropdownContainer,selectDropdownCollapsedClassName);dojo.addClass(oSelectDropdownContainer,selectDropdownExpandedClassName);}else
if(dojo.hasClass(oSelectDropdownContainer,selectDropdownExpandedClassName)){dojo.removeClass(oSelectDropdownContainer,selectDropdownExpandedClassName);dojo.addClass(oSelectDropdownContainer,selectDropdownCollapsedClassName);}
if(dojo.hasClass(oScrollContainer,scrollContainerCollapsedClassName)){dojo.removeClass(oScrollContainer,scrollContainerCollapsedClassName);dojo.addClass(oScrollContainer,scrollContainerExpandedClassName);}else
if(dojo.hasClass(oScrollContainer,scrollContainerExpandedClassName)){dojo.removeClass(oScrollContainer,scrollContainerExpandedClassName);dojo.addClass(oScrollContainer,scrollContainerCollapsedClassName);}};dojo.connect(this.oSelected,"onclick",toggleDropdownClass);dojo.connect(oScrollValuesContainer,"onclick",toggleDropdownClass);dojo.connect(document,"onclick",function(event){var isMousePointerinModalContainer=dj.util.Element.contains(oScrollContainer,event.clientX,event.clientY);if(isMousePointerinModalContainer===false){if(dojo.hasClass(oSelectDropdownContainer,selectDropdownExpandedClassName)){dojo.removeClass(oSelectDropdownContainer,selectDropdownExpandedClassName);dojo.addClass(oSelectDropdownContainer,selectDropdownCollapsedClassName);}
if(dojo.hasClass(oScrollContainer,scrollContainerExpandedClassName)){dojo.removeClass(oScrollContainer,scrollContainerExpandedClassName);dojo.addClass(oScrollContainer,scrollContainerCollapsedClassName);}}});if(oScrollBar&&oScrollBar!==null&&oScrollTrack&&oScrollTrack!==null){dojo.require("dj.widget.Slider");var noOfValues=oScrollValuesContainer.children.length;var scrollTrackHeight=parseInt(this.cfg.scrollTrackHeight,10);var scrollValuesDisplayHeight=parseInt(this.cfg.scrollValuesDisplayHeight,10);var scrollBarHeight=parseInt((scrollTrackHeight/(noOfValues/10)),10);dojo.style(oScrollBar,{height:scrollBarHeight+"px"});var scrollValuesTopShiftFactor=(scrollValuesDisplayHeight/scrollTrackHeight)*(noOfValues/10);var moveDropDown=function(value){var sliderPx=slider.translateToPx(value);var sliderPxValue=sliderPx.replace("px","");dojo.style(oScrollValuesContainer,{top:"-"+sliderPxValue*scrollValuesTopShiftFactor+"px"});};var slider=new dj.widget.Slider(oScrollBar,oScrollTrack,{onSlide:moveDropDown,onChange:moveDropDown,axis:'vertical'});var scrollTrackContainerClass=this.cfg.scrollTrackContainerClassName;this.oScrollTrackContainer=dojo.query(scrollTrackContainerClass,oSelectDropdownContainer)[0];var scrollUpArrowClass=this.cfg.dropdownScrollUpArrow;var scrollDownArrowClass=this.cfg.dropdownScrollDownArrow;this.oScrollUpArrow=dojo.query(scrollUpArrowClass,this.oScrollTrackContainer)[0];this.oScrollDownArrow=dojo.query(scrollDownArrowClass,this.oScrollTrackContainer)[0];var scrollArrowShiftValue=parseInt(this.cfg.scrollBarArrowShiftValue,10);var scrollBarTopPx,scrollBarTop,sliderValue;dojo.connect(this.oScrollUpArrow,"onclick",function(event){scrollBarTop=dojo.style(oScrollBar,"top");sliderValue=slider.translateToValue(scrollBarTop-scrollArrowShiftValue);if(scrollBarTop>0){slider.setValue(sliderValue);}});dojo.connect(this.oScrollDownArrow,"onclick",function(event){scrollBarTop=dojo.style(oScrollBar,"top");sliderValue=slider.translateToValue(scrollBarTop+scrollArrowShiftValue);if(scrollBarTop<(scrollTrackHeight-scrollBarHeight)){slider.setValue(sliderValue);}});}}});dojo.provide("dj.module.refreshTooltips");dojo.require("dj.util.User");dojo.require("dj.widget.panel.Tooltip");dj.module.refreshTooltips=function(oTooltip){dj.util.User.isSubLoggedIn(function(subLoggedIn){if(!subLoggedIn){if((typeof oTooltip!=='undefined')&&(oTooltip!==null)&&(typeof oTooltip.refreshTooltips=="function")){oTooltip.refreshTooltips();}}});};
dojo.provide("dj.widget.flash.Flash");dojo.require("dj.util.Cookie");dojo.require("dj.util.Observer");dojo.require("swfobject.swfobject_2_2.swfobject");dojo.declare("dj.widget.flash.Flash",null,{constructor:function(idOrDomNode,p,s,params){this.parent=dojo.byId(idOrDomNode);if(this._isWidgetAlreadyHandled()){return;}
params=dojo.mixin({noloaddisabled:false,getSettings:true,swfsettings:undefined},params);this.config={};this.config.myMovie='/public/resources/documents/info-flash08-preloaddisableder.swf';this.p=p;this.s=s;this.swfsettings=params.swfsettings;this.getSettings=params.getSettings;this.swfPrefix='info-';this.params=params;this._swfFlashvars={};this._swfParams={};this._swfAttributes={};this.settingsObserver=new dj.util.Observer();if(p&&!params.noloaddisabled){this.loaddisabled(p,s);}},_isWidgetAlreadyHandled:function(){var isWidgetAlreadyHandled=((typeof dojo.query("div[data-dj-live-widget]",this.parent)[0]==="object")||(typeof dojo.query("div[data-dj-widget]",this.parent)[0]==="object"));if(isWidgetAlreadyHandled){console.info("{Flash} %o will be handled by the util.template.",this.parent.id);return true;}
return false;},loaddisabled:function(p,s){this.newId();this.settingsObserver.subscribe(this.create,this);this.loaddisabledsettings(p,s);if(this.swfsettings){this.create(p,s);}},newId:function(){this.flid="flashdiv_"+Math.floor(Math.random()*999999);},loaddisabledsettings:function(p,s){this.p=p;this.s=s;if(!this.getSettings){this.swfsettings={};return;}
this.settingfile='/public/resources/documents/'+this.swfPrefix+p+'-settings.js';if(!this.swfsettings){this.swfsettings=null;var that=this;var deferred=dojo.xhrGet({url:this.settingfile,loaddisabled:function(data,ioargs){if(!data){return;}
var jso=that._normalizeJsonToObject(data);that.swfsettings=jso.swfsettings;that.settingsObserver.fire(that.p,that.s);},error:function(err){console.error("{Flash} HTTP status code: %s, response: %o",ioargs.xhr.status,data);}});}},create:function(p,s){this.createwrapper();this.createflash();this.settingsObserver.unsubscribe(this.create);},createwrapper:function(){this.newId();this.div=document.createElement('div');this.div.setAttribute('id',this.flid);this.parent.appendChild(this.div);},createflash:function(){if(this.so){return;}
this.myMovie=(this.swfsettings.requiredSettings.preloaddisableder)?('/public/resources/documents/'+this.swfsettings.requiredSettings.preloaddisableder):(this.config.myMovie);this._setSwfParams();this._setSwfFlashvars();this._setSwfAttributes();try{swfobject.embedSWF(this.myMovie,this.flid,this.swfsettings.requiredSettings.swfwidth,this.swfsettings.requiredSettings.swfheight,"9.0.0","",this._swfFlashvars,this._swfParams,this._swfAttributes);}catch(e){console.error("{Flash} threw the following error: %o",e.message);}},_setSwfParams:function(){this._swfParams=dojo.mixin(this._swfParams,{allowScriptAccess:"always",wmode:"opaque",base:"/public/resources/documents",menu:"false",bgcolor:"#FFFFFF",allowfullscreen:"true",height:this.swfsettings.requiredSettings.swfheight});},_setSwfFlashvars:function(){if(this.swfsettings&&this.swfsettings.optionalSettings){for(var setting in this.swfsettings.optionalSettings){if(this.swfsettings.optionalSettings.hasOwnProperty(setting)){this._swfFlashvars[setting]=this.swfsettings.optionalSettings[setting];}}}
if(this.params&&this.params.flashVars){for(var flashVar in this.params.flashvars){if(this.params.flashvars.hasOwnProperty(flashVar)){this._swfFlashvars[flashVar]=this.params.flashvars[flashVar];}}}
this._swfFlashvars.SlugName=this.p;this._swfFlashvars.placement="tab";this.preloaddisabled='info-'+this.p+'-preloaddisabled.xml';this._swfFlashvars.PreloaddisablederURL=this.preloaddisabled;this._swfFlashvars.MovieWidth=this.swfsettings.requiredSettings.swfwidth;this._swfFlashvars.MovieHeight=this.swfsettings.requiredSettings.swfheight;this._swfFlashvars.asub=dj.util.Cookie.getCookie("user_type");this._swfFlashvars.basePath='/public/resources/documents';this._swfFlashvars.cdnDomain=dj.context.core.cdnPrefix;this._swfFlashvars.serverDomain=dj.context.core.urlPrefix;this._swfFlashvars.id=this.s;this._swfFlashvars.PLAYER_ID=this.p;},_setSwfAttributes:function(){this._swfAttributes=dojo.mixin(this._swfAttributes,{id:this.p});},_normalizeJsonToObject:function(response){var json_start=response.indexOf('{');var json_end=response.lastIndexOf('}');if(json_start>-1){response=response.substring(json_start,json_end+1);}
return dojo.fromJson(response);}});dojo.declare("dj.widget.flash.SlideshowFlash",dj.widget.flash.Flash,{constructor:function(id,p,s,noloaddisabled){this.config.myMovie='/public/resources/documents/info-slideshow08-preloaddisableder.swf';window.getContent=this.getContent;},getContent:function(){return null;}});dojo.provide("dj.util.flash.template");dojo.require("dj.util.Element");dojo.require("dj.util.Template");dojo.require("swfobject.swfobject_2_2.swfobject");dojo.require("dj.widget.flash.Flash");dj.util.flash.template={scan:function(){var that=this;dojo.query("div[data-dj-widget=flash.Template]").forEach(function(domNode){try{if(that._isInitialized(domNode)){return;}
that._markAsInitialized(domNode);var dataset=that._getDatasetFromWidget(domNode);if(that._hasValidFlashVersion()){that._handleFlash(domNode,dataset);}else if(dataset.djHideIfNoFlash=="true"){that._destroyWidget(domNode);}else{that._setMagicDatapoints(dataset);that._handleTemplate(domNode,dataset);}}catch(e){console.error("{flash.Template} threw the following error: %s",e.message);}});},_isInitialized:function(domNode){return(dj.util.Element.getData(domNode,"isInitialized")=="true");},_markAsInitialized:function(domNode){dj.util.Element.setData(domNode,"isInitialized","true");},_hasValidFlashVersion:function(){return(swfobject.getFlashPlayerVersion().major>=9);},_handleFlash:function(domNode,dataset){var hasFlashSettings=dataset.flashSettings;var options=hasFlashSettings?{noloaddisabled:true,swfsettings:dojo.fromJson(dataset.flashSettings).swfsettings}:{};var fl=new dj.widget.flash.Flash(domNode,dataset.flashProject,dataset.flashSecondParam,options);if(hasFlashSettings){fl.create(dataset.flashProject,dataset.flashSecondParam);}},_destroyWidget:function(domNode){var parent=domNode.parentNode;dojo.destroy(domNode);var textarea=dojo.query("textarea",parent)[0];if(textarea){dojo.destroy(textarea);}
this._recursivelyDestroyEmptyParents(parent);},_recursivelyDestroyEmptyParents:function(parent){var numOfChildren=dojo.query("*",parent).length;if(numOfChildren===0){var itsParent=parent.parentNode;dojo.destroy(parent);this._recursivelyDestroyEmptyParents(itsParent);}},_setMagicDatapoints:function(dataset){dataset.djIsFlashPossible=this._isFlashPossible();},_handleTemplate:function(domNode,dataset){var template=this._getTemplateFromWidget(domNode);this._renderTemplate(domNode,template,dataset);},_getTemplateFromWidget:function(domNode){var template=dojo.query("textarea",domNode)[0];if(!template){throw new Error("{flash.Template} no template domNode found in %o",domNode);}
return this._stripCdataTags(template.value);},_getDatasetFromWidget:function(domNode){var dataset=dj.util.Element.getDataset(domNode);delete dataset.djWidget;return dataset;},_renderTemplate:function(domNode,template,dataset){domNode.innerHTML=dj.util.Template.parseTemplate(template).process(dataset);},_stripCdataTags:function(string){string=string.replace(/\s*<!\[CDATA\[\s*/,"");string=string.replace(/\s*\]\]>\s*/,"");return string;},_isFlashPossible:function(){var userAgentString=navigator.userAgent.toLowerCase(),isIphone=(userAgentString.indexOf("iphone")>-1),isIpad=(userAgentString.indexOf("ipad")>-1);return(dojo.isBrowser&&!(isIphone||isIpad));}};
dojo.provide("dj.community.CommunityLive");dj.community.CommunityLive=function(communitySiteRoot,container,delayInterval,options){options=options||{};var _lastId=options.lastid;var _updateDiv=document.createElement("div");var _trimResults=function(){var list=new dojo.NodeList(dojo.byId('communityLiveList'));if(!list){return;}
dojo.place(_updateDiv.innerHTML,list[0],"first");var itemCount=list.children().length-2;var removalQueue=[];for(var i=6;i<itemCount;i++){var item=list.children()[i];removalQueue.push(item);}
for(var rItemIndex=0;rItemIndex<removalQueue.length;rItemIndex++){var itemToRemove=removalQueue[rItemIndex];dojo.destroy(itemToRemove);}};trimResults=function(){dojo.deprecated("trimResults","remove if not used publicily","1.0.0");_trimResults();};var _pollCommunityLive=function(lastId){var sUri=options.subjecturi;var url=communitySiteRoot+"/communitylive/newentries.sync?r="+Math.floor(Math.random()*1000);if(sUri){url+="&subjecturi="+sUri;}
if(lastId){url+="&lastId="+lastId;}
dojo.xhrGet({url:url,content:{tracking:options.tracking},loaddisabled:function(data,ioargs){dojo.place(data.replace(/^\s*/,""),_updateDiv,"only");},handle:function(response,ioargs){var json=dojo.fromJson(ioargs.xhr.getResponseHeader("X-JSON"));_processResults(ioargs,json);}});};pollCommunityLive=function(lastId){dojo.deprecated("pollCommunityLive","remove if not used publicily","1.0.0");_pollCommunityLive(lastId);};var touthnd;var _startTimer=function(){if(touthnd){clearTimeout(touthnd);}
touthnd=setTimeout(function(){_pollCommunityLive(_lastId);},delayInterval);};startTimer=function(){dojo.deprecated("startTimer","remove if not used publicily","1.0.0");_startTimer();};var _processResults=function(transport,json){if(json&&json.lastId){_lastId=json.lastId;_trimResults();}
_startTimer();};processResults=function(transport,json){dojo.deprecated("processResults","remove if not used publicily","1.0.0");_processResults(transport,json);};_pollCommunityLive(_lastId);return{Refresh:function(){if(touthnd){clearTimeout(touthnd);}
_pollCommunityLive(_lastId);}};};dojo.provide("dj.module.communityLive");dojo.require("dj.community.CommunityLive");dj.module.communityLive={showCommunityLive:function(refreshRate,urlPrefix){dojo.addOnLoad(function(){if(refreshRate==='undefined'||refreshRate===''){refreshRate=15000;}
if(urlPrefix){urlPrefix=urlPrefix+"/community";}else{urlPrefix=dj.context.core.urlPrefix+"/community";}
dj.community.CommunityLive(urlPrefix,'communityLive',refreshRate,{tracking:'mod=WSJ_hps_communityLive'});});}};
dojo.provide("dj.widget.video.model.PlayerEvents");dj.widget.video.model.PlayerEvents={playVideo:"onPlayVideo",pauseVideo:"onPauseVideo",unpauseVideo:"onUnpauseVideo",getSeek:"onGetSeek",stopVideo:"onStopVideo",createAdvertisement:"onCreateAdvertisement"voidMicroPopUpPlayer:"onOpenMicroPopUpPlayer"voidPopUpPlayer:"onOpenPopUpPlayer",continueLoadVideo:"onContinueLoadVideo",playNextVideo:"onPlayNextVideo"};dojo.provide("dj.widget.video.model.PlayerTypes");(dj.widget.video.model.PlayerTypes={MicroPlayer:{width:272,height:153,swfFile:"VideoMicroPlayer.swf"},MicroPlayerE:{width:360,height:203,swfFile:"VideoMicroPlayer.swf"},MicroPlayerF:{width:512,height:288,swfFile:"VideoMicroPlayer.swf"},MainPlayer:{width:512,height:363,swfFile:"VideoPlayerMain.swf"},AdPlayer:{width:336,height:280,swfFile:"adPlayer.swf"}}).prototype={};dojo.provide("dj.widget.video.model.SWFPlayer");(dj.widget.video.model.SWFPlayer=function(){this.objName="undefined";this.id="";this.swfURL="";this.containerID="";this.width=0;this.height=0;this.videoGUID="";this.flashVersion="9.0.0";this.allowPlayerPopup=1;this.plyMediaEnabled=1;this.host="video.wsj.com";this.allowScriptAccess="always";this.windowMode="opaque";this.configURL="";this.eventNamespace="";this.playVideo="";this.pauseVideo="";this.unpauseVideo="";this.getSeek="";this.stopVideo="";this.createAdvertisement="";voidPopUpPlayer="";this.continueLoadVideo="";this.playNextVideo="";this.chainVideos=1;}).prototype={};dojo.provide("dj.widget.video.view.BasePlayer");dojo.declare("dj.widget.video.view.BasePlayer",null,{constructor:function(userConfiguration){this.controller=null;this.configuration={name:"",preloaddisablederClassName:"videoObjectLoading"};dojo.mixin(this.configuration,userConfiguration);this.playerCreated=false;},init:function(controller){this.controller=controller;},render:function(){console.error("{BasePlayer} 'render' must be overritten");}voidPopUpPlayer:function(){console.error("{BasePlayer} voidPopUpPlayer' must be overritten");}});dojo.provide("dj.util.VideoUtils");dojo.require("swfobject.swfobject_2_2.swfobject");(function(){dj.util.VideoUtils={formatDuration:function(seconds){if(seconds<60){return"0:"+this.formatSeconds(seconds);}
var minutes=0;while(seconds>59){seconds-=60;minutes++;}
return minutes+":"+this.formatSeconds(seconds);},formatSeconds:function(seconds){if(seconds>9){return seconds;}else{return"0"+seconds;}},nullOrUndefined:function(obj){return(obj===null||obj=="undefined");},emptyOrNull:function(string){if(!this.nullOrUndefined(string)){return string.length===0;}
return true;},nonSupportingFlashPlayer:function(divId){dojo.byId(divId).innerHTML="<div class=\"noFlash\"><p>This content can not be displayed because your "
+"browser does not support the Adobe Flash player required to view it.</p></div>";},hasValidFlashVersion:function(){var flashVersion=swfobject.getFlashPlayerVersion();console.log(swfobject);if(flashVersion){console.log(flashVersion);return(flashVersion.major>=9);}else{console.error("{VideoUtils} - flashVersion is undefined.")
return false;}},createSWFPlayer:function(player){if(this.hasValidFlashVersion()){var flashvars={objName:player.objName,allowPlayerPopup:player.allowPlayerPopup,plyMediaEnabled:player.plyMediaEnabled,movieWidth:player.width,movieHeight:player.height,host:player.host,playVideo:this.addEventNamespace(player.eventNamespace,player.playVideo),pauseVideo:this.addEventNamespace(player.eventNamespace,player.pauseVideo),unpauseVideo:this.addEventNamespace(player.eventNamespace,player.unpauseVideo),getSeek:this.addEventNamespace(player.eventNamespace,player.getSeek),stopVideo:this.addEventNamespace(player.eventNamespace,player.stopVideo),createAdvertisement:this.addEventNamespace(player.eventNamespace,player.createAdvertisement)voidPopUpPlayer:this.addEventNamespace(player.eventNamespace,voidPopUpPlayer)voidMicroPopUpPlayer:this.addEventNamespace(player.eventNamespace,voidMicroPopUpPlayer),continueLoadVideo:this.addEventNamespace(player.eventNamespace,player.continueLoadVideo),playNextVideo:this.addEventNamespace(player.eventNamespace,player.playNextVideo)};if(player.swfURL=="/media/swf/VideoMicroPlayer.swf"){player.chainVideos=1;var chainVideosFlag=dojo.getObject("dj.context.video.chainVideos");if(chainVideosFlag!=undefined&&chainVideosFlag===false){player.chainVideos=0;}
flashvars.chainVideos=player.chainVideos;}
try{swfobject.embedSWF(dj.context.core.cdnPrefix+player.swfURL,player.containerID,player.width,player.height,player.flashVersion,"",flashvars,{allowscriptaccess:player.allowScriptAccess,wmode:"opaque"},{id:player.id});}catch(e){console.error("Error on embending "+e);}}else{this.nonSupportingFlashPlayer(player.containerID);}},addEventNamespace:function(ns,event){if(event===null||event===""){return event;}
else{return ns+"."+event;}},popUpPlayer:function(parameters){var popUpPageURL="/public/page/0_0_WP_3001.html";if(dj.context.videoCenter.popUpPageURL){popUpPageURL=dj.context.videoCenter.popUpPageURL;}
var popUpWindow=void(popUpPageURL+'?currentPlayingLocation='+parameters.playLocation+'&currentlyPlayingCollection='+escape(parameters.collection)+'&currentlyPlayingVideoId='+parameters.videoID,'popUpPlayer','height=690,width=510,left='+((screen.width-Number(parameters.width))/2)+',top='+(screen.height-Number(parameters.height))/2+',resizable=yes,scrollbars=no,toolbar=no,status=no');},isGUID:function(guid){return guid.match(/{\w{8}-\w{4}-\w{4}-\w{4}-\w{12}}/);},normalizeGuid:function(guid){return this.isGUID(guid)?guid:"{"+guid+"}";},omnitureEncoding:function(col,subcol,type){if(col=='News'){if(subcol=='Politics'&&type=='s'){return'Politics & Campaign';}
if(this.emptyOrNull(subcol)){return'US';}}
if(col=='Management'){if(this.emptyOrNull(subcol)&&type=='c'){return'Business';}
if(this.emptyOrNull(subcol)&&type=='s'){return'Management';}
if(subcol=='Business Insight'){if(type=='c'){return'Business';}
else{return'Business Insight';}}
return'Business';}
if(col=='Lifestyle'&&type=='c'){return'Life & Style';}
if(col=='Special Packages'){if(subcol=='Journal Reports'&&type=='c'){return'Special';}
if(subcol=='Journal Reports'&&type=='s'){return'In-Depth Reports';}
if(subcol=='Journal Women'&&type=='c'){return'Careers';}
if(subcol=='Journal Women'&&type=='s'){return'Journal Women';}}
if(type=='s'&&this.emptyOrNull(subcol)){return col;}
if(type=='s'){return subcol;}
if(type=='c'){return col;}},isVideoSupported:function(){if(typeof this._isHtml5==="undefined"){var detect=(document.createElement('video')||false),mp4Cpt='video/mp4; codecs="avc1.42E01E, mp4a.40.2"',oggCpt='video/ogg; codecs="theora, vorbis"';this._isHtml5=detect&&(typeof detect.canPlayType!=="undefined");this._isH264=this._isHtml5&&(detect.canPlayType(mp4Cpt)==="maybe"||detect.canPlayType(mp4Cpt)==="probably");this._isOgg=this._isHtml5&&(detect.canPlayType(oggCpt)==="maybe"||detect.canPlayType(oggCpt)==="probably");}
return this._isHtml5;},isOggTheoraVideoSupported:function(){return(this.isVideoSupported()&&this._isOgg);},isH264BaselineVideoSupported:function(){return(this.isVideoSupported()&&this._isH264);},callThroughDispatch:function(callback,context){var link=dojo.create('a',{"is":"false"});dojo.place(link,dojo.body());var linkId=dj.util.Element.identify(link);dojo.connect(link,"click",function(event){dojo.stopEvent(event);if(link.getAttribute("is")==="true"){return;}
else{link.setAttribute("is","true");}
callback.call(context);});setTimeout(dojo.hitch(this,function(){this._doEventDispatch(linkId);}),400);},_doEventDispatch:function(elId){var evt,el=dojo.byId(elId);if(document.createEvent){evt=document.createEvent("MouseEvents");if(evt.initMouseEvent){evt.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);}else{evt=false;}}
(evt)?el.dispatchEvent(evt):(el.click&&el.click());}};}());dojo.provide("dj.util.Video");dojo.require("dj.lang");dojo.require("dj.util.Cookie");dojo.require("dj.util.Observer");dojo.require("dj.util.Omniture");dojo.require("dj.util.Page");dojo.require("dj.util.Region");dojo.require("dj.util.User");dojo.require("dj.util.Query");(function(){var dju=dj.util,djp=dj.util.Page,obs=new dju.Observer(dj.util.Video),players={};dju.Video={unpauseVideo:function(playerId){obs.fireByName("unpauseVideo",playerId);},pauseVideo:function(playerId){obs.fireByName("pauseVideo",playerId);},playVideo:function(playerId){obs.fireByName("playVideo",playerId);},getSeek:function(playerId){obs.fireByName("getSeek",playerId);},stopVideo:function(playerId){obs.fireByName("stopVideo",playerId);},collapsePlayer:function(playerId){obs.fireByName("collapsePlayer",playerId);},expandPlayer:function(playerId){obs.fireByName("expandPlayer",playerId);},isVideoPlayerCollapsed:function(playerId){var player=this._getOrCreatePlayer(playerId);if(player.isCollapsed){return true;}
var cookie=dju.Cookie.getGroupCookie("DJCOOKIE","PLAYERCOLLAPSED_"+playerId),isPlayerCollapsed=(cookie==="yes");if(isPlayerCollapsed){this._collapsePlayerCallback(playerId);}
player.isCollapsed=isPlayerCollapsed;return player.isCollapsed;},subscribe:function(videoEventName,callback,context){obs.subscribeByName(videoEventName,callback,context);},_getOrCreatePlayer:function(playerId){if(!players[playerId]){players[playerId]={isCollapsed:false,largestHeight:25,smallestHeight:25};}
return players[playerId];},handlePageRefresh:function(){var dup=dju.Page,onCb=function(playerId){dup.enableRefresh();},offCb=function(playerId){dup.disableRefresh();};this._subOnOff(onCb,offCb);},handleModuleRefresh:function(moduleName){var onCb=function(playerId){djp.enableModuleRefresh(moduleName);if(dj.module[moduleName+'_updater']){dj.module[moduleName+'_updater'].start();}},offCb=function(playerId){djp.disableModuleRefresh(moduleName);};this._subOnOff(onCb,offCb);},handleVideoPlayer:function(){this.subscribe("collapsePlayer",this._collapsePlayerCallback,this);this.subscribe("expandPlayer",this._expandPlayerCallback,this);},_getPlayerAndUpdateHeights:function(playerId){var player=this._getOrCreatePlayer(playerId);player.node=dojo.byId(playerId);player.largestHeight=(player.node.height>player.largestHeight)?player.node.height:player.largestHeight;player.smallestHeight=(player.node.height<player.smallestHeight)?player.node.height:player.smallestHeight;return player;},_collapsePlayerCallback:function(playerId){var player=this._getPlayerAndUpdateHeights(playerId);if(player.isCollapsed){return;}
player.isCollapsed=true;var container=dj.util.Query.up(player.node,"div");if(container!==dojo.doc){dojo.style(container,{width:"",height:""});}
dojo.anim(player.node,{height:{end:player.smallestHeight}});dju.Cookie.setGroupCookie("DJCOOKIE","PLAYERCOLLAPSED_"+playerId,"yes",(1/24));},_expandPlayerCallback:function(playerId){var player=this._getPlayerAndUpdateHeights(playerId);if(!player.isCollapsed){return;}
player.isCollapsed=false;dojo.anim(player.node,{height:{end:player.largestHeight}});dju.Cookie.deleteGroupCookie("DJCOOKIE","PLAYERCOLLAPSED_"+playerId);},handleNewsHubPageRefresh:function(){var refreshNewsHubPage=function(){location.pathname=location.pathname;};this.subscribe("stopVideo",refreshNewsHubPage,this);},_subOnOff:function(on,off){this.subscribe("unpauseVideo",off,this);this.subscribe("pauseVideo",off,this);this.subscribe("playVideo",off,this);this.subscribe("getSeek",off,this);this.subscribe("stopVideo",on,this);},formatduration:function(d){var minutes=Math.floor(d/60);var seconds=d%60;if(seconds<10){seconds='0'+seconds;}
return''+minutes+':'+seconds;},getVideoDetails:function(args){if(!args.id){return"No Id.";}
var url='/api-video/get_video_info.asp?guid='+args.id;if(args.fields){url+='&fields='+args.fields;}
else{url+='&fields=all';}
dojo.getObject("dj.util.Video.jsonData",true);var params={context:this,handleAs:"json",sync:true,responseType:"application/json",callback:function(json){dju.Video.handleGetVideoDetails(json,args.id);},errorCallback:function(){console.error("Failed while executing util.Video.getVideoDetails");}};dj.util.Video.getVideoData(url,params);return dju.Video.jsonData[args.id];},handleGetVideoDetails:function(json,id){dju.Video.jsonData[id]=json;},getVideoData:function(url,params){params.responseType=(!params.responseType)?"text/xml":params.responseType;var isResponseJson=(params.responseType.indexOf("json")>-1);this._sendXhrRequest(url,params,{requestMethod:"GET",handleAs:(isResponseJson)?"json":"xml",appendCacheBuster:true,requestHeaders:{"Accept":params.responseType},sync:(params.sync?true:false)});},postVideoData:function(url,postData,params){this._sendXhrRequest(url,params,{requestMethod:"POST",content:dojo.toJson(postData),requestHeaders:{"X-HTTP-Method-Override":"POST","Content-Type":"application/json"},sync:(params.sync?true:false)});},putVideoData:function(url,postData,params){this._sendXhrRequest(url,params,{requestMethod:"PUT",content:dojo.toJson(postData),requestHeaders:{"X-HTTP-Method-Override":"PUT","Content-Type":"application/json"},sync:(params.sync?true:false)});},deleteDashboardData:function(url,postData,params){this._sendXhrRequest(url,params,{requestMethod:"POST",content:dojo.toJson(postData),requestHeaders:{"X-HTTP-Method-Override":"DELETE","Content-Type":"application/json"},sync:(params.sync?true:false)});},_sendXhrRequest:function(requestUrl,userParams,requestOptions){var params=dj.lang.cloneMixin({callback:function(){}},userParams);var options=dj.lang.cloneMixin({requestHeaders:{"Accept":"application/json"},handleAs:"json",appendCacheBuster:false,sync:false},requestOptions);if(options.appendCacheBuster){requestUrl=this._appendCacheBuster(requestUrl);}
var xhrReq=this._getRequestByMethod(options.requestMethod);var deferred=xhrReq({url:requestUrl,headers:options.requestHeaders,handleAs:options.handleAs,postData:options.content,sync:options.sync,loaddisabled:function(data,ioargs){if(params.context){params.callback.apply(params.context,[data,ioargs.xhr,params]);}else{params.callback.apply(this,[data,ioargs.xhr,params]);}},error:function(error,ioargs){console.error("httpdisabled status code: %s, response: %o",ioargs.xhr.status,data);if(typeof params.errorCallback!=="undefined"){params.errorCallback.apply(params.context,[ioargs.xhr.status,ioargs.xhr,params]);}else{params.callback.apply(params.context,[ioargs.xhr.status,ioargs.xhr,params]);}}});return deferred;},_appendCacheBuster:function(requestUrl){var cb=(Math.floor(10000000*Math.random()));requestUrl+=(requestUrl.indexOf('?')>-1)?("&cb="+cb):("?cb="+cb);return requestUrl;},_getRequestByMethod:function(requestMethod){return(requestMethod=="GET")?dojo.xhrGet:dojo.xhrPost;},getUrlParam:function(srcUrl,name){name=name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(srcUrl);if(results===null){return"";}
else{return results[1];}},nonSupportingFlashPlayer:function(divId){dojo.byId(divId).innerHTML="<p>This content can not be displayed because your "
+"browser does not support the Adobe Flash player required to view it.</p>";},omnitureEncoding:function(col,subcol,type){if(col=='News'){if(subcol=='Politics'&&type=='s'){return'Politics & Campaign';}
if((!this.isNotBlankOrNull(subcol))&&type=='c'){return'US';}
if((!this.isNotBlankOrNull(subcol))&&type=='s'){return'US';}}
if(col=='Management'){if((!this.isNotBlankOrNull(subcol))&&type=='c'){return'Business';}
if((!this.isNotBlankOrNull(subcol))&&type=='s'){return'Management';}
if(subcol=='Business Insight'&&type=='c'){return'Business';}
if(subcol=='Business Insight'&&type=='s'){return'Business Insight';}
return'Business';}
if(col=='Lifestyle'){return'Life & Style';}
if(col=='Special Packages'){if(subcol=='Journal Reports'&&type=='c'){return'Special';}
if(subcol=='Journal Reports'&&type=='s'){return'In-Depth Reports';}
if(subcol=='Journal Women'&&type=='c'){return'Careers';}
if(subcol=='Journal Women'&&type=='s'){return'Journal Women';}}
if(type=='s'&&!(this.isNotBlankOrNull(subcol))){return col;}
if(type=='s'){return subcol;}
if(type=='c'){return col;}},isNotBlankOrNull:function(strVar){return(strVar!==''&&strVar!==null&&typeof strVar!='undefined');},setupConfig:function(widget){var config={};config.emailURL='http:\u002F\u002Fwww.emailthis.clickability.com\u002Fet\u002FemailThis?clickMap=create&fb=Y&url=@VIDEO_LINK_URL&title=@VIDEO_TITLE&random=@RANDOM_NUMBER&partnerID=@EMAIL_PARTNER_ID&image=@VIDEO_STILL_URL&expire=&summary=@VIDEO_DESCRIPTION';config.domainName='wsj';config.embedConfigURL="httpdisabled://wsj.vo.llnwd.net/o28/players/";config.popUpPageUrl='/public/page/0_0_WP_3001.html';if(dj.context.videoCenter.popUpPageURL){config.popUpPageUrl=dj.context.videoCenter.popUpPageURL;}
var siteFrmUrl=this.getUrlParam(window.location.href,'site');var siteFrmContxt='';try{siteFrmContxt=dj.context.videoCenter.host;}
catch(e){console.error("Error while getting site value from context. "+e.message);}
config.site=this.isNotBlankOrNull(siteFrmUrl)?siteFrmUrl:siteFrmContxt;config.msrc=this.getUrlParam(window.location.href,'msrc');config.playFromRegisteredVideos=false;config.pageSize=12;config.browsingGroup="collection";config.playingGroup="collection";config.skipCollection=true;config.prop24='';config.prop25='';config.prop27='';try{if(typeof setEdition==="function"){config.prop24=setEdition(dj.util.Region.getViewByRegion());}}
catch(e){console.error("cookie read error while fetching prop24 : "+e);}
try{config.prop25=dj.util.Cookie.getCookie('TR');}
catch(e){console.error("cookie read error while fetching prop25 : "+e);}
try{config.cookieUserType=dj.util.Cookie.getCookie("user_type");}
catch(e){console.error("cookie read error while fetching cookieUserType : "+e);}
try{dj.util.User.isLoggedIn(function(isLoggedIn){if(isLoggedIn){dj.util.User.isSubLoggedIn(function(subLoggedIn){if(subLoggedIn){config.prop27='WSJ_sub_yes';}
else{config.prop27='WSJ_mem_yes';}});}
else{if(config.cookieUserType===null||config.cookieUserType!=="subscribed"){config.prop27='WSJ_free';}
else{config.prop27='WSJ_reg_yes';}}});}
catch(e){console.error("cookie read error while fetching prop27");}
return config;}};}());dojo.provide("dj.util.VideoTracking");dojo.require("dj.util.VideoUtils");dojo.require("dj.util.Tracking");dj.util.VideoTracking={init:function(){if(typeof this.omniture==="object"){return;}
this.omniture=dj.util.Tracking.omniture;},fire:function(videoInfoObject){try{this.init();var newData=this._getOmnitureObject(videoInfoObject);var currentData=this._getCurrentOmnitureObject(newData);this._setOmnitureData(newData);this._firePixel();this._setOmnitureData(currentData);}catch(e){console.error("{VideoTracking} ",e);}},_getOmnitureObject:function(data){var appName=data.appName.toUpperCase(),ft=function(arr){return appName+"_"+arr.join("_");};var omObj={pageName:ft(["Video",data.name]),section:"Video",subsection:ft([data.section]),atype:ft(["Video_Video",data.section]),apage:ft(["Video_Video",data.subsection]),aheadline:"video_"+data.name,basesection:ft([data.subsection]),abasedocid:data.id,ctype:data.appType,csource:data.provider+" video",caccess:"free",qsymbol:data.adZone};return omObj;},_getCurrentOmnitureObject:function(omObject){var oldObj={};for(var name in omObject){if(omObject.hasOwnProperty(name)){oldObj[name]=this.omniture.getMetaData(name);}}
return oldObj;},_setOmnitureData:function(omObject){for(var name in omObject){if(omObject.hasOwnProperty(name)){this.omniture.setMetaData(name,omObject[name]);}}},_firePixel:function(){this.omniture.firePixel(true);}};dojo.provide("dj.module.videoModule");dojo.require("dj.lang");dojo.require("dj.util.Video");dojo.require("dj.widget.panels.PanelsFactory");dj.module.videoModule={init:function(config){var djL=dj.lang;this.cfg=djL.deepMixin({videoModuleContainerId:"videoModule",autonomyVideoClassName:"autonomy_video"},config);var oVidMod=dojo.byId(this.cfg.videoModuleContainerId);if(oVidMod===null){console.log("{VideoModule} is undefined.");return;}
if(dojo.hasClass(oVidMod,this.cfg.autonomyVideoClassName)){this._setupAutonomyVideo(oVidMod);}
this._setupVideo(oVidMod);},_setupVideo:function(oVidMod){this.panels=dj.widget.panels.PanelsFactory.create(oVidMod,{core:{},carousel:{}});},_setupAutonomyVideo:function(oVidMod){var djL=dj.lang;var oVideoElements=dojo.query('.preview',oVidMod);var oVideoElId=null;for(var i=0,len=oVideoElements.length;i<len;i++){var oVideoEl=oVideoElements[i];oVideoElId=oVideoEl.id;var tempGUID=oVideoElId.split(':');var getImgGuid=tempGUID[1].replace(/_/g,'-');var guidVideoDetails=dj.util.Video.getVideoDetails({'id':getImgGuid,'fields':'thumbnailURLSmall'});if(guidVideoDetails!=="undefined"){var getSmallThumnailURL='url('+guidVideoDetails.thumbnailURLSmall+')';if(getSmallThumnailURL!==null){oVideoEl.style.backgroundImage=getSmallThumnailURL;}}else{console.log('getSmallThumnailURL is '+getSmallThumnailURL);oVideoEl.style.backgroundImage='/img/bb/BB_DBlogo.gif';}}}};dojo.provide("dj.widget.video.controller.Player");dojo.require("dj.lang");dojo.require("dj.util.Observer");dojo.require("dj.util.User");dojo.require("dj.util.Region");dojo.require("dj.util.Omniture");dojo.require("dj.util.Cookie");dojo.require("dj.util.Page");dojo.require("dj.widget.video.model.PlayerTypes");dojo.declare("dj.widget.video.controller.Player",null,{DEFAULT_CONFIG:{flashPlayerPath:"/media/swf/",playerType:dj.widget.video.model.PlayerTypes.MainPlayer,containerID:"videoPlayer",descriptionID:"videoPlayerDescription",playerID:"",videoAPIURL:"/api-video/get_video_info.asp",embedConfURL:"httpdisabled://wsj.vo.llnwd.net/o28/players/",eventNamespace:"",host:location.host,applications:["video","video_popup","video_tab","video_emb","video_home"],applicationID:0,loaddisabledWaitTime:1000,loaddisabledWaitCount:10,dataset:{},adFormat:"frmt=2;"},constructor:function(obs,userConfiguration){this.observer=(obs||new dj.util.Observer(dj.widget.video.VideoPlayer));this.configuration=dojo.mixin(dojo.clone(this.DEFAULT_CONFIG),userConfiguration);this.videoInformation={};this.seekTime=null;this.view=null;this.readyForEvents=false;this.playedOn=null;var siteFromUrl=dj.util.Page.getQueryParam("site");var siteFromContext="";try{siteFromContext=dj.context.videoCenter.host;}catch(e){console.error("{Player} error while getting site value from context. ",e.message);}
this.site=(siteFromUrl)?siteFromUrl:siteFromContext;this.msrc=dj.util.Page.getQueryParam("msrc");},init:function(view,videoID,seekTime){if(seekTime){this.seekTime=seekTime;}
this.view=view;this.view.init(this);if(videoID){this.playVideo(videoID);}
this.loaddisabledRetriesLeft=this.configuration.loaddisabledWaitCount;},playVideo:function(videoID,playedOn){if(playedOn){this.playedOn=playedOn;}
this.loaddisabledRetriesLeft=this.configuration.loaddisabledWaitCount;if(this.view.renderPreloaddisableder){this.view.renderPreloaddisableder();}
this.queryVideo(videoID);},queryVideo:function(videoID){var that=this;var requestURL=this.configuration.videoAPIURL+"?guid="+videoID+"&fields=all";dojo.xhrGet({url:requestURL,handleAs:"json",preventCache:true,headers:{"Accept":"application/json"},loaddisabled:function(response,ioArgs){that.videoID=videoID;that.videoInformation=response;that.render();that.loaddisabledVideo();that.observer.fireByName("onVideoLoaded",videoID,response,that.playedOn);return response;},error:function(response,ioArgs){console.error("{Player} could not loaddisabled video: '%s'. Response: %o",videoID,response);return response;}});},render:function(){return this.view.render();},loaddisabledVideo:function(){if(this.loaddisabledRetriesLeft==0){console.info("{Player} number of Load Retries expired");return;}
var that=this;if(this.readyForEvents){this._startPlaying();}else{this.loaddisabledRetriesLeft--;setTimeout(function(){that.loaddisabledVideo();},this.configuration.loaddisabledWaitTime);}},_startPlaying:function(){this.view.play(this.addVideoParameters(this.videoInformation));},videoPlayed:function(){},videoPaused:function(){},videoUnPaused:function(){},videoPopUp:function(){},getCurrentVideoID:function(){return this.videoID;},getVideoData:function(data){return this.videoInformation[data];},addVideoParameters:function(params){var wsjPrefix='WSJ_';if(!params){params={};}
if(this.seekTime){params.seekTime=this.seekTime;this.seekTime=null;}
params.emailPartnerID=110626;params.site=this.site;params.msrc=this.msrc;params.adFrmt=this.configuration.adFormat;params.playerName=this.view.configuration.name;params.embedPlayerURL=dj.context.core.cdnPrefix+this.configuration.flashPlayerPath+this.configuration.playerType.swfFile;params.embedConfigURL=this.configuration.embedConfURL;params.embedPlayerID="1000";params.embedName=this.configuration.playerID;params.embedBaseURL=dj.context.core.cdnPrefix+this.configuration.flashPlayerPath;params.embedHeight=this.configuration.playerType.height;params.embedWidth=this.configuration.playerType.width;params.larsID=91;params.larsAdTrackingID=1259;if(this.playedOn){params.lineupID=unescape(this.playedOn).toLowerCase().replace(/[^a-zA-Z0-9]/g,"");}
if(typeof setEdition==="function"){params.prop24=setEdition(dj.util.Region.getViewByRegion());}
params.prop27="";try{dj.util.User.isLoggedIn(function(isLoggedIn){if(isLoggedIn){dj.util.User.isSubLoggedIn(function(subLoggedIn){if(subLoggedIn){dj.util.User.hasRole('WSJ-PRO',function(hasRole){if(hasRole){wsjPrefix='WSJPRO_';params.prop27='WSJ_proc_sub_yes';params.prop8='WSJ Professional Enterprise';params.prop9='premium';params.prop24='Edition_US_Professional_Consumer';}else{dj.util.User.hasRole('WSJ-ENT',function(hasRole){if(hasRole){wsjPrefix='WSJPRO_';params.prop27='WSJ_proe_sub_yes';params.prop8='WSJ Professional Enterprise';params.prop9='premium';params.prop24='Edition_US_Professional';}else{params.prop27='WSJ_sub_yes';}});}});}else{params.prop27='WSJ_mem_yes';}});}
else{if(params.cookieUserType===null||params.cookieUserType!=="subscribed"){params.prop27='WSJ_free';}
else{params.prop27='WSJ_reg_yes';}}});}catch(e){console.info(e);}
var subSecComponent=dj.util.VideoUtils.omnitureEncoding(params['wsj-section'],params['wsj-subsection'],'s');var secComponent=dj.util.VideoUtils.omnitureEncoding(params['wsj-section'],params['wsj-subsection'],'c');params.appName=wsjPrefix.substring(0,wsjPrefix.length-1);params.appType=this.configuration.applications[this.configuration.applicationID];params.section=secComponent;params.subsection=subSecComponent;params.prop2=wsjPrefix+secComponent;params.prop3=wsjPrefix+"Video_Video_"+secComponent;params.prop22=wsjPrefix+"Video_Video_"+subSecComponent;params.prop26=wsjPrefix+subSecComponent;params.prop5=window.location.href.split('?')[0];;params.prop6=window.location.href;params.prop10=dj.util.Page.getQueryParam("mod");params.campaign=dj.util.Page.getQueryParam("mod");params.prop11=dj.util.Page.getQueryParam("reflink");params.prop19=params.appType;params.prop25=dj.util.Cookie.getCookie('TR');try{params.cookieUserType=dj.util.Cookie.getCookie("user_type");}catch(e){console.error("cookie read error while fetching cookieUserType : "+e);}
var suprsAd=((typeof pID==="string")&&(pID.indexOf('0_0_WH')!=-1))?'1':'0';params.suppressAds=suprsAd;return params;}});dojo.provide("dj.widget.video.VideoCenter");dojo.require("dj.lang");dojo.require("dj.util.Ads");dojo.require("dj.util.Cookie");dojo.require("dj.util.Omniture");dojo.require("dj.util.Region");dojo.require("dj.util.Tracking");dojo.require("dj.util.User");dojo.require("dj.util.Video");dojo.require("swfobject.swfobject_2_2.swfobject");dojo.getObject("dj.context.video",true);dojo.declare("dj.widget.video.VideoCenter",null,{constructor:function(args,objName){this.version="1.0.2";this.videoUtil=dj.util.Video;this.usrActnHash={'':this.handleResponse,'toBrowse':this.handleBrowsingResults,'toSearch':this.handleSearchResults,'current':this.handleCurrent,'next':this.handleNext};this.microPlayers=[];this.microPlayersObjects={};this.videoIdMicroPlayerIdMap={};this.popUpWindow='';this.flashPlayerPath=dj.context.core.cdnPrefix+"/media/swf/";this.collectionsXMLPath="/static_html_files/";this.videoCenterPageUrl="/video-center";this.popUpPageUrl='/public/page/0_0_WP_3001.html';this.objName=objName;this.videoPlayerDivId='video_player';this.sideNavUlId='video_sidenav';this.topNavUlId='video_topnav';this.nextVideoDivId='next_video';this.videoResultsDivId='video_results';this.searchDivId='video_search';this.advertisementDivId='advertisement';this.collectionsSelectId='collectionsSelectId';this.videoSummaryDivId='video_headline';this.registeredVideosDivId='registered_videos';if(this.videoUtil.isNotBlankOrNull(args)){this.videoPlayerDivId=args.videoPlayerDivId?args.videoPlayerDivId:'video_player';this.sideNavUlId=args.sideNavUlId?args.sideNavUlId:'video_sidenav';this.topNavUlId=args.topNavUlId?args.topNavUlId:'video_topnav';this.nextVideoDivId=args.nextVideoDivId?args.nextVideoDivId:'next_video';this.videoResultsDivId=args.videoResultsDivId?args.videoResultsDivId:'video_results';this.searchDivId=args.searchDivId?args.searchDivId:'video_search';this.advertisementDivId=args.advertisementDivId?args.advertisementDivId:'advertisement';this.videoSummaryDivId=args.videoSummaryDivId?args.videoSummaryDivId:'video_headline';this.registeredVideosDivId=args.registeredVideosDivId?args.registeredVideosDivId:'';}
this.xmlDoc='';this.defaultCollectionName='News';this.rssUrlsObject={};this.contentUrlsObject={};this.collectionNamesArray=[];this.subcollectionsObject={};this.urlKeysCollectionMap={};this.urlKeysSubCollectionMap={};this.currentlyPlayingVideoId='';this.currentlyPlayingVideoIds=[];this.currentlyPlayingCollection='';this.currentlyPlayingSubCollection='';this.nextVideoId='';this.visibleCollectionId='';this.visibleSubCollectionId='';this.sortOrder='relevancy';this.currentSearchText='';this.isVideoResultsInSideNav=false;this.currentPlayingJsonObject={};this.currentBrowsingJsonObject={};this.currentSearchJsonObject={};this.currentVideoDetailsJsonObject={};this.nextVideoDetailsJsonObject={};this.registeredVideos=[];this.registeredVideosIds=[];this.relatedVideosCollection='';this.userAction='';this.sourceApplicationName='';this.bookMarkedId='';this.bookMarkedLocation='';this.cookieUserType='';dj.lang.mixin(this,this.videoUtil.setupConfig());},loaddisabledVideo:function(id,sourceApplicationName,domainName){console.info("video.js v"+this.version);if(this.videoUtil.isNotBlankOrNull(domainName)){this.domainName=domainName;}
this.sourceApplicationName=sourceApplicationName;if(this.videoUtil.isNotBlankOrNull(id)){if(id.indexOf('{')==-1){this.currentlyPlayingVideoId='{'+id+'}';}
else{this.currentlyPlayingVideoId=id;}}
if(swfobject.getFlashPlayerVersion().major>=9){this.createFlashPlayer();}
else{dj.util.Video.nonSupportingFlashPlayer(this.videoPlayerDivId);}},continueLoadVideo:function(){this.loaddisabledCollectionsDoc(this,this.handleLoadVideo);},handleLoadVideo:function(data,xhr){this.xmlDoc=xhr.responseXML.documentElement;this.parseInformationFromXmlDoc();if(this.sourceApplicationName=='articlePage'){this.visibleCollectionId='';var vObj='';if(this.videoUtil.isNotBlankOrNull(this.currentlyPlayingVideoId)){vObj=this.registeredVideos[this.registeredVideosIds.indexOf(this.currentlyPlayingVideoId)];this.playVideoByParam(vObj);}else{if(this.videoUtil.isNotBlankOrNull(this.bookMarkedId)){this.currentlyPlayingVideoId=this.bookMarkedId;vObj=this.registeredVideos[this.registeredVideosIds.indexOf(this.currentlyPlayingVideoId)];vObj.seekTime=this.bookMarkedLocation;this.playVideoByParam(vObj);}else{vObj=this.registeredVideos[0];this.currentlyPlayingVideoId=vObj.id;this.playVideoByParam(vObj);}}
this.relatedVideosCollection=this.videoUtil.isNotBlankOrNull(this.registeredVideos[0]['wsj-section'])?this.registeredVideos[0]['wsj-section']:this.defaultCollectionName;this.currentlyPlayingCollection=this.registeredVideos[0]['wsj-section'];if(this.currentlyPlayingCollection=='Lifestyle'){this.currentlyPlayingCollection='Life & Style';}
this.getVideos(this.validateContentUrl(this.contentUrlsObject[this.currentlyPlayingCollection])+'&count=60','',this,this.finishHandleLoadVideo);}
else{if(typeof AT_VARS!='undefined'&&AT_VARS.baseDocId){this.currentlyPlayingVideoId='{'+AT_VARS.baseDocId+'}';}
if(this.videoUtil.isNotBlankOrNull(this.currentlyPlayingVideoId)){this.playVideoByVideoId(this.currentlyPlayingVideoId);this.currentlyPlayingCollection=this.currentVideoDetailsJsonObject['wsj-section'];this.currentlyPlayingSubCollection=this.currentVideoDetailsJsonObject['wsj-subsection'];if(this.videoUtil.isNotBlankOrNull(this.currentlyPlayingSubCollection)){this.visibleCollectionId=this.collectionNameForSubcollection(this.currentlyPlayingSubCollection);this.currentlyPlayingCollection=this.visibleCollectionId;this.getVideos(this.validateContentUrl(this.contentUrlsObject[this.currentlyPlayingSubCollection])+'&count=60','',this,this.finishHandleLoadVideo);}
else{if(!this.videoUtil.isNotBlankOrNull(this.currentlyPlayingCollection)){this.currentlyPlayingCollection=this.defaultCollectionName;}
this.getVideos(this.validateContentUrl(this.contentUrlsObject[this.currentlyPlayingCollection])+'&count=60','',this,this.finishHandleLoadVideo);}}
else{var browserUrl=window.location.pathname;this.currentlyPlayingCollection=this.defaultCollectionName;if(browserUrl.indexOf(".")!=-1){var urlArray=browserUrl.split(".")[0].split('/');var urlKey=urlArray.pop();if(this.urlKeysCollectionMap[urlKey]){this.currentlyPlayingCollection=this.urlKeysCollectionMap[urlKey];}
if(this.urlKeysSubCollectionMap[urlKey]){this.currentlyPlayingSubCollection=this.urlKeysSubCollectionMap[urlKey];this.visibleCollectionId=this.collectionNameForSubcollection(this.currentlyPlayingSubCollection);this.currentlyPlayingCollection=this.visibleCollectionId;}}
var getVideoCallback=dojo.hitch(this,function(){this.currentlyPlayingVideoId=this.currentPlayingJsonObject.items[0].id;this.playVideoByVideoId(this.currentlyPlayingVideoId);this.finishHandleLoadVideo();});if(this.videoUtil.isNotBlankOrNull(this.currentlyPlayingSubCollection)){this.getVideos(this.validateContentUrl(this.contentUrlsObject[this.currentlyPlayingSubCollection])+'&count=60','',null,getVideoCallback);}else{this.getVideos(this.validateContentUrl(this.contentUrlsObject[this.currentlyPlayingCollection])+'&count=60','',null,getVideoCallback);}}}},finishHandleLoadVideo:function(){this.populateSideNav();this.populateTopNav();if(this.videoUtil.isNotBlankOrNull(this.currentlyPlayingSubCollection)){this.updateSideNavAppearance('subcollection',this.currentlyPlayingSubCollection);this.visibleSubCollectionId=this.currentlyPlayingSubCollection;this.browsingGroup="subcollection";this.playingGroup="subcollection";}else{this.updateSideNavAppearance('collection',this.currentlyPlayingCollection);this.visibleCollectionId=this.currentlyPlayingCollection;}
this.currentBrowsingJsonObject=this.currentPlayingJsonObject;if(this.sourceApplicationName=='articlePage'&&this.registeredVideosIds.length>0){this.createRegisteredVideosThumbnails();this.updateVideoThumbnailVisual('','reg'+this.currentlyPlayingVideoId);}
this.updateTopNavAppearance('',this.currentlyPlayingCollection);this.createNextVideo();this.createSearch();this.createAdvertisementFramework();this.populateMoreVideos(1);this.loaddisabledPagination(1);this.updateRssFeed((this.visibleSubCollectionId!=='')?this.visibleSubCollectionId:this.visibleCollectionId);},validateContentUrl:function(contentUrl){if(this.videoUtil.isNotBlankOrNull(contentUrl)){return contentUrl;}else{this.currentlyPlayingCollection=this.defaultCollectionName;return this.contentUrlsObject[this.defaultCollectionName];}},createAdvertisementFramework:function(){if(this.advertisementDivId){if(swfobject.getFlashPlayerVersion().major>=9){var dim={w:"336",h:"280"};swfobject.embedSWF(this.flashPlayerPath+"adPlayer.swf",this.advertisementDivId,dim.w,dim.h,"9.0.0","",{'objName':this.getName(),'movieWidth':dim.w,'movieHeight':dim.h,'host':location.host},{allowscriptaccess:"always",wmode:"opaque"},{});}else{dj.util.Video.nonSupportingFlashPlayer(this.advertisementDivId);}}},collectionNameForSubcollection:function(subCol){for(var index=0,len=this.collectionNamesArray.length;index<len;++index){if(this.subcollectionsObject[(this.collectionNamesArray[index])].indexOf(subCol)!=-1){return this.collectionNamesArray[index];}}},pauseMicroPlayers:function(){try{for(var index=0,len=this.microPlayers.length;index<len;++index){swfobject.getObjectById(this.microPlayers[index]).pauseVideo();}}
catch(e){console.error("Error while pausing microPlayers. "+e.message);}},setBookMark:function(){try{this.bookMarkedId=this.currentlyPlayingVideoId;this.bookMarkedLocation=Math.floor(swfobject.getObjectById("flashPlayer").getSeek());swfobject.getObjectById("flashPlayer").pauseVideo();}
catch(e){console.error("Error while setting the bookmark. "+e.message);}},updateVideoThumbnailVisual:function(cleanId,applyId){if(cleanId!==''&&dojo.byId("li_"+cleanId)){dojo.byId("li_"+cleanId).className="";}
if(applyId!==''&&dojo.byId("li_"+applyId)){dojo.byId("li_"+applyId).className="nowPlaying";}},parseInformationFromXmlDoc:function(){var collectionArray=this.xmlDoc.getElementsByTagName("collection");for(var index=0,len=collectionArray.length;index<len;++index){var item=collectionArray[index];this.urlKeysCollectionMap[item.getAttribute("urlkey")]=item.getAttribute("name");this.contentUrlsObject[item.getAttribute("name")]=item.getAttribute("contenturl");this.rssUrlsObject[item.getAttribute("name")]=item.getAttribute("rssurl");this.collectionNamesArray[this.collectionNamesArray.length]=item.getAttribute("name");var subCollectionArray=item.getElementsByTagName("subcollection");var subCollectionArrayLength=subCollectionArray.length;var subCollNamesAr=[];for(var sindex=0,slen=subCollectionArray.length;sindex<slen;++sindex){var sitem=subCollectionArray[sindex];this.urlKeysSubCollectionMap[sitem.getAttribute("urlkey")]=sitem.getAttribute("name");this.contentUrlsObject[sitem.getAttribute("name")]=sitem.getAttribute("contenturl");this.rssUrlsObject[sitem.getAttribute("name")]=sitem.getAttribute("rssurl");subCollNamesAr[sindex]=sitem.getAttribute("name");}
this.subcollectionsObject[item.getAttribute("name")]=subCollNamesAr;}},createFlashPlayer:function(){if(dojo.byId(this.videoPlayerDivId)){try{var dim={w:"512",h:"363"};swfobject.embedSWF(this.flashPlayerPath+"main.swf",this.videoPlayerDivId,dim.w,dim.h,"9.0.0","",{'objName':this.getName(),'allowPlayerPopup':'1','plyMediaEnabled':'1','movieWidth':dim.w,'movieHeight':dim.h,'host':location.host},{allowscriptaccess:"always",wmode:"opaque"},{id:"flashPlayer"});}
catch(e){console.error("Error occured createFlashPlayer.."+e.message);dojo.byId(this.videoPlayerDivId).innerHTML='Couldn\'t loaddisabled the flash player. \n Error message is: '+e.message;}}},convertCurrentPlayingJsonToIdsArray:function(){this.currentlyPlayingVideoIds=[];if(this.currentPlayingJsonObject.items.length>0){for(var index=0,len=this.currentPlayingJsonObject.items.length;index<len;++index){this.currentlyPlayingVideoIds[index]=this.currentPlayingJsonObject.items[index].id;}}},populateVideoSummary:function(name,description,formattedCreationDate){if(dojo.byId(this.videoSummaryDivId)){var str='';try{str+='<h2>'+name+' <small>'+formattedCreationDate.split(' ')[0]+'</small>';str+='</h2>';str+='<p>'+description+'</p>';}
catch(e){console.error("Error occured in populateVideoSummary."+e.message);str+='Couldn\'t get video summary.';}
dojo.byId(this.videoSummaryDivId).innerHTML=str;}},createAdvertisement:function(imgUrl,link){try{swfobject.getObjectById(this.advertisementDivId).loaddisabledAd(imgUrl,link);}
catch(e){console.error("Error while loaddisableding ad in createAdvertisement : "+e);}},createNextVideo:function(){var str='Loading...';try{this.nextVideoId=this.getNextVideoId();if(this.nextVideoId!==''){var url='/api-video/get_video_info.asp?guid='+this.nextVideoId+'&fields=all';this.getVideos(url,'next');}
else{str='No more videos.';}}
catch(e){console.error("Error occured while executing createNextVideo() - "+e.message);str+='Couldn\'t determine next video details.';}
if(dojo.byId(this.nextVideoDivId)){dojo.byId(this.nextVideoDivId).innerHTML=str;}},populateNextVideo:function(){var str='';try{var nameToDisplay=this.videoUtil.isNotBlankOrNull(this.currentlyPlayingSubCollection)?this.currentlyPlayingSubCollection:this.currentlyPlayingCollection;if(this.currentlyPlayingCollection=='Search Results'){str+='<h3>Next in Video '+this.currentlyPlayingCollection+'</h3>';}
else{str+='<h3>Next in '+nameToDisplay+' Video</h3>';}
str+='<ul class="newsItem video">';str+='<li>';str+='<a href="javascript:'+this.getName()+'.nextVideoThumbnailClicked(\''+this.nextVideoDetailsJsonObject.id+'\')" style="background-image: url('+this.nextVideoDetailsJsonObject.thumbnailURL+')" class="preview"><span>&nbsp;</span></a>';str+='<h2><a href="javascript:'+this.getName()+'.nextVideoThumbnailClicked(\''+this.nextVideoDetailsJsonObject.id+'\')">'+this.nextVideoDetailsJsonObject.name+'</a></h2>';var minutes=Math.floor(this.nextVideoDetailsJsonObject.duration/60);var seconds=this.nextVideoDetailsJsonObject.duration%60;if(seconds<10){seconds='0'+seconds;}
str+='<small>'+minutes+':'+seconds+'</small>';str+='<p>'+this.nextVideoDetailsJsonObject.description+'</p>';str+='</li>';str+='</ul>';}
catch(e){console.error("Error occured while executing populateNextVideo() - "+e.message);str+='Couldn\'t populate next video details.';}
if(dojo.byId(this.nextVideoDivId)){dojo.byId(this.nextVideoDivId).innerHTML=str;}},nextVideoThumbnailClicked:function(videoId){this.userAction='';this.populateMoreVideos(1);this.loaddisabledPagination(1);this.updateVideoThumbnailVisual(this.currentlyPlayingVideoId,videoId);this.currentlyPlayingVideoId=videoId;this.playVideoByVideoId(videoId);this.createNextVideo();if(this.videoUtil.isNotBlankOrNull(this.currentlyPlayingSubCollection)){this.updateSideNavAppearance('subcollection',this.currentlyPlayingSubCollection);}
else{this.updateSideNavAppearance('collection',this.currentlyPlayingCollection);}},createSearch:function(){var str='';str+='<form id="searchForm" onSubmit="javascript:'+this.getName()+'.searchButtonClicked();return false;" class="" method="post" accept-charset="utf-8">';str+='<fieldset>';str+='<legend>Search Videos</legend>';str+='<div class="ctl">';str+='<label for="frmSearchSectCtl01">Search Videos</label>';str+='<input type="text" name="frmSearchSectCtl01" value="Search Video" id="frmSearchSectCtl01" class="text" onFocus="'+this.getName()+'.searchInputBoxFocused();"/>';str+='</div>';str+='<div class="ctl">';str+='<label for="frmSearchSectSub">Search</label>';str+='<button id="searchButton" type="submit">Search</button>';str+='</div>';str+='</fieldset>';str+='</form>';if(dojo.byId(this.searchDivId)){dojo.byId(this.searchDivId).innerHTML=str;}},searchInputBoxFocused:function(){dojo.byId("frmSearchSectCtl01").value="";dojo.byId("searchForm").className="";},searchButtonClicked:function(){var searchTxt=dojo.byId("frmSearchSectCtl01").value.replace(/^\s+|\s+$/,'');if(searchTxt===''){dojo.byId("searchForm").className="search_error";dojo.byId("frmSearchSectCtl01").value="Please enter search terms";dojo.byId("searchButton").focus();return false;}
this.currentSearchText=searchTxt;this.sortOrder='relevancy';if(!this.isVideoResultsInSideNav){this.insertVideoResultsInSideNav();this.isVideoResultsInSideNav=true;}
this.updateVideoResultsInSideNav(this.currentSearchText);this.updateSideNavAppearance('collection','Search Results');var searchUrl='/api-video/find_all_videos.asp?type=wsj-fulltext&query='+searchTxt;this.performSearch(searchUrl);dojo.byId("searchButton").focus();},insertVideoResultsInSideNav:function(){var str='';str+='<li id="Search Results" class="noSubCollection">';str+='</li>';str+=dojo.byId(this.sideNavUlId).innerHTML;dojo.byId(this.sideNavUlId).innerHTML=str;},updateVideoResultsInSideNav:function(srchText){var fields='id,name,description,duration,thumbnailURL,videoURL,formattedCreationDate,wsj-section,wsj-subsection';var srchContentUrl='/api-video/find_all_videos.asp?type=wsj-fulltext&query='+srchText+'&fields='+fields;this.contentUrlsObject['Search Results']=srchContentUrl;var str='';str+='<a id="a_Search Results" class="" href="javascript:'+this.getName()+'.sideNavClicked(\'collection\',\'Search Results\');">';str+='Search Results</a>';dojo.byId("Search Results").innerHTML=str;},performSearch:function(searchUrl){this.userAction='toSearch';var fields='id,name,description,duration,thumbnailURL,videoURL,formattedCreationDate,wsj-section,wsj-subsection';dojo.byId(this.videoResultsDivId).innerHTML='<p class="noResults"> Loading ... </p>';this.getVideos(searchUrl+'&fields='+fields+'&count=60',this.userAction);},loaddisabledPagination:function(pageNumber){var varToDisplay='';if(this.userAction=='toBrowse'){if(typeof this.currentBrowsingJsonObject!="undefined"){varToDisplay=this.currentBrowsingJsonObject.items;}}
else
if(this.userAction=='toSearch'){if(typeof this.currentSearchJsonObject!="undefined"){varToDisplay=this.currentSearchJsonObject.items;}}
else{varToDisplay=this.currentPlayingJsonObject.items;}
var currentPageNumber=Number(pageNumber);var flr=Math.floor(varToDisplay.length/this.pageSize);var cl=Math.ceil(varToDisplay.length/this.pageSize);var lastPageNumber=Math.max(flr,cl);var str='';if(currentPageNumber==1){str+='<li id="previous" class="listFirst"><span>Previous</span></li>';}
else{str+='<li id="previous" class="listFirst"><a href="javascript:'+this.getName()+'.paginationClicked(\''+(currentPageNumber-1)+'\')">Previous</a></li>';}
for(var index=1;index<=lastPageNumber;index++){if(currentPageNumber==index){str+='<li><span>'+index+'</span></li>';}
else{str+='<li><a href="javascript:'+this.getName()+'.paginationClicked(\''+index+'\')" >'+index+'</a></li>';}}
if(currentPageNumber>=lastPageNumber){str+='<li id="next"><span>Next</span></li>';}
else{str+='<li id="next"><a href="javascript:'+this.getName()+'.paginationClicked(\''+(currentPageNumber+1)+'\')">Next</a></li>';}
dojo.byId("pagination").innerHTML=str;},paginationClicked:function(pageNumber){this.populateMoreVideos(pageNumber);this.loaddisabledPagination(pageNumber);this.updateRssFeed((this.visibleSubCollectionId!=='')?this.visibleSubCollectionId:this.visibleCollectionId);},getVideos:function(url,userAction,context,callback,error){var localErrorCallback=dojo.hitch(this,function(err,url,userAction,context,callback){setTimeout(this.getVideos(url,userAction,context,callback,err),10000);});var that=this;var params={handleAs:"json",responseType:"application/json",callback:function(json){that.usrActnHash[userAction].apply(that,[json]);if(callback){if(context){callback.apply(context);}else{callback();}}},errorCallback:function(err){console.warn("faled to getVideos:"+err+", fetching "+url);localErrorCallback(err,url,userAction,context,callback);}};dj.util.Video.getVideoData(url,params);},handleResponse:function(json){this.currentPlayingJsonObject=json;this.convertCurrentPlayingJsonToIdsArray();},handleBrowsingResults:function(json){this.currentBrowsingJsonObject=json;this.populateMoreVideos(1);this.loaddisabledPagination(1);this.updateRssFeed((this.visibleSubCollectionId!=='')?this.visibleSubCollectionId:this.visibleCollectionId);},handleSearchResults:function(json){this.currentSearchJsonObject=json;this.populateMoreVideos(1);this.loaddisabledPagination(1);},handleCurrent:function(json){this.currentVideoDetailsJsonObject=json;this.currentlyPlayingCollection=this.currentVideoDetailsJsonObject['wsj-section'];this.currentlyPlayingSubCollection=this.currentVideoDetailsJsonObject['wsj-subsection'];this.playVideoByParam(this.currentVideoDetailsJsonObject);this.populateVideoSummary(this.currentVideoDetailsJsonObject.name,this.currentVideoDetailsJsonObject.description,this.currentVideoDetailsJsonObject.formattedCreationDate);},handleNext:function(json){this.nextVideoDetailsJsonObject=json;this.populateNextVideo();},populateSideNav:function(){var src='';var collectionArray=this.xmlDoc.getElementsByTagName("collection");for(var index=0,len=collectionArray.length;index<len;++index){var item=collectionArray[index];var subCollectionArray=item.getElementsByTagName("subcollection");var subCollectionArrayLength=subCollectionArray.length;if(subCollectionArrayLength>0){src+='<li class="expand" id="'+item.getAttribute("name")+'"><a id="a_'+item.getAttribute("name")+'" class="" href="javascript:'+this.getName()+'.sideNavClicked(\''+item.nodeName+'\',\''+item.getAttribute("name")+'\');">'+item.getAttribute("name")+'</a>';}
else{src+='<li class="noSubCollection" id="'+item.getAttribute("name")+'"><a id="a_'+item.getAttribute("name")+'" class="" href="javascript:'+this.getName()+'.sideNavClicked(\''+item.nodeName+'\',\''+item.getAttribute("name")+'\');">'+item.getAttribute("name")+'</a>';}
if(subCollectionArrayLength>0){src+='<ul id=Sub'+item.getAttribute("name")+'>';for(var sindex=0,slen=subCollectionArray.length;sindex<slen;++sindex){var sitem=subCollectionArray[sindex];src+='<li><a id="a_'+sitem.getAttribute("name")+'" class="current" href="javascript:'+this.getName()+'.sideNavClicked(\''+sitem.nodeName+'\',\''+sitem.getAttribute("name")+'\');">'+sitem.getAttribute("name")+'</a></li>';}
src+='</ul>';}
src+='</li>';}
dojo.byId(this.sideNavUlId).innerHTML=src;},populateTopNav:function(){if(dojo.byId(this.topNavUlId)){var src='';var collectionArray=this.xmlDoc.getElementsByTagName("collection");for(var index=0,len=collectionArray.length;index<len;++index){var item=collectionArray[index];var itemName=item.getAttribute("name");if((itemName!='Most Popular Today')&&(itemName!='Management')&&(itemName!='Special Packages')){var className=itemName;className='navlink_'+className.toLowerCase().replace(/\s+/g,'_');if(index=='1'){src+='<li class="listFirst">';}
else{src+='<li>';}
src+='<a class='+className+' id="a_topnav_'+itemName+'" href="javascript:'+this.getName()+'.topNavClicked(\''+item.nodeName+'\',\''+itemName+'\');">'+itemName+'</a>';src+='</li>';}}
dojo.byId(this.topNavUlId).innerHTML=src;}},topNavClicked:function(strType,strName){this.userAction='';this.updateSideNavAppearance(strType,strName);this.updateTopNavAppearance(strType,strName);this.currentlyPlayingCollection=strName;this.getVideos(this.validateContentUrl(this.contentUrlsObject[this.currentlyPlayingCollection])+'&count=60','',this,this.handleTopNavGetVideos);},handleTopNavGetVideos:function(){this.visibleCollectionId=this.currentlyPlayingCollection;this.currentBrowsingJsonObject=this.currentPlayingJsonObject;this.currentlyPlayingVideoId=this.currentPlayingJsonObject.items[0].id;this.playVideoByVideoId(this.currentlyPlayingVideoId);this.populateMoreVideos(1);this.loaddisabledPagination(1);this.browsingGroup="collection";this.playingGroup="collection";this.createNextVideo();},updateTopNavAppearance:function(strType,strName){var removeFrom=this.currentlyPlayingCollection;if(removeFrom=='Lifestyle'){removeFrom='Life & Style';}
if(dojo.byId('a_topnav_'+removeFrom)){var playingCollectionClassName=dojo.byId('a_topnav_'+removeFrom).className;var newPlayingCollectionClassName=playingCollectionClassName.replace('selected ','');dojo.byId('a_topnav_'+removeFrom).className=newPlayingCollectionClassName;}
if(dojo.byId('a_topnav_'+strName)){var classNameToApply='selected '+'navlink_'+strName.toLowerCase().replace(/\s+/g,'_');dojo.byId('a_topnav_'+strName).className=classNameToApply;}},sideNavClicked:function(strType,strName){this.userAction='';if(this.videoUtil.isNotBlankOrNull(this.contentUrlsObject[strName])){this.browsingGroup=strType;if(strName=='Search Results'){this.userAction='toSearch';this.sortOrder='relevancy';}
else
if(((strType=='subcollection')&&(strName!=this.currentlyPlayingSubCollection))||((strType=='collection')&&(strName!=this.currentlyPlayingCollection))){this.userAction='toBrowse';}
this.updateSideNavAppearance(strType,strName);dojo.byId(this.videoResultsDivId).innerHTML='<p class="noResults"> Loading ... </p>';if(this.videoUtil.isNotBlankOrNull(this.userAction)){this.getVideos(this.contentUrlsObject[strName]+'&count=60',this.userAction);}
else{this.populateMoreVideos(1);this.loaddisabledPagination(1);}}
else{this.updateSideNavAppearance(strType,strName);}},searchLinkClicked:function(searchUrl,sortParam){this.sortOrder=sortParam;this.performSearch(searchUrl);},populateMoreVideos:function(pageNumber){var varToDisplay='';if(this.userAction=='toBrowse'){if(typeof this.currentBrowsingJsonObject!="undefined"){varToDisplay=this.currentBrowsingJsonObject.items;}}
else
if(this.userAction=='toSearch'){if(typeof this.currentSearchJsonObject!="undefined"){varToDisplay=this.currentSearchJsonObject.items;}}
else{varToDisplay=this.currentPlayingJsonObject.items;}
var startIndex=(pageNumber-1)*12;var endIndex=Math.min(pageNumber*12-1,varToDisplay.length-1);var str='';if(this.userAction=='toSearch'&&varToDisplay.length>0){str+='<ul class="sort"><li class="listFirst">Sort by:</li>';var sUrl='/api-video/find_all_videos.asp?type=wsj-fulltext&query='+this.currentSearchText;if(this.sortOrder=='relevancy'){str+='<li class="selected"><span>relevance</span></li>';str+='<li class="listLast"><a href="javascript:'+this.getName()+'.searchLinkClicked(\''+sUrl+'&sort=date+desc\',\'date\')">Date</a></li>';}
else{str+='<li><a href="javascript:'+this.getName()+'.searchLinkClicked(\''+sUrl+'&sort=relevancy\',\'relevancy\')">Relevance</a></li>';str+='<li class="listLast selected"><span>Date</span></li>';}
str+='</ul>';str+='<p class="resultsLabel">'+(startIndex+1)+' - '+(endIndex+1)+' results out of '+varToDisplay.length+' for: '+this.currentSearchText+'</p>';}
if(this.userAction=='toSearch'&&varToDisplay.length===0){str+='<p class="noResults"> No content matches your search terms. Please try again. </p>';dojo.byId(this.videoResultsDivId).innerHTML=str;return false;}
str+='<ul class="newsItem video videoListMed">';for(var i=startIndex;i<endIndex+1;i++){var title=varToDisplay[i];str+='<li id="li_'+title.id+'" class="">';str+='<a href="javascript:'+this.getName()+'.videoThumbnailClicked(\''+title.id+'\')" id="'+title.id+'" style="background-image: url('+unescape(title.thumbnailURL)+');" class="preview"><span>&nbsp;</span></a>';str+='<h2><a href="javascript:'+this.getName()+'.videoThumbnailClicked(\''+title.id+'\')">'+title.name+'</a></h2>';var minutes=Math.floor(title.duration/60);var seconds=title.duration%60;if(seconds<10){seconds='0'+seconds;}
str+='<small>'+minutes+':'+seconds+'</small>';if(this.videoUtil.isNotBlankOrNull(title.formattedCreationDate)){str+='<small> '+title.formattedCreationDate.split(' ')[0]+'</small>';}
str+='</li>';if(((i+1)%4)===0){str+='<li class="rowEnd"></li>';}}
str+='</ul>';str+='<ul id="pagination" class="pagination">';str+='</ul>';if(this.userAction!='toSearch'){var nameToDisplay=this.videoUtil.isNotBlankOrNull(this.visibleSubCollectionId)?this.visibleSubCollectionId:this.visibleCollectionId;str+='<a target="_blank" id="rssFeed" class="rss" href="">'+nameToDisplay+' Video Feed</a>';}
dojo.byId(this.videoResultsDivId).innerHTML=str;if(!this.playFromRegisteredVideos){this.updateVideoThumbnailVisual('',this.currentlyPlayingVideoId);}},updateRssFeed:function(str){if(dojo.byId("rssFeed")){dojo.byId("rssFeed").href=this.rssUrlsObject[str];}},videoThumbnailClicked:function(videoId){var videoDetails='';if(this.sourceApplicationName=='articlePage'){this.playFromRegisteredVideos=false;this.updateVideoThumbnailVisual('reg'+this.currentlyPlayingVideoId,'');videoDetails=this.videoUtil.getVideoDetails({'id':videoId,'fields':'linkRelativeURL,wsj-section'});}
if(videoDetails!==''&&(this.relatedVideosCollection!=videoDetails['wsj-section']||this.visibleCollectionId=='Search Results')){window.location.href=videoDetails.linkRelativeURL+'.html';;}
else{this.playingGroup=this.browsingGroup;if(this.userAction=='toSearch'){this.currentPlayingJsonObject=this.currentSearchJsonObject;}
else
if(this.userAction=='toBrowse'){this.currentPlayingJsonObject=this.currentBrowsingJsonObject;}
this.convertCurrentPlayingJsonToIdsArray();this.updateTopNavAppearance('',this.visibleCollectionId);this.currentlyPlayingCollection=this.visibleCollectionId;this.currentlyPlayingSubCollection=this.visibleSubCollectionId;this.updateVideoThumbnailVisual(this.currentlyPlayingVideoId,videoId);this.currentlyPlayingVideoId=videoId;this.playVideoByVideoId(videoId);this.createNextVideo();}
if(dojo.byId("flashPlayer")){window.scrollTo(0,dojo.position(dojo.byId("flashPlayer"),true).y);}},playNextVideo:function(){if(this.nextVideoId!==''){this.updateVideoThumbnailVisual('reg'+this.currentlyPlayingVideoId,'reg'+this.nextVideoDetailsJsonObject.id);this.updateVideoThumbnailVisual(this.currentlyPlayingVideoId,this.nextVideoDetailsJsonObject.id);this.currentlyPlayingVideoId=this.nextVideoDetailsJsonObject.id;this.playVideoByParam(this.nextVideoDetailsJsonObject);this.populateVideoSummary(this.nextVideoDetailsJsonObject.name,this.nextVideoDetailsJsonObject.description,this.nextVideoDetailsJsonObject.formattedCreationDate);this.createNextVideo();}},getNextVideoId:function(){if(this.sourceApplicationName=='articlePage'){if(this.playFromRegisteredVideos&&this.registeredVideosIds.indexOf(this.currentlyPlayingVideoId)<this.registeredVideosIds.length-1){return this.registeredVideosIds[this.registeredVideosIds.indexOf(this.currentlyPlayingVideoId)+1];}
if(this.playFromRegisteredVideos&&this.registeredVideosIds.indexOf(this.currentlyPlayingVideoId)==this.registeredVideosIds.length-1){this.playFromRegisteredVideos=false;return this.currentlyPlayingVideoIds[0];}
if(this.currentlyPlayingVideoIds.indexOf(this.currentlyPlayingVideoId)<(this.currentlyPlayingVideoIds.length-1)){return this.currentlyPlayingVideoIds[this.currentlyPlayingVideoIds.indexOf(this.currentlyPlayingVideoId)+1];}
if(this.currentlyPlayingVideoIds.indexOf(this.currentlyPlayingVideoId)==(this.currentlyPlayingVideoIds.length-1)){return'';}}
else{if(this.currentlyPlayingVideoIds.indexOf(this.currentlyPlayingVideoId)==-1){return this.currentlyPlayingVideoIds[0];}
if(this.currentlyPlayingVideoIds.indexOf(this.currentlyPlayingVideoId)<(this.currentlyPlayingVideoIds.length-1)){return this.currentlyPlayingVideoIds[this.currentlyPlayingVideoIds.indexOf(this.currentlyPlayingVideoId)+1];}
if(this.currentlyPlayingVideoIds.indexOf(this.currentlyPlayingVideoId)==(this.currentlyPlayingVideoIds.length-1)){if(this.currentlyPlayingCollection=='Search Results'){return'';}
if(this.playingGroup!==""&&this.playingGroup=='collection'){return this.getVideoIdFromNextCollection();}
if(this.playingGroup!==""&&this.playingGroup=='subcollection'){return this.getVideoIdFromNextSubCollection();}}}},getVideoIdFromNextSubCollection:function(){var subColAr=this.subcollectionsObject[this.currentlyPlayingCollection];if(subColAr.indexOf(this.currentlyPlayingSubCollection)!=subColAr.length-1){this.currentlyPlayingSubCollection=subColAr[subColAr.indexOf(this.currentlyPlayingSubCollection)+1];this.getVideos(this.contentUrlsObject[this.currentlyPlayingSubCollection]+'&count=60','',this,handleGetVideoIdFromNextSubColection);}else{this.currentlyPlayingSubCollection='';return this.getVideoIdFromNextCollection();}},handleGetVideoIdFromNextSubColection:function(){if(this.currentPlayingJsonObject.items.length===0){return this.getVideoIdFromNextSubCollection();}
else{return this.currentPlayingJsonObject.items[0].id;}},getVideoIdFromNextCollection:function(){if(this.collectionNamesArray.indexOf(this.currentlyPlayingCollection)!=this.collectionNamesArray.length-1){if(this.skipCollection){this.currentlyPlayingCollection=this.collectionNamesArray[this.collectionNamesArray.indexOf(this.currentlyPlayingCollection)+1];}
this.skipCollection=true;this.getVideos(this.contentUrlsObject[this.currentlyPlayingCollection]+'&count=60','',this,handleGetVideoIdFromNextCollection);}
else{this.currentlyPlayingCollection=this.defaultCollectionName;this.skipCollection=false;return this.getVideoIdFromNextCollection();}},handleGetVideoIdFromNextCollection:function(){if(this.currentPlayingJsonObject.items.length===0){return this.getVideoIdFromNextCollection();}
else{return this.currentPlayingJsonObject.items[0].id;}},loaddisabledCollectionsDoc:function(context,callback){var params={context:context,callback:callback,responseType:"text/xml",errorCallback:function(){console.error("Failure while loaddisableding video Collection xml.");}};dj.util.Video.getVideoData(this.collectionsXMLPath+"video-collections.xml",params);},updateSideNavAppearance:function(strType,id){if(this.visibleSubCollectionId!==''){if(dojo.byId('a_'+this.visibleSubCollectionId)){if(dojo.byId('a_'+this.visibleSubCollectionId).className=='subcollection-selected'){dojo.byId('a_'+this.visibleSubCollectionId).className='current';}}}
if(strType=='collection'){if(this.visibleCollectionId!==''){var vCol=dojo.byId(this.visibleCollectionId);var aVCol=dojo.byId('a_'+this.visibleCollectionId);if(vCol.className=='expanded'){vCol.className='expand';aVCol.className='';}else if(vCol.className=='expand'){aVCol.className='';}else{vCol.className='noSubCollection';aVCol.className='';}}
if(dojo.byId(id).className=='expand'){dojo.byId(id).className='expanded';dojo.byId('a_'+id).className='collection-selected';}
else{dojo.byId(id).className='noSubCollection-expanded';dojo.byId('a_'+id).className='selected';}
this.visibleCollectionId=id;this.visibleSubCollectionId='';}
if(strType=='subcollection'){if(this.videoUtil.isNotBlankOrNull(dojo.byId('a_'+id))){dojo.byId('a_'+id).className='subcollection-selected';}
if(this.videoUtil.isNotBlankOrNull(dojo.byId(this.visibleCollectionId))){dojo.byId(this.visibleCollectionId).className='expanded';}
if(this.videoUtil.isNotBlankOrNull(dojo.byId('a_'+this.visibleCollectionId))){dojo.byId('a_'+this.visibleCollectionId).className='';}
this.visibleSubCollectionId=id;}},getName:function(){return this.objName;},playVideoByVideoId:function(videoId){var url='/api-video/get_video_info.asp?guid='+videoId+'&fields=all';this.getVideos(url,'current');},playVideoByParam:function(params){var adZone=new dj.util.Ads().getRegisteredAdsZone('');var lineup=this.videoUtil.isNotBlankOrNull(this.currentlyPlayingSubCollection)?this.currentlyPlayingSubCollection:this.currentlyPlayingCollection;if(adZone!='default'&&adZone!=''){params.adZone=adZone;}
params.lineup=lineup;params.emailPartnerID=110626;params.site=this.site;params.msrc=this.msrc;params.adFrmt="frmt=2;";params.playerName=(this.sourceApplicationName=='articlePage')?"video_articletab":"video_videocenter";params.embedPlayerURL=this.flashPlayerPath+"main.swf";params.embedConfigURL=this.embedConfigURL;params.embedPlayerID="1000";params.embedName="flashPlayer";params.embedBaseURL=this.flashPlayerPath;params.embedHeight=363;params.embedWidth=512;params.larsID=91;params.larsAdTrackingID=1259;params.prop5=window.location.href.split('?')[0];params.prop6=window.location.href;params.prop10=this.videoUtil.getUrlParam(window.location.href,'mod');params.campaign=this.videoUtil.getUrlParam(window.location.href,'mod');params.prop11=this.videoUtil.getUrlParam(window.location.href,'reflink');params.prop19=(this.sourceApplicationName=='articlePage')?"video_tab":"video";params.prop24=this.prop24;params.prop25=this.prop25;params.prop27=this.prop27;var subSecComponent=this.videoUtil.omnitureEncoding(this.currentlyPlayingCollection,this.currentlyPlayingSubCollection,'s');var secComponent=this.videoUtil.omnitureEncoding(this.currentlyPlayingCollection,this.currentlyPlayingSubCollection,'c');params.prop2="WSJ_"+secComponent;params.prop3="WSJ_Video_Video_"+secComponent;params.prop22="WSJ_Video_Video_"+subSecComponent;params.prop26="WSJ_"+subSecComponent;params.emailURL=this.emailURL;swfobject.getObjectById("flashPlayer").playVideo(dojo.toJson(params));}voidPopUpPlayer:function(){var currentPlayingLocation=Math.floor(swfobject.getObjectById("flashPlayer").getSeek());var width='512';var height='660';var currentlyPlayingCollection=this.currentlyPlayingCollection;if((currentlyPlayingCollection=='Special Packages')||(currentlyPlayingCollection=='Search Results')){currentlyPlayingCollection=this.currentVideoDetailsJsonObject['wsj-section'];}
this.popUpWindow=void(this.popUpPageUrl+'?currentPlayingLocation='+currentPlayingLocation+'&currentlyPlayingCollection='+escape(currentlyPlayingCollection)+'&currentlyPlayingVideoId='+this.currentlyPlayingVideoId,'popUpPlayer','height='+height+',width='+width+',left='+((screen.width-Number(width))/2)+',top='+(screen.height-Number(height))/2+',resizable=yes,scrollbars=no,toolbar=no,status=no');},focusPopUp:function(){if(this.popUpWindow){this.popUpWindow.focus();}},createRegisteredVideosThumbnails:function(){if(this.registeredVideosIds.length>0){var str='';for(var index=0,len=this.registeredVideosIds.length;index<len;++index){var title=this.registeredVideos[index];if(title){str+='<li id="li_reg'+title.id+'" class="">';str+='<a href="javascript:'+this.getName()+'.regVideoThumbnailClicked(\''+title.id+'\',\''+unescape(title.videoURL)+'\')" id="'+title.id+'" style="background-image: url('+unescape(title.thumbnailURL)+');" class="preview"><span>&nbsp;</span></a>';str+='<h2><a href="javascript:'+this.getName()+'.regVideoThumbnailClicked(\''+title.id+'\',\''+unescape(title.videoURL)+'\')">'+title.name+'</a></h2>';var minutes=Math.floor(title.duration/60);var seconds=title.duration%60;if(seconds<10){seconds='0'+seconds;}
str+='<small>'+minutes+':'+seconds+'</small>';str+='</li>';if(((index+1)%4)===0){str+='<li class="rowEnd"></li>';}}}
dojo.byId(this.registeredVideosDivId).innerHTML=str;}},regVideoThumbnailClicked:function(videoId){this.playFromRegisteredVideos=true;this.updateVideoThumbnailVisual('reg'+this.currentlyPlayingVideoId,'reg'+videoId);this.updateVideoThumbnailVisual(this.currentlyPlayingVideoId,'');this.currentlyPlayingVideoId=videoId;this.playVideoByVideoId(videoId);this.createNextVideo();},registerVideo:function(videoId){this.playFromRegisteredVideos=true;if(videoId.indexOf('{')==-1){videoId='{'+videoId+'}';}
if(dojo.indexOf(this.registeredVideosIds,videoId)==-1){this.registeredVideosIds[this.registeredVideosIds.length]=videoId;this.registeredVideos[this.registeredVideos.length]=this.videoUtil.getVideoDetails({'id':videoId,'fields':'all'});}},loaddisabledSoloVideo:function(videoId,divId){if(videoId.indexOf('{')==-1){videoId='{'+videoId+'}';}
var microPlayerId="MicroPlayer_"+Math.floor(Math.random()*1000000);this.microPlayers[this.microPlayers.length]=microPlayerId;this.videoIdMicroPlayerIdMap[videoId]=microPlayerId;if(!dj.context.video){dj.context.video={};}
if(!dj.context.video.soloVideos){dj.context.video.soloVideos=[];}
dj.context.video.soloVideos[videoId]=this;if(swfobject.getFlashPlayerVersion().major>=9){var dim={w:"272",h:"180"};swfobject.embedSWF(this.flashPlayerPath+"microPlayer.swf",divId,dim.w,dim.h,"9.0.0","",{'objName':"dummy",'videoGUID':videoId,'allowPlayerPopup':'1','plyMediaEnabled':'1','movieWidth':dim.w,'movieHeight':dim.h,'host':location.host},{allowscriptaccess:"always",wmode:"opaque"},{id:microPlayerId});}
else{dj.util.Video.nonSupportingFlashPlayer(divId);}},getJSON:function(id){var url='/api-video/get_video_info.asp?guid='+id;url+='&fields=all';var params={context:this,handleAs:"json",sync:true,responseType:"application/json",callback:this.handleGetJSON,errorCallback:function(){console.error("Failed while executing video.VideoCenter.getJSON");}};dj.util.Video.getVideoData(url,params);this.microPlayersObjects[id]=this.jsonData;return dojo.toJson(this.jsonData);},handleGetJSON:function(json){this.jsonData=json;var adZone=new dj.util.Ads().getRegisteredAdsZone('');if(adZone!='default'&&adZone!=''){this.jsonData.adZone=adZone;}
this.jsonData.emailPartnerID=110626;this.jsonData.site=this.site;this.jsonData.msrc=this.msrc;this.jsonData.adFrmt="frmt=0;";this.jsonData.playerName="video_articleembed";this.jsonData.videoCenterURL="httpdisabled://"+window.location.host+"/video-center";this.jsonData.embedPlayerURL=this.flashPlayerPath+"microPlayer.swf";this.jsonData.embedConfigURL=this.embedConfigURL;this.jsonData.embedPlayerID="1000";this.jsonData.embedName="microflashPlayer";this.jsonData.embedBaseURL=this.flashPlayerPath;this.jsonData.embedHeight=180;this.jsonData.embedWidth=272;this.jsonData.larsID=91;this.jsonData.larsAdTrackingID=1259;this.jsonData.prop5=window.location.href.split('?')[0];this.jsonData.prop6=window.location.href;this.jsonData.prop10=this.videoUtil.getUrlParam(window.location.href,'mod');this.jsonData.campaign=this.videoUtil.getUrlParam(window.location.href,'mod');this.jsonData.prop11=this.videoUtil.getUrlParam(window.location.href,'reflink');this.jsonData.prop19="video_emb";this.jsonData.prop24=this.prop24;this.jsonData.prop25=this.prop25;this.jsonData.prop27=this.prop27;var subSecComponent=this.videoUtil.omnitureEncoding(this.jsonData['wsj-section'],this.jsonData['wsj-subsection'],'s');var secComponent=this.videoUtil.omnitureEncoding(this.jsonData['wsj-section'],this.jsonData['wsj-subsection'],'c');this.jsonData.prop2="WSJ_"+secComponent;this.jsonData.prop3="WSJ_Video_Video_"+secComponent;this.jsonData.prop22="WSJ_Video_Video_"+subSecComponent;this.jsonData.prop26="WSJ_"+subSecComponent;this.jsonData.emailURL=this.emailURL;var suprsAd='0';try{if(pID.indexOf('0_0_WH')!=-1){suprsAd='1';}}
catch(e){console.error("pID read error");}
this.jsonData.suppressAds=suprsAd;},updateTitle:function(){var title=dj.lang.query('#videoPlayerDescription h2')[0].innerHTML;title=title.substring(0,title.indexOf('<small>')-1);document.title=document.title.replace('Article',title);}});dojo.declare("dj.widget.video.video",dj.widget.video.VideoCenter,{constructor:function(args,objName){dojo.deprecated("dj.widget.video.video","Use dj.widget.video.VideoCenter, remove alias when MST JSEXECs updated","1.0");}});dojo.provide("dj.widget.video.Video");dojo.require("dj.lang");dojo.require("dj.util.Video");dojo.require("dj.util.Ads");dojo.require("swfobject.swfobject_1_5.swfobject");dojo.require("swfobject.swfobject_2_2.swfobject");dojo.require("dj.widget.video.VideoCenter");dojo.getObject("dj.module.video",true);dojo.declare("dj.widget.video.Video",null,{config:{thumbnail:{divclass:"headlineSummary video",onclickprefix:"dj.module.articleVideoPlayer.tabplay(",onclicksuffix:");",hrefprefix:"#articleTabs_video-"},bc:{src:"httpdisabled://wsj.vo.llnwd.net/o28/plymedia/SWF/BrightPLYembed.swf",flashVars:"playerId=452319854&viewerSecureGatewayURL=https://services.brightcove.com/services/amfgateway&servicesURL=http://services.brightcove.com/services&cdnURL=http://admin.brightcove.com&domain=embed&autoStart=false&showTicker=true&flashId=flashObj&videoId=",base:"httpdisabled://wsj.vo.llnwd.net/o28/plymedia/SWF",bgcolor:"#000000",name:"BrightPLYembed",pluginspage:"httpdisabled://www.macromedia.com/shockwave/downloaddisabled/index.cgi?P1_Prod_Version=ShockwaveFlash",flashversion:"8"}},constructor:function(id,v,w,h,c){if(!id){return;}
this.parent=dojo.byId(id);var isWidgetAlreadyHandled=(typeof dojo.query("div[data-dj-live-widget]",this.parent)[0]==="object");if(isWidgetAlreadyHandled){console.info("{Video} %o will be handled by the video.MicroPlayer.",id);return;}
this.microPlayers=[];this.microPlayersObjects={};this.videoIdMicroPlayerIdMap={};this.videoUtil=dj.util.Video;var overlayConfig=this.videoUtil.setupConfig();dj.lang.mixin(this,overlayConfig);this.flashPlayerPath=dj.context.core.cdnPrefix+"/media/swf/";this.parentid=id;if(!this.parent){console.log('id '+id+' not found');return;}
this.v=v;w=264;this.w=w;h=254;this.h=h;this.c=c;if(v){this.loaddisabled(v,w,h,c);}},createwrapper:function(v,w,h){this.div=dojo.create("div",{"id":this.vidid});if(w&&!this.isguid(v)){this.tryw=''+w+'px';this.div.style.width=this.tryw;}
this.parent.appendChild(this.div);},createvideobc:function(v,w,h,c){dojo.deprecated("dj.widget.video.Video.createvideobc","If brightcove is not supported, remove this method","2.0");this.so=new SWFObject(this.config.bc.src,v,w,h,this.config.bc.flashversion,this.config.bc.bgcolor);this.so.setAttribute('id','video_'+this.vidid);this.so.addParam('base',this.config.bc.base);this.so.addParam("flashVars",this.config.bc.flashVars+v+'&');this.so.addParam("seamlesstabbing","false");this.so.addParam("swLiveConnect","true");this.so.addParam("name",this.config.bc.name);this.so.addParam("pluginspage",this.config.bc.pluginspage);this.so.addParam("wmode","opaque");this.void(this.div);if(c){var caption=dojo.create("p",{"class":"targetCaption",innerHTML:c});this.div.appendChild(caption);}},createvideoguid:function(v){this.loaddisabledSoloVideo(v,this.vidid);if(this.c){var caption=dojo.create("p",{"class":"targetCaption","innerHTML":this.c});this.parent.appendChild(caption);}},createvideo:function(v,w,h,c){if(this.isguid(v))
{this.createvideoguid(v);}else{this.createvideobc(v,w,h,c);}},loaddisabled:function(v,w,h,c){if(!this.div){this.newId();this.createwrapper(v,w,h);this.createvideo(v,w,h,c);}},createthumbnail:function(playObserver){if(!this.guidvideo){console.error('no guidvideo');return;}
if(!this.guidvideo.details){console.error('no guidvideo.details');return;}
if(!playObserver){console.warn('no playObserver');}
var vtdiv=dojo.create('div',{'class':'videoTree'});this.div.appendChild(vtdiv);var vfdiv=dojo.create('div',{'class':'videoFrame'});vtdiv.appendChild(vfdiv);var aimg=dojo.create('a',{'href':"#"});var that=this;dojo.connect(aimg,"onclick",this,function(ev){playObserver.fire(this.v);dojo.stopEvent(ev);});vfdiv.appendChild(aimg);var img=dojo.create('img',{'src':this.guidvideo.details.thumbnailURLSmall,'width':'115','height':'65','alt':'video'});aimg.appendChild(img);var spannbsp=dojo.create('span',{'class':'videoBug'});spannbsp.innerHTML="&nbsp;";aimg.appendChild(spannbsp);var title=dojo.create("h3",{"class":"first"});this.div.appendChild(title);var ah3=dojo.create("a",{"href":"#",innerHTML:this.guidvideo.details.name});var that2=this;dojo.connect(ah3,"onclick",this,function(ev){playObserver.fire(this.v);dojo.stopEvent(ev);});title.appendChild(ah3);var duration=dojo.create("small",{innerHTML:this.videoUtil.formatduration(this.guidvideo.details.duration)});this.div.appendChild(duration);var desc=dojo.create("p",{"class":"targetCaption",innerHTML:this.guidvideo.details.description});this.div.appendChild(desc);},loaddisabledthumbnail:function(v,w,h,playObserver){this.v=v;if(!this.isguid(v)){console.error("cannot create tumbnail to old video");return;}
this.getvideodetails();this.newId();this.createwrapper(v,w,h);this.createthumbnail(playObserver);},getguidvideo:function(){try{if(this.guidvideo){return this.guidvideo;}else{this.guidvideo=new dj.widget.video.VideoCenter();return this.guidvideo;}}
catch(e){console.error("could not instantiate dj.widget.video.VideoCenter");}
return null;},getvideodetails:function(){if(this.getguidvideo()){this.guidvideo.details=this.videoUtil.getVideoDetails({'id':this.v,'fields':'name,id,duration,description,thumbnailURL,thumbnailURLSmall'});}},setBookMark:function(){if(this.getguidvideo()){this.guidvideo.setBookMark();}},pauseMicroPlayer:function(){if(this.getguidvideo()){this.guidvideo.pauseMicroPlayers();}},isguid:function(g){g=''+g;if(g.substring(0,1)!='{'){g='{'+g;}
if(g.substring(0,1)=='{'&&g.substring(9,10)=='-'&&g.substring(14,15)=='-'&&g.substring(19,20)=='-'){return true;}else{return false;}},newId:function(){this.vidid="videodiv_"+Math.floor(Math.random()*999999);},loaddisabledSoloVideo:function(videoId,divId){var overlayConfig=this.videoUtil.setupConfig();dj.lang.mixin(this,overlayConfig);if(videoId.indexOf('{')==-1){videoId='{'+videoId+'}';}
var microPlayerId="MicroPlayer_"+Math.floor(Math.random()*1000000);this.microPlayers[this.microPlayers.length]=microPlayerId;this.videoIdMicroPlayerIdMap[videoId]=microPlayerId;dojo.getObject("dj.context.video",true);if(!dj.context.video.soloVideos){dj.context.video.soloVideos=[];}
dj.context.video.soloVideos[videoId]=this;var chainVideos=1;var chainVideosFlag=dojo.getObject("dj.context.video.chainVideos");if(chainVideosFlag!=undefined&&chainVideosFlag===false){chainVideos=0;}
if(swfobject.getFlashPlayerVersion().major>=9){var dim={w:"272",h:"180"};swfobject.embedSWF(this.flashPlayerPath+"microPlayer.swf",divId,dim.w,dim.h,"9.0.0","",{'objName':"dummy",'videoGUID':videoId,'allowPlayerPopup':'1','plyMediaEnabled':'1','movieWidth':dim.w,'movieHeight':dim.h,'host':location.host,'chainVideos':chainVideos},{allowscriptaccess:"always",wmode:"opaque"},{id:microPlayerId});}
else{dj.util.Video.nonSupportingFlashPlayer(divId);}}voidMicroPopUpPlayer:function(id){var currentPlayingLocation=Math.floor(swfobject.getObjectById(this.videoIdMicroPlayerIdMap[id]).getSeek());var currentlyPlayingCollection=this.microPlayersObjects[id]['wsj-section'];if(currentlyPlayingCollection=='Lifestyle'){currentlyPlayingCollection='Life & Style';}
var currentlyPlayingVideoId=id;var width='512';var height='660';this.popUpWindow=void(this.popUpPageUrl+'?currentPlayingLocation='+currentPlayingLocation+'&currentlyPlayingCollection='+escape(currentlyPlayingCollection)+'&currentlyPlayingVideoId='+currentlyPlayingVideoId,'popUpPlayer','height='+height+',width='+width+',left='+((screen.width-Number(width))/2)+',top='+(screen.height-Number(height))/2+',resizable=yes,scrollbars=no,toolbar=no,status=no');},getJSON:function(id){var url='/api-video/get_video_info.asp?guid='+id;url+='&fields=all';var params={context:this,handleAs:"json",sync:true,responseType:"application/json",callback:this.handleGetJSON,errorCallback:function(){console.error("Failed while executing video.Video.getJSON");}};dj.util.Video.getVideoData(url,params);this.microPlayersObjects[id]=this.jsonData;return dojo.toJson(this.jsonData);},handleGetJSON:function(json){this.jsonData=json;var adZone=new dj.util.Ads().getRegisteredAdsZone('');if(adZone!='default'&&adZone!=''){this.jsonData.adZone=adZone;}
this.jsonData.emailPartnerID=110626;this.jsonData.site=this.site;this.jsonData.msrc=this.msrc;this.jsonData.adFrmt="frmt=0;";this.jsonData.playerName="video_articleembed";this.jsonData.videoCenterURL="httpdisabled://"+window.location.host+"/video-center";this.jsonData.embedPlayerURL=this.flashPlayerPath+"microPlayer.swf";this.jsonData.embedConfigURL=this.embedConfigURL;this.jsonData.embedPlayerID="1000";this.jsonData.embedName="microflashPlayer";this.jsonData.embedBaseURL=this.flashPlayerPath;this.jsonData.embedHeight=180;this.jsonData.embedWidth=272;this.jsonData.larsID=91;this.jsonData.larsAdTrackingID=1259;this.jsonData.prop5=window.location.href.split('?')[0];this.jsonData.prop6=window.location.href;this.jsonData.prop10=this.videoUtil.getUrlParam(window.location.href,'mod');this.jsonData.campaign=this.videoUtil.getUrlParam(window.location.href,'mod');this.jsonData.prop11=this.videoUtil.getUrlParam(window.location.href,'reflink');this.jsonData.prop19="video_emb";this.jsonData.prop24=this.prop24;this.jsonData.prop25=this.prop25;this.jsonData.prop27=this.prop27;var subSecComponent=this.videoUtil.omnitureEncoding(this.jsonData['wsj-section'],this.jsonData['wsj-subsection'],'s');var secComponent=this.videoUtil.omnitureEncoding(this.jsonData['wsj-section'],this.jsonData['wsj-subsection'],'c');this.jsonData.prop2="WSJ_"+secComponent;this.jsonData.prop3="WSJ_Video_Video_"+secComponent;this.jsonData.prop22="WSJ_Video_Video_"+subSecComponent;this.jsonData.prop26="WSJ_"+subSecComponent;this.jsonData.emailURL=this.emailURL;var suprsAd=(pID&&pID.indexOf('0_0_WH')!=-1)?'1':'0';this.jsonData.suppressAds=suprsAd;}});dojo.provide("dj.widget.video.controller.MicroPlayer");dojo.require("dj.widget.video.controller.Player");dojo.require("dj.widget.video.model.PlayerEvents");dojo.require("dj.util.Ads");dojo.declare("dj.widget.video.controller.MicroPlayer",dj.widget.video.controller.Player,{constructor:function(obs,userConfiguration){this.configuration.applicationID=3;this._events=dj.widget.video.model.PlayerEvents;},init:function(view,videoID,seekTime,reloaddisabled){this.videoInformation.id=videoID;if(!reloaddisabled){this._setupFlashToJsListeners();this._setupInternalEvents();}
this.inherited(arguments);},getEventNamespace:function(){return"dj.context.video.soloVideos['"+this.videoInformation.id+"']";},subscribeByName:function(eventName,callback,context){this.observer.subscribeByName(eventName,callback,context);},addVideoParameters:function(params){params=this.inherited(arguments);var adZone=(new dj.util.Ads()).getRegisteredAdsZone('');params.adZone=((adZone!='default')&&(adZone!=''))?adZone:params.adZone;params.adFrmt="frmt=0;";params.videoCenterURL="httpdisabled://"+window.location.host+"/video-center";return params;},_setupInternalEvents:function(){this.observer.subscribeByName(this._events.continueLoadVideo,function(){this.readyForEvents=true;},this);this.observer.subscribeByName(this.voidMicroPopUpPlayer,function(){this.voidPopUpPlayer();},this);},_setupFlashToJsListeners:function(){var obs=this.observer,events=this._events,player={};for(var evName in events){if(events.hasOwnProperty(evName)){var evValue=events[evName];(function(name,value){player[name]=function(){obs.fireByName(value);};}(evName,evValue));}}
dojo.getObject("dj.context.video.soloVideos",true);dj.context.video.soloVideos[this.videoInformation.id]=player;}});dojo.provide("dj.widget.video.view.MainPlayer");dojo.require("dj.util.VideoUtils");dojo.require("dj.widget.video.model.SWFPlayer");dojo.require("dj.widget.video.model.PlayerEvents");(dj.widget.video.view.MainPlayer=function(userConfiguration){this.controller=null;this.configuration={name:"mainPlayer",allowPopUp:1};dojo.mixin(this.configuration,userConfiguration);this.playerCreated=false;}).prototype={init:function(controller){this.controller=controller;this.render();},render:function(){var conf=this.controller.configuration;if(!this.playerCreated){this.playerCreated=true;var swfPlayer=new dj.widget.video.model.SWFPlayer();swfPlayer.id=conf.playerID;swfPlayer.swfURL=conf.flashPlayerPath+conf.playerType.swfFile;swfPlayer.allowPlayerPopup=this.configuration.allowPopUp;swfPlayer.containerID=conf.containerID;swfPlayer.width=conf.playerType.width;swfPlayer.height=conf.playerType.height;swfPlayer.eventNamespace=conf.eventNamespace;var playerEvents=dj.widget.video.model.PlayerEvents;for(var evName in playerEvents){if(playerEvents.hasOwnProperty(evName)){swfPlayer[evName]=evName;}}
swfPlayer.host=conf.host;dj.util.VideoUtils.createSWFPlayer(swfPlayer);}},play:function(videoInfo){var playerObject=swfobject.getObjectById(this.controller.configuration.playerID);if(playerObject&&typeof playerObject.playVideo=="function"){playerObject.playVideo(dojo.toJson(videoInfo));}else{console.error("{Player} video Player still not loaddisableded");}}};dojo.provide("dj.widget.video.view.Mp4MicroPlayer");dojo.require("dj.widget.video.view.BasePlayer");dojo.require("dj.widget.video.model.PlayerEvents");dojo.require("dj.util.VideoTracking");dojo.declare("dj.widget.video.view.Mp4MicroPlayer",dj.widget.video.view.BasePlayer,{renderPreloaddisableder:function(){this.oCnt=dojo.byId(this.controller.configuration.playerID);dojo.addClass(this.oCnt,this.configuration.preloaddisablederClassName);},render:function(){if(this.playerCreated){return;}
this.playerCreated=true;var Ev=dj.widget.video.model.PlayerEvents;this.controller.observer.fireByName(Ev.continueLoadVideo);this.controller.observer.fireByName(Ev.playVideo);this.controller.readyForEvents=true;},play:function(parameters){dj.util.VideoTracking.fire(parameters);var videoUri=parameters.video320kMP4Url;if(!videoUri){console.error("{view.MicroPlayer} no videoUri specified");return;}
setTimeout(function(){document.location=videoUri;},500);}});dojo.provide("dj.widget.video.view.SwfMicroPlayer");dojo.require("dj.widget.video.view.BasePlayer");dojo.require("dj.util.VideoUtils");dojo.require("dj.widget.video.model.PlayerEvents");dojo.require("dj.widget.video.model.SWFPlayer");dojo.declare("dj.widget.video.view.SwfMicroPlayer",dj.widget.video.view.BasePlayer,{renderPreloaddisableder:function(){this.oCnt=dojo.byId(this.controller.configuration.playerID);dojo.addClass(this.oCnt,this.configuration.preloaddisablederClassName);},render:function(){if(this.playerCreated){return;}
this.playerCreated=true;var conf=this.controller.configuration;var swfPlayer=new dj.widget.video.model.SWFPlayer();swfPlayer.id=conf.playerID;swfPlayer.swfURL=conf.flashPlayerPath+conf.playerType.swfFile;swfPlayer.containerID=conf.containerID;swfPlayer.width=conf.playerType.width;swfPlayer.height=conf.playerType.height;swfPlayer.host=conf.host;swfPlayer.allowPlayerPopup=1;swfPlayer.eventNamespace=this.controller.getEventNamespace();var playerEvents=dj.widget.video.model.PlayerEvents;for(var evName in playerEvents){if(playerEvents.hasOwnProperty(evName)){swfPlayer[evName]=evName;}}
this._wrapPlayerInContainer();this._replacePlayerWithSwf(swfPlayer);},play:function(parameters){this._playerObject=swfobject.getObjectById(this.controller.configuration.playerID);if(this._playerObject&&typeof this._playerObject.playVideo=="function"){this._playerObject.playVideo(dojo.toJson(parameters));this._pollForVideoEvents();}else{console.error("{Player} video Player still not loaddisableded");}}voidPopUpPlayer:function(){dj.util.VideoUtils.popUpPlayer({playLocation:Math.floor(swfobject.getObjectById(this.controller.configuration.playerID).getSeek()),collection:this.controller.getVideoData("wsj-section"),videoID:this.controller.getVideoData("id"),height:this.controller.configuration.playerType.height,width:this.controller.configuration.playerType.width});},_replacePlayerWithSwf:function(swfPlayer){dj.util.VideoUtils.createSWFPlayer(swfPlayer);},_wrapPlayerInContainer:function(){var oCnt=dojo.byId(this.controller.configuration.containerID),oCntPosition=dojo.position(oCnt),wrapper=document.createElement("div");var pos=dojo.position(oCnt);dojo.style(wrapper,{width:pos.w+"px",height:pos.h+"px"});dojo.addClass(wrapper,oCnt.className);dojo.place(wrapper,oCnt,"before");dojo.place(oCnt,wrapper,"first");},_pollForVideoEvents:function(){if(!this._playerObject||(typeof this._playerObject.getSeek!=="function")){return;}
var events=dj.widget.video.model.PlayerEvents,that=this,duration=this.controller.videoInformation.duration,pos=(that._playerObject.getSeek()||0),cnt=3,isPlay=true;clearInterval(this.ival);this.ival=setInterval(function(){if(typeof that._playerObject.getSeek!=="function"){clearInterval(that.ival);return;}
var newPos=that._playerObject.getSeek(),newCnt=(newPos===pos)?(cnt+1):0;if(isPlay){isPlay=false;that.controller.observer.fireByName(events.playVideo);console.log("Playing Video");}else if((cnt>3)&&(newCnt==0)){that.controller.observer.fireByName(events.unpauseVideo);}
cnt=newCnt;pos=newPos;if(cnt==3){if((duration-pos)<=1){that.controller.observer.fireByName(events.stopVideo);clearInterval(that.ival);}else{that.controller.observer.fireByName(events.pauseVideo);}}},250);},destructor:function(){clearInterval(this.ival);}});dojo.provide("dj.widget.video.view.Html5MicroPlayer");dojo.require("dj.widget.video.view.Mp4MicroPlayer");dojo.provide("dj.widget.video.model.PlayerEvents");dojo.require("dj.util.VideoUtils");dojo.declare("dj.widget.video.view.Html5MicroPlayer",dj.widget.video.view.Mp4MicroPlayer,{play:function(parameters){var videoUri=parameters.video320kMP4Url;if(!videoUri){console.error("{view.MicroPlayer} no videoUri specified");return;}
this._createVideoObject(parameters.videoStillURL,videoUri);this._subscribeToVideoEvents();dojo.removeClass(this.oCnt,this.configuration.preloaddisablederClassName);dojo.empty(this.oCnt);dojo.place(this._video,this.oCnt);dj.util.VideoTracking.fire(parameters);this._playing=false;dj.util.VideoUtils.callThroughDispatch(function(){this._video.play();},this);},_createVideoObject:function(videoStillURL,videoUri){var pos=dojo.position(this.oCnt);this._video=dojo.create("video",{poster:videoStillURL,src:videoUri,controls:true,width:pos.w,height:pos.h});},_subscribeToVideoEvents:function(){var ev=dj.widget.video.model.PlayerEvents,ob=this.controller.observer;dojo.connect(this._video,"onplay",function(){ob.fireByName(ev.playVideo);});dojo.connect(this._video,"onpause",function(){ob.fireByName(ev.pauseVideo);});dojo.connect(this._video,"onended",function(){ob.fireByName(ev.stopVideo);});}});dojo.provide("dj.module.video.standAloneVideo");dojo.require("dj.util.Video");dojo.require("dj.module.videoModule");dojo.require("dj.lang");dojo.require("dj.widget.video.controller.MicroPlayer");dojo.require("dj.widget.video.controller.Player");dojo.require("dj.widget.video.model.PlayerEvents");dojo.require("dj.util.Element");dj.module.video.standAloneVideo={init:function(conf){this.configuration={standAloneVideoClass:"",thumbnailVideoClass:""};dojo.mixin(this.configuration,conf);that=this;var standAloneVideoClass=this.configuration.standAloneVideoClass;var thumbnailVideoClass=this.configuration.thumbnailVideoClass;var standAloneAnchor=dojo.query('#'+standAloneVideoClass)[0];if(standAloneAnchor){try{var standAloneGuid=dj.util.Element.getData(standAloneAnchor,'guid');var videoDetail=dj.util.Video.getVideoDetails({id:standAloneGuid,fields:'formattedLastModifiedDate,duration,wsj-section,wsj-subsection'});dojo.query('.video #videoMetaStrap .videoCategory')[0].innerHTML=that.getCategory(videoDetail);dojo.query('.video #videoMetaStrap .videoDateStamp')[0].innerHTML=that.getVideoDate(videoDetail['formattedLastModifiedDate']);dojo.query('.video #videoMetaStrap .videoDuration')[0].innerHTML=that.getDuration(videoDetail['duration']);}catch(e){console.error(e);}}
try{var thumbnailVideoArr=dojo.query('.'+thumbnailVideoClass);dojo.forEach(thumbnailVideoArr,function(item,index){var thumbnailGuid=dj.util.Element.getData(item,"guid");var tVideoDetail=dj.util.Video.getVideoDetails({id:thumbnailGuid,fields:'duration,wsj-section,wsj-subsection'});dojo.query('.video #desc .videoCategory')[index].innerHTML=that.getCategory(tVideoDetail);dojo.query('.video #desc .videoDuration')[index].innerHTML=that.getDuration(tVideoDetail['duration']);});}catch(e){console.error(e);}
dojo.addLiveEvent("."+thumbnailVideoClass,"click",function(ev){var videoImgEle=dojo.query('#'+standAloneVideoClass+' img')[0];var id=this.id.split("|");var videoEle=dojo.byId(standAloneVideoClass);var outerSpan=dojo.query('#'+id[0]+'> span')[0];var innerSpan=dojo.query('#'+id[0]+'> span > span')[0];try{var nowPlayClass=dojo.query('.video .videoVerticalList .nowPlaying');if(nowPlayClass!==null&&nowPlayClass!==undefined&&nowPlayClass.length>0){var nowPlayId=nowPlayClass[0].id;console.log("nowPlayId: "+nowPlayId);dojo.removeClass(dojo.byId(nowPlayId),'nowPlaying');dojo.byId(nowPlayId+"_inner").innerHTML="";}
dojo.addClass(outerSpan,"nowPlaying");innerSpan.innerHTML="now playing";}catch(error){console.log("now playing not found");}
if(!videoImgEle){videoEle=dojo.query('.video .videoObjectBox')[0];dojo.removeClass(videoEle,'videoObjectLoading');videoEle.setAttribute('id',standAloneVideoClass);videoEle.setAttribute('data-dj-live-widget','video.MicroPlayer');videoEle.setAttribute('data-guid',outerSpan.getAttribute('guid'));videoEle.setAttribute('data-video-info','');videoEle.innerHTML="<a href='#' class='videoClickThru'><span class='videoHint'>Click to Play</span><img width='272' height='152' src='"
+outerSpan.getAttribute('image')
+"'/></a>";}else{videoEle.setAttribute('data-guid',outerSpan.getAttribute('guid'));videoImgEle.setAttribute('src',outerSpan.getAttribute('image'));console.log("data-fuid"+videoEle.getAttribute('data-guid'));}
var vGuid=outerSpan.getAttribute('guid');if(vGuid!==undefined){try{var result=dj.util.Video.getVideoDetails({id:vGuid,fields:'formattedLastModifiedDate,duration,wsj-section,wsj-subsection'});dojo.query('.video #videoMetaStrap .videoDateStamp')[0].innerHTML=that.getVideoDate(result['formattedLastModifiedDate']);dojo.query('.video #videoMetaStrap .videoCategory')[0].innerHTML=that.getCategory(result);dojo.query('.video #videoMetaStrap .videoDuration')[0].innerHTML=that.getDuration(result['duration']);dojo.query('.video #videoDesc > h2')[0].innerHTML=outerSpan.getAttribute('title');}catch(error){console.log(error);}}
var obj=dojo.byId(standAloneVideoClass);that.fireEvent(obj,'click');});},getDuration:function(vDuration){var hours=Math.floor(vDuration/(60*60));var divisorMinutes=vDuration%(60*60);var minutes=Math.floor(divisorMinutes/60);var divisorSeconds=divisorMinutes%60;var seconds=Math.ceil(divisorSeconds);if(hours>0){vDuration=hours+':'+minutes+':'+seconds;}else if(minutes>0){if(seconds<10){vDuration=minutes+':0'+seconds;}else{vDuration=minutes+':'+seconds;}}else{vDuration=seconds;}
return vDuration;},getVideoDate:function(videoTimeStamp){if(videoTimeStamp!==null&&videoTimeStamp!==''){videoTimeStamp=videoTimeStamp.substring(videoTimeStamp.indexOf('/')-2,videoTimeStamp.lastIndexOf('/')+5);}
return videoTimeStamp;},getCategory:function(result){var vCategory=result['wsj-subsection'];if(vCategory===null||vCategory===''){vCategory=result['wsj-section'];}
return vCategory;}};dojo.provide("dj.module.video.playlistPlayer");dojo.require("dj.widget.video.controller.Player");dojo.require("dj.widget.video.view.MainPlayer");dojo.require("dj.widget.video.view.Html5MicroPlayer");dojo.require("dj.lang");dojo.require("dj.util.Element");dojo.require("dj.util.Video");dj.module.video.playlistPlayer={init:function(conf){this.configuration={playerContainerID:"standAloneVideoPlayer",playerContainerClass:"videoObjectBox",playerID:"standAloneVideoPlayer",standAloneVideoClass:"standAloneVideo",thumbnailVideoClass:"thumbnail-link",linupId:"module",playerName:"homepage",adFormat:"frmt=0;",applicationID:4};dojo.mixin(this.configuration,conf);this.observer=new dj.util.Observer(dj.module.video.playlistPlayer);this.createVideoPlayer();this.displayDataForThumbnails();this.subscribeToEvents();this.addEvents();},subscribe:function(videoEventName,callback,context){this.observer.subscribeByName(videoEventName,callback,context);},subscribeToEvents:function(){this.subscribe("onVideoLoaded",this.videoLoaded,this);},videoLoaded:function(videoID,videoInfo){dojo.query('.videoObjectData .videoDateStamp')[0].innerHTML=this.getVideoDate(videoInfo['formattedLastModifiedDate']);dojo.query('.videoObjectData #videoMetaStrap .videoCategory')[0].innerHTML=this.getCategory(videoInfo);dojo.query('.videoObjectData #videoMetaStrap .videoDuration')[0].innerHTML=this.getDuration(videoInfo['duration']);dojo.query('#videoDesc > h2')[0].innerHTML=videoInfo.name;dojo.query(".nowPlaying").removeClass("nowPlaying");dojo.forEach(dojo.query(".js_nowplaying"),function(obj,index){obj.innerHTML="&nbsp;";});dojo.addClass(dojo.byId("video_image_"+videoID),"nowPlaying");dojo.byId("video_playing_"+videoID).innerHTML="now playing";},addEvents:function(){var that=this;dj.lang.addLiveEvent(".js_playvideo","click",function(event){dojo.stopEvent(event);var target=(event.srcElement||event.target);var guid=dj.util.Element.getData(target,"guid");that.videoPlayer.init(that.videoPlayerView);that.videoPlayer.playVideo(guid,that.configuration.linupId);});},createVideoPlayer:function(){this.videoPlayer=new dj.widget.video.controller.Player(this.observer,{playerType:dj.widget.video.model.PlayerTypes.MicroPlayer,containerID:this.configuration.playerContainerID,eventNamespace:"dj.module.video.playlistPlayer",playerID:this.configuration.playerID,adFormat:this.configuration.adFormat,applicationID:this.configuration.applicationID});this.videoPlayerView=(dj.util.VideoUtils.hasValidFlashVersion())?new dj.widget.video.view.MainPlayer({name:this.configuration.playerName}):new dj.widget.video.view.Html5MicroPlayer({name:this.configuration.playerContainerClass});},displayDataForThumbnails:function(){var that=this;var standAloneVideoClass=this.configuration.standAloneVideoClass;var thumbnailVideoClass=this.configuration.thumbnailVideoClass;var standAloneAnchor=dojo.query('#'+standAloneVideoClass)[0];if(standAloneAnchor){try{var timestamp=dj.util.Element.getData(standAloneAnchor,'timestamp');var duration=dj.util.Element.getData(standAloneAnchor,'duration');dojo.query('.video #videoMetaStrap .videoDateStamp')[0].innerHTML=that.getVideoDate(timestamp);dojo.query('.video #videoMetaStrap .videoDuration')[0].innerHTML=that.getDuration(duration);}catch(e){console.error(e);}}
try{var thumbnailVideoArr=dojo.query('.'+thumbnailVideoClass);dojo.forEach(thumbnailVideoArr,function(item,index){var duration=dj.util.Element.getData(item,"duration");dojo.query('.video #desc .videoDuration')[index].innerHTML=that.getDuration(duration);});}catch(e){console.error(e);}},getDuration:function(vDuration){var hours=Math.floor(vDuration/(60*60));var divisorMinutes=vDuration%(60*60);var minutes=Math.floor(divisorMinutes/60);var divisorSeconds=divisorMinutes%60;var seconds=Math.ceil(divisorSeconds);if(hours>0){vDuration=hours+':'+minutes+':'+seconds;}else if(minutes>0){if(seconds<10){vDuration=minutes+':0'+seconds;}else{vDuration=minutes+':'+seconds;}}else{vDuration=seconds;}
return vDuration;},getVideoDate:function(videoTimeStamp){if(videoTimeStamp!==null&&videoTimeStamp!==''){videoTimeStamp=videoTimeStamp.substring(videoTimeStamp.indexOf('/')-2,videoTimeStamp.lastIndexOf('/')+5);}
return videoTimeStamp;},getCategory:function(result){var vCategory=result['wsj-subsection'];if(vCategory===null||vCategory===''){vCategory=result['wsj-section'];}
return vCategory;},createAdvertisement:function(image,url){console.log("Response from createAdvertisement : %s, %s",image,url);},playVideo:function(){console.log("Playing...");}voidMicroPopUpPlayer:function(){dj.util.VideoUtils.popUpPlayer({playLocation:Math.floor(swfobject.getObjectById(this.videoPlayer.configuration.playerID).getSeek()),collection:this.videoPlayer.getVideoData("wsj-section"),videoID:this.videoPlayer.videoID,height:this.videoPlayer.configuration.playerType.height,width:this.videoPlayer.configuration.playerType.width});},continueLoadVideo:function(){this.videoPlayer.readyForEvents=true;}};dojo.provide("dj.widget.video.MicroPlayer");dojo.require("dj.widget.video.controller.MicroPlayer");dojo.require("dj.util.Video");dojo.require("dj.util.VideoUtils");dojo.require("dj.widget.video.model.PlayerEvents");dojo.require("dj.widget.video.view.SwfMicroPlayer");dojo.require("dj.widget.video.view.Mp4MicroPlayer");dojo.require("dj.widget.video.view.Html5MicroPlayer");dojo.declare("dj.widget.video.MicroPlayer",null,{constructor:function(containerId,dataset){this.containerId=containerId;this.dataset=dataset;},loaddisabledVideo:function(){this._createView();this._createController();this._connectPageAndControllerEvents();this.dataset.guid=dj.util.VideoUtils.normalizeGuid(this.dataset.guid);var seekTime=0;this.controller.init(this.view,this.dataset.guid,seekTime);},reloaddisabledVideo:function(dataset){this.dataset=dataset;this.dataset.guid=dj.util.VideoUtils.normalizeGuid(this.dataset.guid);var seekTime=0;this.controller.init(this.view,this.dataset.guid,seekTime,true);},_createView:function(){if(dj.util.VideoUtils.hasValidFlashVersion()){this.view=new dj.widget.video.view.SwfMicroPlayer();}else if(dj.util.VideoUtils.isH264BaselineVideoSupported()){this.view=new dj.widget.video.view.Html5MicroPlayer();}else{this.view=new dj.widget.video.view.Mp4MicroPlayer();}},_createController:function(){this.controller=new dj.widget.video.controller.MicroPlayer(null,{containerID:this.containerId,playerID:this.containerId,playerType:this._getPlayerType(this.dataset.videoSize),dataset:this.dataset});},_getPlayerType:function(size){if(size==='E'){playerType=dj.widget.video.model.PlayerTypes.MicroPlayerE;}else if(size==='F'){playerType=dj.widget.video.model.PlayerTypes.MicroPlayerF;}else{playerType=dj.widget.video.model.PlayerTypes.MicroPlayer;}
return playerType;},_connectPageAndControllerEvents:function(){var guid=this.dataset.guid,events=dj.widget.video.model.PlayerEvents,Video=dj.util.Video;this.controller.subscribeByName(events.playVideo,function(){Video.playVideo(guid);});this.controller.subscribeByName(events.pauseVideo,function(){Video.pauseVideo(guid);});this.controller.subscribeByName(events.stopVideo,function(){Video.stopVideo(guid);});},destructor:function(){this.view.destructor();}});dojo.provide("dj.module.video.liveMicroPlayer");dojo.require("dj.util.liveWidget");dojo.require("dj.util.Element");dojo.require("dj.widget.video.MicroPlayer");dj.module.video.liveMicroPlayer={init:function(){if(this._isInit){return;}
this._isInit=true;this._setupLiveWidget();},destroy:function(){dj.util.liveWidget.unregister("video.MicroPlayer");},_setupLiveWidget:function(){dj.util.liveWidget.register("video.MicroPlayer",function(liveWidget,dataset){dojo.stopEvent(liveWidget.event);var id=dj.util.Element.identify(liveWidget.domNode);this._initMicroPlayer(id,dataset);},this);},_initMicroPlayer:function(id,dataset){var player=new dj.widget.video.MicroPlayer(id,dataset);player.loaddisabledVideo();}};
dojo.provide("dj.module.facebook.connect");dojo.require("dj.lang");dj.module.facebook.connect={init:function(callback){window.fbAsyncInit=function(){FB.init({appId:dj.context.facebook.apiKey,status:true,cookie:true,xfbml:true});var paramString=dojo.queryToObject(window.location.search.slice(1));if(typeof paramString.fbresult!='undefined'){if(paramString.fbresult=='add'){dj.module.facebook.voidModalMessage('/public/page/0_0_WG_GlobalfacebookScrim2010.html');dj.module.facebook.connect.fireScrimPixel('FBconnect_thankyou1');}else if(paramString.fbresult=='update'){dj.module.facebook.voidModalMessage('/public/page/0_0_WG_GlobalfacebookScrim2010_reconnect.html');dj.module.facebook.connect.fireScrimPixel('FBconnect_thankyou2');}}
if(typeof callback=='function'){callback();}};(function(){var e=document.createElement('script');e.src=document.location.protocol+'//connect.facebook.net/en_US/all.js';e.type='text/javascript';e.charset="utf-8";e.async=true;var fbRoot=dojo.byId("fb-root");if(null===fbRoot){fbRoot=dojo.create("div",{id:"fb-root",style:{display:"none"}},dojo.body());}
dojo.place(e,fbRoot);}());},fireScrimPixel:function(pName){if(typeof setMetaData!='undefined'){var pageNameHolder=dj.util.Tracking.omniture.getMetaData("pagename");var c19Holder=dj.util.Tracking.omniture.getMetaData("ctype");var sectionHolder=dj.util.Tracking.omniture.getMetaData("section");var subsectionHolder=dj.util.Tracking.omniture.getMetaData("subsection");var caccessHolder=dj.util.Tracking.omniture.getMetaData("caccess");var qsymbolHolder=dj.util.Tracking.omniture.getMetaData("qsymbol");var basesectionHolder=dj.util.Tracking.omniture.getMetaData("basesection");setMetaData('pagename',pName);setMetaData('ctype',"marketing and support");setMetaData('section',"WSJ_Customer Resources");setMetaData('subsection',"WSJ_Customer Resources");setMetaData('caccess',"free");setMetaData('basesection',"WSJ_FBconnect");setMetaData('qsymbol',null);dj.util.Tracking.omniture.firePixel();setMetaData('pagename',pageNameHolder);setMetaData('ctype',c19Holder);setMetaData('section',sectionHolder);setMetaData('subsection',subsectionHolder);setMetaData('caccess',caccessHolder);setMetaData('basesection',basesectionHolder);setMetaData('qsymbol',qsymbolHolder);}},login:function(afterLoginURL){if(typeof FB=="undefined"){this.init(dj.module.facebook.connect.processLogin);}else{this.processLogin(afterLoginURL);}},processLogin:function(afterLoginURL,callback){if(afterLoginURL){this.afterLoginURL=afterLoginURL;}
if(typeof callback!='undefined'){FB.login(callback,{perms:'publish_stream,email,offline_access,user_birthday,user_work_history,user_education_history,user_website,user_about_me'});}else{FB.login(dj.module.facebook.connect.afterLogin,{perms:'publish_stream,email,offline_access,user_birthday,user_work_history,user_education_history,user_website,user_about_me'});}},afterLogin:function(response){if(response.session){if(dj.module.facebook.connect.afterLoginURL){location.href=dj.context.facebook.commerceLoginURL+"?url="+encodeURIComponent(dj.module.facebook.connect.afterLoginURL);}else{location.href=dj.context.facebook.commerceLoginURL+"?url="+encodeURIComponent(location.href);}}else{}},addConnectClick:function(button,afterLoginURL){var that=this;dj.lang.addLiveEvent(button,"click",function(event){dojo.stopEvent(event);that.login(afterLoginURL);});},displayMessage:function(parameters){parameters.url="";parameters.message="";if(typeof parameters.callback=="function"){parameters.callback();}},logout:function(callback){FB.logout(callback);},getUserID:function(){if(FB.getSession()){return FB.getSession().uid;}else{return null;}},publish:function(publishObject,callback){if(typeof FB!="undefined"){if(FB.getSession()){myObj=publishObject;myObj.method='stream.publish';myObj.preview=1;myObj.display='popup';FB.ui(myObj,callback);}else{}}else{console.error("User is not logged in or FB in undefined");callback(false);}},showModalScrim:function(){var modalBackground=dojo.byId('fbscrim');var modalContent=dojo.byId('fbscrim_content');modalBackground.style.display='block';modalContent.style.display='block';dojo.query('div#fbscrim_content a.closebtn').connect("onclick",dj.module.facebook.connect.hideModalScrim);},hideModalScrim:function(){var modalBackground=dojo.byId('fbscrim');var modalContent=dojo.byId('fbscrim_content');modalBackground.style.display='none';modalContent.style.display='none';}voidModalMessage:function(pageURL,height){var that=this;dojo.xhrGet({url:pageURL,handleAs:"text",preventCache:false,loaddisabled:function(response,ioArgs){var firstlastname;dojo.byId('fbscrim_content').innerHTML=response;firstlastname=djcs.UserInfo.getFirstName()+' '+djcs.UserInfo.getLastName();dojo.query('div#fbscrim_content .fullpageScrimMessage .userName').forEach(function(node,index,nodeList){node.innerHTML=firstlastname;});FB.XFBML.parse(dojo.byId('fbscrim_content'),dj.module.facebook.connect.showModalScrim);},error:function(rseponse,ioArgs){console.error("Could not loaddisabled scrim"+response);}});}};dojo.provide("dj.module.facebook.api");dojo.require("dj.module.facebook.connect");dj.module.facebook.api={modValue:'fbconnect_wsj',numOfWords:40,truncateWords:function(in_str,counter){var postfix="";var return_val="";var splitup=in_str.split(" ");if(splitup.length>counter){postfix="...";splitup=splitup.slice(0,counter);}
return splitup.join(" ")+postfix;},addtracking:function(url,modstring){parseUri=function(str){var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--)uri[o.key[i]]=m[i]||"";uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1)uri[o.q.name][$1]=$2;});return uri;};parseUri.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var myUri=parseUri(url);var newUrl=myUri.protocol+"://"+myUri.host+myUri.path+"?";var newMod=(modstring)?modstring:this.modValue;for(var param in myUri.queryKey){if(String(param).toUpperCase()!='MOD'){newUrl+=param+"="+myUri.queryKey[param]+"&";}}
newUrl+="mod="+newMod;newUrl+=(myUri.anchor)?"#"+myUri.anchor:"";return newUrl;},postAnswer:function(params){if(!(params.question&&params.answer&&params.questionPermalink)){return false;}
var message=this.truncateWords(params.answer,this.numOfWords);var attachment={'name':params.question,'href':this.addtracking(params.questionPermalink),'caption':"WSJ.com"};var actionlink=[{'text':'Answer','href':this.addtracking(params.questionPermalink)}];this.sendStream(message,attachment,actionlink,params.callbackFn,params.callbackParams);},postArticleComment:function(params){var returnedPostId=-1;if(!(params.comment&&params.commentPermalink)){return false;}
JSON.stringify=function(obj){return dojo.toJson(obj);};var articlePermalink=(typeof AT_VARS!='undefined')?AT_VARS.articleUrl:params.commentPermalink;var seoHeadline=(typeof AT_VARS!='undefined')?AT_VARS.seoHeadline:'';if(typeof seoHeadline=='undefined'){seoHeadline=AT_VARS.articleHeadline;}
var sizeA=(typeof AT_VARS!='undefined')?AT_VARS.imgSizeA:'http://s.wsj.net/img/WSJ_profile_lg.gif';var description=(typeof AT_VARS!='undefined'&&typeof AT_VARS.bodyText!='undefined')?AT_VARS.bodyText.replace(/\+/g," "):"";var message=this.truncateWords(params.comment,this.numOfWords);var attachment={'name':seoHeadline,'href':this.addtracking(articlePermalink),'description':unescape(description),'caption':"WSJ.com"};if(sizeA!=null){attachment.media=[{'type':'image','src':sizeA,'href':this.addtracking(articlePermalink)}];}
var actionlink=[{'text':'Read the Article','href':this.addtracking(params.commentPermalink)}];this.sendStream(message,attachment,actionlink,params.callbackFn,params.callbackParams);},postCreateGroup:function(params){if(!(params.groupName&&params.groupDescription&&params.groupPermalink)){return false;}
var message="";var attachment={'name':params.groupName,'href':this.addtracking(params.groupPermalink),'description':params.groupDescription,'caption':"WSJ.com"};var actionlink=[{'text':'Join this Journal Group','href':this.addtracking(params.groupPermalink)}];this.sendStream(message,attachment,actionlink,params.callbackFn,params.callbackParams);},postJoinGroup:function(params){if(!(params.groupName&&params.groupDescription&&params.groupPermalink)){return false;}
var message="";var attachment={'name':params.groupName,'href':this.addtracking(params.groupPermalink),'description':params.groupDescription,'caption':"WSJ.com"};var actionlink=[{'text':'Join this Journal Group','href':this.addtracking(params.groupPermalink)}];this.sendStream(message,attachment,actionlink,params.callbackFn,params.callbackParams);},postPollVote:function(params_str){if(!params_str){return null;}
params=dojo.fromJson(params_str);var pollOptions="";JSON.stringify=function(obj){return dojo.toJson(obj);};for(var i=0;i<params.options.length;i++){pollOptions+=(i+1)+") "+params.options[i].value+" ";}
var static_img='http://s.wsj.net/img/WSJ_profile_lg.gif';var message='voted on a Wall Street Journal poll';var attachment={'name':params.question,'href':this.addtracking(window.location),'description':pollOptions,'media':[{'type':'image','src':static_img,'href':this.addtracking(window.location)}]};var actionlink=[{'text':'Related Article','href':this.addtracking(params.poll_meta.urlSrc)}];if(params.poll_meta.communityURLSrc!=""){actionlink=[{'text':'Journal Community Group','href':this.addtracking(params.poll_meta.communityURLSrc)}];}
this.sendStream(message,attachment,actionlink,function(response){},null);},postQuestion:function(params){if(!(params.question&&params.category&&params.questionPermalink)){return false;}
var message=this.truncateWords(params.question,this.numOfWords);var attachment={'name':params.category,'href':this.addtracking(params.questionPermalink),'caption':"WSJ.com"};var actionlink=[{'text':'Answer','href':this.addtracking(params.questionPermalink)}];this.sendStream(message,attachment,actionlink,params.callbackFn,params.callbackParams);},postTopic:function(params){if(!(params.topic&&params.topicPermalink&&params.description)){return false;}
var message=this.truncateWords(params.topic,this.numOfWords);var attachment={'name':params.topic,'href':this.addtracking(params.topicPermalink),'description':params.description,'caption':"WSJ.com"};var actionlink=[{'text':'Join the discussion','href':this.addtracking(params.topicPermalink)}];this.sendStream(message,attachment,actionlink,params.callbackFn,params.callbackParams);},postTopicComment:function(params){var returnedPostId=-1;if(!(params.comment&&params.commentPermalink&&params.topicName&&params.topicDescription&&params.topicPermalink)){return false;}
var message=this.truncateWords(params.comment,this.numOfWords);;var attachment={'name':params.topicName,'href':this.addtracking(params.topicPermalink),'description':params.topicDescription,'caption':"WSJ.com"};var actionlink=[{'text':'Join this discussion','href':this.addtracking(params.commentPermalink)}];this.sendStream(message,attachment,actionlink,params.callbackFn,params.callbackParams);},sendStream:function(msg,attach,actionlink,callbackFn,callbackParams){var returnedPostId=-1;FB.getLoginStatus(function(response){if(response.session){dj.module.facebook.connect.publish({message:msg,attachment:attach,action_links:actionlink},function(response_pub){if(response_pub){returnedPostId=response_pub.post_id;dj.module.facebook.api.omnitureEventCall("event56");if(callbackFn)
callbackFn(callbackParams,dj.module.facebook.connect.getUserID(),returnedPostId);else
console.log('success: '+returnedPostId);}else{}});}else{dj.module.facebook.connect.processLogin(document.location,dojo.hitch(this,dj.module.facebook.api.sendStream,msg,attach,actionlink,callbackFn,callbackParams));}});return returnedPostId;},omnitureEventCall:function(evnt){if(typeof s!='undefined'){s.linkTrackVars="events";s.linkTrackEvents="event56";s.events="event56";s.tl(this,'o',"fb_activity");s.linkTrackVars="None";s.linkTrackEvents="None";}}};
dojo.provide("dj.widget.networkHat.infocomplete");function InfoComplete(){this.dataSource=null;this.autoComplete=null;this.count=0;this.domain="";this.allowcountries="";this.allowsymboltypes="";this.allowexchanges="";this.currentQueryHasResultMatch=false;this.lastExactResult="";this.exactMatches=[];this.symbol=null;this.keyword=null;}
function autoCompleteTrim(text){return text.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1");}
InfoComplete.prototype.Setup=function(config)
{var i,maxi;if(typeof config=='undefined'||config===null){return;}
for(i=0,maxi=config.sections.length;i<maxi;i++){var server=config.sections[i].dataSource.server;if(typeof server=='undefined'||server===null||server===''){return;}}
var bodyelement=document.getElementsByTagName("BODY")[0];this.count=config.count;this.dataSource=[];for(i=0,maxi=config.sections.length;i<maxi;i++){var section=config.sections[i];if(section.type=='keyword'){this.keyword=i;}
else if(section.type=='symbol'){this.symbol=i;}
var tmpDs=new YAHOO.widget.DS_XHR(section.dataSource.server,section.dataSource.schema);tmpDs.responseType=section.dataSource.responseType;tmpDs.scriptQueryAppend=section.dataSource.scriptQueryAppend;tmpDs.index=i;tmpDs.dataErrorEvent.subscribe(this.handleError,tmpDs);this.dataSource[i]=tmpDs;}
this.autoComplete=new YAHOO.widget.MultiAutoComplete(config.inputId,config.containerId,this.dataSource);this.count=config.count;this.autoComplete.autoHighlight=false;this.autoComplete.maxResultsDisplayed=config.count;this.autoComplete.queryDelay=config.delay;this.autoComplete.allowBrowserAutocomplete=false;this.autoComplete.typeAhead=true;this.autoComplete.animVert=false;this.autoComplete.animHoriz=false;this.autoComplete.delimChar=",";this.autoComplete.setHeader('Choose a quote match or "GO" to get quote news');this.autoComplete.setFooter('Separate multiple symbols with commas (,)');this.autoComplete.formatResult=function(aResultItem,sQuery,iIndex){return config.sections[iIndex].formatFunc(aResultItem,sQuery,iIndex,this);};this.autoComplete.dataReturnEvent.subscribe(this.checkResultsForExactMatch,this.autoComplete,this);this.autoComplete.textboxKeyEvent.subscribe(this.checkPastExactResults,this.autoComplete,this);};InfoComplete.prototype.getFirstDelimChar=function()
{if(this.autoComplete.delimChar&&this.autoComplete.delimChar.length>0){return this.autoComplete.delimChar[0];}
return'';};InfoComplete.prototype.isSymbolMatch=function()
{var delim=this.getFirstDelimChar();if(this.currentQueryHasResultMatch===true&&this.lastExactResult.toUpperCase()==autoCompleteTrim(this.autoComplete._oTextbox.value).replace(/,$|\.,$/,"").toUpperCase()){return true;}
var splitInput=this.autoComplete._oTextbox.value.split(delim);for(var i=0;i<this.exactMatches.length;i++){for(var j=0;j<splitInput.length;j++){if(this.exactMatches[i]==splitInput[j]){return true;}}}
return this.doesListHaveMatch(0);};InfoComplete.prototype.handleError=function(e,args)
{var ac=args[1];if(ac._populateStaging){ac._populateStaging("null",null,ac,args[0].index);}};InfoComplete.prototype.checkPastExactResults=function(e,args)
{if('function'==typeof this.getFirstDelimChar){var delim=this.getFirstDelimChar();if(args[0]._oTextbox.value.length>0&&args[0]._oTextbox.value.lastIndexOf(delim)==args[0]._oTextbox.value.length-1&&this.currentQueryHasResultMatch)
{if(this.exactMatches.length>0)
{for(var i=0;i<this.exactMatches.length;i++)
{if(this.exactMatches[i]==this.lastExactResult){return;}}}
this.exactMatches.push(this.lastExactResult);}}};InfoComplete.prototype.checkResultsForExactMatch=function(e,args)
{if(!args||args.length<4||args[3]>0){return;}
var delim=this.getFirstDelimChar();var listItems=args[2];var termToMatch=args[0]._oTextbox.value;if(termToMatch.indexOf(delim)>0)
{var splitTerms=termToMatch.split(delim);termToMatch=autoCompleteTrim(splitTerms[splitTerms.length-1]);}
if(listItems&&listItems.length>0)
{for(var i=0;i<listItems.length;i++)
{if(listItems[i]&&listItems[i][0]!==null)
{var ticker=listItems[i][0];if(termToMatch.toUpperCase()==ticker.toUpperCase())
{this.currentQueryHasResultMatch=true;this.lastExactResult=termToMatch;return;}}}}
this.currentQueryHasResultMatch=false;};InfoComplete.prototype.doesListHaveMatch=function(iDsIndex)
{var delim=this.getFirstDelimChar();var allItems=this.autoComplete.getListItems();var termToMatch=autoCompleteTrim(this.autoComplete._oTextbox.value).replace(/,$|\.,$/,"");if(termToMatch.indexOf(delim)>0)
{var splitTerms=termToMatch.split(delim);termToMatch=autoCompleteTrim(splitTerms[splitTerms.length-1]);}
if(iDsIndex<allItems.length)
{var listItems=allItems[iDsIndex];for(var i=0;i<listItems.length;i++)
{if(listItems[i]&&listItems[i]._oResultData!==null)
{if(termToMatch.toUpperCase()==listItems[i]._oResultData[0].toUpperCase())
{return true;}}}}
return false;};function param()
{this.array=new Array(1);this.setValue=function(v){this.array[0]=v;};this.getValue=function(){return this.array[0];};}
function InstallLibrary(target)
{var t=target||window;t.symbolComplete=new InfoComplete();t.InfoComplete=new InfoComplete();}
InstallLibrary();dojo.provide("dj.widget.networkHat.hat");dojo.require("dj.util.Region");hat={search_keypress:function(e){var key;if(window.event){key=window.event.keyCode;}else{key=e.which;}
if(key==13){if(e.preventDefault){e.preventDefault();e.stopPropagation();}else{e.cancelBubble=true;e.returnValue=false;}
this.search();}},search:function(){try{var hatinput=document.getElementById("hat_input");var query=hatinput.value;var site=this.thisSite();if(site=="MW"){}else if(site=="MWC"||site=="VSE"||site=="BC"){query=query.replace(/^\s+|\s+$/g,"").replace(/,$|\.,$/,"");query=query.replace("Enter Keyword(s)","");if(query){window.location='http://www.marketwatch.com/search/?value='+query;}else{window.location='http://www.marketwatch.com/search';}}else{var baseDomain='http://'+document.domain;query=query.replace(/^\s+|\s+$/g,"").replace(/,$|\.,$/,"");var searchURL=baseDomain+'/search/term.html?KEYWORDS='+escape(query);window.location=searchURL;}}catch(ex){console.error("hat.search: "+ex);}},search_form:function(){var hat_searchform=document.getElementById("hat_searchform");if(hat_searchform){hat_searchform.submit();}},hideEl:function(id){var el=document.getElementById(id);if(el&&el.style){el.olddisplay=el.style.display;el.style.display="none";}},showEl:function(id){var el=document.getElementById(id);if(el&&el.style){el.style.display=el.olddisplay||"block";}},moremenu:function(){try{if(this.moreTimeout){clearTimeout(this.moreTimeout);this.moreTimeout=null;return;}
this.showEl("hat_more_menu");var moretab=document.getElementById("hat_tab5");moretab.className="hat_tab hat_more_sel";if(document.all){var el=document.getElementById("wsjCRSelectDrpdwn");if(el&&el.style){el.style.visibility="hidden";}}}catch(ex){console.error("hat.moremenu: "+ex);}},moreTimeout:null,moremenuhide:function(){if(!this.moreTimeout){this.moreTimeout=setTimeout(this.moremenuhidedelayed,100);}},moremenuhidedelayed:function(){try{hat.moreTimeout=null;hat.hideEl("hat_more_menu");var moretab=document.getElementById("hat_tab5");moretab.className="hat_tab";if(document.all){var el=document.getElementById("wsjCRSelectDrpdwn");if(el&&el.style){el.style.visibility="visible";}}}catch(ex){console.error("hat.moremenuhidedelayed: "+ex);}},tabover:function(el){try{if(el.className!="hat_tabsel"){if(el.srcElement)
{if(el.srcElement.parentNode.tagName=="LI"){el=el.srcElement.parentNode;}}
el.className="hat_tab hat_tab_over";}}catch(ex){console.error("hat.tabover: "+ex);}},tabout:function(el){try{if(el.className!="hat_tabsel"){if(el.srcElement)
{if(el.srcElement.parentNode.tagName=="LI"){el=el.srcElement.parentNode;}}
el.className="hat_tab";}}catch(ex){console.error("hat.tabout: "+ex);}},menuover:function(el){if(el.srcElement)
{el=el.srcElement;if(el.tagName=="A"){el=el.parentNode;}}
if(el){dojo.addClass(el,"hat_drop_item_sel");}},menuout:function(el){if(el.srcElement){el=el.srcElement;if(el.tagName=="A"){el=el.parentNode;}}
if(el&&el.className.indexOf("hat_drop_item_sel")>0){dojo.removeClass(el,"hat_drop_item_sel");}},inputfocus:function(searchField){try{var index=searchField.className.indexOf("hat_unused");if(index>=0){searchField.value="";searchField.className="hat_input";}}catch(ex){console.error("hat.inputfocus: "+ex);}},updateAnchorText:function(anchor,text){if(anchor.innerHTML!=text){if(anchor.firstChild){anchor.removeChild(anchor.firstChild);}
anchor.innerHTML=text;}},updateAnchorHref:function(anchor,href){if(anchor.href!=href){anchor.href=href;}},updateAnchorTitle:function(anchor,title){if(anchor.title!=title){anchor.title=title;}},updateChangeTab:function(tabnumber,text,url,linkTo,newId,popUp){var anchor=document.getElementById("hat_link"+tabnumber);if(anchor){if(text!==null){hat.updateAnchorText(anchor,text);}
if(url){hat.updateAnchorHref(anchor,url);}
if(linkTo){hat.updateAddTrackingOnclick(anchor,linkTo);}
if(popUp){hat.updateAnchorTitle(anchor,popUp);}}else{hat.updateAddChangeTab(tabnumber,text,url,linkTo);}
if(newId){var tab=document.getElementById("hat_tab"+tabnumber);tab.id=newId;}},updateAddChangeTab:function(tabnumber,text,url,linkTo,popUp){var hat_div=document.getElementById("hat_div");var hat_tab5=document.getElementById("hat_tab5");var hat_tabs;for(var i=0;i<hat_div.childNodes.length;i++){if(hat_div.childNodes[i].className=="hat_tabs"){hat_tabs=hat_div.childNodes[i];}}
var newItem=document.createElement("li");var anchor=document.createElement("a");newItem.appendChild(anchor);newItem.className="hat_tab";newItem.setAttribute("id","hat_tab"+tabnumber);if(newItem.attachEvent)
{newItem.attachEvent("onmouseover",hat.tabover);newItem.attachEvent("onmouseout",hat.tabout);}else{newItem.setAttribute("onmouseover","hat.tabover(this)");newItem.setAttribute("onmouseout","hat.tabout(this)");}
anchor.href=url;anchor.setAttribute("id","hat_link"+tabnumber);if(text!==null){hat.updateAnchorText(anchor,text);}
if(url){hat.updateAnchorHref(anchor,url);}
if(linkTo){hat.updateAddTrackingOnclick(anchor,linkTo);}
if(popUp){hat.updateAnchorTitle(anchor,popUp);}
if(hat_tabs){hat_tabs.insertBefore(newItem,hat_tab5);}},updateChangeMoreItem:function(morenumber,text,url,linkTo){var moreli=document.getElementById("hat_more"+morenumber);if(moreli&&moreli.childNodes){for(var i=0;i<moreli.childNodes.length;i++){var node=moreli.childNodes[i];var tag=node.tagName;if(tag&&tag.toLowerCase()=="a"){if(text!==null){hat.updateAnchorText(node,text);}
if(url){hat.updateAnchorHref(node,url);}
if(linkTo){hat.updateAddTrackingOnclick(node,linkTo);}
break;}}}else{hat.updateAddMoreItem(morenumber,text,url,linkTo);}},updateRemoveMoreItem:function(morenumber){var moreli=document.getElementById("hat_more"+morenumber);var hat_more_menu=document.getElementById("hat_more_menu");if(moreli&&hat_more_menu){hat_more_menu.removeChild(moreli);}},updateAddTrackingOnclick:function(anchor,linkTo){if(anchor.attributes.onclick){if(anchor.attributes.onclick.nodeValue==("hat.track('"+linkTo+"')")){return;}
anchor.removeAttribute("onclick");}
if(anchor.attachEvent)
{anchor.attachEvent("onclick",hat.track);}else{anchor.addEventListener("click",hat.track,false);}
anchor.linkTo=linkTo;},updateAddMoreItem:function(morenumber,text,url,linkTo){var hat_more_menu=document.getElementById("hat_more_menu");var newItem=document.createElement("li");var anchor=document.createElement("a");newItem.appendChild(anchor);newItem.className="hat_drop_item";newItem.setAttribute("id","hat_more"+morenumber);if(newItem.attachEvent)
{newItem.attachEvent("onmouseover",hat.menuover);newItem.attachEvent("onmouseout",hat.menuout);}else{newItem.setAttribute("onmouseout","hat.menuout(this)");newItem.setAttribute("onmouseover","hat.menuover(this)");}
anchor.href=url;anchor.appendChild(document.createTextNode(text));hat.updateAddTrackingOnclick(anchor,linkTo);if(hat_more_menu){hat_more_menu.appendChild(newItem);}},track:function(evt){try{var linkTo;if(evt.target){linkTo=evt.target.linkTo;}else if(evt.srcElement){linkTo=evt.srcElement.linkTo;}else{linkTo=evt;}
var link="dnh_"+hat.thisSite()+'2'+linkTo;link=link.toLowerCase();var s_ios=s.ios;s.ios=1;if(s){s.tl(true,'o',link);}
s.ios=s_ios;}catch(ex){console.error("hat.track: "+ex);}},updateSelectTab:function(tabnumber){for(var i=1;i<=4;i++){var tab=document.getElementById("hat_tab"+i);if(tab){tab.className=(i==tabnumber?"hat_tabsel":"hat_tab");}}},thisSite:function(){var hat_div=document.getElementById("hat_div");if(hat_div){var cl=hat_div.className;if(cl.match(/hat_eur/)){return"EUR";}
if(cl.match(/hat_spa/)){return"SPA";}
if(cl.match(/hat_por/)){return"POR";}
if(cl.match(/hat_chi/)){return"CHI";}
if(cl.match(/hat_jpn/)){return"JPN";}
if(cl.match(/hat_asia/)){return"ASIA";}
if(cl.match(/hat_wsj/)){return"WSJ";}
if(cl.match(/hat_mwc/)){return"MWC";}
if(cl.match(/hat_mw/)){return"MW";}
if(cl.match(/hat_bol/)){return"BOL";}
if(cl.match(/hat_atd/)){return"ATD";}
if(cl.match(/hat_vse/)){return"VSE";}
if(cl.match(/hat_bc/)){return"BC";}
if(cl.match(/hat_sm/)){return"SM";}
if(cl.match(/hat_wrad/)){return"WRAD";}
if(cl.match(/hat_fins/)){return"FINS";}
if(cl.match(/hat_wsd/)){return"WSD";}}
return"";},updateBuildLink:function(url){var site=hat.thisSite();var query="?reflink=";switch(site){case"WSJ":if(url.match(/wsj/i)){query="?MOD=";}
break;case"BOL":if(url.match(/barrons/i)){query="?MOD=";}
break;case"ATD":if(url.match(/allthingsd/i)){query="?link=";}
break;case"VSE":if(url.match(/vse/i)){query="?dist=";}
break;case"BC":if(url.match(/bigcharts/i)){query="?dist=";}
break;case"MWC":if(url.match(/community/i)){query="?dist=";}
break;case"MW":if(url.match(/marketwatch/i)&&!url.match(/vse/i)&&!url.match(/bigcharts/i)&&!url.match(/community/i)){query="?dist=";}
break;}
return url+query+"DNH_"+site;},updateBuildMODLink:function(url){return url+"?MOD=DNH_"+hat.thisSite();},updateShowHat:function(){var hat_div=document.getElementById("hat_div");if(hat_div){hat_div.className+=" hat_visible";}},update:function(){try{var cookie=document.cookie;var wsjregion;var regionindex=cookie.indexOf("wsjregion");var WSJRenoApp=true;var regioncookie;if(regionindex!=-1){var nonrenoHeader=dojo.getObject("dj.module.header");if(nonrenoHeader||(typeof window.currentRegion=='undefined')){regioncookie=dj.util.Region.getViewByRegion();if(regioncookie!="na,us"){wsjregion=regioncookie;}}else{WSJRenoApp=false;if(currentRegion!==''){regioncookie=currentRegion;if(regioncookie!="na,us"){wsjregion=regioncookie;}}else{regioncookie=GetCookie("wsjregion");if(regioncookie.indexOf("reset")!=-1){currentRegion=regioncookie.substring(0,regioncookie.indexOf("reset")-1);}else{currentRegion=regioncookie;}
if(currentRegion!="na,us"){wsjregion=currentRegion;}}}}
if((typeof window.overrideWSJRenoApp)!=='undefined'){WSJRenoApp=false;}
if(!wsjregion){if(!WSJRenoApp){hat.updateChangeTab(1,"","httpdisabled://online.wsj.com/home","WSJ");hat.updateChangeTab(2,"","httpdisabled://www.marketwatch.com/","MW");hat.updateChangeTab(3,"","httpdisabled://online.barrons.com/home","BOL");hat.updateChangeTab(4,"","httpdisabled://allthingsd.com/","ATD");hat.updateChangeTab(6,"","httpdisabled://www.fins.com/Finance-Jobs","FINS",0,"Finance & Accounting Jobs");hat.updateChangeTab(7,"","httpdisabled://www.smartmoney.com","SM");}
hat.updateChangeMoreItem(1,"BigCharts","httpdisabled://bigcharts.marketwatch.com/","BC");hat.updateChangeMoreItem(2,"Virtual Stock Exchange","httpdisabled://vse.marketwatch.com/Game/Homepage.aspx","VSE");hat.updateChangeMoreItem(3,"WSJ Asia","httpdisabled://asia.wsj.com/","ASIA");hat.updateChangeMoreItem(4,"WSJ Europe","httpdisabled://europe.wsj.com/","EUR");hat.updateChangeMoreItem(5,"WSJ Portuguese","httpdisabled://online.wsj.com/portuguese","POR");hat.updateChangeMoreItem(6,"WSJ Spanish","httpdisabled://online.wsj.com/americas","SPA");hat.updateChangeMoreItem(7,"WSJ Chinese","httpdisabled://cn.wsj.com/gb/index.asp","CHI");hat.updateChangeMoreItem(8,"WSJ Japanese","httpdisabled://jp.wsj.com/","JPN");hat.updateChangeMoreItem(9,"WSJ Radio","httpdisabled://www.wsjradio.com","WRAD");hat.updateChangeMoreItem(10,"Financial News","httpdisabled://www.efinancialnews.com/","FNO");hat.updateChangeMoreItem(12,"WSJ Store","httpdisabled://www.wsjstore.com/","STOR","hat_drop_item hat_drop_item_lifestyle","store");hat.updateChangeMoreItem(13,"WSJ Wine","httpdisabled://www.wsjwine.com/ ","WINE","hat_drop_item hat_drop_item_lifestyle","wine");}else
if(wsjregion=="asia"||wsjregion=="asia,india"){if(!WSJRenoApp){hat.updateChangeTab(1,"","httpdisabled://online.wsj.com/home","WSJ");hat.updateChangeTab(2,"","httpdisabled://cn.wsj.com/gb/index.asp","CHI","hat_tabchi");hat.updateChangeTab(3,"","httpdisabled://jp.wsj.com/","JPN","hat_tabjp");hat.updateChangeTab(4,"","httpdisabled://www.marketwatch.com/","MW","hat_tab2");hat.updateChangeTab(6,"","httpdisabled://allthingsd.com/","ATD","hat_tab4");}
hat.updateChangeMoreItem(1,"SmartMoney.com","httpdisabled://www.smartmoney.com/","SM");hat.updateChangeMoreItem(2,"BigCharts","httpdisabled://bigcharts.marketwatch.com/","BC");hat.updateChangeMoreItem(3,"Virtual Stock Exchange","httpdisabled://vse.marketwatch.com/Game/Homepage.aspx","VSE");hat.updateChangeMoreItem(4,"Barron's","httpdisabled://online.barrons.com/home","BOL");hat.updateChangeMoreItem(5,"Financial News","httpdisabled://www.efinancialnews.com/","FNO");hat.updateChangeMoreItem(6,"WSJ Portuguese","httpdisabled://online.wsj.com/portuguese","POR");hat.updateChangeMoreItem(7,"WSJ Spanish","httpdisabled://online.wsj.com/americas","SPA");}else if(wsjregion=="europe"){if(!WSJRenoApp){hat.updateChangeTab(1,"","httpdisabled://online.wsj.com/home","WSJ");hat.updateChangeTab(2,"","httpdisabled://www.marketwatch.com/","MW");hat.updateChangeTab(3,"","httpdisabled://online.barrons.com/home","BOL");hat.updateChangeTab(4,"","httpdisabled://www.efinancialnews.com/","FNO","hat_tabfno");}
hat.updateChangeMoreItem(1,"SmartMoney.com","httpdisabled://www.smartmoney.com/","SM");hat.updateChangeMoreItem(2,"BigCharts","httpdisabled://bigcharts.marketwatch.com/","BC");hat.updateChangeMoreItem(3,"All Things D","httpdisabled://allthingsd.com/","ATD");hat.updateChangeMoreItem(4,"Virtual Stock Exchange","httpdisabled://vse.marketwatch.com/Game/Homepage.aspx","VSE");hat.updateChangeMoreItem(5,"WSJ India","httpdisabled://india.wsj.com","IND");hat.updateChangeMoreItem(6,"WSJ Portuguese","httpdisabled://online.wsj.com/portuguese","POR");hat.updateChangeMoreItem(7,"WSJ Spanish","httpdisabled://online.wsj.com/americas","SPA");hat.updateChangeMoreItem(8,"WSJ Chinese","httpdisabled://cn.wsj.com/gb/index.asp","CHI");hat.updateChangeMoreItem(9,"WSJ Japanese","httpdisabled://jp.wsj.com/","JPN");}
hat.updateShowHat();}catch(ex){console.error("hat.update: "+ex);}},hatMaxInitPolling:200,init:function(){try{var el=document.getElementById("hat_div");if(el&&hat&&(typeof hat.update==="function")){hat.update();}else{hat.hatMaxInitPolling--;if(hat.hatMaxInitPolling>0){setTimeout(hat.init,50);}}}catch(ex){console.error("hat.init: "+ex);}}};hat.init();dojo.provide("dj.widget.networkHat.global_autocomplete");dojo.require("dj.widget.networkHat.infocomplete");dojo.require("yui.yui-2.5.2");if((typeof window.nSP)=='undefined'||nSP==null){var baseDomain='http://'+document.domain;}else{var baseDomain=nSP;}
InfoCompleteConfig=function(I,C,B){this.count=8;this.delay=0.05;this.SCkey='88DF4730C6A6550285F22ED26514254A16E53C6A8725A61E0F'+'11CFE5384904E7E6E29DBAC369DCB18FCDF8715405601FA73B'+'9FE9CBB5D7B0DBBC636B2F74DE9D6724596AEA605596E1CFE1'+'55A5F14A962956795C2DF7D2680FE0712A193D9C0692EB8865';this.allowcountries='';this.allowexchanges='';this.allowsymboltypes='';this.inputId=I||'';this.containerId=C||'';this.buttonId=B||'';this.sections=[];this.initSymbol=function(F){this.sections[this.sections.length]={type:'symbol',dataSource:{server:'/api/djSymbolComplete/GetSymbolsJSON.ashx',schema:["Results","Symbol","Name","CountryCode","Exchange","DjUrl"],responseType:YAHOO.widget.DS_XHR.TYPE_JSON,scriptQueryAppend:'count='+this.count+'&license='+this.SCkey+'&allowcountries='+this.allowcountries+'&allowexchanges='+this.allowexchanges+'&allowtypes='+this.allowsymboltypes+'&deprecateexchange=PINKSH,NNOTC,NASDBB'},formatFunc:F,subHeader:null};return this;};this.initKeyword=function(F){this.sections[this.sections.length]={type:'keyword',dataSource:{server:'/api/djKeywordcomplete/GetKeywordsJSON.ashx',schema:["Results","Word","Rank"],responseType:YAHOO.widget.DS_XHR.TYPE_JSON,scriptQueryAppend:'count='+this.count+'&license='+this.SCkey},formatFunc:F,subHeader:'<div class="subHeading">Choose a topic to search news:</div>'};return this;};};function initInfoComplete(C,O)
{var infoCompleteObj=O||window.InfoComplete;if(!infoCompleteObj){return;}
var config=C||new InfoCompleteConfig(searchBoxID,resultContainerID,searchGoButtonID).initSymbol(formatSymbolCompleteResult).initKeyword(formatKeywordCompleteResult);infoCompleteObj.Setup(config);if((typeof(infoCompleteObj.autoComplete)=='undefined')||(infoCompleteObj.autoComplete==null))
{var inputBox=YAHOO.util.Dom.get(config.inputId);var goButton=YAHOO.util.Dom.get(config.buttonId);inputBox.setAttribute('onchange','');YAHOO.util.Event.addListener(goButton,'click',submitSymbolOrSearch);var listenEvent='keypress';if(YAHOO.util.Event.isIE)
{listenEvent='keydown';}
YAHOO.util.Event.addListener(inputBox,listenEvent,function(e){if(e.keyCode==13)
{submitSymbolOrSearch(e);}
else
{window.gotSymbolReply=false;}});}
else
{if(window.JSON&&window.JSON.deserialize)
{window.JSON.parse=window.JSON.deserialize;}
var inputBox=YAHOO.util.Dom.get(config.inputId);var goButton=YAHOO.util.Dom.get(config.buttonId);infoCompleteObj.autoComplete.setHeader('');infoCompleteObj.autoComplete.setFooter('');for(var i=0,maxi=config.sections.length;i<maxi;i++){if(typeof config.sections[i].subHeader!='undefined'&&config.sections[i].subHeader!=null){infoCompleteObj.autoComplete.setSubHeader(config.sections[i].subHeader,i);}}
infoCompleteObj.autoComplete.dataReturnEvent.subscribe(updateSearchTerm,this);inputBox.setAttribute('onchange','');infoCompleteObj.autoComplete.itemSelectEvent.subscribe(function(acObj,liElement,dat){if(!dojo.hasClass(inputBox,"acExactMatch")){dojo.addClass(inputBox,"acExactMatch");}},this);dojo.connect(inputBox,"onkeypress",null,function(ev){if(ev){var el;if(window.event){el=window.event.srcElement;}else{el=ev.currentTarget;}
if(ev.keyCode!==13){dojo.removeClass(el,"acExactMatch");}
matchedSymbolCompInfo=[];}});infoCompleteObj.autoComplete.itemSelectEvent.subscribe(submitSymbolOrSearch,infoCompleteObj);YAHOO.util.Event.addListener(goButton,'click',function(e){submitSymbolOrSearch(e,null,infoCompleteObj);});var listenEvent='keypress';if(YAHOO.util.Event.isIE)
{listenEvent='keydown';}
YAHOO.util.Event.addListener(inputBox,listenEvent,function(e){if(e.keyCode==13)
{submitSymbolOrSearch(e,null,infoCompleteObj);}
else
{window.gotSymbolReply=false;}});}}
function updateSearchTerm()
{window.gotSymbolReply=true;var searchTerm=YAHOO.util.Dom.get('symbolCompleteSearchTerm');if(searchTerm){searchTerm.innerHTML=YAHOO.util.Dom.get(searchBoxID).value;}}
var submittedSymbolOrSearch=false;function submitSymbolOrSearch(e,args,icObj)
{var inputId=icObj.autoComplete._oTextbox.id;if((typeof(icObj.autoComplete)=='undefined')||(icObj.autoComplete==null))
{YAHOO.util.Event.stopEvent(e);if(submittedSymbolOrSearch){return;}
var searchBox=YAHOO.util.Dom.get(inputId);checkUnUsed(searchBox);if(validateQuoteSearchBox(searchBox))
{submittedSymbolOrSearch=true;var isOverride=isSearchOverride(searchBox.value);if(isOverride)
{doKeyWordSearch(searchBox.value);}
else if(isIndex(searchBox.value,inputId))
{if(matchedSymbolCompInfo&&matchedSymbolCompInfo[4]){var djUrl=matchedSymbolCompInfo[4];window.location=djUrl;}}
else if((!window.gotSymbolReply&&searchBox.value.length<=5&&!isOverride)||isQuoteInput(searchBox.value,icObj))
{if((searchBox.value.length==5)&&!isMutualFund(searchBox.value))
{doKeyWordSearch(searchBox.value);}
else
{if(args&&args[2]&&args[2][4]){doViewQuote(searchBox.value,args[2][4]);}else{doViewQuote(searchBox.value);}}}
else
{doKeyWordSearch(searchBox.value);}}}
else
{YAHOO.util.Event.stopEvent(e);if(submittedSymbolOrSearch){return;}
var searchBox=YAHOO.util.Dom.get(inputId);checkUnUsed(searchBox);var select=false;if(icObj.autoComplete._bItemSelected||(e&&e=='itemSelect')){select=true;}
var index=-1;if(args&&args[1]){index=args[1]._nDataSourceIndex;}
if(validateQuoteSearchBox(searchBox))
{submittedSymbolOrSearch=true;var isOverride=isSearchOverride(searchBox.value);if(index==icObj.symbol)
{if(args&&args[2]&&args[2][4]){doViewQuote(searchBox.value,args[2][4]);}else{doViewQuote(searchBox.value);}}
else if(index==icObj.keyword||isOverride)
{doKeyWordSearch(args?args[2][0].toLowerCase():searchBox.value);}
else if(isIndex(searchBox.value,inputId))
{if(matchedSymbolCompInfo&&matchedSymbolCompInfo[4]){var djUrl=matchedSymbolCompInfo[4];window.location=djUrl;}}
else if((!window.gotSymbolReply&&searchBox.value.length<=5&&!isOverride)||(select&&index==icObj.symbol)||isQuoteInput(searchBox.value,icObj))
{if((searchBox.value.length==5)&&!isMutualFund(searchBox.value))
{doKeyWordSearch(searchBox.value);}
else
{if(args&&args[2]&&args[2][4]){doViewQuote(searchBox.value,args[2][4]);}else{doViewQuote(searchBox.value);}}}
else
{doKeyWordSearch(searchBox.value);}}}}
function isMutualFund(term)
{term=term.replace(/^\s+|\s+$/g,"").toUpperCase();var match=term.match(/[X|Y]$/);return match!=null&&match.length>0&&match[0].length>0;}
function isIndex(term,inputId)
{if(dojo.hasClass(inputId,"acExactMatch")){if(matchedSymbolCompInfo&&matchedSymbolCompInfo[0]&&matchedSymbolCompInfo[3]){var symbolExchange=matchedSymbolCompInfo[0];var symbol=symbolExchange;if(symbolExchange.indexOf("(")!==-1){symbol=symbolExchange.substring(0,symbolExchange.indexOf("("));}
if(term.toUpperCase()===symbol){var exchange=matchedSymbolCompInfo[3];return exchange==="INDEXES";}}}
return false;}
function isSearchOverrideold(term)
{term=term.replace(/^\s+|\s+$/g,"").toUpperCase();term=term.replace(/,+/gi,"");var match=term.match(/^PUTIN$|^OBAMA$|^CHINA$|^FBI$|^CIA$|^FDA$/);return match!=null&&match.length>0&&match[0].length>0;}
function isSearchOverride(term)
{var match=false;term=term.replace(/^\s+|\s+$/g,"").toUpperCase();term=term.replace(/,+/gi,"");if((typeof window.keywordException)!='undefined'&&keywordException!=null&&keywordException.length>0)
{var len=keywordException.length;for(var i=0;i<len;i++){var word=keywordException[i];word=word.replace(/^\s+|\s+$/g,"").toUpperCase();if(word==term)
{match=true;}}}
return match;}
function doExchangeCountryMap(exchange)
{var hashExchange=new Object();hashExchange["US"]="";hashExchange["SAO PAULO"]="Brazil";hashExchange["TOR"]="Canada";hashExchange["CSEC"]="Venezuela";hashExchange["ASX"]="Australia";hashExchange["SHSE"]="China Shanghai";hashExchange["SSE"]="China Shenzhen";hashExchange["HKSE"]="Hong Kong";hashExchange["TSE"]="Japan";hashExchange["KLSE"]="Malaysia";hashExchange["NZSE"]="New Zealand";hashExchange["SES"]="Singapore";hashExchange["TWSE"]="Taiwan";hashExchange["BRUX"]="Belgium";hashExchange["COPN"]="Denmark";hashExchange["TALLINN"]="Estonia";hashExchange["HELS"]="Finland";hashExchange["PARB"]="France";hashExchange["FRNK"]="German Floor";hashExchange["XETRA"]="German Xetra";hashExchange["REYKJAVIK"]="Iceland";hashExchange["DUBLIN"]="Ireland";hashExchange["MILAN"]="Italy";hashExchange["RIGA"]="Latvia";hashExchange["LITHUANIA"]="Lithuania";hashExchange["AMS"]="Netherlands";hashExchange["OSLO"]="Norway";hashExchange["SIBE"]="Spain";hashExchange["STKM"]="Sweden";hashExchange["ZSE"]="Switzerland";hashExchange["LONDON"]="U.K.";hashExchange["VTX"]="virt-x";hashExchange["PINKSH"]="Pink Sheets";hashExchange["NNOTC"]="Other OTC";hashExchange["NASDBB"]="OTC BB";var country=hashExchange[exchange];return country;}
function doExchangeTypeMap(exchange)
{var hashExchange=new Object();hashExchange["US"]="usstock usfund";hashExchange["SAO PAULO"]="brsp";hashExchange["TOR"]="tse";hashExchange["CSEC"]="vecsec";hashExchange["ASX"]="auasx";hashExchange["SHSE"]="shse";hashExchange["SSE"]="sse";hashExchange["HKSE"]="hkse";hashExchange["TSE"]="jptse";hashExchange["KLSE"]="myklse";hashExchange["NZSE"]="nzse";hashExchange["SES"]="sgses";hashExchange["TWSE"]="twtwse";hashExchange["BRUX"]="bebrux";hashExchange["COPN"]="copn";hashExchange["TALLINN"]="tallinn";hashExchange["HELS"]="hels";hashExchange["PARB"]="frparb";hashExchange["FRNK"]="defrnk";hashExchange["XETRA"]="dexetra";hashExchange["REYKJAVIK"]="reykjavik";hashExchange["DUBLIN"]="iedublin";hashExchange["MILAN"]="itmilan";hashExchange["RIGA"]="riga";hashExchange["LITHUANIA"]="lithuania";hashExchange["AMS"]="nlams";hashExchange["OSLO"]="nooslo";hashExchange["SIBE"]="escats";hashExchange["STKM"]="sestkm";hashExchange["ZSE"]="chzse";hashExchange["LONDON"]="lse";hashExchange["VTX"]="virtx";hashExchange["PINKSH"]="pinksh";hashExchange["NNOTC"]="nnotc";hashExchange["NASDBB"]="nasdbb";var type=hashExchange[exchange];return type;}
function doViewQuote(symbol,djUrl)
{symbol=symbol.replace(/^\s+|\s+$/g,"");symbol=symbol.replace(/,+/gi,",");symbol=symbol.replace(/,$|\.,$/,"");if(symbol.match(","))
{var symbolslist=symbol.split(",");var querySymbol='';var exchange='';for(i=0;i<symbolslist.length;i++)
{tempSymb=symbolslist[i];tempEx='';if(symbolslist[i].indexOf('(')>0)
{tempSymb=symbolslist[i].substring(0,symbolslist[i].indexOf('('));tempEx=symbolslist[i].substring(symbolslist[i].indexOf('(')+1,symbolslist[i].length-1);}
else
{tempEx='US';}
tempSymb=tempSymb.replace(/^\s+|\s+$/g,"");querySymbol=querySymbol+tempSymb+",";exchange=exchange+doExchangeTypeMap(tempEx)+",";}
querySymbol=querySymbol.substring(0,querySymbol.length-1);exchange=exchange.substring(0,exchange.length-1);querySymbol=querySymbol.replace(/\+/g,"%2B");var quoteURL=baseDomain+((loggedIn)?'':'/public')+'/quotes/main.html?symbol='+querySymbol+'&type='+exchange+'&mod=DNH_S';window.location=quoteURL;}
else
{var exchange='US';var querySymbol=symbol;if(symbol.indexOf('(')>0)
{querySymbol=symbol.substring(0,symbol.indexOf('('));exchange=symbol.substring(symbol.indexOf('(')+1,symbol.length-1);}
querySymbol=querySymbol.replace("+","%2B");var quoteURL=baseDomain+((loggedIn)?'':'/public')+'/quotes/main.html?symbol='+querySymbol+'&type='+doExchangeTypeMap(exchange)+'&mod=DNH_S';if(exchange==="INDEXES"){quoteURL=djUrl;}
window.location=quoteURL;}}
function doKeyWordSearch(query)
{query=query.replace(/^\s+|\s+$/g,"").replace(/,$|\.,$/,"");var searchURL=baseDomain+'/search/term.html?KEYWORDS='+escape(query)+'&mod=DNH_S';window.location=searchURL;}
function doRedirectMDC(query)
{query=query.replace(/^\s+|\s+$/g,"").replace(/,$|\.,$/,"");query=query.toLowerCase();baseDomain="httpdisabled://online.wsj.com";var isInternational=false;var match=query.match(/^ftse$|^dax$|^cac 40$|^jsx$/);if(match!=null&&match.length>0&&match[0].length>0)
{isInternational=true;}
query=query.replace("util","djua");query=query.replace("tran","djta");query=query.replace("gspc","spx");query=query.replace("compq","comp");query=query.replace("nysi","nya");query=query.replace("amsi","xax");query=query.replace("sox","soxx");query=query.replace("ftse","uk:ftse100");query=query.replace("dax","dx:1876534");query=query.replace("cac 40","fr:px1");query=query.replace("jsx","1803554");var mdcURL=baseDomain+'/mdc/public/npage/2_3051.html?symb='+query+((isInternational)?'&page=intl':'');window.location=mdcURL+'&mod=DNH_S';}
function addMoreResultsLink(q,iIndex,acObj)
{var lookupURL=baseDomain+((loggedIn)?'':'/public')+'/quotes/main.html?name='+q;var headerText="";if(q.length>1)
{headerText="<div class=\"subHeading\">Choose a symbol match to get quote:</div><div class=\"showAllLink\"><a href='"+lookupURL+"'>See all symbol results for \""+q.toUpperCase()+"\"</a></div>";}
else
{headerText="<div class=\"subHeading\">Choose a symbol match to get quote:</div>";}
acObj.setSubHeader(headerText,iIndex);}
function formatKeywordCompleteResult(aResultItem,Query,iIndex)
{var SCRegExp=new RegExp("\\b("+Query+")(.*)\\b","i");var result=aResultItem[0].toLowerCase();aResultItem[0]=result;if(result.length>80)
{result=result.substring(0,80);}
if(result.match(SCRegExp)){result=result.replace(SCRegExp,'<span class="scResultTerm">$1</span>$2');}
var aMarkup='<span class="keywordResult">'+result+'</span>';return aMarkup;}
function formatSymbolCompleteResult(aResultItem,Query,iIndex,acObj)
{addMoreResultsLink(Query,iIndex,acObj);var SelectionValue=new param;var CompanyName=aResultItem[1];CompanyName=CompanyName.toLowerCase();var Exchange=aResultItem[3];var CountryCode=aResultItem[2].toUpperCase();var djUrl=aResultItem[4];Symbol=aResultItem[0];if(Symbol.indexOf('(')>0)
{Symbol=Symbol.substring(0,Symbol.indexOf('('));}
if(CountryCode!="US")
{aResultItem[0]=Symbol+"("+Exchange+")";}
if(Exchange=="NNOTC"||Exchange=="NASDBB"||Exchange=="PINKSH")
{if(CountryCode=="US")
{aResultItem[0]=Symbol+"("+Exchange+")";}}
var CountryName=doExchangeCountryMap(Exchange);var SCRegExp=new RegExp("\\b("+Query+")(.*)\\b","i");var tickerDisplay=Symbol;if(Symbol.match(SCRegExp)){tickerDisplay=tickerDisplay.replace(SCRegExp,"<span class=scResultTerm>$1</span>$2");}else{CompanyName=CompanyName.replace(SCRegExp,"<span class=scResultTerm>$1</span>$2");}
var aMarkup=["<table class=scResultTable><tr><td class=symbolCompleteCol1>",tickerDisplay,"</td><td class=symbolCompleteCol2>",CompanyName,"</td><td class=symbolCompleteCol3>",CountryName,"</td></tr></table>"];if(Symbol.toUpperCase()==acObj._oTextbox.value.toUpperCase()){matchedSymbolCompInfo=aResultItem;if(!dojo.hasClass(acObj._oTextbox,"acExactMatch")){dojo.addClass(acObj._oTextbox,"acExactMatch");}}
return(aMarkup.join(""));}
function validateQuoteSearchBox(el)
{var isTextEntered=false;if(el.value==null||el.value.length==0)
{alert("Please Enter a Symbol or Keyword.");}
else
{isTextEntered=true;}
return isTextEntered;}
function isQuoteInput(textValue,icObj)
{if(!icObj||!icObj.autoComplete){return false;}else if(icObj.autoComplete._bItemSelected){return true;}else{return icObj.isSymbolMatch();}}
function showHideCRDrpdwn(elem)
{if(document.all){var resultsContentEl=document.getElementById("resultsContentDiv");var crDrpdwnEl=document.getElementById("wsjCRSelectDrpdwn");if(elem!="show"){if(crDrpdwnEl){crDrpdwnEl.style.display="none";}}else{if(crDrpdwnEl){crDrpdwnEl.style.display="block";}}}}
function setFocused(elem)
{var resolved=YAHOO.util.Dom.get(elem);window.formElementWithFocus=resolved;}
function setUnUsed(searchField){var defaultValue;switch(searchField.name)
{case"Symbol":defaultValue="Symbol(s)";break;case"KeywordSearch":defaultValue="Keyword(s)";break;}
if(searchField.value==defaultValue)
{searchField.className=searchField.className+" unUsed";}}
function checkUnUsed(searchField){if(searchField.className.indexOf("unUsed")>=0)
{searchField.value="";}
return true;}
function searchFieldOnFocus(searchField)
{var index=searchField.className.indexOf("unUsed");if(index>=0)
{searchField.value="";if(index==0)
{if(searchField.className.match("unUsed "))
{searchField.className=searchField.className.replace("unUsed ","");}
else
{searchField.className=searchField.className.replace("unUsed","");}}
else
{searchField.className=searchField.className.replace(" unUsed","");}}}
function clearSearchFieldFocus(searchFieldID)
{var searchField=document.getElementById(searchFieldID);if(typeof(searchField)!='undefined')
{searchField.blur();searchField.className="unUsed";}}
dojo.provide("dj.widget.networkHat.AutoComplete");dojo.require("dj.widget.networkHat.hat");dojo.require("dj.widget.networkHat.infocomplete");dojo.require("dj.lang");dojo.getObject("dj.context.networkHat",true);(function(){var _dwn=dj.widget.networkHat;(_dwn.AutoComplete=function(){this.d=document;this.cdnDomain=dj.context.core.cdnPrefix;this.uP="";if(typeof uP!='undefined'){this.uP=uP;}
var dt=new Date();var dtStamp=""+dt.getFullYear()+dt.getMonth()+dt.getDay();if(this.d.location.host.indexOf('s.dev')!=-1||this.d.location.host.indexOf('idev')!=-1){this.jScript=this.uP+"/djscript/j_networkHat-"+dtStamp+".js";}else{this.jScript=this.cdnDomain+"/djscript/j_networkHat-"+dtStamp+".js";}
var fw=this.d.getElementsByTagName("div")[0];var loggedIn=(fw.className.indexOf("subType-subscribed")!==-1);var searchBoxID='hat_input_auto';this.inputDefaultText="News, Quotes, Companies, Videos";var oHat=dojo.byId("hat_div");this.oHatInput=dojo.byId("hat_input_auto");var oHatSelect=dojo.query(".hat_select",oHat);var oHatSelectItems=dojo.query(".hat_drop_item",oHat);var oHatTabs=dojo.query(".hat_tab",oHat);var oHatMenu=dojo.byId("hat_more_menu");if(dojo.isIE&&(this.d.domain.indexOf('ds.sat.wsj.com')!=-1||this.d.domain.indexOf('ds.wsj.com')!=-1)){dj.util.Url.addStylesheet("httpdisabled://s.wsj.net/css/hatIEPortfolio.css");}
dojo.style(oHat,{"width":"989px","height":"35px","position":"relative","zIndex":999999});dojo.style(oHatMenu,{width:"155px"});oHatTabs.forEach(function(node,index,nodeList){if(!dojo.hasClass(node,"hat_select")){dojo.connect(node,"onmouseover",null,function(ev){if(typeof hat!=="undefined"){hat.tabover(this);}});dojo.connect(node,"onmouseout",null,function(ev){if(typeof hat!=="undefined"){hat.tabout(this);}});}});oHatSelect.connect("onmouseover",null,function(ev){if(typeof hat!=="undefined"){hat.moremenu();}});oHatSelect.connect("onmouseout",null,function(ev){if(typeof hat!=="undefined"){hat.moremenuhide();}});oHatSelectItems.connect("onmouseover",null,function(ev){if(typeof hat!=="undefined"){hat.menuover(this);}});oHatSelectItems.connect("onmouseout",null,function(ev){if(typeof hat!=="undefined"){hat.menuout(this);}});this.onfocusLoad=dojo.connect(this.oHatInput,"onfocus",this,this.onHatLoad);this.onmouseoverLoad=dojo.connect(this.oHatInput,"onmouseover",this,this.onHatLoad);this.onclickClear=dojo.connect(this.oHatInput,"onclick",this,this.clearField);this.onkeydownClear=dojo.connect(this.oHatInput,"onkeydown",this,this.clearField);if(this.oHatInput.value!==""&&this.oHatInput.value!=this.inputDefaultText||dj.context.networkHat.jnetworkHatJsLoaded){this.onHatLoad();}
this.setFieldDefault();}).prototype={setFieldDefault:function(){if(this.oHatInput.value===""){this.oHatInput.value=this.inputDefaultText;dojo.addClass(this.oHatInput,"unUsed");}},clearField:function(){this.stopObservingClick();var unUsed=dojo.hasClass(this.oHatInput,"unUsed");if(unUsed){this.oHatInput.value="";}
dojo.removeClass(this.oHatInput,"unUsed");},stopObservingClick:function(){dojo.disconnect(this.onclickClear);dojo.disconnect(this.onkeydownClear);},onHatLoad:function(){dojo.disconnect(this.onfocusLoad);dojo.disconnect(this.onmouseoverLoad);if(dj.context.networkHat.jnetworkHatJsLoaded){this.initInfoComplete();return;}
var hds=this.d.getElementsByTagName('head');var hd;if(!hds){hd=new Element('head');this.d.getElementsByTagName('body')[0].appendChild(hd);}else{hd=hds[0];}
this.jsNode=this.loaddisabledAutoCompleteScript(this.jScript);},loaddisabledAutoCompleteScript:function(jScript){var jsNode=this.d.createElement("script");jsNode.type="text/javascript";jsNode.src=jScript;if(this.d.getElementsByTagName("head").length===0){var headNode=this.d.createElement("head");this.d.getElementsByTagName("html")[0].appendChild(headNode);}
this.d.getElementsByTagName("head")[0].appendChild(jsNode);return jsNode;},initInfoComplete:function(){if(dojo.isIE&&(this.d.domain.indexOf('ds.sat.wsj.com')!=-1||this.d.domain.indexOf('ds.wsj.com')!=-1)){dj.util.Url.addStylesheet("httpdisabled://s.wsj.net/css/hatIEPortfolio.css");}
initInfoComplete();this.stopObservingClick();dojo.connect(this.oHatInput,"onfocus",null,function(ev){this.style.backgroundImage="url('http://s.wsj.net/img/b.gif')";searchFieldOnFocus(this);setFocused(this);});dojo.connect(this.oHatInput,"onkeypress",null,function(){showHideCRDrpdwn('hide');});dojo.connect(this.oHatInput,"onblur",null,function(){showHideCRDrpdwn('show');});var textValue=this.oHatInput.value;if(textValue&&textValue!=this.inputDefaultText){InfoComplete.autoComplete.sendQuery(textValue);}}};}());dojo.provide("dj.module.networkHat");dojo.require("dj.widget.networkHat.infocomplete");dojo.require("dj.widget.networkHat.global_autocomplete");dojo.require("dj.widget.networkHat.AutoComplete");dojo.require("dj.widget.networkHat.hat");var fw=dojo.query("div.fullwide")[0];var loggedIn=dojo.hasClass(fw,"subType-subscribed");var searchBoxID='hat_input_auto';var resultContainerID='symbolCompleteResults';var searchGoButtonID='SearchQuoteGoButton';var oHat=dojo.byId("hat_div");var oHatMenu=dojo.byId("hat_more_menu");dojo.getObject("dj.context",true);dojo.getObject("dj.module",true);if(dj.module.networkHatLoader){dj.module.networkHatLoader.initInfoComplete();}
dojo.getObject("dj.context.networkHat",true);dj.context.networkHat.jnetworkHatJsLoaded=true;
dojo.provide("dj.module.carouselSection");dojo.require("dj.widget.panels.virtual.Carousel");dojo.addOnLoad(function(){dj.module.carouselSection=dj.widget.panels.PanelsFactory.create("carouselSection",{core:{panelGroup:".newsItem",panel:"li",paginationContainer:".pagination",viewport:2},carousel:{prevButton:".nav-inline .prev",nextButton:".nav-inline .next"},rotator:{rotateTime:10}});});dojo.provide("dj.module.chartbeat");dojo.require("dj.util.io");dj.module.chartbeat={init:function()
{var canonicalUrl="";var linkArr=document.getElementsByTagName("link");if(linkArr!='undefined'&&linkArr.length>0){for(count=0;count<linkArr.length;count++){if(linkArr[count].rel==='canonical'){canonicalUrl=linkArr[count].href;break;}}}
var domainPrefix=dj.context.core.urlPrefix;var index=canonicalUrl.indexOf(".com")+4;var canonicalSuffix=canonicalUrl.substring(index);var http="httpdisabled://";var domainName=domainPrefix.substring(http.length);window._sf_async_config={uid:8900,domain:domainName,path:canonicalSuffix,sections:s.prop2};window._sf_endpt=(new Date()).getTime();dj.util.io.insertScriptAsync((("httpdisabledsdisabled:"==document.location.protocol)?"httpdisabledsdisabled://s3.amazonaws.com/":"httpdisabled://")+"static.chartbeat.com/js/chartbeat.js");}};dojo.provide("dj.module.mostPopularTab");dojo.require("dj.widget.panels.virtual.Tabs");dj.module.mostPopularTab={init:function(coreOptions){var _tabIds=["mostRead","mostEmailed","mostPopularVideo","mostCommented","mostSearched"];var pnlConf={core:{panelPrefix:"mostPopularTab_panel_",panels:_tabIds},tabs:{tabPrefix:"mostPopularTab_tab_",tabOnStyle:"selectedTab",tabOffStyle:"deselected"}};if(coreOptions){pnlConf.core=dojo.mixin(pnlConf.core,coreOptions);}
this.pnl=dj.widget.panels.PanelsFactory.create("mostPopularTab",pnlConf);var that=this;var pnlRssConf={core:{panelPrefix:"mostPopularTab_rssPanel_",panels:_tabIds,controller:that.pnl}};if(coreOptions){pnlRssConf.core=dojo.mixin(pnlRssConf.core,coreOptions);}
this.pnlRss=dj.widget.panels.PanelsFactory.create("mostPopularTab",pnlRssConf);}};dojo.provide("dj.module.newsTicker");dojo.require("dj.widget.panels.virtual.Carousel");dj.module.newsTicker={init:function(config){if(typeof this.ticker=="object"){this.ticker.update();}else{this.ticker=this.createTicker(config);}},createTicker:function(config){var cfg=dojo.deepMixin({container:"newsTicker",assassinContainer:"topBanner",containerClass:"headlineSummary newsTicker"},config);var containerNode=dojo.byId(cfg.container);containerNode.className=cfg.containerClass;var ticker=dj.widget.panels.PanelsFactory.create(containerNode,{carousel:{type:"circular",prevButtonEnabledStyle:"",nextButtonEnabledStyle:""},rotator:{rotateTime:8}});return ticker;}};dojo.provide("dj.module.rssBlogTimes");dojo.require("dj.util.Element");dj.module.rssBlogTimes={init:function(getClasses){var timeStamps=dojo.query(getClasses);if(timeStamps.length===0){console.log("{dj.module.xslTimestamp} no timestamps found.");return;}
for(var i=0,timeStamp;timeStamp=timeStamps[i++];){timeStamp=dj.util.Element.cleanWhitespace(timeStamp);var dur=this.calculateDuration(dojo.trim(timeStamp.innerHTML));dojo.empty(timeStamp);timeStamp.innerHTML=dur;}},calculateDuration:function(getPubDate){var today=new Date();var newDate=new Date(getPubDate);var getTimeDIff=Math.ceil(today.getTime()-newDate.getTime());var one_min=1000*60;var getMins=Math.ceil(getTimeDIff/one_min);var getOutput='';if(getMins<1){getOutput="1 min ago";}else if(getMins<59){getOutput="6 mins ago";}else if(getMins>60&&getMins<240){var getHrs=newDate.getHours();var getAMPM="";if(getHrs<=12){getAMPM=" am";}else{getHrs=(getHrs-12);getAMPM=" pm";}
getOutput=newDate.getHours()+":"+newDate.getMinutes()+getAMPM;}
return(getOutput==='')?null:getOutput;}};dojo.provide("dj.module.assasinModule");dojo.require("dj.util.Element");dojo.require("dj.widget.video.Video");dojo.require("dj.widget.flash.Flash");dj.module.assasinModule={init:function(flashNamespace){if(typeof flashNamespace=='undefined'){flashNamespace='';}
var cnt=dojo.query('.viModule [id^=assasinMedia]');if(cnt===null){return;}
for(var index=0,length=cnt.length;index<length;++index){var t=cnt[index].className.split('::');if(t&&t[1]!=='undefined'){var source=t[0];var id=t[1];var caption=t[2];if(source===flashNamespace+'VIDEO'){this.videoPlayer=new dj.widget.video.Video(dj.util.Element.identify(cnt[index]),id,'','',caption);}
else if(source===flashNamespace+'FLASH'){this.flashPlayer=new dj.widget.flash.Flash(dj.util.Element.identify(cnt[index]),id,caption);}}}}};dojo.provide("dj.module.freeReg");dj.module.freeReg={init:function(){this.oAnyUserLoggedIn=false;var that=this;dj.util.User.isLoggedIn(function(isLoggedIn){if(isLoggedIn){that.oAnyUserLoggedIn=true;}});if(!that.oAnyUserLoggedIn){this.inlineReg=new dj.widget.panel.ModalPanel('register','register_module',voidModalPanelEvent:"click",closeModalPanelEvent:"blur",closeModalPanelButtonSelector:".closeFreereg",closeModalPanelEventForButtonSelector:"click"});this.oRegister_module=this.inlineReg.oModalContainer;this.inlineLogin=new dj.widget.panel.ModalPanel('login','login_module',voidModalPanelEvent:"click",closeModalPanelEvent:"blur",closeModalPanelButtonSelector:".closeLogin",closeModalPanelEventForButtonSelector:"click"});this.logindiv=this.inlineLogin.oModalContainer;this.ologin_form=dj.lang.byId('login_form');this.ologinMod=this.inlineLogin.oModalId;this.osublogin=dj.lang.byId('subscriberLogin');this.ofreereg=dj.lang.byId('freereg');this.oFree_reg=this.inlineReg.oModalId;this.oErrorCount=0;this.http_request=false;this.oRegFieldErrorMsgsValue="";this.oregFieldErrorMsg=dj.lang.byId('oregFieldErrorMsg');this.oFr_confirm=dj.lang.byId('fr_confirm');this.oFr_content=dj.lang.byId('fr_content');this.oFreeRegistration_form=dj.lang.byId('freeRegistration_form');this.oFreeregemailerrormsg=dj.lang.byId('freeregemailerrormsg');this.oFreeregusererrormsg=dj.lang.byId('freeregusererrormsg');this.oFreeRegServiceErrorMsg=dj.lang.byId('freeRegServiceErrorMsg');this.oFreeRegSubButton=dj.lang.byId('freeRegSubButton');this.oFreeRegEmail=dj.lang.byId('regemail');this.oFreeRegWhyReason=dj.lang.byId('whyreasons');this.ofreewhyregister=dj.lang.byId('ofreewhyregister');this.regErrorCode=['userName-exists','userName-required','userName-invalid','firstName-required','firstName-invalid','lastName-required','lastName-invalid','emailAddress-exists','emailAddress-required','emailAddress-invalid','password-required','password-invalid','passwordConfirmation-invalid','userName-unique','emailAddress-unique','passwordConfirmation-required'];this.regErrorValue=['Please enter your First Name.','Please enter your Last Name.','Please enter a valid email address.','Please create a Password.','Please confirm Password.','The email addresses do not match. Please re-enter both.','Passwords do not match.','Password must be 5-15 characters in length.','Confirm Password must be 5-15 characters in length.','','','Please Confirm Email.','First name contains invalid characters.','Last name contains invalid characters.'];this.regFieldName=['firstNameReg','lastNameReg','emailAddressReg','passwordReg','passwordConfirmationReg','emailAddressConfirmationReg','passwordConfirmationReg','passwordReg','passwordConfirmationReg','sendEmailsReg','jcommunityReg','emailAddressConfirmationReg','firstNameReg','lastNameReg','companySizeReg'];this.attachEvents();this.freeRegResetForm();}},attachEvents:function(){var textFields=dojo.query("input[type=text]",this.oFreeRegistration_form);var passfields=dojo.query("input[type=password]",this.oFreeRegistration_form);textFields.forEach(function(ipt){dojo.connect(ipt,"onfocus",this,function(ev){this.checkFreeRegFocus(ipt.name);});},this);textFields.forEach(function(ipt){dojo.connect(ipt,"onblur",this,function(ev){this.checkFreeRegFieldBlur(ipt.name);});},this);passfields.forEach(function(ipt){dojo.connect(ipt,"onfocus",this,function(ev){this.checkFreeRegFocus(ipt.name);});},this);passfields.forEach(function(ipt){dojo.connect(ipt,"onblur",this,function(ev){this.checkFreeRegFieldBlur(ipt.name);});},this);this.oimagefields=dojo.query("input[type=image]",this.oFreeRegistration_form);this.oimagefields.forEach(function(ipt){dojo.connect(ipt,"onclick",this,function(ev){this.submitregForm();});},this);this.okButtonClicked=dojo.query("input[class=okButton]",this.oFreeRegConfirm);this.okButtonClicked.forEach(function(ipt){dojo.connect(ipt,"onclick",this,function(ev){this.closeRegSuccessBlock();});},this);this.oFreewhyReasons=dojo.query("a[class=ofreewhyReasons]",this.oRegister_module);this.oFreewhyReasons.forEach(function(ipt){dojo.connect(ipt,"onclick",this,function(ev){this.oFreeRegWhyReason.style.display=(this.oFreeRegWhyReason.style.display=='block')?'none':'block';if(this.oFreeRegWhyReason.style.display==='block'){this.ofreewhyregister.className="why";}else{this.ofreewhyregister.className="whynot";}});});this.oFreeTermsConditions=dojo.query("a[class=ofreeTermsConditions]",this.oRegister_module);this.oFreeTermsConditions.forEach(function(ipt){dojo.connect(ipt,"onclick",this,function(ev){dj.util.voidWin('/public/page/subscriber_agreement.html','TermAndConditions',800,800,'scrollbars',1,300,100);});},this);this.oFreeEmailNewLetter=dojo.query("a[class=ofreeEmailNewLetter]",this.oRegister_module);this.oFreeEmailNewLetter.forEach(function(ipt){dojo.connect(ipt,"onclick",this,function(ev){dj.util.voidWin('/public/email','EmailNewLetterLink');});});this.oprivacyPolicy=dojo.query("a[class=oprivacyPolicy]",this.oRegister_module);this.oprivacyPolicy.forEach(function(ipt){dojo.connect(ipt,"onclick",this,function(ev){dj.util.voidWin('/public/page/privacy_policy.html','FreeRegPrivacyPolicy',800,800,'scrollbars',1,300,100);});},this);dojo.connect(this.ologinMod,'click',this,function(ev){dojo.stopEvent(ev);this.closeRegOtherBlock(2);this.ologin_form.reset();});},freeRegResetForm:function(){dojo.connect(this.oFree_reg,"onclick",this,function(ev){dojo.stopEvent(ev);this.closeRegOtherBlock(1);this.oFreeRegistration_form.reset();dj.util.Element.hide(this.oregFieldErrorMsg);this.ofreewhyregister.className="whynot";this.oRegFieldErrorMsgsValue="";this.oFreeRegSubButton.disabled=false;dj.util.Element.hide(this.oFreeregemailerrormsg);dj.util.Element.hide(this.oFreeRegServiceErrorMsg);dj.util.Element.hide(this.oFreeregusererrormsg);this.oFreeRegistration_form[this.regFieldName[0]].style.backgroundColor='#ffffff';this.oFreeRegistration_form[this.regFieldName[1]].style.backgroundColor='#ffffff';this.oFreeRegistration_form[this.regFieldName[2]].style.backgroundColor='#ffffff';this.oFreeRegistration_form[this.regFieldName[3]].style.backgroundColor='#ffffff';this.oFreeRegistration_form[this.regFieldName[4]].style.backgroundColor='#ffffff';this.oFreeRegistration_form[this.regFieldName[5]].style.backgroundColor='#ffffff';});},closeRegSuccessBlock:function(){this.oFreeRegEmail.innerHTML="";dj.util.Element.hide(this.oFr_confirm);dj.util.Element.show(this.oFr_content);dj.util.Element.hide(this.oRegister_module);this.oFreeRegSubButton.disabled=false;this.oFreeRegistration_form.reset();},closeRegOtherBlock:function(val){if(val===1){this.ofreereg.className="freereg";this.osublogin.className+=" login_hidden";dj.util.Element.hide(this.logindiv);dj.util.Element.show(this.oRegister_module);this.oFreeRegWhyReason.style.display='block';this.oFreeRegWhyReason.style.display='none';}
if(val===2){this.osublogin.className="login";this.ofreereg.className+=" freereg_hidden";dj.util.Element.show(this.logindiv);dj.util.Element.hide(this.oRegister_module);}},checkFreeRegFieldBlur:function(oregFieldname){this.ofieldName=this.oFreeRegistration_form[oregFieldname];this.ofieldValue=this.ofieldName.value;if(/^\s*$/.test(this.ofieldValue)){this.oErrorCount=1;this.oFreeRegSubButton.disabled=false;}else{this.ofieldName.style.color='#000000';this.ofieldName.style.backgroundColor='#ffffff';this.ofieldName.value=this.ofieldValue.strip();}},checkFreeRegBlur:function(oregFieldnumber){this.ofieldName=this.oFreeRegistration_form[this.regFieldName[oregFieldnumber]];this.ofieldValue=this.ofieldName.value;if(/^\s*$/.test(this.ofieldValue)){this.changeFieldValue(oregFieldnumber);this.oErrorCount=1;this.oFreeRegSubButton.disabled=false;}else{this.ofieldName.style.color='#000000';this.ofieldName.style.backgroundColor='#ffffff';this.ofieldName.value=this.ofieldValue.strip();}},checkFreeRegFocus:function(oregFieldname){this.ofieldName=this.oFreeRegistration_form[oregFieldname];this.ofieldName.style.color="#000000";this.ofieldName.style.backgroundColor="#ffffff";},checkFreeRegEmail:function(email){var invalidEmailChars=" ?!#$%&*()\"||<>=+;:][{}/\\";for(var count=0,len=invalidEmailChars.length;count<len;count++){var badChar=invalidEmailChars.charAt(count);if(email.indexOf(badChar,0)>-1){this.oErrorCount=1;this.changeFieldValue(2);this.oFreeRegSubButton.disabled=false;return;}}
this.lastAtSign=email.lastIndexOf("@");this.firstAtSign=email.indexOf("@");this.lastPeriod=email.lastIndexOf(".");if(!(this.firstAtSign>0&&email.length>=5&&email.length<=100&&this.firstAtSign===this.lastAtSign&&email.lastIndexOf("..")<0&&this.lastPeriod>=(this.firstAtSign+2)&&this.lastPeriod<=(email.length-3)&&email.charAt(this.firstAtSign+1)!==".")){this.changeFieldValue(2);this.oFreeRegSubButton.disabled=false;this.oErrorCount=1;return;}},compareFreeRegEmail:function(){this.oEmailfieldValue=this.oFreeRegistration_form[this.regFieldName[2]].value;this.oEmailfieldConfValue=this.oFreeRegistration_form[this.regFieldName[5]].value;if((this.oEmailfieldValue!=''&&this.oEmailfieldConfValue!='')&&(this.oEmailfieldValue!==this.oEmailfieldConfValue)){this.changeFieldValue(5);this.oFreeRegSubButton.disabled=false;this.oErrorCount=1;}},compareFreeRegPassword:function(){this.oPassfieldValue=this.oFreeRegistration_form[this.regFieldName[3]].value;this.oCPassfieldValue=this.oFreeRegistration_form[this.regFieldName[4]].value;if(this.oPassfieldValue!==this.oCPassfieldValue){this.changeFieldValue(6);this.oFreeRegSubButton.disabled=false;this.oErrorCount=1;}},changeFieldValue:function(oregFieldnumber){dj.util.Element.show(this.oregFieldErrorMsg);this.ofieldName=this.oFreeRegistration_form[this.regFieldName[oregFieldnumber]];this.oRegFieldErrorMsgsValue+=" "+this.regErrorValue[oregFieldnumber];this.ofieldName.style.color='#ff0000';this.ofieldName.style.backgroundColor='#fff28d';},responseErrorData:function(responseData){var that=this;var oshow=0;var profileErrors=responseData.profile.errors;var emailAddressVal=profileErrors.emailAddress;var userNameVal=profileErrors.userName;var firstNameVal=profileErrors.firstName;var lastNameVal=profileErrors.lastName;var passwordVal=profileErrors.password;var compasswordVal=profileErrors.passwordConfirmation;if(emailAddressVal!==null&&emailAddressVal!==undefined){if(this.regErrorCode[7]===emailAddressVal||this.regErrorCode[14]===emailAddressVal){dj.util.Element.show(this.oFreeregemailerrormsg);this.ofieldName=this.oFreeRegistration_form[this.regFieldName[2]];this.ofieldName.style.backgroundColor='#fff28d';}else{this.changeFieldValue(2);oshow=1;}}
if(userNameVal!==null&&userNameVal!==undefined){if(this.regErrorCode[0]===userNameVal||this.regErrorCode[13]===userNameVal){dj.util.Element.show(this.oFreeregusererrormsg);this.ofieldName=this.oFreeRegistration_form[this.regFieldName[5]];this.ofieldName.style.backgroundColor='#fff28d';}else{this.changeFieldValue(5);oshow=1;}}
if(firstNameVal!==null&&firstNameVal!==undefined){this.changeFieldValue(0);oshow=1;}
if(lastNameVal!==null&&lastNameVal!==undefined){this.changeFieldValue(1);oshow=1;}
if(passwordVal!==null&&passwordVal!==undefined){if(passwordVal===this.regErrorCode[11]){this.changeFieldValue(7);}else{this.changeFieldValue(3);}
oshow=1;}
if(compasswordVal!==null&&compasswordVal!==undefined){if(compasswordVal===this.regErrorCode[12]){this.changeFieldValue(8);}else{this.changeFieldValue(4);}
oshow=1;}
console.log("inside responseError data"+this.oRegFieldErrorMsgsValue);if(oshow===1){dj.util.Element.show(this.oregFieldErrorMsg);this.oregFieldErrorMsg.innerHTML="<p>"+this.oRegFieldErrorMsgsValue+"</p>";console.log("inside responseError show data"+this.oRegFieldErrorMsgsValue);}},freeRegRequest:function(){this.ofirstName=this.oFreeRegistration_form[this.regFieldName[0]].value;this.olastName=this.oFreeRegistration_form[this.regFieldName[1]].value;this.oemailName=this.oFreeRegistration_form[this.regFieldName[2]].value;this.opassName=this.oFreeRegistration_form[this.regFieldName[3]].value;this.ocpassName=this.oFreeRegistration_form[this.regFieldName[4]].value;this.oemailConfName=this.oFreeRegistration_form[this.regFieldName[5]].value;this.oFeatureEmail=true;this.oCommunityProfile=this.oFreeRegistration_form[this.regFieldName[10]].checked;this.ocompanySize=this.oFreeRegistration_form[this.regFieldName[14]].value;if(this.ocompanySize.length==0||this.ocompanySize==null){this.data={'profile.firstName':this.ofirstName,'profile.lastName':this.olastName,'profile.emailAddress':this.oemailName.toLowerCase(),'profile.password':this.opassName,'profile.passwordConfirmation':this.ocpassName,'service.templateCode':'WSJ','service.registrationType':'FREE_REGISTRATION','profile.options.returnLink':window.location.href,'profile.options.featureEmailOptIn':this.oFeatureEmail,'profile.trackingCode':'INLINEFREEREG'};}
else{this.data={'profile.firstName':this.ofirstName,'profile.lastName':this.olastName,'profile.emailAddress':this.oemailName.toLowerCase(),'profile.password':this.opassName,'profile.passwordConfirmation':this.ocpassName,'service.templateCode':'WSJ','service.registrationType':'FREE_REGISTRATION','profile.options.returnLink':window.location.href,'profile.options.featureEmailOptIn':this.oFeatureEmail,'profile.demographics.questionId1':this.opassQuestion,'profile.demographics.answer1':this.ocompanySize,'profile.trackingCode':'INLINEFREEREG'};}
var that=this;var request=dojo.xhrPost({url:"/epiton/registration/v2/profile",handleAs:"json",headers:{Accept:"application/json"},postData:dojo.objectToQuery(this.data),handle:function(data,ioargs){if(ioargs.xhr.status===200){that.oFreeRegEmail.innerHTML=that.oemailName;dojo.style(that.oFr_content);dj.util.Element.hide(that.oFr_content);dj.util.Element.show(that.oFr_confirm);that.oFreeRegistration_form.reset();}else if(ioargs.xhr.status===412){var responseData=eval('('+ioargs.xhr.responseText+')');that.oFreeRegSubButton.disabled=false;that.responseErrorData(responseData);}else if(ioargs.xhr.status===500||ioargs.xhr.status===404){that.oFreeRegSubButton.disabled=false;dj.util.Element.show(that.oFreeRegServiceErrorMsg);}else{that.oFreeRegSubButton.disabled=false;dj.util.Element.show(that.oFreeRegServiceErrorMsg);}}});},checkEmailInEmailCenter:function(){this.oemailName=this.oFreeRegistration_form[this.regFieldName[2]].value;var that=this;this.request=dojo.xhrGet({url:'/emailcheck/'+this.oemailName,loaddisabled:function(data){if(data){if('false'===dojo.strip(data)){that.freeRegRequest();}else if('true'===dojo.strip(data)){that.oFreeRegSubButton.disabled=false;}else{that.oFreeRegSubButton.disabled=false;dj.util.Element.show(that.oFreeRegServiceErrorMsg);}}else{that.oFreeRegSubButton.disabled=false;dj.util.Element.show(that.oFreeRegServiceErrorMsg);}},error:function(error){that.oFreeRegSubButton.disabled=false;dj.util.Element.show(that.oFreeRegServiceErrorMsg);}});},submitregForm:function(){this.oErrorCount=0;this.oRegFieldErrorMsgsValue="";dj.util.Element.hide(this.oFreeregemailerrormsg);dj.util.Element.hide(this.oFreeregusererrormsg);dj.util.Element.hide(this.oFreeRegServiceErrorMsg);this.oFreeRegSubButton.disabled=true;this.checkFreeRegBlur(0);this.checkFreeRegBlur(1);this.checkFreeRegBlur(2);this.checkFreeRegBlur(11);this.checkFreeRegBlur(3);this.checkFreeRegBlur(4);this.compareFreeRegEmail();this.compareFreeRegPassword();if(this.oErrorCount===0){this.oRegFieldErrorMsgsValue="";}
if(this.oErrorCount>0){this.oregFieldErrorMsg.innerHTML="<p>"+this.oRegFieldErrorMsgsValue+"</p>";console.log(this.oRegFieldErrorMsgsValue);dj.util.Element.show(this.oregFieldErrorMsg);this.oFreeRegSubButton.disabled=false;return false;}else{this.oFreeRegSubButton.disabled=true;dj.util.Element.hide(this.oregFieldErrorMsg);this.oRegFieldErrorMsgsValue="";this.oregFieldErrorMsg.innerHTML="";this.freeRegRequest();return false;}
return false;}};dojo.provide("dj.module.globalHeader");dojo.deprecated("dj.module.globalHeader","use the one in the 'header' bundle","0.7");dojo.require("dj.lang");dojo.require("dj.util.Config");dojo.require("dj.util.Cookie");dojo.require("dj.util.Date");dojo.require("dj.util.Region");dojo.require("dj.util.Element");dojo.require("dj.util.User");dj.module.globalHeader=function(){var DEFAULT_CONFIG={HEADER_CONTAINER_CLASS:".header",TIMESTAMP_CLASS:".date",WSJ_LOGO_ID:"wsjLogo",WSJ_LARGE_LOGO_CLASSNAME:"logo_large",WSJ_SMALL_LOGO_CLASSNAME:"logo_small",CURRENT_SUBSECTION_DISPLAY_CLASS:".currentSubSection",GLOBALNAV_SUBSECTION_ELEMENT_ID:"currentGlobalNavSubSection",SUBSCRIBER_LOGIN_CLASS:".login",HEADER_PROMO_CLASS:".promo",SUBSCRIBER_DETAILS_ELEMENT_ID:"subscribedUserDetailsId",COMMUNITY_FORUMS_LINK_CLASS:".communityForumsLink",TODAYS_PAPER_LINK_CLASS:".todaysPaperLink",MOJ_LINK_CLASS:".myOnlineJournalLink",MESSAGE_CENTER_LINK_CLASS:".messageCenterLink",MESSAGE_COUNT_CLASS:".messageCount",LOGIN_USERNAME_ELEMENT_ID:"login_username",LOGIN_PASSWORD_ELEMENT_ID:"login_password",LOGIN_FORM_ID:"login_form",PAGE_URL_ELEMENT_ID:"page_url",LOGOUT_LINK_ELEMENT_ID:"logoutLink",LOGIN_BUTTON_ELEMENT_ID:"login_button",USER_NAME_ELEMENT_ID:"userName",WSJ_LOGO_FADE_APPEAR_DURATION:"1.0",WSJ_LOGO_DELAY_DURATION:"2000",LOGGED_IN_COMMUNITY_URL:"/community",LOGGED_IN_TODAYS_PAPER_URL:"/itp?mod=WSJ_formfactor",MESSAGE_CENTER_POST_URL:"/community/integration/userinfo.html",LOGOUT_URL:"/static_html_files/logout_confirmation.htm",SUBSCRIBER_HOMEPAGE_PID:"0_0_WH_0001",NONSUBSCRIBER_HOMEPAGE_PID:"0_0_WH_0001_public",ASIA_PAGE_PID:"0_0_WP_2103",EUROPE_PAGE_PID:"0_0_WP_2104",NONSUBSCRIBER_NEWSLETTERS_ALERTS_PAGE_PID:"5_6007",NONSUBSCRIBER_SEARCH_PAGE_PID:"3_0466",HOMEPAGE_SUBSCRIBER_URL:"/",SEARCH_PAGE_SUBSCRIBER_URL:"/search",TODAYS_PAPER_LINK_CONTAINER_CLASS:".todaysPaperLinkContainer",VIDEO_LINK_CONTAINER_CLASS:".videoLinkContainer",COLUMNS_LINK_CONTAINER_CLASS:".columnsLinkContainer",BLOGS_LINK_CONTAINER_CLASS:".blogsLinkContainer",INTERACTIVE_GRAPHICS_LINK_CONTAINER_CLASS:".interactiveGraphicsLinkContainer",TOPICS_LINK_CONTAINER_CLASS:".topicsLinkContainer",COMMUNITY_FORUMS_LINK_CONTAINER_CLASS:".communityForumsLinkContainer",TODAYS_PAPER_PID:"0_0_WP_40",TODAYS_PAPER_US_NONSUB_PID:"2_0433",TODAYS_PAPER_EUROPE_NONSUB_PID:"2_0434",TODAYS_PAPER_ASIA_NONSUB_PID:"2_0435",TODAYS_PAPER_US_PID:"2_0133",TODAYS_PAPER_EUROPE_PID:"2_0134",TODAYS_PAPER_ASIA_PID:"2_0135",TODAYS_PAPER_PAST_EDITIONS_PID:"2_0233",TODAYS_PAPER_INDEX_BIZ_PID:"2_0156",TODAYS_PAPER_INDEX_PEOPLE_PID:"2_0155",TODAYS_PAPER_CORRECTIONS_PID:"Corrections",VIDEO_PID:"0_0_WP_3000",BLOGS_PID:"8_0019",COLUMNS_PID:"2_0140",INTERACTIVE_GRAPHICS_PID:"0_0_WP_2003",TOPICS_PID:"0_0_WT_0001",NEWSLETTERS_ALERTS_SUB_PID:"5_6001",NEWSLETTERS_ALERTS_PUB_PID:"5_6003",MOJ_LINK_URL:"/page/my-journal-main.html",MDC_LINK_URL:"/mdc/page/marketsdata.html",MDC_PAGE_PID:"2_3000",COMMUNITY_HIGHLIGHT_COMPARE_URL:"/community",FORUMS_HIGHLIGHT_COMPARE_URL:"forums.wsj.com",FREE_REG_CLASS:".freereg",LOCATION_NAV_CLASS:".location_nav",LOCATION_NAV_COLLAPSED_CLASSNAME:"location_collapsed",LOCATION_NAV_EXPANDED_CLASSNAME:"location_expanded",US_EDITION_LINK_CLASS:".map_us",EU_EDITION_LINK_CLASS:".map_europe",ASIA_EDITION_LINK_CLASS:".map_asia",IN_EDITION_LINK_CLASS:".map_india",LOGGED_IN_TODAYS_PAPER_URL_ASIA:"/page/asia_in_todays_paper.html?mod=WSJ_formfactor",LOGGED_IN_TODAYS_PAPER_URL_EUROPE:"/page/europe_in_todays_paper.html?mod=WSJ_formfactor",US_EDITION_MDC_URL:"/marketsdata",EU_EDITION_MDC_URL:"/mdc/public/page/marketsdata_europe.html",ASIA_EDITION_MDC_URL:"/mdc/public/page/marketsdata_asia.html",IN_EDITION_MDC_URL:"/mdc/public/page/marketsdata_asia.html",MDC_COMPARE_URL:"/mdc/",FOOTER_CONTAINER_CLASS:".pagefooter"};return{initialize:function(config){this.cfg=dj.lang.cloneMixin(DEFAULT_CONFIG,config);var headerContainerClass=this.cfg.HEADER_CONTAINER_CLASS;this.oHeader=dojo.query(headerContainerClass)[0];this.editionDropdownSetUp();this.displaySubSection();this.displayTimeStamp();var that=this;this.currRegion=dj.util.Region.getViewByRegion();this.concatURL='';if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){this.concatURL="httpdisabled://"+gcDomain;}else{this.concatURL="httpdisabled://"+document.domain;}
dj.util.User.isLoggedIn(function(isLoggedIn){if(isLoggedIn){that.displaySubscriberDetails();that.setupLogout();}else{that.setupLogin();var freeregClass=that.cfg.FREE_REG_CLASS;that.ofreereg=dojo.query(freeregClass,that.oHeader)[0];var registerModule=dojo.query("#register_module",that.ofreereg)[0];dojo.style(registerModule,{display:"none"});dojo.style(that.ofreereg,{display:"block"});var subscriberLoginClass=that.cfg.SUBSCRIBER_LOGIN_CLASS;that.oSubscriberLogin=dojo.query(subscriberLoginClass,that.oHeader)[0];var loginModule=dojo.query(".login_module",that.oSubscriberLogin)[0];dojo.style(loginModule,{display:"none"});dojo.style(that.oSubscriberLogin,{display:"block"});var headerPromoClass=that.cfg.HEADER_PROMO_CLASS;that.oHeaderPromo=dojo.query(headerPromoClass,that.oHeader)[0];dojo.style(that.oHeaderPromo,{display:"block"});}});this.highlightFormFactorLinks();var todaysPaperLinkClass=this.cfg.TODAYS_PAPER_LINK_CLASS;this.oTodaysPaperLink=dojo.query(todaysPaperLinkClass,this.oHeader)[0];var loggedInTodaysPaperUrl=this.cfg.LOGGED_IN_TODAYS_PAPER_URL;var loggedInTodaysPaperUrlAsia=this.cfg.LOGGED_IN_TODAYS_PAPER_URL_ASIA;var loggedInTodaysPaperUrlEurope=this.cfg.LOGGED_IN_TODAYS_PAPER_URL_EUROPE;var currEdition="";if(this.currRegion=="asia"||this.currRegion=="asia,india"){loggedInTodaysPaperUrl=loggedInTodaysPaperUrlAsia;}else if(this.currRegion=="europe"){loggedInTodaysPaperUrl=loggedInTodaysPaperUrlEurope;}
if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){this.oTodaysPaperLink.href="httpdisabled://"+gcDomain+loggedInTodaysPaperUrl;}else{this.oTodaysPaperLink.href=loggedInTodaysPaperUrl;}
var that=this;dj.util.User.isSubLoggedIn(function(subLoggedIn){if(!subLoggedIn){if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){that.oTodaysPaperLink.href="httpdisabled://"+gcDomain+"/public"+loggedInTodaysPaperUrl;}else{that.oTodaysPaperLink.href="/public"+loggedInTodaysPaperUrl;}}});},toggleDropdownClass:function(){var selLocDrpdwnCollapsedClassName=this.cfg.LOCATION_NAV_COLLAPSED_CLASSNAME;var selLocDrpdwnExpandedClassName=this.cfg.LOCATION_NAV_EXPANDED_CLASSNAME;if(dojo.hasClass(this.oLocDropDownContainer,selLocDrpdwnCollapsedClassName)){dojo.removeClass(this.oLocDropDownContainer,selLocDrpdwnCollapsedClassName);dojo.addClass(this.oLocDropDownContainer,selLocDrpdwnExpandedClassName);}else if(dojo.hasClass(this.oLocDropDownContainer,selLocDrpdwnExpandedClassName)){dojo.addClass(this.oLocDropDownContainer,selLocDrpdwnCollapsedClassName);}},editionDropdownSetUp:function(){var that=this;var locationNavClass=this.cfg.LOCATION_NAV_CLASS;this.oLocationNav=dojo.query(locationNavClass,this.oHeader)[0];var selLocDrpdwnCollapsedClassName=this.cfg.LOCATION_NAV_COLLAPSED_CLASSNAME;var selLocDrpdwnExpandedClassName=this.cfg.LOCATION_NAV_EXPANDED_CLASSNAME;var usEditionLinkClassName=this.cfg.US_EDITION_LINK_CLASS;var usEditionLinkClassName=this.cfg.US_EDITION_LINK_CLASS;var euEditionLinkClassName=this.cfg.EU_EDITION_LINK_CLASS;var inEditionLinkClassName=this.cfg.IN_EDITION_LINK_CLASS;var asiaEditionLinkClassName=this.cfg.ASIA_EDITION_LINK_CLASS;this.usEditionMDCUrl=this.cfg.US_EDITION_MDC_URL;this.euEditionMDCUrl=this.cfg.EU_EDITION_MDC_URL;this.inEditionMDCUrl=this.cfg.IN_EDITION_MDC_URL;this.asiaEditionMDCUrl=this.cfg.ASIA_EDITION_MDC_URL;var mdcCompareUrl=this.cfg.MDC_COMPARE_URL;this.oCurrentEdition=dojo.byId("currentEdition");this.oUsEdition=dojo.byId("usEdition");this.oEuEdition=dojo.byId("europeEdition");this.oInEdition=dojo.byId("indiaEdition");this.oAsiaEdition=dojo.byId("asiaEdition");this.oChiEdition=dojo.byId("chiEdition");this.oSpaEdition=dojo.byId("spaEdition");this.oPorEdition=dojo.byId("porEdition");this.osectionFooterSub=dojo.byId("hrefNonSubId");this.osectionFooterNonSub=dojo.byId("hrefSubId");this.oUsEditionFooter=dojo.byId("usEditionFooter");this.currRegion=dj.util.Region.getViewByRegion();var currEdition="";if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){this.tempConcatURL="httpdisabled://"+gcDomain;}else{this.tempConcatURL="httpdisabled://"+document.domain;}
this.isMDCPageFlag=((document.location.href!==null)&&(document.location.href!=="")&&(document.location.href.indexOf(mdcCompareUrl)!==-1));if(this.oUsEdition!==null){dojo.connect(this.oUsEdition,"onclick",this,function(ev){dojo.stopEvent(ev);dj.util.Region.setViewByRegion('na,us');dj.util.Cookie.setGroupCookie("DJCOOKIE","HOMEPAGE","/home-page",365);window.location=(this.isMDCPageFlag)?this.tempConcatURL+this.usEditionMDCUrl:this.oUsEdition.href;});}
if(this.oUsEditionFooter!==null){dojo.connect(this.oUsEditionFooter,"onclick",this,function(ev){dojo.stopEvent(ev);dj.util.Region.setViewByRegion('na,us');dj.util.Cookie.setGroupCookie("DJCOOKIE","HOMEPAGE","/home/us",365);window.location=(this.isMDCPageFlag)?this.tempConcatURL+this.usEditionMDCUrl:this.oUsEditionFooter.href;});}
if(this.oEuEdition!==null){dojo.connect(this.oEuEdition,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=(this.isMDCPageFlag)?this.tempConcatURL+this.euEditionMDCUrl:this.oEuEdition.href;if(this.isMDCPageFlag){dj.util.Region.setViewByRegion("europe");dj.util.Cookie.setGroupCookie("DJCOOKIE","HOMEPAGE","/home/europe",365);}});}
if(this.oInEdition!==null){dojo.connect(this.oInEdition,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=(this.isMDCPageFlag)?this.tempConcatURL+this.inEditionMDCUrl:this.oInEdition.href;if(this.isMDCPageFlag){dj.util.Region.setViewByRegion("asia,india");dj.util.Cookie.setGroupCookie("DJCOOKIE","HOMEPAGE","/home/india",365);}});}
if(this.oAsiaEdition!==null){dojo.connect(this.oAsiaEdition,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=(this.isMDCPageFlag)?this.tempConcatURL+this.asiaEditionMDCUrl:this.oAsiaEdition.href;if(this.isMDCPageFlag){dj.util.Region.setViewByRegion("asia");dj.util.Cookie.setGroupCookie("DJCOOKIE","HOMEPAGE","/home/asia",365);}});}
if(this.oChiEdition!==null){dojo.connect(this.oChiEdition,"onclick",this,function(ev){dojo.stopEvent(ev);void(this.oChiEdition.href);});}
if(this.oSpaEdition!==null){dojo.connect(this.oSpaEdition,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=this.oSpaEdition.href;});}
if(this.oPorEdition!==null){dojo.connect(this.oPorEdition,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=this.oPorEdition.href;});}
if(this.osectionFooterSub!==null){dojo.connect(this.osectionFooterSub,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=this.osectionFooterSub.href;});}
if(this.osectionFooterNonSub!==null){dojo.connect(this.osectionFooterNonSub,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=this.osectionFooterNonSub.href;});}
if(this.currRegion=="asia"){currEdition="Asia Edition";this.oSelectedEdition=dojo.query(asiaEditionLinkClassName,this.oHeader)[0];}else if(this.currRegion=="asia,india"){currEdition="Asia Edition";this.oSelectedEdition=dojo.query(inEditionLinkClassName,this.oHeader)[0];}else if(this.currRegion=="europe"){currEdition="Europe Edition";this.oSelectedEdition=dojo.query(euEditionLinkClassName,this.oHeader)[0];}else{currEdition="U.S. Edition";this.oSelectedEdition=dojo.query(usEditionLinkClassName,this.oHeader)[0];}
dojo.addClass(this.oSelectedEdition,"selected");this.oCurrentEdition.innerHTML=currEdition;this.oFormFactorContainer=dojo.byId("formFactorContainer");dojo.style(this.oFormFactorContainer,{"display":""});this.oLocDropDownContainer=dojo.byId("locNavContainer");dojo.style(this.oLocDropDownContainer,{"display":""});if(this.oLocDropDownContainer!==null){var toggleDropdownClass=function(){if(dojo.hasClass(that.oLocDropDownContainer,selLocDrpdwnCollapsedClassName)){dojo.removeClass(that.oLocDropDownContainer,selLocDrpdwnCollapsedClassName);dojo.addClass(that.oLocDropDownContainer,selLocDrpdwnExpandedClassName);}else if(dojo.hasClass(that.oLocDropDownContainer,selLocDrpdwnExpandedClassName)){dojo.removeClass(that.oLocDropDownContainer,selLocDrpdwnExpandedClassName);dojo.addClass(that.oLocDropDownContainer,selLocDrpdwnCollapsedClassName);}};dojo.connect(this.oLocationNav,"onclick",this,function(event){dojo.stopEvent(event);toggleDropdownClass();});dojo.connect(document,"onclick",this,function(event){var isMousePointerinModalContainer=dj.util.Element.contains(this.oLocDropDownContainer,event.clientX,event.clientY);if(isMousePointerinModalContainer==false){if(dojo.hasClass(this.oLocDropDownContainer,selLocDrpdwnExpandedClassName)){dojo.removeClass(this.oLocDropDownContainer,selLocDrpdwnExpandedClassName);dojo.addClass(this.oLocDropDownContainer,selLocDrpdwnCollapsedClassName);}}});this.oSectionFooterNonSub=dojo.byId("sectionFooterNonSub");this.oSectionFooterSub=dojo.byId("sectionFooterSub");dj.util.User.isLoggedIn(function(isLoggedIn){if(isLoggedIn){dojo.style(that.oSectionFooterNonSub,{"display":"none"});dojo.style(that.oSectionFooterSub,{"display":""});}else{dojo.style(that.oSectionFooterNonSub,{"display":""});dojo.style(that.oSectionFooterSub,{"display":"none"});}});}},displayTimeStamp:function(){var timestampClass=this.cfg.TIMESTAMP_CLASS;this.oTimestamp=dojo.query(timestampClass,this.oHeader)[0];if((typeof pDate!=="undefined")&&(this.oTimestamp!==null)){if(window.pStl=="renovation"){var pubDate=dj.util.Date.displayTime(pDate,pDateinGMT);this.oTimestamp.innerHTML=pubDate;}else{this.oTimestamp.innerHTML=pDate;}}},displaySubSection:function(){this.oCurrentSubSection=dojo.query(this.cfg.CURRENT_SUBSECTION_DISPLAY_CLASS,this.oHeader)[0];if((typeof globalHeaderPageTitle!=="undefined")&&(globalHeaderPageTitle!==null)&&(globalHeaderPageTitle!=="")){this.oCurrentSubSection.innerHTML=globalHeaderPageTitle;this._delayedFadeInSubSection();}},_delayedFadeInSubSection:function(){setTimeout(dojo.hitch(this,function(){dojo.style(this.oCurrentSubSection,{"display":"inline","opacity":0});dojo.fadeIn({node:this.oCurrentSubSection,duration:(this.cfg.WSJ_LOGO_FADE_APPEAR_DURATION*1000)}).play();}),this.cfg.WSJ_LOGO_DELAY_DURATION);},displaySubscriberDetails:function(){var userNameElementId=this.cfg.USER_NAME_ELEMENT_ID;dj.util.User.renderCallsign(userNameElementId);this.setupSubscriberLinks();var messageCenterLinkClass=this.cfg.MESSAGE_CENTER_LINK_CLASS;this.oMessageCenterLink=dojo.query(messageCenterLinkClass,this.oHeader)[0];var that=this;dj.util.User.isSubLoggedIn(function(subLoggedIn){if(subLoggedIn){that.setupMessageCenter();}else{that.setUpMJLinksForReg();dojo.style(that.oMessageCenterLink,{"display":"none"});}});var subscriberDetailsElementId=this.cfg.SUBSCRIBER_DETAILS_ELEMENT_ID;this.oSubscriberDetails=dojo.byId(subscriberDetailsElementId);dojo.removeClass(this.oSubscriberDetails,"hidden");},setUpMJLinksForReg:function(){var footerContainerClass=this.cfg.FOOTER_CONTAINER_CLASS;this.oFooter=dojo.query(footerContainerClass)[0];var mojLinkUrl=this.cfg.MOJ_LINK_URL;var mojLinkClass=this.cfg.MOJ_LINK_CLASS;this.oMojLinkHeader=dojo.query(mojLinkClass,this.oHeader)[0];this.oMojLinkFooter=dojo.query(mojLinkClass,this.oFooter)[0];if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){this.oMojLinkHeader.href="httpdisabled://"+gcDomain+mojLinkUrl;this.oMojLinkFooter.href="httpdisabled://"+gcDomain+mojLinkUrl;}else{this.oMojLinkHeader.href=mojLinkUrl;this.oMojLinkFooter.href=mojLinkUrl;}},setupSubscriberLinks:function(){var todaysPaperLinkClass=this.cfg.TODAYS_PAPER_LINK_CLASS;this.oTodaysPaperLink=dojo.query(todaysPaperLinkClass,this.oHeader)[0];var loggedInTodaysPaperUrl=this.cfg.LOGGED_IN_TODAYS_PAPER_URL;var that=this;dj.util.User.isSubLoggedIn(function(subLoggedIn){if(subLoggedIn){if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){that.oTodaysPaperLink.href="httpdisabled://"+gcDomain+loggedInTodaysPaperUrl;}else{that.oTodaysPaperLink.href=loggedInTodaysPaperUrl;}}});},setupMessageCenter:function(){var messageCenterLinkClass=this.cfg.MESSAGE_CENTER_LINK_CLASS;this.oMessageCenterLink=dojo.query(messageCenterLinkClass,this.oHeader)[0];var messageCountClass=this.cfg.MESSAGE_COUNT_CLASS;this.oMessageCount=dojo.query(messageCountClass,this.oHeader)[0];var that=this;var setupMsgCenterLink=function(noOfMessages){if(noOfMessages==='-1'){dojo.style(that.oMessageCenterLink,{"display":"none"});}else{that.oMessageCount.innerHTML=noOfMessages;}};var noOfMessages=dj.util.Cookie.getCookie("msgCount");if(noOfMessages===null){var messageCenterPostUrl=this.cfg.MESSAGE_CENTER_POST_URL;var messageCountReq=dojo.xhrPost({url:messageCenterPostUrl,loaddisabled:function(data,ioargs){var jsonObj=data;noOfMessages=jsonObj.MessagesCount;var userStatus=jsonObj.Status;dj.util.Cookie.setCookie("msgCount",noOfMessages,(5/24/60));dj.util.Cookie.setCookie("userStatus",userStatus,(5/24/60));setupMsgCenterLink(noOfMessages);},error:function(transport,exception){console.error("Exception occured while posting posting Ajax Request: %s",exception);}});}else{setupMsgCenterLink(noOfMessages);}},setupLogin:function(){var loginUserElementId=this.cfg.LOGIN_USERNAME_ELEMENT_ID;this.oUserName=dojo.byId(loginUserElementId);var loginPasswordElementId=this.cfg.LOGIN_PASSWORD_ELEMENT_ID;this.oPassword=dojo.byId(loginPasswordElementId);var loginButtonImageId=this.cfg.LOGIN_BUTTON_ELEMENT_ID;this.oLoginImg=dojo.byId(loginButtonImageId);var loginFormId=this.cfg.LOGIN_FORM_ID;this.oLoginForm=dojo.byId(loginFormId);this.oLoginForm.reset();var pageUrlId=this.cfg.PAGE_URL_ELEMENT_ID;this.oPageUrl=dojo.byId(pageUrlId);var that=this;if(this.oPageUrl!==null){var nonSubscriberHomepagePid=this.cfg.NONSUBSCRIBER_HOMEPAGE_PID;var nonSubscriberSearchPagePid=this.cfg.NONSUBSCRIBER_SEARCH_PAGE_PID;var nonSubNewslettersAlertsPagePid=this.cfg.NONSUBSCRIBER_NEWSLETTERS_ALERTS_PAGE_PID;var mdcPagePid=this.cfg.MDC_PAGE_PID;var concatURL;if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){concatURL="httpdisabled://"+gcDomain;}else{concatURL="httpdisabled://"+document.domain;}
var oCurrentUrl;if(dojo.isIE){oCurrentUrl=window.location.href;}else{oCurrentUrl=document.location.href;}
var url_value=oCurrentUrl;if(typeof pID!=="undefined"){if(pID===nonSubscriberHomepagePid){url_value=concatURL+this.cfg.HOMEPAGE_SUBSCRIBER_URL;}else if(pID===nonSubNewslettersAlertsPagePid){url_value=concatURL+"/email";}else if(pID===nonSubscriberSearchPagePid){url_value=concatURL+this.cfg.SEARCH_PAGE_SUBSCRIBER_URL;}else if(pID===mdcPagePid){url_value=concatURL+this.cfg.MDC_LINK_URL;}else{url_value=oCurrentUrl;}
if(dojo.isIE){document.login_form.url.value=url_value;}else{this.oPageUrl.value=url_value;}}
if(this.oUserName!==null){dojo.connect(this.oUserName,"onfocus",this,function(event){dj.util.Form.clearValue(this.oUserName,"User Name");});dojo.connect(this.oUserName,"onclick",this,function(event){dj.util.Form.clearValue(this.oUserName,"User Name");});}
if(this.oPassword!==null){dojo.connect(this.oPassword,"onfocus",this,function(event){dj.util.Form.clearValue(that.oPassword,"Password");this.oPassword.type="password";});dojo.connect(this.oPassword,"onclick",this,function(event){dj.util.Form.clearValue(that.oPassword,"Password");});dojo.connect(this.oPassword,"onchange",this,function(event){dj.util.Form.clearValue(that.oPassword,"Password");});}
if(dojo.isIE){dojo.connect(this.oLoginImg,"onclick",this,function(e){document.login_form.url.value=oCurrentUrl;console.log("coming in to img onlick in IE"+oCurrentUrl);this.oLoginForm.submit();});}
dojo.connect(this.oPassword,"onkeypress",this,function(e){var cKeyCode=e.keyCode||e.which;if(dojo.isIE){if(cKeyCode==Event.KEY_RETURN){document.login_form.url.value=oCurrentUrl;this.oLoginForm.submit();}}});}},setupLogout:function(){var logoutLinkElementId=this.cfg.LOGOUT_LINK_ELEMENT_ID;this.oLogout=dojo.byId(logoutLinkElementId);if(this.oLogout!==null){dojo.connect(this.oLogout,"onclick",this,function(ev){dojo.stopEvent(ev);dj.util.Cookie.deleteCookie("msgCount");dj.util.Cookie.deleteCookie("HOMEPAGE",true);document.cookie="HOMEPAGE"+"="+";path=/"+";domain=.wsj.com"
+";expires=Thu, 01-Jan-1970 00:00:01 GMT";if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){window.location="/logout?url=http://"+gcDomain;}else{window.location="/logout";}});}},highlightFormFactorLinks:function(){var todaysPaperLinkContainerClass=this.cfg.TODAYS_PAPER_LINK_CONTAINER_CLASS;this.oTodaysPaperLinkContainer=dojo.query(todaysPaperLinkContainerClass,this.oHeader)[0];var videoLinkContainerClass=this.cfg.VIDEO_LINK_CONTAINER_CLASS;this.oVideoLinkContainer=dojo.query(videoLinkContainerClass,this.oHeader)[0];var blogsLinkContainerClass=this.cfg.BLOGS_LINK_CONTAINER_CLASS;this.oBlogsLinkContainer=dojo.query(blogsLinkContainerClass,this.oHeader)[0];var columnsLinkContainerClass=this.cfg.COLUMNS_LINK_CONTAINER_CLASS;this.oColumnsLinkContainer=dojo.query(columnsLinkContainerClass,this.oHeader)[0];var interactiveGraphicsLinkContainerClass=this.cfg.INTERACTIVE_GRAPHICS_LINK_CONTAINER_CLASS;this.oInteractiveGraphicsLinkContainer=dojo.query(interactiveGraphicsLinkContainerClass,this.oHeader)[0];var topicsLinkContainerClass=this.cfg.TOPICS_LINK_CONTAINER_CLASS;this.oTopicsLinkContainer=dojo.query(topicsLinkContainerClass,this.oHeader)[0];var communityForumsLinkContainerClass=this.cfg.COMMUNITY_FORUMS_LINK_CONTAINER_CLASS;this.oCommunityForumsLinkContainer=dojo.query(communityForumsLinkContainerClass,this.oHeader)[0];var todaysPaperPid=this.cfg.TODAYS_PAPER_PID;var todaysPaperUsNonSubPid=this.cfg.TODAYS_PAPER_US_NONSUB_PID;var todaysPaperEuropeNonSubPid=this.cfg.TODAYS_PAPER_EUROPE_NONSUB_PID;var todaysPaperAsiaNonSubPid=this.cfg.TODAYS_PAPER_ASIA_NONSUB_PID;var todaysPaperUsPid=this.cfg.TODAYS_PAPER_US_PID;var todaysPaperEuropePid=this.cfg.TODAYS_PAPER_EUROPE_PID;var todaysPaperAsiaPid=this.cfg.TODAYS_PAPER_ASIA_PID;var todaysPaperPastEditionsPid=this.cfg.TODAYS_PAPER_PAST_EDITIONS_PID;var todaysPaperIndexBizPid=this.cfg.TODAYS_PAPER_INDEX_BIZ_PID;var todaysPaperIndexPeoplePid=this.cfg.TODAYS_PAPER_INDEX_PEOPLE_PID;var todaysPaperCorrectionsPid=this.cfg.TODAYS_PAPER_CORRECTIONS_PID;var videoPid=this.cfg.VIDEO_PID;var interactiveGraphicsPid=this.cfg.INTERACTIVE_GRAPHICS_PID;var topicsPid=this.cfg.TOPICS_PID;var newslettersAlertsPubPid=this.cfg.NEWSLETTERS_ALERTS_PUB_PID;var newslettersAlertsSubPid=this.cfg.NEWSLETTERS_ALERTS_SUB_PID;var columnsPid=this.cfg.COLUMNS_PID;var blogsPid=this.cfg.BLOGS_PID;var hostUrl=document.location.host;var communityUrl=hostUrl+this.cfg.COMMUNITY_HIGHLIGHT_COMPARE_URL;var compareForumsUrl=this.cfg.FORUMS_HIGHLIGHT_COMPARE_URL;if(typeof pID!=="undefined"){if((pID.indexOf(todaysPaperPid)==0)||(pID===todaysPaperUsNonSubPid)||(pID===todaysPaperEuropeNonSubPid)||(pID===todaysPaperAsiaNonSubPid)||(pID===todaysPaperUsPid)||(pID===todaysPaperEuropePid)||(pID===todaysPaperAsiaPid)||(pID===todaysPaperPastEditionsPid)||(pID===todaysPaperIndexBizPid)||(pID===todaysPaperIndexPeoplePid)||(pID===todaysPaperCorrectionsPid)){dojo.addClass(this.oTodaysPaperLinkContainer,"selected");}else if(pID===videoPid){dojo.addClass(this.oVideoLinkContainer,"selected");}else if(pID===interactiveGraphicsPid){dojo.addClass(this.oInteractiveGraphicsLinkContainer,"selected");}else if(pID===columnsPid){dojo.addClass(this.oColumnsLinkContainer,"selected");}else if(pID===blogsPid){dojo.addClass(this.oBlogsLinkContainer,"selected");}else if(pID===topicsPid){dojo.addClass(this.oTopicsLinkContainer,"selected");}}
if((document.location.href!==null)&&(document.location.href!=="")&&(document.location.href.indexOf(communityUrl)!==-1)||(document.location.href.indexOf(compareForumsUrl)!==-1)){dojo.addClass(this.oCommunityForumsLinkContainer,"selected");}}};}();dojo.provide("dj.module.showSectionAndTicker");dojo.require("dj.module.newsTicker");dj.module.showSectionAndTicker={init:function(){this.sectPan=dj.module.carouselSection.panels;this.newsPan=dj.module.newsTicker.ticker;if(!this.sectPan||!this.newsPan){console.warn("{showSectionAndTicker} either (or both) of the carousels is not found");return;}
this.bind();},bind:function(){var ctr=0,span=this.sectPan,npan=this.newsPan,tot=span.model.getNumberOfPanels();npan.model.setRotationState(0);span.model.addChangeListener("success",function(panel){if(panel.getPosition()==tot){ctr++;}
if((panel.getPosition()==1)&&(ctr>0)){span.model.setRotationState(0);npan.model.setRotationState(1);}});span.model.addChangeListener("rotationStateSuccess",function(rstate){if(rstate==0){npan.model.setRotationState(1);}else{npan.model.setRotationState(0);}});}};
dojo.provide("dj.module.CCS");dojo.require("dj.lang");dojo.require("dj.util.Cookie");dojo.require("dj.util.User");dj.module.CCS={init:function(cfg){this._cfg=dj.lang.cloneMixin(this.DEFAULT_CONFIG,cfg);this.product='WSJ';var prefixDtext=(typeof window.nSP!='undefined')?window.nSP:"";this.dtext=['<table cellpadding="0" cellspacing="0" border="0" width="100%"><tr>','<td class="p10" style="padding:4px 0px 5px 0px;border-right:1px solid #9BADCE;" align="center"><a href="'+prefixDtext+'/acct/setup_account" class="unvisited p10">My Account</a></td>','<td class="p10" style="padding:4px 0px 5px 0px;border-right:1px solid #9BADCE;" align="center"><a href="'+prefixDtext+'/msgcenter/view_messages.html?product='+this.product+'" class="unvisited p10">Messages</a></td>','<td class="p10" style="padding:4px 0px 5px 0px;" align="center"><a href="'+prefixDtext+'/setup/setup_center_mainpage" class="unvisited p10">Preferences</a></td>','</tr></table>'];var prefixAtext=(typeof window.nSP!='undefined')?window.nSP:"";this.atext=['<a href="'+prefixAtext+'/msgcenter/view_messages.html?product='+this.product+'">','<img src="/img/message_alert_icon.gif" border="0" width="25" height="16" style="padding:0px;margin:0px;vertical-align:middle;"/><span class="p11" style="vertical-align:middle;">You have an important message</span>','</a>'];var prefixNtext=(typeof window.nSP!='undefined')?window.nSP:"";this.ntext=['<a href="'+prefixNtext+'/msgcenter/view_messages.html?product='+this.product+'">','<img src="/img/message_icon_WSJ.gif" border="0" width="15" height="11" style="padding:0px;margin:0px;vertical-align:middle;"/><span class="p11" style="vertical-align:middle;">You have a new message</span>','</a>'];},DEFAULT_CONFIG:{product:null,messageCenterRequest:null,messageCenterTimeout:null,displayedInterstitialRequest:null,displayedInterstitialTimeout:null,readRequest:null,readTimeout:null,getContentRequest:null,getContentTimeout:null,changeOrderRequest:null,changeOrderTimeout:null,dtext:null,atext:null,ntext:null,VarX:null,y:null,z:null},changeStyle:function(httpRequest,msgid){var v=document.getElementById('m_'+msgid+'_f');v.style.fontWeight='';v=document.getElementById('m_'+msgid+'_s');v.style.fontWeight='';v=document.getElementById('m_'+msgid+'_r');v.style.fontWeight='';v=document.getElementById('m_'+msgid+'_e');v.style.fontWeight='';},displayMessages:function(httpRequest){var m=document.getElementById("messages");m.innerHTML=httpRequest.xhr.responseText;},closeMessage:function(){this.y.style.display='none';this.VarX.style.display='none';},checkAll:function(){var f=document.getElementById("mform");var num=f.elements.length;for(var i=0;i<num;i++){var e=f.elements[i];if(e.type=='checkbox'){e.checked=true;}}},uncheckAll:function(){var f=document.getElementById("mform");var num=f.elements.length;for(var i=0;i<num;i++){var e=f.elements[i];if(e.type=='checkbox'){e.checked=false;}}},displayDiv:function(content,mid,mname,isInterstitial){this.VarX=dojo.byId('modal');this.y=dojo.byId('message');this.z=dojo.byId('messagecontent');this.z.innerHTML=content;this.y.style.zIndex=1000000001;this.y.style.display='block';this.y.style.overflow='hidden';this.VarX.style.zIndex=1000000000;this.VarX.style.display='block';this.VarX.style.height=document.body.scrollHeight+'px';var s;if(typeof s==='undefined'){s=(typeof window.s!='undefined')?window.s:"";}
if(s!==""){s.events="event30";if(isInterstitial){s.eVar30='WSJ Interstitial - '+mname;}else{s.eVar30='WSJ Message - '+mname;}
s.linkTrackVars="eVar30,events";s.linkTrackEvents="event30";if(isInterstitial){s.tl(true,'o','WSJ Interstitial - '+mname);}else{s.tl(true,'o','WSJ Message - '+mname);}}},showInterstitialContent:function(content,mid,uid,umid,mname){var tmp='';try{tmp=(new XMLSerializer()).serializeToString(content);}catch(e){tmp=content.xml;}
tmp=tmp.replace(/&amp;/g,'&');tmp=tmp.replace(/<user\/>/g,userName);tmp=tmp.replace(/gotosite/g,'WSJ.com');tmp=tmp.replace(/myacctsite/g,'https://commerce.wsj.com/myaccount/do/viewBillingInfo');tmp=tmp.replace(/modvalue/g,'mc_wsj_interstitial_'+mname);tmp=tmp.replace(/<site_name\/>/g,'WSJ.com');tmp=tmp.replace(/site/g,'wsj');tmp=tmp.replace(/msgbg/g,'#364A92');var d=new Date();tmp=tmp.replace(/<year\/>/g,d.getFullYear());tmp=tmp.substring(9,tmp.indexOf("</content>"));this.displayDiv(tmp,mid,mname,true);this.sendDisplayedInterstitialRequest(uid,umid);},processTop:function(httpRequest){try{var strDtext=this.dtext.join("");var strAtext=this.atext.join("");var strNtext=this.ntext.join("");var message=httpRequest.xhr.responseXML.getElementsByTagName("message")[0];if(message!==null){if(message.firstChild!==null){var mid=(message.getElementsByTagName("mid")[0]).firstChild.nodeValue;var uid=(message.getElementsByTagName("uid")[0]).firstChild.nodeValue;var umid=(message.getElementsByTagName("umid")[0]).firstChild.nodeValue;var mname=(message.getElementsByTagName("messageid")[0]).firstChild.nodeValue;var priority=message.getElementsByTagName("priority")[0];var display=message.getElementsByTagName("display")[0];if(display!==null){var dvalue=display.firstChild.nodeValue;if(dvalue=='true'){var content=message.getElementsByTagName("content")[0];this.showInterstitialContent(content,mid,uid,umid,mname);}else{if(priority!==null){var value=priority.firstChild.nodeValue;if(value==1){dojo.byId('msgCenter').innerHTML=strAtext;dj.util.Cookie.setCookie('CMCAlert',strAtext,1);}else{dojo.byId('msgCenter').innerHTML=strNtext;dj.util.Cookie.setCookie('CMCAlert',strNtext,1);}}}}else{dojo.byId('msgCenter').innerHTML=strDtext;}}else{dojo.byId('msgCenter').innerHTML=strDtext;}}else{dojo.byId('msgCenter').innerHTML=strDtext;}
return true;}catch(e){console.error("Exception while processing response",e);return false;}},reloaddisabledMessageCenter:function(){this.init();var cmcalertcookie=dj.util.Cookie.getCookie("CMCAlert");if(cmcalertcookie!==null){dojo.byId('msgCenter').innerHTML=cmcalertcookie;}
var cmccookie=dj.util.Cookie.getCookie("CMC");if(cmccookie===null){if(this.messageCenterRequest!==null){this.messageCenterRequest=null;}
dj.util.Cookie.setCookie('CMC','top',1);var processX;var d=new Date();var dataUrl='/msgcenter/top_message.html';var dataUrlParams={product:this.product,d:d.getTime()};var that=this;dojo.xhrGet({url:dataUrl,content:dataUrlParams,loaddisabled:function(data,ioargs){processX=that.processTop(ioargs);},error:function(exception,ioargs){console.error('Exception occured during Ajax Request to retrieve data: %o',exception);}});}},sendDisplayedInterstitialRequest:function(uid,umid){if(this.displayedInterstitialRequest!==null){this.displayedInterstitialRequest=null;}
var params={uId:uid,umId:umid,product:this.product};var postUrl='/msgcenter/displayed_interstitial.html';var that=this;dojo.xhrPost({url:postUrl,postData:dojo.objectToQuery(params),error:function(exception,ioargs){console.error('Exception occured while posting posting Ajax Request : '+exception);},handle:function(data,ioargs){that.reloaddisabledMessageCenter();}});},sendReadRequest:function(msgid,umid){if(this.readRequest!==null){this.readRequest=null;}
var params={umId:umid,product:this.product};var postUrl='/msgcenter/read_message.html';var that=this;dojo.xhrPost({url:postUrl,postData:dojo.objectToQuery(params),error:function(exception,ioargs){console.error('Exception occured while posting posting Ajax Request : '+exception);},handle:function(data,ioargs){that.changeStyle(ioargs,msgid);that.reloaddisabledMessageCenter();}});},showMessage:function(httpRequest,msgid,umid,mname){var message=httpRequest.xhr.responseText.replace(/&amp;/g,'&');var ccsuser1=document.getElementById('CCS_USER');if(ccsuser1){dj.util.User.renderCallsign(ccsuser1);}
message=message.replace(/gotosite/g,'WSJ.com');message=message.replace(/myacctsite/g,'https://commerce.wsj.com/myaccount/do/viewBillingInfo');message=message.replace(/modvalue/g,'mc_wsj_message_'+mname);var d=new Date();message=message.replace(/<year\/>/g,d.getFullYear());message=message.replace(/<site_name\/>/g,'WSJ.com');message=message.replace(/site/g,'wsj');message=message.replace(/msgbg/g,'#364A92');dj.util.Cookie.setCookie('CMCAlert','',-1);this.displayDiv(message,msgid,mname,false);this.sendReadRequest(msgid,umid);},loaddisabledMessageContent:function(msgid,uid,umid,read,mname){if(this.getContentRequest!==null){this.getContentRequest=null;}
var dataUrl='/msgcenter/get_message.html?messageId='+msgid+'&product='+this.product;var that=this;dojo.xhrGet({url:dataUrl,loaddisabled:function(data,ioargs){that.showMessage(ioargs,msgid,umid,mname);},error:function(exception,ioargs){console.error('Exception occured during Ajax Request to retrieve data: %o',exception);}});},sendChangeOrderRequest:function(order,product){if(this.changeOrderRequest!==null){this.changeOrderRequest=null;}
var dataUrl='/msgcenter/order_messages.html?order='+order+'&product='+product;var that=this;dojo.xhrGet({url:dataUrl,loaddisabled:function(data,ioargs){that.displayMessages(ioargs);},error:function(exception,ioargs){console.error('Exception occured during Ajax Request to retrieve data: %o',exception);}});},updateusermessagestatuscode:function(){if(this.readRequest!==null){this.readRequest=null;}
var params={product:this.product};var postUrl='/umsl/user_messages/do_not_show';var that=this;dojo.xhrPost({url:postUrl,postData:dojo.objectToQuery(params),error:function(exception,ioargs){console.error('Exception occured while posting posting Ajax Request : '+exception);},handle:function(data,ioargs){that.reloaddisabledMessageCenter();}});}};
if(!document.createElement('canvas').getContext){(function(){var m=Math;var mr=m.round;var ms=m.sin;var mc=m.cos;var abs=m.abs;var sqrt=m.sqrt;var Z=10;var Z2=Z/2;function getContext(){return this.context_||(this.context_=new CanvasRenderingContext2D_(this));}
var slice=Array.prototype.slice;function bind(f,obj,var_args){var a=slice.call(arguments,2);return function(){return f.apply(obj,a.concat(slice.call(arguments)));};}
var G_vmlCanvasManager_={init:function(opt_doc){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var doc=opt_doc||document;doc.createElement('canvas');doc.attachEvent('onreadystatechange',bind(this.init_,this,doc));}},init_:function(doc){if(!doc.namespaces['g_vml_']){doc.namespaces.add('g_vml_','urn:schemas-microsoft-com:vml','#default#VML');}
if(!doc.namespaces['g_o_']){doc.namespaces.add('g_o_','urn:schemas-microsoft-com:office:office','#default#VML');}
if(!doc.styleSheets['ex_canvas_']){var ss=doc.createStyleSheet();ss.owningElement.id='ex_canvas_';ss.cssText='canvas{display:inline-block;overflow:hidden;'+'text-align:left;width:300px;height:150px}'+'g_vml_\\:*{behavior:url(#default#VML)}'+'g_o_\\:*{behavior:url(#default#VML)}';}
var els=doc.getElementsByTagName('canvas');for(var i=0;i<els.length;i++){this.initElement(els[i]);}},initElement:function(el,width,height){if(!el.getContext){this.width=width;this.height=height;el.getContext=getContext;el.attachEvent('onpropertychange',onPropertyChange);el.attachEvent('onresize',onResize);var attrs=el.attributes;if(attrs.width&&attrs.width.specified){el.style.width=attrs.width.nodeValue+'px';}else{el.width=el.clientWidth;}
if(attrs.height&&attrs.height.specified){el.style.height=attrs.height.nodeValue+'px';}else{el.height=el.clientHeight;}}
return el;}};function onPropertyChange(e){var el=e.srcElement;switch(e.propertyName){case'width':el.style.width=el.attributes.width.nodeValue+'px';el.getContext().clearRect();break;case'height':el.style.height=el.attributes.height.nodeValue+'px';el.getContext().clearRect();break;}}
function onResize(e){var el=e.srcElement;if(el.firstChild){el.firstChild.style.width=el.clientWidth+'px';el.firstChild.style.height=el.clientHeight+'px';}}
var dec2hex=[];for(var i=0;i<16;i++){for(var j=0;j<16;j++){dec2hex[i*16+j]=i.toString(16)+j.toString(16);}}
function createMatrixIdentity(){return[[1,0,0],[0,1,0],[0,0,1]];}
function matrixMultiply(m1,m2){var result=createMatrixIdentity();for(var x=0;x<3;x++){for(var y=0;y<3;y++){var sum=0;for(var z=0;z<3;z++){sum+=m1[x][z]*m2[z][y];}
result[x][y]=sum;}}
return result;}
function copyState(o1,o2){o2.fillStyle=o1.fillStyle;o2.lineCap=o1.lineCap;o2.lineJoin=o1.lineJoin;o2.lineWidth=o1.lineWidth;o2.miterLimit=o1.miterLimit;o2.shadowBlur=o1.shadowBlur;o2.shadowColor=o1.shadowColor;o2.shadowOffsetX=o1.shadowOffsetX;o2.shadowOffsetY=o1.shadowOffsetY;o2.strokeStyle=o1.strokeStyle;o2.globalAlpha=o1.globalAlpha;o2.arcScaleX_=o1.arcScaleX_;o2.arcScaleY_=o1.arcScaleY_;o2.lineScale_=o1.lineScale_;}
function processStyle(styleString){var str,alpha=1;styleString=String(styleString);if(styleString.substring(0,3)=='rgb'){var start=styleString.indexOf('(',3);var end=styleString.indexOf(')',start+1);var guts=styleString.substring(start+1,end).split(',');str='#';for(var i=0;i<3;i++){str+=dec2hex[Number(guts[i])];}
if(guts.length==4&&styleString.substr(3,1)=='a'){alpha=guts[3];}}else{str=styleString;}
return{color:str,alpha:alpha};}
function processLineCap(lineCap){switch(lineCap){case'butt':return'flat';case'round':return'round';case'square':default:return'square';}}
function CanvasRenderingContext2D_(surfaceElement){this.m_=createMatrixIdentity();this.mStack_=[];this.aStack_=[];this.currentPath_=[];this.strokeStyle='#000';this.fillStyle='#000';this.lineWidth=1;this.lineJoin='miter';this.lineCap='butt';this.miterLimit=Z*1;this.globalAlpha=1;this.canvas=surfaceElement;var el=surfaceElement.ownerDocument.createElement('div');el.style.width=G_vmlCanvasManager_.width;el.style.height=G_vmlCanvasManager_.height;el.style.overflow='hidden';el.style.position='absolute';surfaceElement.appendChild(el);this.element_=el;this.arcScaleX_=1;this.arcScaleY_=1;this.lineScale_=1;}
var contextPrototype=CanvasRenderingContext2D_.prototype;contextPrototype.clearRect=function(){this.element_.innerHTML='';this.currentPath_=[];};contextPrototype.beginPath=function(){this.currentPath_=[];};contextPrototype.moveTo=function(aX,aY){var p=this.getCoords_(aX,aY);this.currentPath_.push({type:'moveTo',x:p.x,y:p.y});this.currentX_=p.x;this.currentY_=p.y;};contextPrototype.lineTo=function(aX,aY){var p=this.getCoords_(aX,aY);this.currentPath_.push({type:'lineTo',x:p.x,y:p.y});this.currentX_=p.x;this.currentY_=p.y;};contextPrototype.bezierCurveTo=function(aCP1x,aCP1y,aCP2x,aCP2y,aX,aY){var p=this.getCoords_(aX,aY);var cp1=this.getCoords_(aCP1x,aCP1y);var cp2=this.getCoords_(aCP2x,aCP2y);bezierCurveTo(this,cp1,cp2,p);};function bezierCurveTo(self,cp1,cp2,p){self.currentPath_.push({type:'bezierCurveTo',cp1x:cp1.x,cp1y:cp1.y,cp2x:cp2.x,cp2y:cp2.y,x:p.x,y:p.y});self.currentX_=p.x;self.currentY_=p.y;}
contextPrototype.quadraticCurveTo=function(aCPx,aCPy,aX,aY){var cp=this.getCoords_(aCPx,aCPy);var p=this.getCoords_(aX,aY);var cp1={x:this.currentX_+2.0/3.0*(cp.x-this.currentX_),y:this.currentY_+2.0/3.0*(cp.y-this.currentY_)};var cp2={x:cp1.x+(p.x-this.currentX_)/3.0,y:cp1.y+(p.y-this.currentY_)/3.0};bezierCurveTo(this,cp1,cp2,p);};contextPrototype.arc=function(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){aRadius*=Z;var arcType=aClockwise?'at':'wa';var xStart=aX+mc(aStartAngle)*aRadius-Z2;var yStart=aY+ms(aStartAngle)*aRadius-Z2;var xEnd=aX+mc(aEndAngle)*aRadius-Z2;var yEnd=aY+ms(aEndAngle)*aRadius-Z2;if(xStart==xEnd&&!aClockwise){xStart+=0.125;}
var p=this.getCoords_(aX,aY);var pStart=this.getCoords_(xStart,yStart);var pEnd=this.getCoords_(xEnd,yEnd);this.currentPath_.push({type:arcType,x:p.x,y:p.y,radius:aRadius,xStart:pStart.x,yStart:pStart.y,xEnd:pEnd.x,yEnd:pEnd.y});};contextPrototype.rect=function(aX,aY,aWidth,aHeight){this.moveTo(aX,aY);this.lineTo(aX+aWidth,aY);this.lineTo(aX+aWidth,aY+aHeight);this.lineTo(aX,aY+aHeight);this.closePath();};contextPrototype.strokeRect=function(aX,aY,aWidth,aHeight){this.beginPath();this.moveTo(aX,aY);this.lineTo(aX+aWidth,aY);this.lineTo(aX+aWidth,aY+aHeight);this.lineTo(aX,aY+aHeight);this.closePath();this.stroke();this.currentPath_=[];};contextPrototype.fillRect=function(aX,aY,aWidth,aHeight){this.beginPath();this.moveTo(aX,aY);this.lineTo(aX+aWidth,aY);this.lineTo(aX+aWidth,aY+aHeight);this.lineTo(aX,aY+aHeight);this.closePath();this.fill();this.currentPath_=[];};contextPrototype.createLinearGradient=function(aX0,aY0,aX1,aY1){var gradient=new CanvasGradient_('gradient');gradient.x0_=aX0;gradient.y0_=aY0;gradient.x1_=aX1;gradient.y1_=aY1;return gradient;};contextPrototype.createRadialGradient=function(aX0,aY0,aR0,aX1,aY1,aR1){var gradient=new CanvasGradient_('gradientradial');gradient.x0_=aX0;gradient.y0_=aY0;gradient.r0_=aR0;gradient.x1_=aX1;gradient.y1_=aY1;gradient.r1_=aR1;return gradient;};contextPrototype.drawImage=function(image,var_args){var dx,dy,dw,dh,sx,sy,sw,sh;var oldRuntimeWidth=image.runtimeStyle.width;var oldRuntimeHeight=image.runtimeStyle.height;image.runtimeStyle.width='auto';image.runtimeStyle.height='auto';var w=image.width;var h=image.height;image.runtimeStyle.width=oldRuntimeWidth;image.runtimeStyle.height=oldRuntimeHeight;if(arguments.length==3){dx=arguments[1];dy=arguments[2];sx=sy=0;sw=dw=w;sh=dh=h;}else if(arguments.length==5){dx=arguments[1];dy=arguments[2];dw=arguments[3];dh=arguments[4];sx=sy=0;sw=w;sh=h;}else if(arguments.length==9){sx=arguments[1];sy=arguments[2];sw=arguments[3];sh=arguments[4];dx=arguments[5];dy=arguments[6];dw=arguments[7];dh=arguments[8];}else{throw Error('Invalid number of arguments');}
var d=this.getCoords_(dx,dy);var w2=sw/2;var h2=sh/2;var vmlStr=[];var W=10;var H=10;vmlStr.push(' <g_vml_:group',' coordsize="',Z*W,',',Z*H,'"',' coordorigin="0,0"',' style="width:',W,'px;height:',H,'px;position:absolute;');if(this.m_[0][0]!=1||this.m_[0][1]){var filter=[];filter.push('M11=',this.m_[0][0],',','M12=',this.m_[1][0],',','M21=',this.m_[0][1],',','M22=',this.m_[1][1],',','Dx=',mr(d.x/Z),',','Dy=',mr(d.y/Z),'');var max=d;var c2=this.getCoords_(dx+dw,dy);var c3=this.getCoords_(dx,dy+dh);var c4=this.getCoords_(dx+dw,dy+dh);max.x=m.max(max.x,c2.x,c3.x,c4.x);max.y=m.max(max.y,c2.y,c3.y,c4.y);vmlStr.push('padding:0 ',mr(max.x/Z),'px ',mr(max.y/Z),'px 0;filter:progid:DXImageTransform.Microsoft.Matrix(',filter.join(''),", sizingmethod='clip');")}else{vmlStr.push('top:',mr(d.y/Z),'px;left:',mr(d.x/Z),'px;');}
vmlStr.push(' ">','<g_vml_:image src="',image.src,'"',' style="width:',Z*dw,'px;',' height:',Z*dh,'px;"',' cropleft="',sx/w,'"',' croptop="',sy/h,'"',' cropright="',(w-sx-sw)/w,'"',' cropbottom="',(h-sy-sh)/h,'"',' />','</g_vml_:group>');this.element_.insertAdjacentHTML('BeforeEnd',vmlStr.join(''));};contextPrototype.stroke=function(aFill){var lineStr=[];var lineOpen=false;var a=processStyle(aFill?this.fillStyle:this.strokeStyle);var color=a.color;var opacity=a.alpha*this.globalAlpha;var W=10;var H=10;lineStr.push('<g_vml_:shape',' filled="',!!aFill,'"',' style="position:absolute;width:',W,'px;height:',H,'px;"',' coordorigin="0 0" coordsize="',Z*W,' ',Z*H,'"',' stroked="',!aFill,'"',' path="');var newSeq=false;var min={x:null,y:null};var max={x:null,y:null};for(var i=0;i<this.currentPath_.length;i++){var p=this.currentPath_[i];var c;switch(p.type){case'moveTo':c=p;lineStr.push(' m ',mr(p.x),',',mr(p.y));break;case'lineTo':lineStr.push(' l ',mr(p.x),',',mr(p.y));break;case'close':lineStr.push(' x ');p=null;break;case'bezierCurveTo':lineStr.push(' c ',mr(p.cp1x),',',mr(p.cp1y),',',mr(p.cp2x),',',mr(p.cp2y),',',mr(p.x),',',mr(p.y));break;case'at':case'wa':lineStr.push(' ',p.type,' ',mr(p.x-this.arcScaleX_*p.radius),',',mr(p.y-this.arcScaleY_*p.radius),' ',mr(p.x+this.arcScaleX_*p.radius),',',mr(p.y+this.arcScaleY_*p.radius),' ',mr(p.xStart),',',mr(p.yStart),' ',mr(p.xEnd),',',mr(p.yEnd));break;}
if(p){if(min.x==null||p.x<min.x){min.x=p.x;}
if(max.x==null||p.x>max.x){max.x=p.x;}
if(min.y==null||p.y<min.y){min.y=p.y;}
if(max.y==null||p.y>max.y){max.y=p.y;}}}
lineStr.push(' ">');if(!aFill){var lineWidth=this.lineScale_*this.lineWidth;if(lineWidth<1){opacity*=lineWidth;}
lineStr.push('<g_vml_:stroke',' opacity="',opacity,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',processLineCap(this.lineCap),'"',' weight="',lineWidth,'px"',' color="',color,'" />');}else if(typeof this.fillStyle=='object'){var fillStyle=this.fillStyle;var angle=0;var focus={x:0,y:0};var shift=0;var expansion=1;if(fillStyle.type_=='gradient'){var x0=fillStyle.x0_/this.arcScaleX_;var y0=fillStyle.y0_/this.arcScaleY_;var x1=fillStyle.x1_/this.arcScaleX_;var y1=fillStyle.y1_/this.arcScaleY_;var p0=this.getCoords_(x0,y0);var p1=this.getCoords_(x1,y1);var dx=p1.x-p0.x;var dy=p1.y-p0.y;angle=Math.atan2(dx,dy)*180/Math.PI;if(angle<0){angle+=360;}
if(angle<1e-6){angle=0;}}else{var p0=this.getCoords_(fillStyle.x0_,fillStyle.y0_);var width=max.x-min.x;var height=max.y-min.y;focus={x:(p0.x-min.x)/width,y:(p0.y-min.y)/height};width/=this.arcScaleX_*Z;height/=this.arcScaleY_*Z;var dimension=m.max(width,height);shift=2*fillStyle.r0_/dimension;expansion=2*fillStyle.r1_/dimension-shift;}
var stops=fillStyle.colors_;stops.sort(function(cs1,cs2){return cs1.offset-cs2.offset;});var length=stops.length;var color1=stops[0].color;var color2=stops[length-1].color;var opacity1=stops[0].alpha*this.globalAlpha;var opacity2=stops[length-1].alpha*this.globalAlpha;var colors=[];for(var i=0;i<length;i++){var stop=stops[i];colors.push(stop.offset*expansion+shift+' '+stop.color);}
lineStr.push('<g_vml_:fill type="',fillStyle.type_,'"',' method="none" focus="100%"',' color="',color1,'"',' color2="',color2,'"',' colors="',colors.join(','),'"',' opacity="',opacity2,'"',' g_o_:opacity2="',opacity1,'"',' angle="',angle,'"',' focusposition="',focus.x,',',focus.y,'" />');}else{lineStr.push('<g_vml_:fill color="',color,'" opacity="',opacity,'" />');}
lineStr.push('</g_vml_:shape>');this.element_.insertAdjacentHTML('beforeEnd',lineStr.join(''));};contextPrototype.fill=function(){this.stroke(true);}
contextPrototype.closePath=function(){this.currentPath_.push({type:'close'});};contextPrototype.getCoords_=function(aX,aY){var m=this.m_;return{x:Z*(aX*m[0][0]+aY*m[1][0]+m[2][0])-Z2,y:Z*(aX*m[0][1]+aY*m[1][1]+m[2][1])-Z2}};contextPrototype.save=function(){var o={};copyState(this,o);this.aStack_.push(o);this.mStack_.push(this.m_);this.m_=matrixMultiply(createMatrixIdentity(),this.m_);};contextPrototype.restore=function(){copyState(this.aStack_.pop(),this);this.m_=this.mStack_.pop();};contextPrototype.translate=function(aX,aY){var m1=[[1,0,0],[0,1,0],[aX,aY,1]];this.m_=matrixMultiply(m1,this.m_);};contextPrototype.rotate=function(aRot){var c=mc(aRot);var s=ms(aRot);var m1=[[c,s,0],[-s,c,0],[0,0,1]];this.m_=matrixMultiply(m1,this.m_);};contextPrototype.scale=function(aX,aY){this.arcScaleX_*=aX;this.arcScaleY_*=aY;var m1=[[aX,0,0],[0,aY,0],[0,0,1]];var m=this.m_=matrixMultiply(m1,this.m_);var det=m[0][0]*m[1][1]-m[0][1]*m[1][0];this.lineScale_=sqrt(abs(det));};contextPrototype.clip=function(){};contextPrototype.arcTo=function(){};contextPrototype.createPattern=function(){return new CanvasPattern_;};function CanvasGradient_(aType){this.type_=aType;this.x0_=0;this.y0_=0;this.r0_=0;this.x1_=0;this.y1_=0;this.r1_=0;this.colors_=[];}
CanvasGradient_.prototype.addColorStop=function(aOffset,aColor){aColor=processStyle(aColor);this.colors_.push({offset:aOffset,color:aColor.color,alpha:aColor.alpha});};function CanvasPattern_(){}
G_vmlCanvasManager=G_vmlCanvasManager_;CanvasRenderingContext2D=CanvasRenderingContext2D_;CanvasGradient=CanvasGradient_;CanvasPattern=CanvasPattern_;})();}
dojo.provide("dj.module.marketdata.marketwatch");var BlueGrass={};if(typeof(MarketWatch)=="undefined")
var MarketWatch=new(function(){this.Sample={area:"sample"};this.Section={area:"section"};this.Investing={area:"investing"};this.Story={area:"story"};this.News={area:"news"};this.Community={area:"community"};this.Community.InstrumentPicker={area:"community"};this.Community.TopPickers={area:"community"};this.Community.PickerAccordian={area:"community"};this.Community.CommenterGrid={area:"community"};this.Community.FilteredCommentTabs={area:"community"};this.Search={area:"search"};this.MarketState={component:"marketstate"};this.Member={component:"member"};this.DockingBar={component:"dockingbar"};this.DockingBar.Community={component:"dockingbar"};this.DockingBar.Community.Groups={component:"dockingbar"};this.DockingBar.Portfolio={component:"dockingbar"};this.DayParting={component:"dayparting"};this.MarketsNews={component:"marketsnews"};this.Panels={component:"panels"};this.Kiosk={component:"kiosk"};this.BreakingNews={component:"breakingnews"};this.MultiQuote={component:"multiquote"};this.Investing.AdvancedCharts={area:"investing"};this.Investing.AdvancedCharts.Cookie={area:"investing"};this.UI={component:"ui"};this.FishHawk={component:"fishhawk"};this.Video={component:"video"};this.Investing.MutualFunds={area:"investing"};var _baseUrl="";this.setBaseUrl=function(url){_baseUrl=url;};this.getBaseUrl=function(){return _baseUrl;};})();if(typeof(string)=="undefined"){var string=(new function(){return{IsNullOrEmpty:function(theString){return(typeof(theString)=="undefined"||!theString||theString.length==0);}}}());}
else{string.IsNullOrEmpty=function(theString){return(typeof(theString)=="undefined"||!theString||theString.length==0);}}
String.prototype.IndexOf=function(val){return this.indexOf(val);}
String.prototype.Substring=function(start){return this.substring(start);}
var Html=new(function(){var thunk=this;var _headlineModelLink=function(text,object,options){var area=options.area||options.Area||"story";var controller=options.controller||options.Controller||"story";var action=null;var guid=object.DocGuid;var attr=null;var queryString="guid="+object.DocGuid.Value;text=object.HeadlineText;if(options&&typeof(options.MaxLength)=="number")
text=text.substring(0,options.MaxLength);if(typeof(object.ContentType)=="number")
object.ContentType=_getContentType(object.ContentType);if(object.ContentType=="headline"){if(typeof(options.LinkDocType90)=="undefined"||options.LinkDocType90==null||options.LinkDocType90==true){if(object.Instruments&&object.Instruments.length>0&&object.Instruments[0].Ticker){if(typeof(options.LinkTickerAsHeadline)!="undefined"&&options.LinkTickerAsHeadline){return _instrumentModelLink(text,object.Instruments[0],{});}
return"["+_instrumentModelLink(object.Instruments[0].Ticker,object.Instruments[0],{})+"] "+text;}}
return text;}
else if(object.ContentType=="nofollow"){attr='rel="nofollow"';}
if(object.SeoHeadlineFragment&&object.SeoHeadlineFragment.length>0){controller=null;action=object.SeoHeadlineFragment.substr(1);queryString=null;}
return thunk.ActionLink(text,area,controller,action,queryString,attr);};var _instrumentModelLink=function(text,object,options){var area=options.area||options.Area||"investing";var controller=options.controller||options.Controller||"stock";if(!object.Ticker)
return;if(object.Type)
controller=_getInstrumentType(object.Type);if(!text||text.length==0)
text=object.Ticker
var area="investing";var action=object.Ticker+"/overview";var queryString="";if(object.CountryCode&&object.CountryCode.toLowerCase()!="us")
queryString="countrycode="+object.CountryCode;return thunk.ActionLink(text,area,controller,action,queryString,null);};var _getContentType=function(type){switch(type){case 1:return"story";case 2:return"audio";case 3:return"video";case 4:return"nofollow";case 5:return"headline";}
return"story";};var _getInstrumentType=function(instrumentType){if(typeof(instrumentType)=="number"){switch(instrumentType){case 0:return"bond";case 2:return"currency";case 1:case 3:case 4:case 7:return"fund";case 5:return"future";case 6:return"index";case 8:case 9:case 10:return"option";}}
else if(instrumentType=="bond"||instrumentType=="currency"||instrumentType=="fund"||instrumentType=="future"||instrumentType=="index"||instrumentType=="option")
return instrumentType;return"stock";}
this.ModelLink=function(textOrObject,objectOrOptions,options){var text=textOrObject;var object=objectOrOptions;if(typeof(textOrObject)!="string"){text="";object=textOrObject;options=objectOrOptions;}
if(!options)options={};if(object.HeadlineText){return _headlineModelLink(text,object,options);}
else if(object.Ticker){return _instrumentModelLink(text,object,options);}};this.ActionLink=function(text,area,controller,action,queryString,attr){var link='<a '+(attr?attr:'')+' href="'+MarketWatch.getBaseUrl()+'/'+area+(controller?'/'+controller:'')+(action?'/'+action:'')+(queryString?'?'+queryString:'')+'">'+text+'</a>';return link;};this.GetShortDateStampMarkup=function(utcTimestamp,offset){if(typeof(BlueGrass)!="undefined"&&BlueGrass.Utility){var date=BlueGrass.Utility.convertToExchangeTime(utcTimestamp,offset);var now=new Date();var diff=now.getTime()-date.getTime();if(diff>86400000||now.getUTCDate()!=date.getUTCDate())
return"<span>"+date.dateFormat("m/d")+"</span>";var formatted=date.dateFormat("g:ia");return"<span>"+formatted.substring(0,formatted.length-1)+"</span>";}
return"<span>&nbsp;</span>";};this.GetTimeAgoMarkup=function(utcTimestamp,offset){if(typeof(BlueGrass)!="undefined"&&BlueGrass.Utility){var date=BlueGrass.Utility.convertToExchangeTime(utcTimestamp,offset);var now=new Date();var nowUtc=new Date().getTime();var easternNow=BlueGrass.Utility.convertToExchangeTime(nowUtc+"",offset);var diff=easternNow.getTime()-date.getTime();var formatted=date.dateFormat("g:ia Today");if(diff>86400000||now.getUTCDate()!=date.getUTCDate())
return"<span>"+date.dateFormat("g:ia n/d/y")+"</span>";else if(diff<=3600000){var ceiling=Math.ceil(diff/60000);if(ceiling==0)
formatted="< 1 min ago"
else
formatted=ceiling+" min ago";}
return"<span class='timeAgo'><span>"+formatted+"</span>"+"<span class='invisible'>"+date.dateFormat("g:ia n/d/y")+"</span></span>";}
return"<span>&nbsp;</span>";};this.GetShortTimeAgoMarkup=function(utcTimestamp,offset){if(typeof(BlueGrass)!="undefined"&&BlueGrass.Utility){var date=BlueGrass.Utility.convertToExchangeTime(utcTimestamp,offset);var now=new Date();var nowUtc=new Date().getTime();var easternNow=BlueGrass.Utility.convertToExchangeTime(nowUtc+"",offset);var diff=easternNow.getTime()-date.getTime();var formatted=date.dateFormat("g:ia");if(easternNow.getDay()!=date.getDay())
return"<span>"+date.dateFormat("n/d/y")+"</span>";else if(diff<=3600000){var ceiling=Math.ceil(diff/60000);if(ceiling==0)
formatted="< 1 min ago"
else
formatted=ceiling+" min ago";}
return"<span class='timeAgo short'><span>"+formatted+"</span>"+"<span class='invisible'>"+date.dateFormat("g:ia n/d/y")+"</span></span>";}
return"<span>&nbsp;</span>";};})();dojo.provide("dj.module.marketdata.thunderball");var Thunderball={ChartScalingV2:{CalculateDelta2:function(preferredDivisionCount,preferMoreDivisions,allowNoGap,dMin,dMax,dStart,dFinish){if(!dMin){dMin=0;}
if(!dMax){dMax=1;}
if(preferredDivisionCount<=1||preferredDivisionCount==null||preferredDivisionCount==undefined){dStart.value=dMin;dFinish.value=dMax;return dMax-dMin;}
if(dMax<dMin){var Tmp=dMin;dMin=dMax;dMax=Tmp;}
var dMax=Math.abs(dMax);if(dMax==0)dMax=1;var Tol=5.0e-6;if((dMax-dMin)/dMax<=Tol){if(dMax<0)
dMax=0;else if(dMax==0)
dMax=1;else
dMin=0;}
var dGears=[10,5,2.5,2,1];var dBestDifference=-1;var dBestLineCount=-1;var dBestMax=0;var dBestMin=0;var dBestDelta=0;var dRange=dMax-dMin;var dRangeDivision=dRange/preferredDivisionCount;Math.log10=function(n){return this.log(n)/this.log(10);}
var dDivisionMagnitude=Math.log10(dRangeDivision);var nDivisionMultiplier=parseInt(Math.floor(dDivisionMagnitude));for(var nMagAdditive=1;nMagAdditive>-2;nMagAdditive--){for(var i=0;i<dGears.length;i++){var dTmpDelta=dGears[i]*Math.pow(10,nDivisionMultiplier+nMagAdditive);var dTmpMax=Thunderball.ChartScalingV2.Math.RoundUpToMultiple(dMax,dTmpDelta,allowNoGap);var dTmpMin=Thunderball.ChartScalingV2.Math.RoundDownToMultiple(dMin,dTmpDelta,allowNoGap);var dLineCount=Math.round((dTmpMax-dTmpMin)/dTmpDelta)+1;var dDiff=Math.abs(preferredDivisionCount-dLineCount);if((dBestDifference==-1)||(dDiff<=dBestDifference)){if(preferMoreDivisions||(dLineCount<=preferredDivisionCount)){dBestDifference=dDiff;dBestLineCount=dLineCount;dBestMax=dTmpMax;dBestMin=dTmpMin;dBestDelta=dTmpDelta;}}}}
dFinish.value=dBestMax;dStart.value=dBestMin;return dBestDelta;},Math:{RoundUpToMultiple:function(val,multiple,inclusive){var dRemainder=Math.abs(val%multiple);if((dRemainder==0)&&inclusive)
return val;if(val>0)
return val+(multiple-dRemainder);else
return val+dRemainder;},RoundDownToMultiple:function(val,multiple,inclusive){var dRemainder=Math.abs(val%multiple);if((dRemainder==0)&&inclusive)
return val;if(val>0)
return val-dRemainder;else
return val-(multiple-dRemainder);}}},Utilities:{canvas_compatible:false,Requesters:[],check_canvas:function(){try{this.canvas_compatible=!!(document.createElement('canvas').getContext('2d'));}catch(e){this.canvas_compatible=!!(document.createElement('canvas').getContext);}
return this.canvas_compatible;},DataUpdater:function(data){for(var i=0;i<Thunderball.Utilities.Requesters.length;i++){if(Thunderball.Utilities.Requesters[i].requestId==data.requestId){Thunderball.Utilities.Requesters[i].data=data;Thunderball.Utilities.Requesters[i]._didLoad();Thunderball.Utilities.Requesters.splice(i,1);}}},GetData:function(chart){var requestObject=chart.buildRequest();$.ajax({type:"POST",url:chart.url,dataType:"json",data:requestObject,success:function(data){if(data!=null&&data.length>0){var chartdata=data[0].Value;chartdata.requestId=chart.requestId;Thunderball.Utilities.DataUpdater(chartdata);data=null;}}});requestObject=null;},FormatDate:function(dateString){if(typeof dateString=="string"){var converted=0;if(dateString.indexOf("-")>=0||dateString.indexOf("+")>=0){var _userOffset=new Date().getTimezoneOffset()/60;var temp=dateString.substring(dateString.length-7,dateString.length-2);var offset=parseInt(temp.substring(2))/100;if(temp.substring(0,1)=="-"){offset=-offset;}
converted=parseInt(dateString.substring(6,dateString.length-7))+((_userOffset+offset)*3600000);}
else{converted=parseInt(dateString.substring(6,dateString.length-2));}
var dateTime=new Date(converted);return dateTime;}
else{return dateString;}},drawXaxisLines:function(chart){if(chart.style.verticalGridLineStyle){var ctx=chart.drawingContext;chart._bump=true;ctx.beginPath();var ticks=chart._timeLines;for(var i=0;i<ticks.length;i++){var x=ticks[i];ctx.moveTo(x+0.5,chart.height);ctx.lineTo(x+0.5,0);}
ctx.strokeStyle=chart.style.verticalGridLineStyle;ctx.stroke();}
if(chart.style.verticalGridLineStyle_Opaque){var ctx=chart.drawingContext;chart._bump=true;ctx.beginPath();var ticks=chart._opaqueTimeLines;for(var i=0;i<ticks.length;i++){var x=ticks[i];ctx.moveTo(x+0.5,chart.height);ctx.lineTo(x+0.5,0);}
ctx.strokeStyle=chart.style.verticalGridLineStyle_Opaque;ctx.stroke();}
chart._timeLines=[];chart._opaqueTimeLines=[];},addXAxisLabels:function(chart){var labelsToCreate=chart._xAxisLabels;var self=chart;var target=self.targetSelector;var TotalHeight=self.height;var XAxisContent="";var elmWidth=30;var elmWidthCenter;if(!self.style.xAxisLabelPadding){self.style.xAxisLabelPadding=20;}
XAxisContent="<div style='position:relative width:"+self.width+"px;'>";for(var i=0;i<labelsToCreate.length;i++){elmWidthCenter=labelsToCreate[i].x-(elmWidth/2);XAxisContent=XAxisContent+"<div style='text-align:center; position: absolute; top:"+TotalHeight+"px;left:"+elmWidthCenter+"px;width:"+elmWidth+"px' class='xValueLbl'>"+labelsToCreate[i].element+"</div>";}
XAxisContent=XAxisContent+"</div>";_djl.place(XAxisContent,target);},addTick:function(Data,Symbol,Timestamp,Price,Offset){var Sessions=Thunderball.Utilities._getSessionByTicker(Data,Symbol);if(Sessions!=null){var timestamp=BlueGrass.Utility.convertToExchangeTime(Timestamp,Offset);var where=Thunderball.Utilities._findXSession(Sessions,timestamp,Data.BarFactor);if(where&&where.x){where.Session.Trades[where.x]=Price;if(where.Session.Trades.length-2==where.x){where.Session.Trades[where.x+1]=null;}
if(where.Session.Low&&where.Session.Low.Price>Price){where.Session.Low.Price=Price;where.Session.Low.Index=where.x;}
if(where.Session.High&&where.Session.High.Price<Price){where.Session.High.Price=Price;where.Session.High.Index=where.x;}
return where;}}
return where;},_findXSession:function(Sessions,Timestamp,BarFactor){Timestamp=new Date(Timestamp);for(var i=0;i<Sessions.length;i++){var Session=Sessions[i];var ten_days=1000*60*60*24*10;if(Session.Stop.getTime()-Session.Start.getTime()<=ten_days){if(Session.Start<=Timestamp&&Timestamp<=Session.Stop){var x=(Timestamp.getTime()-Session.Start.getTime())/BarFactor;return{x:parseInt(x),Session:Session,Historical:false};}}
else{return{x:null,Session:null,Historical:true};}}
return{x:null,Session:null,Historical:false};},_getSessionByTicker:function(ChartData,Symbol){var s=Symbol.toUpperCase();for(var i=0;i<ChartData.Data.length;i++){if(ChartData.Data[i].Key==s){return ChartData.Data[i].Value.Sessions;}}
return null;}}};dojo.provide("dj.module.marketdata.marketdata");dojo.require("dj.widget.panels.PanelsFactory");if(typeof dj.module==="undefined"){dj.module={};}
if(typeof dj.module.marketdata==="undefined"){dj.module.marketdata={};}
var _djl=dj.lang;var _djp=dj.util.Page;dj.module.marketdata.marketDataModule={init:function(conf,passMod){if(_djl.isIE){if(!document.namespaces.g_vml_){document.namespaces.add('g_vml_','urn:schemas-microsoft-com:vml','#default#VML');}
if(!document.namespaces.g_o_){document.namespaces.add('g_o_','urn:schemas-microsoft-com:office:office','#default#VML');}}
var setModValue="";if(passMod==undefined||passMod==""){setModValue="mdc_h_dtabnk";}else
{setModValue=passMod;}
this.configuration={moduleName:"marketDataModule",defaultSymbols:[{tab:"mymarkets",symbols:["DJI","NCM","SPX","GDOW","FST","NIKKE"]},{tab:"us",symbols:["DJI","NCM","SPX","DWC","RUT","GDOW"]},{tab:"europe",symbols:["FST","DAX30","PAS","SXXP","GDOW","DJI"]},{tab:"asia",symbols:["HKS","NIKKE","SHCOMP","BSESN","GDOW","DJI"]},{tab:"currencyrates",symbols:["EUR","JPY","GBP","USTYN"]}],defaultTab:1,refreshModule:true,refreshRate:60,moduleContainer:"marketDataContainer",tabs:[],tableDataURL:"/public/resources/live/2_3001_HP_JSON.js",chartDataURL:"/internal/marketData.json",personalizedSymbolsURL:"/pznusersvc/view/getUser/indexes/userName",indexLinkURL:"/mdc/public/npage/2_3051.html?mod="+setModValue+"&symb=",chartContainer:"marketDataChart_",dataContainer:"marketDataTable_",chartWidth:80,chartHeight:95,frequency:"1mi",time:"1dy",showMyMarkets:true,myMarketSymbols:[],symbolMapping:[{"Key":"DJI","mws":"INDU","country":"US"},{"Key":"NCM","mws":"COMP","country":"US"},{"Key":"SPX","mws":"SPX","country":"US"},{"Key":"GDOW","mws":"GDOW","country":"US"},{"Key":"RUT","mws":"RUT","country":"US"},{"Key":"DWC","mws":"DWC","country":"US"},{"Key":"FST","mws":"UKX","country":"UK"},{"Key":"NIKKE","mws":"NI225","country":"JP"},{"Key":"DAX30","mws":"DAX","country":"DX"},{"Key":"PAS","mws":"PX1","country":"FR"},{"Key":"SX5P","mws":"SX5P","country":"ST"},{"Key":"SXXP","mws":"SXXP","country":"ST"},{"Key":"HKS","mws":"HSI","country":"HK"},{"Key":"DJSH","mws":"DJSH","country":"CN"},{"Key":"BSESN","mws":"BSESN","country":"XX"},{"Key":"US1YN","mws":"UST1YR","country":"US"},{"Key":"US2YN","mws":"UST2YR","country":"US"},{"Key":"US5YN","mws":"UST5YR","country":"US"},{"Key":"USTYN","mws":"UST10Y","country":"US"},{"Key":"US30B","mws":"UST30Y","country":"US"},{"Key":"KLCOMP","mws":"1807307","country":"MY"},{"Key":"EUR","mws":"CUR_EURUSD","country":"US"},{"Key":"JPY","mws":"CUR_USDYEN","country":"US"},{"Key":"GBP","mws":"CUR_GBPUSD","country":"US"},{"Key":"AORD","mws":"XAO","country":"AU"},{"Key":"MSH","mws":"MSH","country":"US"},{"Key":"AEX","mws":"AAEX","country":"NL"},{"Key":"B400","mws":"B400","country":"US"},{"Key":"BEL20","mws":"BEL20","country":"XX"},{"Key":"BVSP","mws":"BVSP","country":"XX"},{"Key":"GSPTSE","mws":"ISPTX","country":"CA"},{"Key":"VIX","mws":"VIX","country":"US"},{"Key":"DJUSBT","mws":"1522956","country":"XX"},{"Key":"DW25","mws":"DW25","country":"US"},{"Key":"DJUSBC","mws":"1522967","country":"XX"},{"Key":"SX5E","mws":"SX5E","country":"ST"},{"Key":"DJUSHP","mws":"1522752","country":"XX"},{"Key":"MYDOW","mws":"1524725","country":"XX"},{"Key":"DJUSAV","mws":"1522901","country":"XX"},{"Key":"DJUSPR","mws":"1523216","country":"XX"},{"Key":"DJUSBPB","mws":"1523335","country":"XX"},{"Key":"SGDOW","mws":"1524781","country":"XX"},{"Key":"DJUBS","mws":"DJUBS","country":"US"},{"Key":"DWCOGS","mws":"DWCOGS","country":"US"},{"Key":"FOX50","mws":"FOX50","country":"US"},{"Key":"ALLSHR","mws":"J203","country":"XX"},{"Key":"JKCOMP","mws":"JKSE","country":"XX"},{"Key":"SPMIB","mws":"FTSEMIB","country":"XX"},{"Key":"RIXF","mws":"NDX","country":"US"},{"Key":"PSE","mws":"PSE.X","country":"US"},{"Key":"NNYA","mws":"NYA","country":"US"},{"Key":"OSEAX","mws":"OSEAX","country":"XX"},{"Key":"GSPASX","mws":"1867453","country":"AU"},{"Key":"SEU","mws":"KS11","country":"XX"},{"Key":"SHCOMP","mws":"SHCOMP","country":"CN"},{"Key":"IBEX35","mws":"IBEX","country":"XX"},{"Key":"SWEDI","mws":"SAX","country":"XX"},{"Key":"TAI","mws":"TWII","country":"XX"},{"Key":"SMI","mws":"SMI","country":"XX"}]};_djl.mixin(this.configuration,conf);this.timer="";this.chartData="";this.tableData="";this.panelData=[];this.panels=this.createPanels(this.configuration.moduleContainer);this.helpInfo=_djl.byId("helpInfo");this.footerBox=_djl.byId("footerBox");this.timeStamp=_djl.byId("mdm_timestamp");if(this.configuration.showMyMarkets){this.getPersonalizedSymbols();}
this.chartDataReady=false;this.tableDataReady=false;this.getChartData();this.addEvents();this.initializeNewsTicker();if(this.configuration.refreshModule){_djp.enableModuleRefresh(this.configuration.moduleName);this.setRefresh(this.configuration.refreshRate);}},initializeNewsTicker:function(){if(dojo.byId("newsTickerDiv")){dj.widget.panels.PanelsFactory.create("newsTickerDiv",{core:{panelIncrement:1},carousel:{type:"circular"},rotator:{rotateTime:0,rotateIterations:10}});}},setRefresh:function(refreshRate){var that=this;that.timer=setInterval(function(){if(_djp.isModuleRefreshEnabled(that.configuration.moduleName)){that.getChartData();console.log("Refreshed Market Data");}},refreshRate*1000);},addEvents:function(){var that=this;_djl.addLiveEvent(".mdRow","mouseover",function(ev){var target=(ev.srcElement||ev.target);while(target.tagName!="li"&&target.tagName!="LI"){target=target.parentNode;}
_djl.stopEvent(ev);var params=target.id.split("~");that.setRowSelected(target,params[0]);that.renderChartWithContainerAndSymbol(that.configuration.chartContainer+params[0],params[1],params[2]);that.timeStamp.innerHTML=params[3];},that);_djl.addLiveEvent(".btn_help","click",function(ev){_djl.stopEvent(ev);_djl.addClassName(that.footerBox,"mdmLegend-expanded");});_djl.addLiveEvent(".btn_close","click",function(ev){_djl.stopEvent(ev);_djl.removeClassName(that.footerBox,"mdmLegend-expanded");});},setRowSelected:function(target,container){var that=this;var tabs=_djl.query("#"+that.configuration.dataContainer+container+" .mdRow");for(var i=tabs.length-1;i>=0;i--){_djl.removeClassName(tabs[i],"mdRow-selected");}
_djl.addClassName(target,"mdRow-selected");},buildMyMarketSymbols:function(data){var that=this;if(!data.indexes){return;}
for(var i=0;i<data.indexes.length;i++){that.configuration.myMarketSymbols[i]=data.indexes[i].id;}
if(that.configuration.myMarketSymbols.length>0){that.configuration.defaultSymbols[0].symbols=that.configuration.myMarketSymbols;}},wsjToMWSymbol:function(symbol){var that=this;try{var symbolSize=that.configuration.symbolMapping.length;for(var i=0;i<symbolSize;i++){var map=that.configuration.symbolMapping[i];if(symbol==map.Key){return map.country+":"+map.mws;}}}catch(e){console.log(e);}
return symbol;},getPersonalizedSymbols:function(){var that=this;_djl.xhrGet({url:that.configuration.personalizedSymbolsURL,handleAs:"json",preventCache:true,headers:{"Accept":"application/json"},loaddisabled:function(response,ioArgs){that.buildMyMarketSymbols(response);return response;},error:function(response,ioArgs){return response;}});},getChartData:function(){var that=this;_djl.xhrGet({url:that.configuration.chartDataURL,handleAs:"json",preventCache:true,loaddisabled:function(response,ioArgs){that.chartData=response;that.chartDataReady=true;that.getTableData();return response;},error:function(response,ioArgs){that.chartDataReady=false;return response;}});},getTableData:function(){var that=this;_djl.xhrGet({url:that.configuration.tableDataURL,handleAs:"text",preventCache:true,loaddisabled:function(response,ioArgs){response=response.substring(0,response.indexOf("<")-1);that.tableData=_djl.fromJson(response);that.tableDataReady=true;that.renderDataTable();that.renderChart();return response;},error:function(response,ioArgs){that.tableDataReady=false;console.log(response);console.log(ioArgs);return response;}});},renderChart:function(){var that=this;var withMyMarkets=0;for(var i=that.configuration.defaultSymbols.length-1;i>=withMyMarkets;i--){var symbol=that.configuration.defaultSymbols[i].symbols[0];that.renderChartWithContainerAndSymbol(that.configuration.chartContainer+
that.configuration.defaultSymbols[i].tab,that.wsjToMWSymbol(symbol),symbol);}},renderChartWithContainerAndSymbol:function(container,symbol,simId){var that=this;try{var stockchartChart=new EmbeddedChart(container,WSJIndexChartStyle,that.configuration.chartWidth,that.configuration.chartHeight,that.configuration.time,that.configuration.frequency,null,null,that.chartData,symbol,'');var chartExists=stockchartChart.ShowChart();if(!chartExists){that.showNoChartMessage(container,simId);}}catch(exception){console.log(exception);}},showNoChartMessage:function(container,symbol){var that=this;var containerObject=_djl.byId(container);containerObject.innerHTML="<p class=\"msg-chart\">Chart available at <a href=\""+that.configuration.indexLinkURL+symbol+"\">Market Data Center</a></p>";},setLastPointInChart:function(symbol,dataPoint,closeValue){var that=this;dataPoint=parseFloat(dataPoint);closeValue=parseFloat(closeValue);if(that.chartData!==""){for(var i=that.chartData.length-1;i>=0;i--){if(that.chartData[i].Key==symbol){var tradesSize=that.chartData[i].Value.Data[0].Value.Sessions[0].Trades.length;tradesSize=(tradesSize===0)?1:tradesSize;that.chartData[i].Value.Data[0].Value.Sessions[0].Trades[tradesSize]=dataPoint;if(closeValue!==0){that.chartData[i].Value.Data[0].Value.Sessions[0].PreviousClose=closeValue;}
if(dataPoint>that.chartData[i].Value.Data[0].Value.Sessions[0].High.Price){that.chartData[i].Value.Data[0].Value.Sessions[0].High={Index:that.chartData[i].Value.Data[0].Value.Sessions[0].High.Index,Price:dataPoint};}else if(dataPoint<that.chartData[i].Value.Data[0].Value.Sessions[0].Low.Price){that.chartData[i].Value.Data[0].Value.Sessions[0].Low={Index:that.chartData[i].Value.Data[0].Value.Sessions[0].Low.Index,Price:dataPoint};}}}}else{console.log("No Chart Data");}},renderDataTable:function(){var that=this;for(var i=that.tableData.treasuries.length-1;i>=0;i--){that.panelData[that.tableData.treasuries[i].sym]=that.tableData.treasuries[i];}
for(i=that.tableData.indices.length-1;i>=0;i--){that.panelData[that.tableData.indices[i].sym]=that.tableData.indices[i];}
for(var currIndex=that.tableData.currencies.length-1;currIndex>=0;currIndex--){that.panelData[that.tableData.currencies[currIndex].sym]=that.tableData.currencies[currIndex];}
var withMyMarkets=0;var timeStamp="";for(var j=that.configuration.defaultSymbols.length-1;j>=withMyMarkets;j--){var symbolsArray=that.configuration.defaultSymbols[j].symbols;var tableContent="";var firstIndexOnList=true;var priceDP=2;var changeDP=2;var percentDP=2;for(var k=0;k<symbolsArray.length;k++){var dataForIndex=that.panelData[symbolsArray[k]];if(dataForIndex){if(dataForIndex.last!==null&&dataForIndex.last!==undefined){var name=dataForIndex.name.replace(/[\s+\w]+:\s*/g,"");var lastTrade=parseFloat(dataForIndex.last);var difference=0.00;var percentage=0.00;var stateCSS="positive";var hideCSS="";var mwSymbol=that.wsjToMWSymbol(symbolsArray[k]);if(that.configuration.defaultSymbols[j].tab==="currencyrates"&&symbolsArray[k]!=="USTYN"){var pastDay=parseFloat(dataForIndex.pd);difference=lastTrade-pastDay;percentage=(difference/pastDay)*100;that.setLastPointInChart(mwSymbol,lastTrade,dataForIndex.pd);priceDP=4;changeDP=4;percentDP=3;}else{if(symbolsArray[k]==="USTYN"){lastTrade=parseFloat(dataForIndex.yield);difference=parseFloat(dataForIndex.chg);percentage=(difference/dataForIndex.last);priceDP=4;changeDP=4;percentDP=3;}else{difference=parseFloat(dataForIndex.chg);percentage=parseFloat(dataForIndex.pchg);priceDP=2;changeDP=2;percentDP=2;}
that.setLastPointInChart(mwSymbol,lastTrade,0);}
stateCSS=(percentage>=0)?"positive":"negative";percentage=Math.abs(percentage);difference=Math.abs(difference);difference=difference.toFixed(changeDP);percentage=percentage.toFixed(percentDP);lastTrade=lastTrade.toFixed(priceDP);var selectedCSS=(firstIndexOnList)?" mdRow-selected":"";tableContent+="<li class=\"mdRow rowType-"+stateCSS+" "+selectedCSS+"\" id=\""+that.configuration.defaultSymbols[j].tab+"~"+mwSymbol+"~"+dataForIndex.symsid+"~"+dataForIndex.timestamp+"\">";tableContent+="<span class=\"mdData marketName\"><a href=\""+that.configuration.indexLinkURL+dataForIndex.symsid+"\" class=\"md_index\" >"+name+"</a></span>";tableContent+="<span class=\"mdData marketValue\">"+lastTrade+"</span>";if(symbolsArray[k]!="USTYN"){tableContent+="<span class=\"mdData marketDelta\">"+difference+"</span>";tableContent+="<span class=\"mdData marketValue\">"+percentage+"%</span>";}else{tableContent+="<span class=\"mdData\"></span>";tableContent+="<span class=\"mdData\"></span>";}
tableContent+="</li>";if(firstIndexOnList){that.renderChartWithContainerAndSymbol(that.configuration.chartContainer+
that.configuration.defaultSymbols[j].tab,mwSymbol,symbolsArray[k]);timeStamp=dataForIndex.timestamp;firstIndexOnList=false;}}}}
document.getElementById(that.configuration.dataContainer+that.configuration.defaultSymbols[j].tab).innerHTML=tableContent;}
that.timeStamp.innerHTML=timeStamp;},addCommas:function(nStr){nStr+='';var x=nStr.split('.');var x1=x[0];var x2=x.length>1?'.'+x[1]:'';var rgx=/(\d+)(\d{3})/;while(rgx.test(x1)){x1=x1.replace(rgx,'$1'+','+'$2');}
return x1+x2;},createPanels:function(container){var that=this;that.configuration.tabs=["mymarkets","us","europe","asia","currencyrates"];return dj.widget.panels.PanelsFactory.create(container,{core:{panelPrefix:"marketDataPanel_",panels:that.configuration.tabs,enableHistory:false,activePanel:that.configuration.defaultTab},tabs:{tabPrefix:"marketDataTab_",tabOnStyle:"selectedTab",tabOffStyle:"deselected"}});}};dojo.provide("dj.module.marketdata.chart");dojo.require("dj.module.marketdata.thunderball");dojo.require("dj.module.marketdata.marketwatch");var WSJIndexChartStyle={background:"#ffffff",border:"#E6E2D7",closelineStyle:"#e36825",horizontalGridLineStyle:"#f4f3f1",highIndicatorStyle:"#093c71",highlowLineStyle:"#015190",lowIndicatorStyle:"#093c71",mainLineStyle:"#557BA0",mainPriceLineFill:"rgba(85,123,160,0.15)",mainPriceLineWidth:1,maxPriceLines:4,verticalGridLineStyle:"rgba(180,201,202,0.5)",verticalGridLineStyle_Opaque:"rgba(180,201,202,1.0)",vPadding:12,YAxisLabelStyle:1,YAxisLabelHeight:12,showDecimals:1,regionStyles:{0:'#cde2e0',1:'#cde2e0',2:'rgba(51,51,51,0.06)'},comparelineStyles:{0:'#cc3333',1:'#3b8dad',2:'#c9932e',3:'#b78383',4:'#8eb3bc',5:'#dbb782'}};function LegacyChart(container,legacyQueryString,width,height){var _chartBox=dojo.byId(container);var _legacyQueryString=legacyQueryString;var _width=width;var _height=height;var _currentsymbol=null;var start=legacyQueryString.indexOf("symb=")+5;var end=legacyQueryString.indexOf("&",start);if(end==-1){_currentsymbol=legacyQueryString.substr(start).toUpperCase();}else{_currentsymbol=legacyQueryString.substr(start,end-start).toUpperCase();}
var _showChart=function(){_chartBox.innerHTML="";_djl.place('<img src="//www.marketwatch.com/charts/big.chart'+_legacyQueryString+'" />',_chartBox);};return{ShowChart:function(symbol){if(symbol!=null&&symbol!=undefined&&_currentsymbol!=symbol.toUpperCase()){_currentsymbol=symbol.toUpperCase();_legacyQueryString=_legacyQueryString.replace(/sid=[^&^\n]*/i,"sid=");if(_currentsymbol.indexOf("US:CRUDE OIL - ELECTRONIC")>-1){_legacyQueryString=_legacyQueryString.replace(/symb=[^&^\n]*/i,"symb=");if(_legacyQueryString.indexOf("sid=")>-1){_legacyQueryString=_legacyQueryString.replace(/sid=[^&^\n]*/i,"sid=3343724");}else{_legacyQueryString=_legacyQueryString+"&sid=3343724";}}else if(_currentsymbol.indexOf("US:FUTURE-US-GOLD")>-1){_legacyQueryString=_legacyQueryString.replace(/symb=[^&^\n]*/i,"symb=");if(_legacyQueryString.indexOf("sid=")>-1){_legacyQueryString=_legacyQueryString.replace(/sid=[^&^\n]*/i,"sid=1782661");}else{_legacyQueryString=_legacyQueryString+"&sid=1782661";}}else if(_currentsymbol.indexOf("DX:DAX")>-1){_legacyQueryString=_legacyQueryString.replace(/symb=[^&^\n]*/i,"symb=");if(_legacyQueryString.indexOf("sid=")>-1){_legacyQueryString=_legacyQueryString.replace(/sid=[^&^\n]*/i,"sid=125284");}else{_legacyQueryString=_legacyQueryString+"&sid=125284";}}else{_legacyQueryString=_legacyQueryString.replace(/symb=[^&^\n]*/i,"symb="+_currentsymbol);}}
_showChart();},TickSubscribe:function(){},UpdateAllCharts:function(time,freq,startdate,enddate){this.UpdateChart(time,freq,startdate,enddate);},UpdateChart:function(time,freq,startdate,enddate){_legacyQueryString=_legacyQueryString.replace(/freq=[^&^\n]*/i,"freq="+freq);if(time==null||time==undefined){_legacyQueryString=_legacyQueryString.replace(/time=[^&^\n]*/i,"time=");}else{_legacyQueryString=_legacyQueryString.replace(/time=[^&^\n]*/i,"time="+time);}
if(startdate==null||startdate==undefined){_legacyQueryString=_legacyQueryString.replace(/startdate=[^&^\n]*/i,"startdate=");}else{if(_legacyQueryString.indexOf("startdate=")>-1){_legacyQueryString=_legacyQueryString.replace(/startdate=[^&^\n]*/i,"startdate="+startdate);}else{_legacyQueryString=_legacyQueryString+"&startdate="+startdate;}}
if(enddate==null||enddate!=undefined){_legacyQueryString=_legacyQueryString.replace(/enddate=[^&^\n]*/i,"enddate=");}else{if(_legacyQueryString.indexOf("enddate=")>-1){_legacyQueryString=_legacyQueryString.replace(/enddate=[^&^\n]*/i,"enddate="+enddate);}else{_legacyQueryString=_legacyQueryString+"&enddate="+enddate;}}
_showChart();},ChangeSymbol:function(symbol){var symbols=symbol.toUpperCase().split('|');_currentsymbol=symbols[0];_legacyQueryString=_legacyQueryString.replace(/symb=[^&^\n]*/i,"symb="+_currentsymbol);if(symbols.length>1){if(_legacyQueryString.indexOf("compidx=")>-1){_legacyQueryString=_legacyQueryString.replace(/compidx=[^&^\n]*/i,"compidx="+symbols[1]);}else{_legacyQueryString=_legacyQueryString+"&compidx="+symbols[1];}}else{_legacyQueryString=_legacyQueryString.replace(/compidx=[^&^\n]*/i,"compidx=");}
if(symbols.length>2){var comp="";for(var i=2;i<symbols.length;i++){if(comp.length>0){comp=comp+",";}
comp=comp+symbols[i];}
if(_legacyQueryString.indexOf("comp=")>-1){_legacyQueryString=_legacyQueryString.replace(/comp=[^&^\n]*/i,"comp="+comp);}else{_legacyQueryString=_legacyQueryString+"&comp="+comp;}}else{_legacyQueryString=_legacyQueryString.replace(/comp=[^&^\n]*/i,"comp=");}
_showChart();},SetChartRefresh:function(rate){setInterval(_showChart,rate);}}}
function EmbeddedChart(container,style,width,height,time,freq,startdate,enddate,chartdata,symbol){var _chartBox=document.getElementById(container);var _style=style;var _width=width;var _height=height;var _time=time;var _freq=freq;var _startdate=startdate;var _enddate=enddate;var _pagedata=null;var _currentsymbol=null;var _firstsymbol=symbol;var _symbolCount=0;var _chart=null;var _tick=false;var _ticktimeout=null;var _currentchannel=null;var _connection=null;var _url="/Market/ECProxy/ChartData";var _setPageData=function(data){if(data!=null&&data!=undefined&&data.length>0){if(_pagedata==null){_pagedata=[];}
for(var i=0;i<data.length;i++){if(data[i].Value!=null&&data[i].Value!=undefined&&data[i].Key!=''){_pagedata[data[i].Key]=data[i].Value;if(_pagedata[data[i].Key].Data!=null){for(var j=0;j<_pagedata[data[i].Key].Data.length;j++){for(var k=0;k<_pagedata[data[i].Key].Data[j].Value.Sessions.length;k++){var session=_pagedata[data[i].Key].Data[j].Value.Sessions[k];session.Start=new Date(Thunderball.Utilities.FormatDate(session.Start));session.Stop=new Date(Thunderball.Utilities.FormatDate(session.Stop));}}}}}}}
var _showChart=function(symbol){if(_pagedata==null){_chart=new JSChart(_chartBox,symbol.split('|'),_width,_height,_style,_freq,_time,_startdate,_enddate,undefined,MarketWatch.getBaseUrl()+_url);_currentsymbol=symbol;}else{if(symbol!=_currentsymbol){if(_chart!=null){_pagedata[_currentsymbol]=_chart.data;_chart.data=null;_chart=null;}
var symbols=symbol.split('|');_chart=new JSChart(_chartBox,symbols,_width,_height,_style,_freq,_time,_startdate,_enddate,_pagedata[symbol],MarketWatch.getBaseUrl()+_url);_currentsymbol=symbol;_symbolCount=symbols.length;}}}
_setPageData(chartdata);var _refreshPageData=function(){var symbols=[]
for(var symbol in _pagedata){symbols.push(symbol);}
_refreshData(symbols,"mo");}
var _refreshData=function(symbols,cachekey){requestObject={freq:_freq,time:_time,Symbol:symbols,StartDate:_startdate,EndDate:_enddate,Width:_width,Height:_height,CacheKey:cachekey};_djl.rawXhrPost({url:MarketWatch.getBaseUrl()+_url,postData:requestObject,handleAs:"json",loaddisabled:function(response,ioArgs){if(response!=null){_setPageData(response);response=null;if(_chart!=null){_chart.data=_pagedata[_currentsymbol];_chart._didLoad();}}
return response;}});requestObject=null;}
var _reloaddisabledChart=function(){if(_chart!=null){_chart.time=_time;_chart.freq=_freq;_chart.startDate=_startdate;_chart.endDate=_enddate;_chart.reloaddisabled();}}
return{ShowChart:function(symbol){if(symbol===undefined){symbol=_firstsymbol;}
symbol=symbol.toUpperCase();if(symbol!=_currentsymbol){if(_pagedata[symbol]!==null&&_pagedata[symbol]!==undefined){_showChart(symbol);return true;}else{return false;}}},TickSubscribe:function(){if(_chart!=null){_tick=true;var chartSubscribeCallback=function(message){if(_chart!=null&&_chart.data!=null&&_symbolCount==1){for(var symbol in _pagedata){for(var i=0;i<_pagedata[symbol].Data.length;i++){if(_pagedata[symbol].Data[i].Value.BlueGrassChannel!=null&&_pagedata[symbol].Data[i].Value.BlueGrassChannel.toLowerCase()==message.h.t){if(symbol.toUpperCase()===_currentsymbol.toUpperCase()){_chart.addTick(symbol,message.b.z,message.b.l,message.b.e);}
break;}}}}};var chartConnectionCallback=function(connection,type){if(type=="connect"){_connection=connection;if(_pagedata[_currentsymbol]!=null){_currentchannel=_connection.subscribe(_pagedata[_currentsymbol].Data[0].Value.BlueGrassChannel,chartSubscribeCallback);}}};if(_currentchannel!=null){_currentchannel.removeCallback(chartSubscribeCallback);}
if(_connection!=null){if(_pagedata[_currentsymbol]!=null){_currentchannel=_connection.subscribe(_pagedata[_currentsymbol].Data[0].Value.BlueGrassChannel,chartSubscribeCallback);}}else{if(BlueGrass!==null&&BlueGrass.Runtime!==null){BlueGrass.voidConnection({},chartConnectionCallback);}}}},UpdateAllCharts:function(time,freq,startdate,enddate){if(_chart!=null){this.UpdateChart(time,freq,startdate,enddate);setTimeout(_refreshPageData,5);}},UpdateChart:function(time,freq,startdate,enddate){if(_chart!=null){_time=time;_freq=freq;_startdate=startdate;_enddate=enddate;_reloaddisabledChart();}},ChangeSymbol:function(symbol){if(_chart!=null){_currentsymbol=symbol;_chart.setSymbols(symbol.split('|'));_symbolCount=_chart.symbols.length;_reloaddisabledChart();}},SetChartRefresh:function(rate){setInterval(_refreshPageData,rate);}}}
var JSChart=function(targetSelector,symbols,width,height,style,freq,time,startDate,endDate,data,url){this.targetSelector=targetSelector;if(style===undefined){this.style=LargeChartStyle;}else{this.style=style;}
if(url!==undefined){this.url=url;}
this.width=width;this.height=height;this.symbols=symbols;this.selectedSymbol=symbols[0];if(freq===undefined){this.freq="1mi";}else{this.freq=freq;}
if(time===undefined){this.time="1dy";}else{this.time=time;}
if(startDate!==undefined){this.startDate=startDate;}
if(endDate!==undefined){this.endDate=endDate;}
var self=this;if(data===undefined){$(function(){self.reloaddisabled();});}else{self.preloaddisabled(data);}};JSChart.prototype={freq:"1mi",time:"1dy",unit:"Minute",url:"./HistoricChartData.aspx",span:1,step:1,startDate:'',endDate:'',data:null,selectedSymbol:null,width:0,height:0,drawingContext:null,style:null,highPrice:null,highPoint:{"x":null,"y":null},lowPoint:{"x":null,"y":null},lowPrice:null,lastPoint:{"x":null,"y":null},lastPrice:null,closePrice:null,buildRequest:function(){var requestObject;var symbol="";for(var i=0;i<this.symbols.length;i++){if(i>0){symbol+="|";}
symbol+=this.symbols[i];}
requestObject={freq:this.freq,time:this.time,Symbol:symbol,StartDate:this.startDate,EndDate:this.endDate,Width:this.width};return requestObject;},lastTickPrice:0,lastTickChange:0,lastTickX:0,addTick:function(tickSymbol,Timestamp,Price,offSet){var where=Thunderball.Utilities.addTick(this.data,tickSymbol,Timestamp,Price,offSet);if(where.Historical==false){if(where.x==null){return;}else{if(Price!=this.lastTickPrice){this.lastTickChange=Price-this.lastTickPrice;this.lastTickPrice=Price;}else if(where.x==this.lastTickX){return;}
this.lastTickX=where.x;this._didLoad();}}},setSymbols:function(symbols){this.symbols=symbols;this.selectedSymbol=symbols[0];},reloaddisabled:function(){this._resetState();var d=new Date();var requestId=this.symbols[0]+d.getTime();this.requestId=requestId;Thunderball.Utilities.Requesters.push(this);Thunderball.Utilities.GetData(this);},preloaddisabled:function(data){this._resetState();this.data=data;this._didLoad();},_resetState:function(){this.lastTickPrice=this.lastTickChange=this.lastTickX=0;},redraw:function(){this._prepareCanvas();this._clearLabels();var ctx=this.drawingContext;ctx.clearRect(0,0,this.width,this.height);ctx.save();this._drawChartBackground();var Data=Thunderball.Utilities._getSessionByTicker(this.data,this.selectedSymbol);if(Data!=null){for(var i=0;i<Data.length;i++){this._drawRegions(Data[i]);}
if(this.style.type=='Spark'){this._drawSpark(Data[Data.length-1]);}else{this._determineTypeOfChart(Data);this._setHLC(Data);this._fillTrades(Data);this._drawPriceLines();this._createYAxisLabels(this.symbols.length);Thunderball.Utilities.addXAxisLabels(this);Thunderball.Utilities.drawXaxisLines(this);this._drawCloseLines(Data);var st=this.style;if(this.highPoint.y!=this.lowPoint.y){this._priceIndicator(this.highPoint,"",st.highIndicatorStyle,"chartPointer chartPoint-high",false);this._priceIndicator(this.lowPoint,"",st.lowIndicatorStyle,"chartPointer chartPoint-low",false);}
this._priceIndicator(this.lastPoint,"","","lastLbl",true);if(this.symbols.length>1){for(var j=1;j<this.symbols.length;j++){var Session=Thunderball.Utilities._getSessionByTicker(this.data,this.symbols[j]);if(Session!=null){var compareColor='black';if(j<=6){compareColor=this.style.comparelineStyles[j-1];}
this._strokeTrades(Session,compareColor);}}}
this._strokeTrades(Data,this.style.mainLineStyle);this._drawChartBorder();if(this.highPoint.y!=this.lowPoint.y){this._drawHorizontalLine(this.highPoint.y);this._drawHorizontalLine(this.lowPoint.y);}
this.startTime=this.overallStartTime;}}
ctx.restore();},_x:0,_xscale:0,_y:0,_yscale:0,_bump:false,_fillStyle:'black',_padding:0,_events:[],_barFactor:0,_barSize:1,_priceLines:[],_timeLines:[],_opaqueTimeLines:[],_historical:false,_customDateRange:false,_chartUnit:1,_displayUnit:1,_xAxisLabels:[],_findOpaqueGridLines:function(){var xAxisInfo=this._xAxisLabels;var timeLines=this._timeLines;var data=this.data;var opaqueTimeLines=[];this._opaqueTimeLines=[];if(this._displayUnit===1||this._displayUnit===2){for(var i=0;i<xAxisInfo.length;i++){var patt=/^M$|^T$|^W$|^F$|^S$/;if(xAxisInfo[i].element.match(patt)){opaqueTimeLines.push(xAxisInfo[i].x);}}}else{for(var i=0;i<xAxisInfo.length;i++){var patt=/^\d{2}$/;if(xAxisInfo[i].element.match(patt)&&xAxisInfo[i].x!==(.5*timeLines[0])){opaqueTimeLines.push(xAxisInfo[i].x);}}}
if(opaqueTimeLines.length>0){for(var i=0;i<opaqueTimeLines.length;i++){this._opaqueTimeLines.push(opaqueTimeLines[i]);}}},_didLoad:function(){if(!this.data)
return;if(this.data.Error){var target=this.targetSelector;var errorMessage="<div style='position: absolute; top:0px;left:0px; class='xValueLbl'>Error, the chart cannot be displayed.</div>";if(this.data.Error=="Error: Time"){errorMessage="<div style='position: absolute; top:0px;left:0px; class='xValueLbl'>One or more of the symbols you have chosen does not contain trade data for this time frame. Please choose a longer timeframe.</div>";}
var ctx=this.drawingContext;if(ctx!=null){ctx.clearRect(0,0,this.width,this.height);this._clearLabels();_djl.place(errorMessage,target);}
return;}
var data=this.data.Data;if(data.length>1){var tradesExist=false;for(var i=0;i<data.length;i++){var value=data[i].Value;var sessions=value.Sessions;for(var j=0;j<sessions.length;j++){if(sessions[j].Trades.length>0){tradesExist=true;continue;}}}
if(!tradesExist){var target=this.targetSelector;var errorMessage="<div style='position: absolute; top:0px;left:0px; class='xValueLbl'>One or more of the symbols you have chosen does not contain trade data for this time frame. Please choose a longer timeframe.</div>";var ctx=this.drawingContext;if(ctx!=null){ctx.clearRect(0,0,this.width,this.height);this._clearLabels();_djl.place(errorMessage,target);}
return;}}
this._barFactor=this.data.BarFactor;this._barSize=this.data.BarSize;this._chartUnit=this.data.xAxisLabelInfo.chartUnit;this._displayUnit=this.data.xAxisLabelInfo.displayUnit;this._timeLines=this.data.xAxisLabelsObj.timeLines;this._xAxisLabels=this.data.xAxisLabelsObj.ElementList;if(this._displayUnit===1||this._displayUnit===2||this._displayUnit===3){this._findOpaqueGridLines();}
this._customDateRange=this.data.CustomDateRange;try{for(var j=0;j<this.symbols.length;j++){var Sessions=Thunderball.Utilities._getSessionByTicker(this.data,this.symbols[j]);if(Sessions!=null){if(this.symbols.length>1){this._changeDataToPercentage(Sessions);}
_djl.forEach(Sessions,function(Session,i){if(Session.Trades===undefined){Session.Trades=[];}
if(Session.Events===undefined){Session.Events=[];}
if(Session.News===undefined){Session.News=[];}
if(Session.Weight===undefined){}
if(Session.Start===undefined){}
if(Session.Stop===undefined){}
var sessionStartFormat=Thunderball.Utilities.FormatDate(Session.Start);var sessionStopFormat=Thunderball.Utilities.FormatDate(Session.Stop);Session.Start=new Date(sessionStartFormat);Session.Stop=new Date(sessionStopFormat);});this._layoutSessions(Sessions);}}}catch(e){}
this._autoScale(this.data.Data);this.redraw();},_changeDataToPercentage:function(Sessions){var basePrice=null;for(var k=0;k<Sessions.length;k++){var trades=Sessions[k].Trades;for(var l=0;l<trades.length;l++){if(trades[l]!==null&&basePrice===null){basePrice=trades[l];break;}}
if(basePrice!==null){break;}}
if(basePrice!==null&&basePrice>0){for(var k=0;k<Sessions.length;k++){var trades=Sessions[k].Trades;for(var l=0;l<trades.length;l++){if(trades[l]!==null){trades[l]=100*((trades[l]-basePrice)/basePrice);}}
if(Sessions[k].Low!==null){Sessions[k].Low.Price=100*((Sessions[k].Low.Price-basePrice)/basePrice);}
if(Sessions[k].High!==null){Sessions[k].High.Price=100*((Sessions[k].High.Price-basePrice)/basePrice);}}}},_drawHorizontalLine:function(y){if(this.style.highlowLineStyle){var ctx=this.drawingContext;this._bump=true;ctx.beginPath();ctx.lineWidth=1;ctx.moveTo(0,y+0.5);ctx.lineTo(this.width,y+0.5);ctx.strokeStyle=this.style.highlowLineStyle;ctx.stroke();}},_priceIndicator:function(point,string,style,cssClass,lastPoint){if(point.x===null||point.y===null){return;}
if(lastPoint){if(point.x>this.width-3){point.x=this.width-3;}
var y=point.y-10;var x=point.x-2;if(this.lastTickChange<0){lastPointIcon="<div class='chartDownIndicator'></div>";}else if(this.lastTickChange>0){lastPointIcon="<div class='chartUpIndicator'></div>";}else{lastPointIcon="<div class='chartIndicator'></div>";y=point.y-3;}
return;}else{}},_createYAxisLabels:function(type){if(!this.style.maxPriceLines)
return;var decimalsToShow=2;var YAxisContent="";var displayValue="";var x,y,p;var elmHeight=this.style.YAxisLabelHeight;var excludeLabel=[];if(!this.style.yAxisLabelPadding){this.style.yAxisLabelPadding=2;}
function addCommas(nStr){nStr+='';x=nStr.split('.');x1=x[0];x2=x.length>1?'.'+x[1]:'';var rgx=/(\d+)(\d{3})/;while(rgx.test(x1)){x1=x1.replace(rgx,'$1'+','+'$2');}
return x1+x2;}
function decimalsNeeded(lineNum,range){var Tol=5.0e-6;if(range===0||lineNum===0)
return 0;var maxDecimals=6;var division=range/lineNum;var decimals=0;while(decimals<=maxDecimals){var divtest=division*Math.pow(10,decimals);if(Math.abs(divtest-Math.round(divtest))<Tol)
break;decimals+=(decimals==0)?2:1;}
return decimals;}
if(this._priceLines.length>1){this._priceLines.sort(function(a,b){return a-b});var firstValue=this._priceLines[0];var lastValue=this._priceLines[this._priceLines.length-1];var diffValue=lastValue-firstValue;var totalNumber=this._priceLines.length-1;if(this.style.showDecimals===0){decimalsToShow=0;}else if(this.style.YAxisLabelStyle===1){if(lastValue<10)
decimalsToShow=3;else if(lastValue<100)
decimalsToShow=2;else
decimalsToShow=0;}else{decimalsToShow=decimalsNeeded(totalNumber,diffValue);}}
try{var current=false;for(var i=this._priceLines.length-1;i>=0;i--){var drawLabel=true;p=this._priceLines[i];if(this._priceLines[i]===this.lastPrice){y=(this.ty(p)-(elmHeight/2)-1);}else if(this._priceLines[i]===this.highPrice){y=(this.ty(p)-elmHeight);}else if(this._priceLines[i]===this.lowPrice){y=this.ty(p)-1;}else if(this._priceLines[i]===this.closePrice){y=(this.ty(p)-(elmHeight/2)-1);}else{y=this.ty(p)-(elmHeight/2);}
x=this.style.yAxisLabelPadding+this.width;if(this.style.YAxisLabelStyle===1){for(var j=0;j<this._priceLines.length;j++){if(this._priceLines[i]!=this.lastPrice&&j!=i&&excludeLabel[j]!=1){var cp=this._priceLines[j];if(this._priceLines[j]===this.lastPrice){cy=(this.ty(cp)-(elmHeight/2))-1;}else if(this._priceLines[j]===this.closePrice){cy=(this.ty(cp)-(elmHeight/2))-1;}else if(this._priceLines[j]===this.highPrice){cy=(this.ty(cp)-elmHeight)-1;}else if(this._priceLines[j]===this.lowPrice){cy=this.ty(cp)-1;}else{drawLabel=false;}
if(Math.abs(Math.abs(cy)-Math.abs(y))<elmHeight+1){if(this._priceLines[j]!=this.closePrice){drawLabel=false;excludeLabel[i]=1;}}}}}
if(type>1){displayValue=p.toFixed(decimalsToShow)+"%";}else{displayValue=p.toFixed(decimalsToShow);}
var labelClass="priceLbl";if(this.style.YAxisLabelStyle===1){var width=5;if(this._priceLines[i]===this.lastPrice&&(this._priceLines[i]>=this.closePrice||this.closePrice===null)&&!current){labelClass="chartPointer chartLastPoint chartPoint-pos";current=true;}else if(this._priceLines[i]===this.lastPrice&&this._priceLines[i]<this.closePrice&&!current){labelClass="chartPointer chartLastPoint chartPoint-neg";current=true;}else if(this._priceLines[i]===this.lowPrice){if(this.lowPrice===this.lastPrice&&current){drawLabel=false;}
labelClass="chartPointer chartPoint-low";}else if(this._priceLines[i]===this.highPrice){if(this.highPrice===this.lastPrice&&current){drawLabel=false;}
labelClass="chartPointer chartPoint-high";}else if(this.closePrice&&this._priceLines[i]===this.closePrice){if(this.closePrice===this.lastPrice&&current){drawLabel=false;}
labelClass="chartPointer chartPoint-close";}}
if(drawLabel===true&&this.style.YAxisLabelStyle===1){YAxisContent=YAxisContent+"<div style='position: absolute; top:"+y+"px;left:"+x+"px; ' class='"
+labelClass+"'>"+displayValue+"</div>";}else if(drawLabel===true){YAxisContent=YAxisContent+"<div style='position: absolute; top:"+y+"px;left:"+x+"px; ' class='"
+labelClass+"'>"+displayValue+"</div>"}}}catch(e){}
_djl.place(YAxisContent,this.targetSelector);},_determineTypeOfChart:function(Sessions){if(Sessions.length>=1&&Sessions[0].Regions.length>=1){var numberOfRegions=Sessions[0].Regions.length;if(numberOfRegions==1&&Sessions[0].Regions[0].Type!=4){this._historical=true;}else{this._historical=false;}}},_setHLC:function(Sessions){this.lastPoint.x=null;this.lastPoint.y=null;this.lowPoint.x=null;this.lowPoint.y=null;this.highPoint.x=null;this.highPoint.y=null;var MinMax=this._getMinMax(Sessions,false);var needsBump=false;if(this.data.Data[0].Value.IsIndex===1&&this._barSize===60){needsBump=true;}
if(MinMax.MinPoint!=null||MinMax.Min!=null){this.lowPoint=MinMax.MinPoint;}
if(MinMax.MaxPoint!=null||MinMax.Max!=null){this.highPoint=MinMax.MaxPoint;}
for(var i=0;i<Sessions.length;i++){var Session=Sessions[i];this._setSession(Session);if(Session.Trades&&Session.Trades.length!==0){var lastIndex=Session.Trades.length-1;var price=Session.Trades[lastIndex];if(price){this.lastPoint.y=this.ty(price);if(this._historical){this.lastPoint.x=this.tx(lastIndex/this._barSize);}else{if(needsBump){this.lastPoint.x=this.tx(lastIndex+0.5);}else{this.lastPoint.x=this.tx(lastIndex);}}}else{for(var j=lastIndex;j>=0;j--){price=Session.Trades[j];if(price){this.lastPoint.y=this.ty(price);if(this._historical){this.lastPoint.x=this.tx(j/this._barSize);}else{if(needsBump){this.lastPoint.x=this.tx(j+0.5);}else{this.lastPoint.x=this.tx(lastIndex);}}
break;}}}}}},_drawRoundIndicator:function(color,x,y,circleSize){if(x!==null&&y!==null){var ctx=this.drawingContext;ctx.fillStyle=color;ctx.beginPath();ctx.arc(x,y,3,0,Math.PI*2,true);ctx.fill();ctx.strokeStyle=color;ctx.beginPath();ctx.save();ctx.lineWidth=1.5;ctx.arc(x,y,circleSize,0,Math.PI*2,true);ctx.stroke();ctx.restore();}},_drawRoundDot:function(color,x,y,size){if(x!==null&&y!==null){var ctx=this.drawingContext;ctx.fillStyle=color;ctx.beginPath();ctx.arc(x,y,size,0,Math.PI*2,true);ctx.fill();}},_drawNewsOverlay:function(Sessions){this._bump=false;for(var i=0;i<Sessions.length;i++){this._setSession(Sessions[i]);var news=Sessions[i].News;for(var j=0;j<news.length;j++){var story=news[j];var x=this.tx(story.At);var p;var Trades=Sessions[i].Trades;for(var k=0;k<Trades.length&&k<story.At;k++){if(Trades[k]){p=Trades[k];}}
if(p){var newsLink=$('<a></a>').attr('href',story.Url);var icon=$('<img />').attr('border',0).attr('src',this.style.newsBackground).attr('title',story.Text).appendTo(newsLink);}}}},_drawPriceLines:function(){if(this.style.horizontalGridLineStyle){var ctx=this.drawingContext;this._bump=true;ctx.beginPath();var ticks=this._priceLines;for(var i=0;i<ticks.length;i++){var y=this.ty(ticks[i]);ctx.moveTo(0,y);ctx.lineTo(this.width,y);}
ctx.strokeStyle=this.style.horizontalGridLineStyle;ctx.stroke();}},_drawChartBorder:function(){if(this.style.border){var ctx=this.drawingContext;ctx.beginPath();ctx.strokeStyle=this.style.border;ctx.strokeRect(0,0,this.width,this.height);}},_drawChartBackground:function(){if(this.style.background){var ctx=this.drawingContext;ctx.beginPath();ctx.fillStyle=this.style.background;ctx.fillRect(0,0,this.width,this.height);}},_drawCloseLines:function(Sessions){var ctx=this.drawingContext;this._bump=true;var x=0;ctx.beginPath();for(var i=0;i<Sessions.length;i++){var session=Sessions[i];this._setSession(session);var w=session.SessionWidth;var x2=x+w;if(session.PreviousClose!==undefined&&session.PreviousClose!==null&&(this.symbols.length==1)){var y=this.ty(session.PreviousClose);ctx.moveTo(x,y);ctx.lineTo(x2,y);}
x=x2;}
ctx.strokeStyle=this.style.closelineStyle;ctx.stroke();},_drawRegions:function(session){var ctx=this.drawingContext;this._setSession(session);this._bump=false;for(var i=0;i<session.Regions.length;i++){var Region=session.Regions[i];var Color=this._regionStyles[Region.Type];if(!Color||Color==this.style.background){continue;}
var x1=this.tx(Region.Start);var x2;if(i===0&&this._barSize===60&&(Region.Stop+Region.Start>0)){x2=this.tx(Region.Stop+0.5);}else{x2=this.tx(Region.Stop);}
ctx.fillStyle=Color;ctx.fillRect(x1,0,x2-x1,this.height);}},_buildTradePath:function(Sessions){var ctx=this.drawingContext;var data=this.data;var isIndex=data.Data[0].Value.IsIndex;var first=true;var x=0;var firstx;var prev=null;var last;for(var i=0;i<Sessions.length;i++){var Session=Sessions[i];this._setSession(Session);if(Session.Trades){for(var j=0;j<Session.Trades.length;j++){var price=Session.Trades[j];if(price==null){if(prev==null)
continue;price=prev;}
prev=price;var y=this.ty(price);if(this._historical){x=this.tx(j/this._barSize);}else{if(isIndex===1&&this._barSize===60){x=this.tx(j+0.5);}else{x=this.tx(j);}}
if(first){firstx=x;ctx.moveTo(0,y);ctx.lineTo(firstx,y);first=false;}else{ctx.lineTo(x,y);}}}}
return{firstx:firstx,lastx:x};},_strokeFillTrades:function(Sessions,strokeStyle){var ctx=this.drawingContext;ctx.save();ctx.lineWidth=this.style.mainPriceLineWidth;ctx.strokeStyle=strokeStyle;ctx.beginPath();this._bump=true;var x=this._buildTradePath(Sessions);if(x.lastx!=undefined&&x.firstx!=undefined){ctx.stroke();ctx.lineTo(x.lastx,this.height);ctx.lineTo(0,this.height);ctx.fillStyle=this.style.mainPriceLineFill;ctx.fill();}
ctx.restore();},_strokeTrades:function(Sessions,strokeStyle){var ctx=this.drawingContext;ctx.save();ctx.miterLimit=0;ctx.lineJoin="round";ctx.lineWidth=this.style.mainPriceLineWidth;ctx.strokeStyle=strokeStyle;ctx.beginPath();this._bump=true;var x=this._buildTradePath(Sessions);ctx.stroke();ctx.restore();},_fillTrades:function(Sessions){var ctx=this.drawingContext;ctx.fillStyle=this._fillStyle;ctx.beginPath();this._bump=false;var points=this._buildTradePath(Sessions);if(points.lastx!=undefined&&points.firstx!=undefined){ctx.lineTo(points.lastx,this.height);ctx.lineTo(0,this.height);}
ctx.fill();},_precomputeStyles:function(){if(this.style.gradientFillStyle){this._fillStyle=this._makeStyle(this.style.gradientFillStyle);}
if(this.style.mainPriceLineFill){this._fillStyle=this.style.mainPriceLineFill;}
this._regionStyles={};var styles=this.style.regionStyles;for(var style in styles){this._regionStyles[style]=this._makeStyle(styles[style]);}},_prepareCanvas:function(){if(!this.drawingContext||this.drawingContext===null){var canvasWidth=this.width;var canvasHeight=this.height;this.targetSelector.innerHTML="";if(canvasWidth<=0||canvasHeight<=0){throw"Invalid dimensions - width = "+canvasWidth+", height = "+canvasHeight;}
var canvas=document.createElement('canvas');canvas.setAttribute('width',canvasWidth);canvas.setAttribute('height',canvasHeight);_djl.place(canvas,this.targetSelector);if(!Thunderball.Utilities.check_canvas()){canvas=window.G_vmlCanvasManager.initElement(canvas,canvasWidth,canvasHeight);}
this.drawingContext=canvas.getContext("2d");}
this._precomputeStyles();},orphan:function(node){node.parentNode.removeChild(node);},_clearLabels:function(){var label=dojo.query("#"+this.targetSelector.id+" > div");},_layoutSessions:function(Sessions){var TotalSessionWeight=0;_djl.forEach(Sessions,function(value,index){TotalSessionWeight+=value.Weight;});var x=0;for(var i=0;i<Sessions.length;i++){var Session=Sessions[i];var SessionWidth;SessionWidth=Math.floor(this.width*Session.Weight/TotalSessionWeight);Session.SessionWidth=SessionWidth;Session._x=x;x+=SessionWidth;var SessionStart=Session.Start.getTime();var SessionStop=Session.Stop.getTime();var SessionTime=SessionStop-SessionStart;Session._xscale=SessionWidth*this._barFactor/(SessionTime);}},_autoScale:function(Data){var Min=null;var Max=null;var High=null;var Low=null;var Close=null;var self=this;var chartValueIndicators=this.style.YAxisLabelStyle;_djl.forEach(Data,function(Sessions,i){var includePreviousClose=true;if(self.symbols.length>1||Sessions.Value===undefined||Sessions.Value.Sessions===undefined||Sessions.Value.Sessions.length<1||Sessions.Value.Sessions[0].PreviousClose===undefined||Sessions.Value.Sessions[0].PreviousClose===null){includePreviousClose=false;}
var MinMax=self._getMinMax(Sessions.Value.Sessions,includePreviousClose);if(chartValueIndicators===1){self._determineLastTrade(Sessions.Value.Sessions[Sessions.Value.Sessions.length-1].Trades);Low=MinMax.Low;High=MinMax.High;if(includePreviousClose){Close=Sessions.Value.Sessions[0].PreviousClose;self.closePrice=Close;}}
if(!Min||MinMax.Min<Min){Min=MinMax.Min;}
if(!Max||MinMax.Max>Max){Max=MinMax.Max;}});function dStart(){this.value=0;}
function dFinish(){this.value=0;}
if(this.style.maxPriceLines>=1){var dFinishObj=new dFinish();var dStartObj=new dStart();var scale=Thunderball.ChartScalingV2.CalculateDelta2(this.style.maxPriceLines,false,true,Min,Max,dStartObj,dFinishObj);if(dStartObj.value<0&&self.symbols.length===1){scale=Thunderball.ChartScalingV2.CalculateDelta2(Math.round(this.style.maxPriceLines/2),false,true,Min,Max,dStartObj,dFinishObj);}
if(chartValueIndicators===1){if(High===null&&Low===null){if(close!=null){Max=Close+(Close*.01);Min=Close-(Close*.01);}else{Max=1;Min=0;}}
this._priceLines=[];var ticks=this._priceLines;if(Low!=null){ticks.push(Low);this.lowPrice=Low;}
if(this.lastPrice!=null){ticks.push(this.lastPrice);}
if((!(Close===undefined||Close===null))){ticks.push(Close);if(High!=null){ticks.push(High);this.highPrice=High;}}else{if(High!=null){ticks.push(High);this.highPrice=High;}}}else{Min=Math.min(Min,dStartObj.value);Max=Math.max(Max,dFinishObj.value);this._priceLines=[];var ticks=this._priceLines;if(scale>0){for(var p=dStartObj.value;p<=dFinishObj.value+((dFinishObj.value-dStartObj.value)*.05);p+=scale){ticks[ticks.length]=p;}}}}
var pad=this.style.vPadding;var height=this.height-2.0*pad;if(Max-Min===0){if(Max<Min){var Tmp=Min;Min=Max;Max=Tmp;}
var Max=Math.abs(Max);if(Max==0)
Max=1;if(Max<0)
Max=0;else if(Max==0)
Max=1;else
Min=0;}
this._yscale=-height/(Max-Min);this._y=height-Min*this._yscale+pad;},_setSession:function(session){this._xscale=session._xscale;this._x=session._x;},tx:function(x){if(!this._x){this._x=1;}
if(!this._xscale){this._xscale=1;}
return Math.floor(this._xscale*x+this._x)+(this._bump?0.5:0);},ty:function(y){return Math.floor(this._yscale*y+this._y)+(this._bump?0.5:0);},_makeStyle:function(spec){var steps=spec.split('-');if(steps.length==2){var gradient=this.drawingContext.createLinearGradient(0,0,0,this.height);gradient.addColorStop(0,steps[0]);gradient.addColorStop(1,steps[1]);return gradient;}else{return spec;}},_determineLastTrade:function(Trades){var latestPrice=null;for(var k=Trades.length-1;k>=0&&latestPrice===null;k--){if(Trades[k]){latestPrice=Trades[k];}}
this.lastPrice=latestPrice;},_getMinMax:function(Sessions,IncludePreviousClose){var MinPoint;var MaxPoint;var Min;var Max;var LowPrice;var HighPrice;var SessionHighPoint={Index:null,Price:null,SessionIndex:null};var SessionLowPoint={Index:null,Price:null,SessionIndex:null};if(IncludePreviousClose&&Sessions[0].PreviousClose!==null){Max=Min=Sessions[0].PreviousClose;}
var needsBump=false;if(this.data.Data[0].Value.IsIndex===1&&this._barSize===60){needsBump=true;}
for(var i=0;i<Sessions.length;i++){var Session=Sessions[i];this._setSession(Session);if(!Session.Trades){Session.Trades=[];}
var Low=Session.Low;var High=Session.High;if(Low||High){if(Low&&(!Min||Low.Price<Min)){Min=Low.Price;if(this._historical){MinPoint={x:this.tx(Low.Index/this._barSize),y:this.ty(Min)};}else{if(needsBump){MinPoint={x:this.tx(Low.Index+0.5),y:this.ty(Min)};}else{MinPoint={x:this.tx(Low.Index),y:this.ty(Min)};}}
SessionLowPoint.Index=Low.Index;SessionLowPoint.Price=Low.Price;SessionLowPoint.SessionIndex=i;}
if(High&&(!Max||High.Price>Max)){Max=High.Price;if(this._historical){MaxPoint={x:this.tx(High.Index/this._barSize),y:this.ty(Max)};}else{if(needsBump){MaxPoint={x:this.tx(High.Index+0.5),y:this.ty(Max)};}else{MaxPoint={x:this.tx(High.Index),y:this.ty(Max)};}}
SessionHighPoint.Index=High.Index;SessionHighPoint.Price=High.Price;SessionHighPoint.SessionIndex=i;}
if(Low&&(!LowPrice||Low.Price<LowPrice)){LowPrice=Low.Price;}
if(High&&(!HighPrice||High.Price>HighPrice)){HighPrice=High.Price;}}}
var UniqueHighPoint=null;var UniqueLowPoint=null;if(SessionHighPoint.Index!=null&&SessionHighPoint.Price!=null&&SessionHighPoint.SessionIndex!=null){if(SessionHighPoint.SessionIndex<Sessions.length&&SessionHighPoint.Index<Sessions[SessionHighPoint.SessionIndex].Trades.length){UniqueHighPoint=SessionHighPoint.Price;HighPrice=SessionHighPoint.Price;}}
if(SessionLowPoint.Index!=null&&SessionLowPoint.Price!=null&&SessionLowPoint.SessionIndex!=null){if(SessionLowPoint.SessionIndex<Sessions.length&&SessionLowPoint.Index<Sessions[SessionLowPoint.SessionIndex].Trades.length){UniqueLowPoint=SessionLowPoint.Price;LowPrice=SessionLowPoint.Price;}}
if(UniqueHighPoint!==null&&UniqueLowPoint!==null){if(SessionLowPoint.SessionIndex==SessionHighPoint.SessionIndex){if(SessionLowPoint.Index!==SessionHighPoint.Index){Sessions[SessionLowPoint.SessionIndex].Trades[SessionLowPoint.Index]=UniqueLowPoint;Sessions[SessionHighPoint.SessionIndex].Trades[SessionHighPoint.Index]=UniqueHighPoint;}}else
{Sessions[SessionLowPoint.SessionIndex].Trades[SessionLowPoint.Index]=UniqueLowPoint;Sessions[SessionHighPoint.SessionIndex].Trades[SessionHighPoint.Index]=UniqueHighPoint;}}else if(UniqueHighPoint!==null){Sessions[SessionHighPoint.SessionIndex].Trades[SessionHighPoint.Index]=UniqueHighPoint;}else if(UniqueLowPoint!==null){Sessions[SessionLowPoint.SessionIndex].Trades[SessionLowPoint.Index]=UniqueLowPoint;}
return({Min:Min,Max:Max,Low:LowPrice,High:HighPrice,MinPoint:MinPoint,MaxPoint:MaxPoint});}};
dojo.provide("dj.widget.survey.WSJDNPopUnder");dojo.require("dj.lang");dojo.require("dj.util.Cookie");dojo.require("dj.util.Url");dojo.require("dj.util.User");(function(){var _du=dj.util;var _dws=dj.widget.survey;(_dws.WSJDNPopUnder=function(cfg){this._cfg=dj.lang.cloneMixin(this.DEFAULT_CONFIG,cfg);this._duc=dj.util.Cookie;try{var that=this;that.popunder();}catch(e){throw e;}}).prototype={DEFAULT_CONFIG:{"url":"httpdisabled://wsjdn.wsj.com/","cookieName":"wsjdnpopunder","windowName":"WSJDN","noRepeatInterval":"1d+","frequencyPercent":100,"cookieGroupExpirationDays":"90","blurPopunder":true,"width":0,"height":0,"popupParams":"menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,personalbar=yes,scrollbars=yes"},popunder:function(){var Cookie=this._duc;if(this._canShowPopunder()){this._setNoRepeatCookie(this._cfg.noRepeatInterval);this.showPopUnder();}},showPopUnder:function(){var dimensions=""
if(this._cfg.width){dimensions="width="+this._cfg.width+",height="+this._cfg.height+",";}
var popunder=void(this._cfg.url,this._cfg.windowName,dimensions+this._cfg.popupParams);console.log(popunder);if(this._cfg.blurPopunder&&popunder!=null){popunder.blur();window.focus();}},_canShowPopunder:function(){var now=new Date();if((now.getTime()%100)>this._cfg.frequencyPercent){return false;}
var showPopunder=true;var noRepeatCookie=this._duc.getGroupCookie("DJCOOKIE",this._cfg.cookieName);if(noRepeatCookie){var noRepeatDate=new Date(noRepeatCookie);if((noRepeatDate-now)>0){showPopunder=false;}else{this._duc.deleteGroupCookie("DJCOOKIE",this._cfg.cookieName);}}
return showPopunder;},_setNoRepeatCookie:function(interval){var noRepeatDate=this._calcDate(interval);this._duc.setGroupCookie("DJCOOKIE",this._cfg.cookieName,noRepeatDate,this._cfg.cookieGroupExpirationDays);},_calcDate:function(D){var MS=this._calcMilliseconds(D),dO=new Date();dO.setTime((D.substring(D.length-1,D.length)=="+")?dO.getTime()+MS:dO.getTime()-MS);return dO.toGMTString();},_calcMilliseconds:function(D){var TD=D.substring(0,D.length-2),TC=D.substring(D.length-2,D.length-1).toLowerCase(),MS=0;MS=(TC=="m")?TD*((24*60*60*1000)*30):MS;MS=(TC=="d")?TD*(24*60*60*1000):MS;MS=(TC=="s")?TD*1000:MS;return MS;}};}());
dojo.provide("dj.module.globalNav");dj.module.globalNav={setupQuicklinks:function(globalSubNavId,quicklinksContainerId){this.oHideQuickLinks=dojo.query('.hideQuickLinks');this.oGlobalSubNav=dojo.byId(globalSubNavId);this.oQuicklinksContainer=dojo.byId(quicklinksContainerId);if(typeof this.oHideQuickLinks==='undefined'){if(this.oGlobalSubNav===null){if(this.oQuicklinksContainer!=null){dojo.removeClass(this.oQuicklinksContainer,"subnav_hide");dojo.addClass(this.oQuicklinksContainer,"subnav_show");}}}}};dojo.provide("dj.module.header.localWeather");dojo.require("dj.util.Cookie");dojo.require("dj.util.User");(function(){dj.module.header.localWeather={init:function(cfg){var defaultConfig={defaultLocation:"10005",expireInterval:"1200",htmlService:"/public/page/0_0_WC_HeaderWeather",populateEl:"weatherContent",iframeId:"iframeweatherDetails",iframeParam:"location",locationNameId:"locationName",pznUrl:"/pznusersvc/update/user/profile",setPznWeatherUrl:"/pznusersvc/view/user/profile?profileType=weatherCode",redirectUrl:"httpdisabled://commerce.wsj.com/auth/login",locationSavedTxt:"Default location saved"};dojo.mixin(defaultConfig,cfg);this.config=defaultConfig;this.cookieWeatherCode=this.getCookie("weatherCode");this.cookieWeatherJson=this.getCookie("weatherJson");if(dj.util.Region.getViewByRegion()=="na,us"){this._loaddisabled();}},_loaddisabled:function(){var that=this;dj.util.User.isLoggedIn(function(isLoggedIn){if(isLoggedIn){dj.util.User.getUserId(function(userId){if(that.getCookie("weatherUser")==userId){if(that.isExpired("weatherExpire")){that.getPznLocalWeather();}
else{try{that.populateHeaderJson(dojo.fromJson(that.cookieWeatherJson));}
catch(err){var wc=that.getCookie("weatherCode");if(wc){that.getHTML(wc);}
else{that.getHTML(that.config.defaultLocation);}}}}
else{that.clearWeatherCookies();that.getPznLocalWeather();}});}
else{if(that.isExpired("weatherExpire")){that.getHTML(that.config.defaultLocation);}
else{if(that.getCookie("weatherCode")==that.config.defaultLocation){if(that.cookieWeatherJson){that.populateHeaderJson(dojo.fromJson(that.cookieWeatherJson));}
else{that.getHTML(that.config.defaultLocation);}}
else{that.getHTML(that.config.defaultLocation);}}}});},getHTML:function(location){var that=this;dojo.xhrGet({url:that.config.htmlService+'-'+location+".html",headers:{Accept:'application/html'},handleAs:"text",loaddisabled:function(response,ioArgs){var requestStatus=ioArgs.xhr.getResponseHeader('Status');if(response.match(/<ul class="local-info">/)){that.populateHeaderHtml(response);dj.util.User.getUserId(function(userId){that.setCookie("weatherUser",userId);});that.setCookie("weatherJson",dojo.toJson(that.parseHTML(response)));that.setCookie("weatherExpire",that.calcDate(that.config.expireInterval+"s+"));that.setCookie("weatherCode",location);}
else{console.error("Could not pull weather from xhtml service.");}},error:function(response,ioArgs){console.error("httpdisabled status code: ",ioArgs.xhr.status);return response;}});},populateHeaderHtml:function(content){dojo.byId(this.config.populateEl).innerHTML=content;},populateHeaderJson:function(weatherJson){var icon=dojo.byId('w_icon');var location=dojo.byId('w_location');dojo.addClass(icon,"wsj-"+weatherJson.image);dojo.byId('w_high').innerHTML=weatherJson.high+"&#186;";dojo.byId('w_low').innerHTML=weatherJson.low+"&#186";icon.href=weatherJson.url;location.href=weatherJson.url;location.innerHTML=weatherJson.city;dojo.removeClass(dojo.query(".temperature.divider")[0],"hidden");},populateFromPznSvc:function(){var pznHTML=this.getHTML(pznWeather);this.setCookie("weatherCode",pznWeather);this.populateHeaderHtml(pznHTML);this.setLocalWeatherJson(pznHTML);},getCookie:function(name){return dj.util.Cookie.getGroupCookie("DJCOOKIE",name);},setCookie:function(name,value){dj.util.Cookie.setGroupCookie("DJCOOKIE",name,value,365);},setLocalWeatherJson:function(htmlFragment){dj.util.Cookie.setGroupCookie("DJCOOKIE","weatherJson",dojo.fromJson(this.parseHTML(htmlFragment)),365);},setDefaultLocation:function(locationId){var that=this;var locationEl=dojo.byId(locationId);var iFrameParam=that.getIframeParam(this.config.iframeId,this.config.iframeParam);var locationCode=iFrameParam!==""?iFrameParam:this.config.defaultLocation;dojo.byId(this.config.locationNameId).innerHTML=unescape(this.getIframeParam(that.config.iframeId,"name"));dj.util.User.isLoggedIn(function(isLoggedIn){if(isLoggedIn){if(locationCode!=that.getCookie("weatherCode")){dojo.connect(locationEl,"click",function(ev){dojo.stopEvent(ev);that.clearWeatherCookies();that.setPznLocalWeather(locationCode);that.getHTML(locationCode);dojo.addClass(locationEl,"hidden");dojo.place("<span style='font-size:1.1em'>"+that.config.locationSavedTxt+"</span>",locationEl,"before");});}
else{dojo.addClass(locationEl,"hidden");}}
else{dojo.connect(locationEl,"click",function(ev){dojo.stopEvent(ev);window.location=that.getCommerceRedirectUrl();});}});},parseHTML:function(frag){try{var city=frag.match(/([^>]*)<\/a>/)[1];var imageCode=frag.match(/class="wsj-(\d*)/)[1];var high=frag.match(/(\d+)&#186;/g)[0].match(/\d*/);var low=frag.match(/(\d+)&#186;/g)[1].match(/\d*/);var url=frag.match(/href\="([^"]*)/)[1];return{city:city,image:imageCode,high:high,low:low,url:url};}
catch(err){console.error("Unable to parse xhtml service: %s",err);return false;}},getPznLocalWeather:function(){var that=this;dojo.xhrGet({url:that.config.setPznWeatherUrl,headers:{Accept:'application/json'},handleAs:"json",loaddisabled:function(response,ioArgs){var requestStatus=ioArgs.xhr.getResponseHeader('Status');if(200!==ioArgs.xhr.status){console.error("Error message: Service is not working with Error Code: "+ioArgs.xhr.status);return;}
var profileData=response.User.profileData[0];if(profileData!==undefined){that.getHTML(profileData.weatherCode);}
else{that.getHTML(that.config.defaultLocation);}},error:function(response,ioArgs){console.error("httpdisabled status code: ",ioArgs.xhr.status);return response;}});},setPznLocalWeather:function(code){var data={"profileType":"weatherCode","profileName":"weatherCode","params":[{"weatherCode":code}]};var xhrArgs={url:this.config.pznUrl,postData:dojo.toJson(data),handleAs:"json",contentType:"application/json",accept:"application/json",loaddisabled:function(data){},error:function(error){}};var deferred=dojo.xhrPost(xhrArgs);},clearWeatherCookies:function(){dj.util.Cookie.deleteGroupCookie("DJCOOKIE","weatherUser");dj.util.Cookie.deleteGroupCookie("DJCOOKIE","weatherCode");dj.util.Cookie.deleteGroupCookie("DJCOOKIE","weatherExpire");dj.util.Cookie.deleteGroupCookie("DJCOOKIE","weatherJson");},getCommerceRedirectUrl:function(urll){var url=urll||this.config.redirectUrl;return url+"&url="+escape(window.location);},calcDate:function(D){var MS=this.calcMilliseconds(D),dO=new Date();dO.setTime((D.substring(D.length-1,D.length)=="+")?dO.getTime()+MS:dO.getTime()-MS);return dO.toGMTString();},calcMilliseconds:function(D){var TD=D.substring(0,D.length-2),TC=D.substring(D.length-2,D.length-1).toLowerCase(),MS=0;MS=(TC=="m")?TD*((24*60*60*1000)*30):MS;MS=(TC=="d")?TD*(24*60*60*1000):MS;MS=(TC=="s")?TD*1000:MS;return MS;},isExpired:function(cookieName){var expireTime=new Date(this.getCookie(cookieName));var status=expireTime-(new Date());if(status>0){return false;}
else{return true;}},getIframeParam:function(iframeId,name){var iframeSrc=dojo.byId(iframeId).src;var location=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regexS="[\\?&]"+location+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(iframeSrc);if(results===null){return"";}
else{return results[1];}}};}());dojo.provide("dj.module.header.sectionMenu");dojo.require("dj.widget.panel.LiveModalPanel");dojo.require("dj.util.Element");dojo.require("dj.lang");dojo.require("dj.widget.panel.SelectDropdownPanel");(function(){dj.module.header.sectionMenu={init:function(){var isInitDone=false;this.delayedMouseOver("._exp",function(el){if(!isInitDone){this.initializeHeaderPanels();this.setEvents();isInitDone=true;}
this.initShowData(el);},250);this.fadeInArrows();},initializeHeaderPanels:function(){var headerMenu=new dj.widget.panel.LiveModalPanel({container:".linklist_dropdown .wsjmn_dropdown_container",containerInd:".linklist_dropdown .wsjmn_dropdown_container .mnExpand",dropdownContent:".wsjmn_dropdownContent",actionEvent:"click",stateContainer:".wsjmn_dropdownTree",stateCollapsed:"wsjmn_ddState-collapsed",stateExpanded:"wsjmn_ddState-expanded",navContainer:".pmMainNav",stateHover:"mndd_ddState-hover",queryUpClass:"wsjmn_dropdownTree",addMouseEvents:false});},initShowData:function(el){var svcUrl=this.getDropdownIndex(el);var ddi=dj.util.Element.getDataset(el).dropdownindex;var ddiEl=dojo.byId(ddi+"_content");this.showData(svcUrl,ddiEl,el);},showData:function(svcUrl,ddiEl,dataEl){var that=this;var initDelay=false;initDelay=setTimeout(function(){if((dojo.hasClassName(dataEl,"_data")===false)){dojo.addClass(dataEl,'_data');that.getHTML(svcUrl,ddiEl,dataEl);}});},getDropdownIndex:function(el){var sEl=dj.util.Element.getDataset(el);var svcEl=dj.util.Element.getDataset(dojo.byId(sEl.dropdownindex));return svcEl.panelServiceUri;},setIframeShimHeights:function(el){var elData=dj.util.Element.getDataset(el).dropdownindex;var elNum=elData.match(/(\d.*)/)[0];var iFrameId="wsjmn_dropdown_iframe"+elNum;var dropdownId="wsjmn_dropdown"+elNum+"_content";var content=dojo.byId(dropdownId);var iFrameEl=dojo.byId(iFrameId);for(var i=0;i<=content.length-1;i++){try{iFrameEl.offsetHeight=dojo.byId("wsjmn_dropdown_content"+elNum).offsetHeight;}
catch(err){}}
try{iFrameEl.offsetHeight=dojo.byId("wsjmn_dropdown_content"+elNum).offsetHeight;}
catch(e){}},setEvents:function(){var that=this;dj.lang.addLiveEvent("._exp","mousedown",function(ev){var el=(ev.target||ev.srcElement);that.initShowData(el);});dj.lang.addLiveEvent(".subExpand","mousedown",function(ev){var el=(ev.target||ev.srcElement);that.subFlyoutToggle("1-3");});},delayedMouseOver:function(containerClass,func,time){var doInit=false,initDelay;var that=this;var outEvent=dj.lang.addLiveEvent(containerClass,"mouseout",function(){doInit=false;});var overEvent=dj.lang.addLiveEvent(containerClass,"mouseover",function(ev){if(initDelay){clearTimeout(initDelay);}
doInit=true;var el=this;initDelay=setTimeout(function(){if(!doInit){return;}
func.call(that,el);},time);});},getHTML:function(location,el,dataEl){var that=this;dojo.xhrGet({url:location,headers:{Accept:'application/html'},handleAs:"text",loaddisabled:function(response,ioArgs){var requestStatus=ioArgs.xhr.getResponseHeader('Status');el.innerHTML=response;if(response.match(/<!--BusinessDropdown-->/)){var panel=new dj.widget.panel.SelectDropdownPanel('subIndDropdown');}},error:function(response,ioArgs){console.error("httpdisabled status code: ",ioArgs.xhr.status);return response;}});},subFlyoutToggle:function(n){var el=dojo.byId("wsjsub_flyout"+n);if(el===null){return false;}
var currentClass=el.className;if(currentClass.indexOf("wsjsub_ddState-collapsed")!=-1){el.className=currentClass.replace(/wsjsub_ddState-collapsed/,"wsjsub_ddState-expanded");}
else{el.className=currentClass.replace(/wsjsub_ddState-expanded/,"wsjsub_ddState-collapsed");}
return false;},fadeInArrows:function(){var arrowNodes=dojo.query(".mnExpand._exp");for(var i=0;i<=arrowNodes.length-1;i++){dojo.fadeIn({node:arrowNodes[i],duration:(1.0*1000)}).play();}}};}());dojo.provide("dj.module.globalHeader");dojo.require("dj.lang");dojo.require("dj.util.Config");dojo.require("dj.util.Cookie");dojo.require("dj.util.Date");dojo.require("dj.util.Region");dojo.require("dj.util.Element");dojo.require("dj.util.User");dj.module.globalHeader=function(){var DEFAULT_CONFIG={HEADER_CONTAINER_CLASS:".header",TIMESTAMP_CLASS:".date",WSJ_LOGO_ID:"wsjLogo",WSJ_LARGE_LOGO_CLASSNAME:"logo_large",WSJ_SMALL_LOGO_CLASSNAME:"logo_small",CURRENT_SUBSECTION_DISPLAY_CLASS:".currentSubSection",GLOBALNAV_SUBSECTION_ELEMENT_ID:"currentGlobalNavSubSection",SUBSCRIBER_LOGIN_CLASS:".login",HEADER_PROMO_CLASS:".promo",SUBSCRIBER_DETAILS_ELEMENT_ID:"subscribedUserDetailsId",COMMUNITY_FORUMS_LINK_CLASS:".communityForumsLink",TODAYS_PAPER_LINK_CLASS:".todaysPaperLink",MOJ_LINK_CLASS:".myOnlineJournalLink",MESSAGE_CENTER_LINK_CLASS:".messageCenterLink",MESSAGE_COUNT_CLASS:".messageCount",LOGIN_USERNAME_ELEMENT_ID:"login_username",LOGIN_PASSWORD_ELEMENT_ID:"login_password",LOGIN_FORM_ID:"login_form",PAGE_URL_ELEMENT_ID:"page_url",LOGOUT_LINK_ELEMENT_ID:"logoutLink",LOGIN_BUTTON_ELEMENT_ID:"login_button",USER_NAME_ELEMENT_ID:"userName",WSJ_LOGO_FADE_APPEAR_DURATION:"1.0",WSJ_LOGO_DELAY_DURATION:"2000",LOGGED_IN_COMMUNITY_URL:"/community",LOGGED_IN_TODAYS_PAPER_URL:"/itp?mod=WSJ_formfactor",LOGGED_IN_TODAYS_PAPER_URL_ASIA:"/itp/asia?mod=WSJ_formfactor",LOGGED_IN_TODAYS_PAPER_URL_EUROPE:"/itp/europe?mod=WSJ_formfactor",MESSAGE_CENTER_POST_URL:"/community/integration/userinfo.html",LOGOUT_URL:"/static_html_files/logout_confirmation.htm",SUBSCRIBER_HOMEPAGE_PID:"0_0_WH_0001",NONSUBSCRIBER_HOMEPAGE_PID:"0_0_WH_0001_public",ASIA_PAGE_PID:"0_0_WP_2103",EUROPE_PAGE_PID:"0_0_WP_2104",NONSUBSCRIBER_NEWSLETTERS_ALERTS_PAGE_PID:"5_6007",NONSUBSCRIBER_SEARCH_PAGE_PID:"3_0466",HOMEPAGE_SUBSCRIBER_URL:"/",SEARCH_PAGE_SUBSCRIBER_URL:"/search",TODAYS_PAPER_LINK_CONTAINER_CLASS:".todaysPaperLinkContainer",VIDEO_LINK_CONTAINER_CLASS:".videoLinkContainer",COLUMNS_LINK_CONTAINER_CLASS:".columnsLinkContainer",BLOGS_LINK_CONTAINER_CLASS:".blogsLinkContainer",INTERACTIVE_GRAPHICS_LINK_CONTAINER_CLASS:".interactiveGraphicsLinkContainer",TOPICS_LINK_CONTAINER_CLASS:".topicsLinkContainer",COMMUNITY_FORUMS_LINK_CONTAINER_CLASS:".communityForumsLinkContainer",TODAYS_PAPER_PID:"0_0_WP_40",TODAYS_PAPER_US_NONSUB_PID:"2_0433",TODAYS_PAPER_EUROPE_NONSUB_PID:"2_0434",TODAYS_PAPER_ASIA_NONSUB_PID:"2_0435",TODAYS_PAPER_US_PID:"2_0133",TODAYS_PAPER_EUROPE_PID:"2_0134",TODAYS_PAPER_ASIA_PID:"2_0135",TODAYS_PAPER_PAST_EDITIONS_PID:"2_0233",TODAYS_PAPER_INDEX_BIZ_PID:"2_0156",TODAYS_PAPER_INDEX_PEOPLE_PID:"2_0155",TODAYS_PAPER_CORRECTIONS_PID:"Corrections",VIDEO_PID:"0_0_WP_3000",BLOGS_PID:"8_0019",COLUMNS_PID:"2_0140",INTERACTIVE_GRAPHICS_PID:"0_0_WP_2003",TOPICS_PID:"0_0_WT_0001",NEWSLETTERS_ALERTS_SUB_PID:"5_6001",NEWSLETTERS_ALERTS_PUB_PID:"5_6003",MOJ_LINK_URL:"/page/my-journal-main.html",MDC_LINK_URL:"/mdc/page/marketsdata.html",MDC_PAGE_PID:"2_3000",COMMUNITY_HIGHLIGHT_COMPARE_URL:"/community",FORUMS_HIGHLIGHT_COMPARE_URL:"forums.wsj.com",FREE_REG_CLASS:".freereg",LOCATION_NAV_CLASS:".location_nav",LOCATION_NAV_COLLAPSED_CLASSNAME:"location_collapsed",LOCATION_NAV_EXPANDED_CLASSNAME:"location_expanded",US_EDITION_LINK_CLASS:".map_us",EU_EDITION_LINK_CLASS:".map_europe",ASIA_EDITION_LINK_CLASS:".map_asia",IN_EDITION_LINK_CLASS:".map_india",US_EDITION_MDC_URL:"/marketsdata",EU_EDITION_MDC_URL:"/mdc/public/page/marketsdata_europe.html",ASIA_EDITION_MDC_URL:"/mdc/public/page/marketsdata_asia.html",IN_EDITION_MDC_URL:"/mdc/public/page/marketsdata_asia.html",MDC_COMPARE_URL:"/mdc/",FOOTER_CONTAINER_CLASS:".pagefooter",GO_PRO_HOOK:"goprohook",GO_PRO_HOOK_REGION:["na,us"]};return{initialize:function(config){this.cfg=dj.lang.cloneMixin(DEFAULT_CONFIG,config);var headerContainerClass=this.cfg.HEADER_CONTAINER_CLASS;this.oHeader=dojo.query(headerContainerClass)[0];this.editionDropdownSetUp();this.displaySubSection();this.displayTimeStamp();var that=this;this.currRegion=dj.util.Region.getViewByRegion();this.concatURL='';if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){this.concatURL="httpdisabled://"+gcDomain;}else{this.concatURL="httpdisabled://"+document.domain;}
dj.util.User.isLoggedIn(function(isLoggedIn){if(isLoggedIn){that.displaySubscriberDetails();that.setupLogout();}else{that.setupLogin();var freeregClass=that.cfg.FREE_REG_CLASS;that.ofreereg=dojo.query(freeregClass,that.oHeader)[0];var registerModule=dojo.query("#register_module",that.ofreereg)[0];dojo.style(registerModule,{display:"none"});dojo.style(that.ofreereg,{display:"block"});var subscriberLoginClass=that.cfg.SUBSCRIBER_LOGIN_CLASS;that.oSubscriberLogin=dojo.query(subscriberLoginClass,that.oHeader)[0];var loginModule=dojo.query(".login_module",that.oSubscriberLogin)[0];dojo.style(loginModule,{display:"none"});dojo.style(that.oSubscriberLogin,{display:"block"});var headerPromoClass=that.cfg.HEADER_PROMO_CLASS;that.oHeaderPromo=dojo.query(headerPromoClass,that.oHeader)[0];dojo.style(that.oHeaderPromo,{display:"block"});}});this.highlightFormFactorLinks();var todaysPaperLinkClass=this.cfg.TODAYS_PAPER_LINK_CLASS;this.oTodaysPaperLink=dojo.query(todaysPaperLinkClass,this.oHeader)[0];var loggedInTodaysPaperUrl=this.cfg.LOGGED_IN_TODAYS_PAPER_URL;var loggedInTodaysPaperUrlAsia=this.cfg.LOGGED_IN_TODAYS_PAPER_URL_ASIA;var loggedInTodaysPaperUrlEurope=this.cfg.LOGGED_IN_TODAYS_PAPER_URL_EUROPE;var currEdition="";if(this.currRegion=="asia"||this.currRegion=="asia,india"){loggedInTodaysPaperUrl=loggedInTodaysPaperUrlAsia;}else if(this.currRegion=="europe"){loggedInTodaysPaperUrl=loggedInTodaysPaperUrlEurope;}
if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){this.oTodaysPaperLink.href="httpdisabled://"+gcDomain+loggedInTodaysPaperUrl;}else{this.oTodaysPaperLink.href=loggedInTodaysPaperUrl;}
dj.util.User.isSubLoggedIn(function(subLoggedIn){if(subLoggedIn){var region_index=-1;dojo.forEach(that.cfg.GO_PRO_HOOK_REGION,function(element,index){if(element===that.currRegion){region_index=index;}});if(that.cfg.GO_PRO_HOOK_REGION==="all"||region_index!==-1){dojo.removeClass(that.cfg.GO_PRO_HOOK,"hidden");}}});},toggleDropdownClass:function(){var selLocDrpdwnCollapsedClassName=this.cfg.LOCATION_NAV_COLLAPSED_CLASSNAME;var selLocDrpdwnExpandedClassName=this.cfg.LOCATION_NAV_EXPANDED_CLASSNAME;if(dojo.hasClass(this.oLocDropDownContainer,selLocDrpdwnCollapsedClassName)){dojo.removeClass(this.oLocDropDownContainer,selLocDrpdwnCollapsedClassName);dojo.addClass(this.oLocDropDownContainer,selLocDrpdwnExpandedClassName);}else if(dojo.hasClass(this.oLocDropDownContainer,selLocDrpdwnExpandedClassName)){dojo.addClass(this.oLocDropDownContainer,selLocDrpdwnCollapsedClassName);}},editionDropdownSetUp:function(){var that=this;var locationNavClass=this.cfg.LOCATION_NAV_CLASS;this.oLocationNav=dojo.query(locationNavClass,this.oHeader)[0];var selLocDrpdwnCollapsedClassName=this.cfg.LOCATION_NAV_COLLAPSED_CLASSNAME;var selLocDrpdwnExpandedClassName=this.cfg.LOCATION_NAV_EXPANDED_CLASSNAME;var usEditionLinkClassName=this.cfg.US_EDITION_LINK_CLASS;var usEditionLinkClassName=this.cfg.US_EDITION_LINK_CLASS;var euEditionLinkClassName=this.cfg.EU_EDITION_LINK_CLASS;var inEditionLinkClassName=this.cfg.IN_EDITION_LINK_CLASS;var asiaEditionLinkClassName=this.cfg.ASIA_EDITION_LINK_CLASS;this.usEditionMDCUrl=this.cfg.US_EDITION_MDC_URL;this.euEditionMDCUrl=this.cfg.EU_EDITION_MDC_URL;this.inEditionMDCUrl=this.cfg.IN_EDITION_MDC_URL;this.asiaEditionMDCUrl=this.cfg.ASIA_EDITION_MDC_URL;var mdcCompareUrl=this.cfg.MDC_COMPARE_URL;this.oCurrentEdition=dojo.byId("currentEdition");this.oUsEdition=dojo.byId("usEdition");this.oEuEdition=dojo.byId("europeEdition");this.oInEdition=dojo.byId("indiaEdition");this.oAsiaEdition=dojo.byId("asiaEdition");this.oChiEdition=dojo.byId("chiEdition");this.oJpnEdition=dojo.byId("jpnEdition");this.oSpaEdition=dojo.byId("spaEdition");this.oPorEdition=dojo.byId("porEdition");this.osectionFooterSub=dojo.byId("hrefNonSubId");this.osectionFooterNonSub=dojo.byId("hrefSubId");this.oUsEditionFooter=dojo.byId("usEditionFooter");this.currRegion=dj.util.Region.getViewByRegion();var currEdition="";if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){this.tempConcatURL="httpdisabled://"+gcDomain;}else{this.tempConcatURL="httpdisabled://"+document.domain;}
this.isMDCPageFlag=((document.location.href!==null)&&(document.location.href!=="")&&(document.location.href.indexOf(mdcCompareUrl)!==-1));if(this.oUsEdition!==null){dojo.connect(this.oUsEdition,"onclick",this,function(ev){dojo.stopEvent(ev);dj.util.Region.setViewByRegion('na,us');dj.util.Cookie.setGroupCookie("DJCOOKIE","HOMEPAGE","/home-page",365);window.location=(this.isMDCPageFlag)?this.tempConcatURL+this.usEditionMDCUrl:this.oUsEdition.href;});}
if(this.oUsEditionFooter!==null){dojo.connect(this.oUsEditionFooter,"onclick",this,function(ev){dojo.stopEvent(ev);dj.util.Region.setViewByRegion('na,us');dj.util.Cookie.setGroupCookie("DJCOOKIE","HOMEPAGE","/home/us",365);window.location=(this.isMDCPageFlag)?this.tempConcatURL+this.usEditionMDCUrl:this.oUsEditionFooter.href;});}
if(this.oEuEdition!==null){dojo.connect(this.oEuEdition,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=(this.isMDCPageFlag)?this.tempConcatURL+this.euEditionMDCUrl:this.oEuEdition.href;if(this.isMDCPageFlag){dj.util.Region.setViewByRegion("europe");dj.util.Cookie.setGroupCookie("DJCOOKIE","HOMEPAGE","/home/europe",365);}});}
if(this.oInEdition!==null){dojo.connect(this.oInEdition,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=(this.isMDCPageFlag)?this.tempConcatURL+this.inEditionMDCUrl:this.oInEdition.href;if(this.isMDCPageFlag){dj.util.Region.setViewByRegion("asia,india");dj.util.Cookie.setGroupCookie("DJCOOKIE","HOMEPAGE","/home/india",365);}});}
if(this.oAsiaEdition!==null){dojo.connect(this.oAsiaEdition,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=(this.isMDCPageFlag)?this.tempConcatURL+this.asiaEditionMDCUrl:this.oAsiaEdition.href;if(this.isMDCPageFlag){dj.util.Region.setViewByRegion("asia");dj.util.Cookie.setGroupCookie("DJCOOKIE","HOMEPAGE","/home/asia",365);}});}
if(this.oChiEdition!==null){dojo.connect(this.oChiEdition,"onclick",this,function(ev){dojo.stopEvent(ev);void(this.oChiEdition.href);});}
if(this.oJpnEdition!==null){dojo.connect(this.oJpnEdition,"onclick",this,function(ev){dojo.stopEvent(ev);void(this.oJpnEdition.href);});}
if(this.oSpaEdition!==null){dojo.connect(this.oSpaEdition,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=this.oSpaEdition.href;});}
if(this.oPorEdition!==null){dojo.connect(this.oPorEdition,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=this.oPorEdition.href;});}
if(this.osectionFooterSub!==null){dojo.connect(this.osectionFooterSub,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=this.osectionFooterSub.href;});}
if(this.osectionFooterNonSub!==null){dojo.connect(this.osectionFooterNonSub,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=this.osectionFooterNonSub.href;});}
if(this.currRegion=="asia"){currEdition="Asia Edition";this.oSelectedEdition=dojo.query(asiaEditionLinkClassName,this.oHeader)[0];}else if(this.currRegion=="asia,india"){currEdition="Asia Edition";this.oSelectedEdition=dojo.query(inEditionLinkClassName,this.oHeader)[0];}else if(this.currRegion=="europe"){currEdition="Europe Edition";this.oSelectedEdition=dojo.query(euEditionLinkClassName,this.oHeader)[0];}else{currEdition="U.S. Edition";this.oSelectedEdition=dojo.query(usEditionLinkClassName,this.oHeader)[0];}
dojo.addClass(this.oSelectedEdition,"selected");this.oCurrentEdition.innerHTML=currEdition;this.oFormFactorContainer=dojo.byId("formFactorContainer");dojo.style(this.oFormFactorContainer,{"display":""});this.oLocDropDownContainer=dojo.byId("locNavContainer");dojo.style(this.oLocDropDownContainer,{"display":""});if(this.oLocDropDownContainer!==null){var toggleDropdownClass=function(){if(dojo.hasClass(that.oLocDropDownContainer,selLocDrpdwnCollapsedClassName)){dojo.removeClass(that.oLocDropDownContainer,selLocDrpdwnCollapsedClassName);dojo.addClass(that.oLocDropDownContainer,selLocDrpdwnExpandedClassName);}else if(dojo.hasClass(that.oLocDropDownContainer,selLocDrpdwnExpandedClassName)){dojo.removeClass(that.oLocDropDownContainer,selLocDrpdwnExpandedClassName);dojo.addClass(that.oLocDropDownContainer,selLocDrpdwnCollapsedClassName);}};dojo.connect(this.oLocationNav,"onclick",this,function(event){dojo.stopEvent(event);toggleDropdownClass();});dojo.connect(document,"onclick",this,function(event){var isMousePointerinModalContainer=dj.util.Element.contains(this.oLocDropDownContainer,event.clientX,event.clientY);if(isMousePointerinModalContainer==false){if(dojo.hasClass(this.oLocDropDownContainer,selLocDrpdwnExpandedClassName)){dojo.removeClass(this.oLocDropDownContainer,selLocDrpdwnExpandedClassName);dojo.addClass(this.oLocDropDownContainer,selLocDrpdwnCollapsedClassName);}}});this.oSectionFooterNonSub=dojo.byId("sectionFooterNonSub");this.oSectionFooterSub=dojo.byId("sectionFooterSub");dj.util.User.isLoggedIn(function(isLoggedIn){if(isLoggedIn){dojo.style(that.oSectionFooterNonSub,{"display":"none"});dojo.style(that.oSectionFooterSub,{"display":""});}else{dojo.style(that.oSectionFooterNonSub,{"display":""});dojo.style(that.oSectionFooterSub,{"display":"none"});}});}},displayTimeStamp:function(){var timestampClass=this.cfg.TIMESTAMP_CLASS;this.oTimestamp=dojo.query(timestampClass,this.oHeader)[0];if((typeof pDate!=="undefined")&&(this.oTimestamp!==null)){if(window.pStl=="renovation"){var pubDate=dj.util.Date.displayTime(pDate,pDateinGMT);this.oTimestamp.innerHTML=pubDate;}else{this.oTimestamp.innerHTML=pDate;}}},displaySubSection:function(){this.oCurrentSubSection=dojo.query(this.cfg.CURRENT_SUBSECTION_DISPLAY_CLASS,this.oHeader)[0];if((typeof globalHeaderPageTitle!=="undefined")&&(globalHeaderPageTitle!==null)&&(globalHeaderPageTitle!=="")){this.oCurrentSubSection.innerHTML=globalHeaderPageTitle;this._delayedFadeInSubSection();}},_delayedFadeInSubSection:function(){setTimeout(dojo.hitch(this,function(){dojo.style(this.oCurrentSubSection,{"display":"inline","opacity":0});dojo.fadeIn({node:this.oCurrentSubSection,duration:(this.cfg.WSJ_LOGO_FADE_APPEAR_DURATION*1000)}).play();}),this.cfg.WSJ_LOGO_DELAY_DURATION);},displaySubscriberDetails:function(){var userNameElementId=this.cfg.USER_NAME_ELEMENT_ID;dj.util.User.renderCallsign(userNameElementId);this.setupSubscriberLinks();var messageCenterLinkClass=this.cfg.MESSAGE_CENTER_LINK_CLASS;this.oMessageCenterLink=dojo.query(messageCenterLinkClass,this.oHeader)[0];var that=this;dj.util.User.isSubLoggedIn(function(subLoggedIn){if(subLoggedIn){that.setupMessageCenter();}else{that.setUpMJLinksForReg();dojo.style(that.oMessageCenterLink,{"display":"none"});}});var subscriberDetailsElementId=this.cfg.SUBSCRIBER_DETAILS_ELEMENT_ID;this.oSubscriberDetails=dojo.byId(subscriberDetailsElementId);dojo.removeClass(this.oSubscriberDetails,"hidden");},setUpMJLinksForReg:function(){var footerContainerClass=this.cfg.FOOTER_CONTAINER_CLASS;this.oFooter=dojo.query(footerContainerClass)[0];var mojLinkUrl=this.cfg.MOJ_LINK_URL;var mojLinkClass=this.cfg.MOJ_LINK_CLASS;this.oMojLinkHeader=dojo.query(mojLinkClass,this.oHeader)[0];this.oMojLinkFooter=dojo.query(mojLinkClass,this.oFooter)[0];if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){this.oMojLinkHeader.href="httpdisabled://"+gcDomain+mojLinkUrl;this.oMojLinkFooter.href="httpdisabled://"+gcDomain+mojLinkUrl;}else{this.oMojLinkHeader.href=mojLinkUrl;this.oMojLinkFooter.href=mojLinkUrl;}},setupSubscriberLinks:function(){var todaysPaperLinkClass=this.cfg.TODAYS_PAPER_LINK_CLASS;this.oTodaysPaperLink=dojo.query(todaysPaperLinkClass,this.oHeader)[0];var loggedInTodaysPaperUrl=this.cfg.LOGGED_IN_TODAYS_PAPER_URL;var that=this;dj.util.User.isSubLoggedIn(function(subLoggedIn){if(subLoggedIn){if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){that.oTodaysPaperLink.href="httpdisabled://"+gcDomain+loggedInTodaysPaperUrl;}else{that.oTodaysPaperLink.href=loggedInTodaysPaperUrl;}}});},setupMessageCenter:function(){var messageCenterLinkClass=this.cfg.MESSAGE_CENTER_LINK_CLASS;this.oMessageCenterLink=dojo.query(messageCenterLinkClass,this.oHeader)[0];var messageCountClass=this.cfg.MESSAGE_COUNT_CLASS;this.oMessageCount=dojo.query(messageCountClass,this.oHeader)[0];var that=this;var setupMsgCenterLink=function(noOfMessages){if(noOfMessages=='-1'){dojo.style(that.oMessageCenterLink,{"display":"none"});}else{that.oMessageCount.innerHTML=noOfMessages;}};var noOfMessages=dj.util.Cookie.getCookie("msgCount");if(noOfMessages===null){var messageCenterPostUrl=this.cfg.MESSAGE_CENTER_POST_URL;var messageCountReq=dojo.xhrPost({url:messageCenterPostUrl,handleAs:"json",handle:function(data,ioargs){var jsonObj=data;noOfMessages=jsonObj.MessagesCount;var userStatus=jsonObj.Status;dj.util.Cookie.setCookie("msgCount",noOfMessages,(5/24/60));dj.util.Cookie.setCookie("userStatus",userStatus,(5/24/60));setupMsgCenterLink(noOfMessages);},error:function(transport,exception){console.error("Exception occured while posting posting Ajax Request: %s",exception);}});}else{setupMsgCenterLink(noOfMessages);}},setupLogin:function(){var loginUserElementId=this.cfg.LOGIN_USERNAME_ELEMENT_ID;this.oUserName=dojo.byId(loginUserElementId);var loginPasswordElementId=this.cfg.LOGIN_PASSWORD_ELEMENT_ID;this.oPassword=dojo.byId(loginPasswordElementId);var loginButtonImageId=this.cfg.LOGIN_BUTTON_ELEMENT_ID;this.oLoginImg=dojo.byId(loginButtonImageId);var loginFormId=this.cfg.LOGIN_FORM_ID;this.oLoginForm=dojo.byId(loginFormId);this.oLoginForm.reset();var pageUrlId=this.cfg.PAGE_URL_ELEMENT_ID;this.oPageUrl=dojo.byId(pageUrlId);var that=this;if(this.oPageUrl!==null){var nonSubscriberHomepagePid=this.cfg.NONSUBSCRIBER_HOMEPAGE_PID;var nonSubscriberSearchPagePid=this.cfg.NONSUBSCRIBER_SEARCH_PAGE_PID;var nonSubNewslettersAlertsPagePid=this.cfg.NONSUBSCRIBER_NEWSLETTERS_ALERTS_PAGE_PID;var mdcPagePid=this.cfg.MDC_PAGE_PID;var concatURL;if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){concatURL="httpdisabled://"+gcDomain;}else{concatURL="httpdisabled://"+document.domain;}
var oCurrentUrl;if(dojo.isIE){oCurrentUrl=window.location.href;}else{oCurrentUrl=document.location.href;}
var url_value=oCurrentUrl;if(typeof pID!=="undefined"){if(pID===nonSubscriberHomepagePid){url_value=concatURL+this.cfg.HOMEPAGE_SUBSCRIBER_URL;}else if(pID===nonSubNewslettersAlertsPagePid){url_value=concatURL+"/email";}else if(pID===nonSubscriberSearchPagePid){url_value=concatURL+this.cfg.SEARCH_PAGE_SUBSCRIBER_URL;}else if(pID===mdcPagePid){url_value=concatURL+this.cfg.MDC_LINK_URL;}else{url_value=oCurrentUrl;}
if(dojo.isIE){document.login_form.url.value=url_value;}else{this.oPageUrl.value=url_value;}}
if(this.oUserName!==null){dojo.connect(this.oUserName,"onfocus",this,function(event){dj.util.Form.clearValue(this.oUserName,"User Name");});dojo.connect(this.oUserName,"onclick",this,function(event){dj.util.Form.clearValue(this.oUserName,"User Name");});}
if(this.oPassword!==null){dojo.connect(this.oPassword,"onfocus",this,function(event){dj.util.Form.clearValue(that.oPassword,"Password");this.oPassword.type="password";});dojo.connect(this.oPassword,"onclick",this,function(event){dj.util.Form.clearValue(that.oPassword,"Password");});dojo.connect(this.oPassword,"onchange",this,function(event){dj.util.Form.clearValue(that.oPassword,"Password");});}
if(dojo.isIE){dojo.connect(this.oLoginImg,"onclick",this,function(e){document.login_form.url.value=oCurrentUrl;console.log("coming in to img onlick in IE"+oCurrentUrl);this.oLoginForm.submit();});}
dojo.connect(this.oPassword,"onkeypress",this,function(e){var cKeyCode=e.keyCode||e.which;if(dojo.isIE){if(cKeyCode==dojo.keys.ENTER){document.login_form.url.value=oCurrentUrl;this.oLoginForm.submit();}}});}},setupLogout:function(){var logoutLinkElementId=this.cfg.LOGOUT_LINK_ELEMENT_ID;this.oLogout=dojo.byId(logoutLinkElementId);if(this.oLogout!==null){dojo.connect(this.oLogout,"onclick",this,function(ev){dojo.stopEvent(ev);dj.util.Cookie.deleteCookie("msgCount");dj.util.Cookie.deleteCookie("HOMEPAGE",true);document.cookie="HOMEPAGE"+"="+";path=/"+";domain=.wsj.com"
+";expires=Thu, 01-Jan-1970 00:00:01 GMT";if((typeof dj.module.facebook.connect.logout=="function")&&(FB.getSession())){dj.module.facebook.connect.logout(function(){if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){window.location="/logout?url=http://"+gcDomain;}else{window.location="/logout";}});}else{console.info("Facebook API is not available when executing Logout");if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){window.location="/logout?url=http://"+gcDomain;}else{window.location="/logout";}}});}},highlightFormFactorLinks:function(){var todaysPaperLinkContainerClass=this.cfg.TODAYS_PAPER_LINK_CONTAINER_CLASS;this.oTodaysPaperLinkContainer=dojo.query(todaysPaperLinkContainerClass,this.oHeader)[0];var videoLinkContainerClass=this.cfg.VIDEO_LINK_CONTAINER_CLASS;this.oVideoLinkContainer=dojo.query(videoLinkContainerClass,this.oHeader)[0];var blogsLinkContainerClass=this.cfg.BLOGS_LINK_CONTAINER_CLASS;this.oBlogsLinkContainer=dojo.query(blogsLinkContainerClass,this.oHeader)[0];var columnsLinkContainerClass=this.cfg.COLUMNS_LINK_CONTAINER_CLASS;this.oColumnsLinkContainer=dojo.query(columnsLinkContainerClass,this.oHeader)[0];var interactiveGraphicsLinkContainerClass=this.cfg.INTERACTIVE_GRAPHICS_LINK_CONTAINER_CLASS;this.oInteractiveGraphicsLinkContainer=dojo.query(interactiveGraphicsLinkContainerClass,this.oHeader)[0];var topicsLinkContainerClass=this.cfg.TOPICS_LINK_CONTAINER_CLASS;this.oTopicsLinkContainer=dojo.query(topicsLinkContainerClass,this.oHeader)[0];var communityForumsLinkContainerClass=this.cfg.COMMUNITY_FORUMS_LINK_CONTAINER_CLASS;this.oCommunityForumsLinkContainer=dojo.query(communityForumsLinkContainerClass,this.oHeader)[0];var todaysPaperPid=this.cfg.TODAYS_PAPER_PID;var todaysPaperUsNonSubPid=this.cfg.TODAYS_PAPER_US_NONSUB_PID;var todaysPaperEuropeNonSubPid=this.cfg.TODAYS_PAPER_EUROPE_NONSUB_PID;var todaysPaperAsiaNonSubPid=this.cfg.TODAYS_PAPER_ASIA_NONSUB_PID;var todaysPaperUsPid=this.cfg.TODAYS_PAPER_US_PID;var todaysPaperEuropePid=this.cfg.TODAYS_PAPER_EUROPE_PID;var todaysPaperAsiaPid=this.cfg.TODAYS_PAPER_ASIA_PID;var todaysPaperPastEditionsPid=this.cfg.TODAYS_PAPER_PAST_EDITIONS_PID;var todaysPaperIndexBizPid=this.cfg.TODAYS_PAPER_INDEX_BIZ_PID;var todaysPaperIndexPeoplePid=this.cfg.TODAYS_PAPER_INDEX_PEOPLE_PID;var todaysPaperCorrectionsPid=this.cfg.TODAYS_PAPER_CORRECTIONS_PID;var videoPid=this.cfg.VIDEO_PID;var interactiveGraphicsPid=this.cfg.INTERACTIVE_GRAPHICS_PID;var topicsPid=this.cfg.TOPICS_PID;var newslettersAlertsPubPid=this.cfg.NEWSLETTERS_ALERTS_PUB_PID;var newslettersAlertsSubPid=this.cfg.NEWSLETTERS_ALERTS_SUB_PID;var columnsPid=this.cfg.COLUMNS_PID;var blogsPid=this.cfg.BLOGS_PID;var hostUrl=document.location.host;var communityUrl=hostUrl+this.cfg.COMMUNITY_HIGHLIGHT_COMPARE_URL;var compareForumsUrl=this.cfg.FORUMS_HIGHLIGHT_COMPARE_URL;if(typeof pID!=="undefined"){if((pID.indexOf(todaysPaperPid)==0)||(pID===todaysPaperUsNonSubPid)||(pID===todaysPaperEuropeNonSubPid)||(pID===todaysPaperAsiaNonSubPid)||(pID===todaysPaperUsPid)||(pID===todaysPaperEuropePid)||(pID===todaysPaperAsiaPid)||(pID===todaysPaperPastEditionsPid)||(pID===todaysPaperIndexBizPid)||(pID===todaysPaperIndexPeoplePid)||(pID===todaysPaperCorrectionsPid)){dojo.addClass(this.oTodaysPaperLinkContainer,"selected");}else if(pID===videoPid){dojo.addClass(this.oVideoLinkContainer,"selected");}else if(pID===interactiveGraphicsPid){dojo.addClass(this.oInteractiveGraphicsLinkContainer,"selected");}else if(pID===columnsPid){dojo.addClass(this.oColumnsLinkContainer,"selected");}else if(pID===blogsPid){dojo.addClass(this.oBlogsLinkContainer,"selected");}else if(pID===topicsPid){dojo.addClass(this.oTopicsLinkContainer,"selected");}}
if((document.location.href!==null)&&(document.location.href!=="")&&(document.location.href.indexOf(communityUrl)!==-1)||(document.location.href.indexOf(compareForumsUrl)!==-1)){dojo.addClass(this.oCommunityForumsLinkContainer,"selected");}}};}();dojo.provide("dj.module.header.globalHeader");dojo.require("dj.lang");dojo.require("dj.util.Config");dojo.require("dj.util.Cookie");dojo.require("dj.util.Date");dojo.require("dj.util.Region");dojo.require("dj.util.Element");dojo.require("dj.util.User");dj.module.header.globalHeader=function(){var DEFAULT_CONFIG={HEADER_CONTAINER_CLASS:".header",CURRENT_SUBSECTION_DISPLAY_CLASS:".currentSubSection",GLOBALNAV_SUBSECTION_ELEMENT_ID:"currentGlobalNavSubSection",MOJ_LINK_URL:"/page/my-journal-main.html",MDC_LINK_URL:"/mdc/page/marketsdata.html",MDC_PAGE_PID:"2_3000",COMMUNITY_HIGHLIGHT_COMPARE_URL:"/community",FORUMS_HIGHLIGHT_COMPARE_URL:"forums.wsj.com",LOCATION_NAV_CLASS:".location_nav",LOCATION_NAV_COLLAPSED_CLASSNAME:"location_collapsed",LOCATION_NAV_EXPANDED_CLASSNAME:"location_expanded",US_EDITION_LINK_CLASS:".map_us",EU_EDITION_LINK_CLASS:".map_europe",ASIA_EDITION_LINK_CLASS:".map_asia",IN_EDITION_LINK_CLASS:".map_india",US_EDITION_MDC_URL:"/marketsdata",EU_EDITION_MDC_URL:"/mdc/public/page/marketsdata_europe.html",ASIA_EDITION_MDC_URL:"/mdc/public/page/marketsdata_asia.html",IN_EDITION_MDC_URL:"/mdc/public/page/marketsdata_asia.html",MDC_COMPARE_URL:"/mdc/",FOOTER_CONTAINER_CLASS:".pagefooter"};return{initialize:function(config){this.cfg=dj.lang.cloneMixin(DEFAULT_CONFIG,config);var headerContainerClass=this.cfg.HEADER_CONTAINER_CLASS;this.oHeader=dojo.query(".header")[0];this.editionDropdownSetUp();this.currRegion=dj.util.Region.getViewByRegion();this.oLocToggle=dojo.byId("loc_toggle");},toggleDropdownClass:function(){var selLocDrpdwnCollapsedClassName=this.cfg.LOCATION_NAV_COLLAPSED_CLASSNAME;var selLocDrpdwnExpandedClassName=this.cfg.LOCATION_NAV_EXPANDED_CLASSNAME;this.oLocToggle=dojo.byId("loc_toggle");if(dojo.hasClass(this.oLocToggle,selLocDrpdwnCollapsedClassName)){dojo.removeClass(this.oLocToggle,selLocDrpdwnCollapsedClassName);dojo.addClass(this.oLocToggle,selLocDrpdwnExpandedClassName);}
else if(dojo.hasClass(this.oLocToggle,selLocDrpdwnExpandedClassName)){dojo.removeClass(this.oLocToggle,selLocDrpdwnExpandedClassName);dojo.addClass(this.oLocToggle,selLocDrpdwnCollapsedClassName);}},editionDropdownSetUp:function(){var that=this;this.oLocationNav=dojo.byId("locNavContainer");var selLocDrpdwnCollapsedClassName=this.cfg.LOCATION_NAV_COLLAPSED_CLASSNAME;var selLocDrpdwnExpandedClassName=this.cfg.LOCATION_NAV_EXPANDED_CLASSNAME;var usEditionLinkClassName=this.cfg.US_EDITION_LINK_CLASS;var euEditionLinkClassName=this.cfg.EU_EDITION_LINK_CLASS;var inEditionLinkClassName=this.cfg.IN_EDITION_LINK_CLASS;var asiaEditionLinkClassName=this.cfg.ASIA_EDITION_LINK_CLASS;this.usEditionMDCUrl=this.cfg.US_EDITION_MDC_URL;this.euEditionMDCUrl=this.cfg.EU_EDITION_MDC_URL;this.inEditionMDCUrl=this.cfg.IN_EDITION_MDC_URL;this.asiaEditionMDCUrl=this.cfg.ASIA_EDITION_MDC_URL;var mdcCompareUrl=this.cfg.MDC_COMPARE_URL;this.oCurrentEdition=dojo.byId("currentEdition");this.oUsEdition=dojo.byId("usEdition");this.oEuEdition=dojo.byId("europeEdition");this.oInEdition=dojo.byId("indiaEdition");this.oAsiaEdition=dojo.byId("asiaEdition");this.oChiEdition=dojo.byId("chiEdition");this.oJpnEdition=dojo.byId("jpnEdition");this.oSpaEdition=dojo.byId("spaEdition");this.oPorEdition=dojo.byId("porEdition");this.osectionFooterSub=dojo.byId("hrefNonSubId");this.osectionFooterNonSub=dojo.byId("hrefSubId");this.oUsEditionFooter=dojo.byId("usEditionFooter");this.currRegion=dj.util.Region.getViewByRegion();var currEdition="";if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){this.tempConcatURL="httpdisabled://"+gcDomain;}else{this.tempConcatURL="httpdisabled://"+document.domain;}
this.isMDCPageFlag=((document.location.href!==null)&&(document.location.href!=="")&&(document.location.href.indexOf(mdcCompareUrl)!==-1));if(this.oUsEdition!==null){dojo.connect(this.oUsEdition,"onclick",this,function(ev){dojo.stopEvent(ev);dj.util.Region.setViewByRegion('na,us');dj.util.Cookie.setGroupCookie("DJCOOKIE","HOMEPAGE","/home-page",365);window.location=(this.isMDCPageFlag)?this.tempConcatURL+this.usEditionMDCUrl:this.oUsEdition.href;});}
if(this.oUsEditionFooter!==null){dojo.connect(this.oUsEditionFooter,"onclick",this,function(ev){dojo.stopEvent(ev);dj.util.Region.setViewByRegion('na,us');dj.util.Cookie.setGroupCookie("DJCOOKIE","HOMEPAGE","/home/us",365);window.location=(this.isMDCPageFlag)?this.tempConcatURL+this.usEditionMDCUrl:this.oUsEditionFooter.href;});}
if(this.oEuEdition!==null){dojo.connect(this.oEuEdition,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=(this.isMDCPageFlag)?this.tempConcatURL+this.euEditionMDCUrl:this.oEuEdition.href;if(this.isMDCPageFlag){dj.util.Region.setViewByRegion("europe");dj.util.Cookie.setGroupCookie("DJCOOKIE","HOMEPAGE","/home/europe",365);}});}
if(this.oInEdition!==null){dojo.connect(this.oInEdition,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=(this.isMDCPageFlag)?this.tempConcatURL+this.inEditionMDCUrl:this.oInEdition.href;if(this.isMDCPageFlag){dj.util.Region.setViewByRegion("asia,india");dj.util.Cookie.setGroupCookie("DJCOOKIE","HOMEPAGE","/home/india",365);}});}
if(this.oAsiaEdition!==null){dojo.connect(this.oAsiaEdition,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=(this.isMDCPageFlag)?this.tempConcatURL+this.asiaEditionMDCUrl:this.oAsiaEdition.href;if(this.isMDCPageFlag){dj.util.Region.setViewByRegion("asia");dj.util.Cookie.setGroupCookie("DJCOOKIE","HOMEPAGE","/home/asia",365);}});}
if(this.oChiEdition!==null){dojo.connect(this.oChiEdition,"onclick",this,function(ev){dojo.stopEvent(ev);void(this.oChiEdition.href);});}
if(this.oJpnEdition!==null){dojo.connect(this.oJpnEdition,"onclick",this,function(ev){dojo.stopEvent(ev);void(this.oJpnEdition.href);});}
if(this.oSpaEdition!==null){dojo.connect(this.oSpaEdition,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=this.oSpaEdition.href;});}
if(this.oPorEdition!==null){dojo.connect(this.oPorEdition,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=this.oPorEdition.href;});}
if(this.osectionFooterSub!==null){dojo.connect(this.osectionFooterSub,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=this.osectionFooterSub.href;});}
if(this.osectionFooterNonSub!==null){dojo.connect(this.osectionFooterNonSub,"onclick",this,function(ev){dojo.stopEvent(ev);window.location=this.osectionFooterNonSub.href;});}
if(this.currRegion=="asia"){currEdition="Asia Edition Home";this.oSelectedEdition=dojo.query(asiaEditionLinkClassName,this.oHeader)[0];}else if(this.currRegion=="asia,india"){currEdition="Asia Edition Home";this.oSelectedEdition=dojo.query(inEditionLinkClassName,this.oHeader)[0];}else if(this.currRegion=="europe"){currEdition="Europe Edition Home";this.oSelectedEdition=dojo.query(euEditionLinkClassName,this.oHeader)[0];}else{currEdition="U.S. Edition Home";this.oSelectedEdition=dojo.query(usEditionLinkClassName,this.oHeader)[0];}
dojo.addClass(this.oSelectedEdition,"selected");this.oFormFactorContainer=dojo.byId("formFactorContainer");this.oLocDropDownContainer=dojo.byId("locNavContainer");this.oLocPopupContainer=dojo.byId("popupContainer");if(this.oLocDropDownContainer!==null){var toggleDropdownClass=function(){this.oLocToggle=dojo.byId("loc_toggle");if(dojo.hasClass(this.oLocToggle,selLocDrpdwnCollapsedClassName)){dojo.removeClass(this.oLocToggle,selLocDrpdwnCollapsedClassName);dojo.addClass(this.oLocToggle,selLocDrpdwnExpandedClassName);}else if(dojo.hasClass(this.oLocToggle,selLocDrpdwnExpandedClassName)){dojo.removeClass(this.oLocToggle,selLocDrpdwnExpandedClassName);dojo.addClass(this.oLocToggle,selLocDrpdwnCollapsedClassName);}};dojo.connect(this.oLocationNav,"onclick",this,function(event){dojo.stopEvent(event);toggleDropdownClass();});dojo.connect(document,"onclick",this,function(event){var isMousePointerinModalContainer=dj.util.Element.contains(this.oLocPopupContainer,event.clientX,event.clientY);if(isMousePointerinModalContainer==false){if(dojo.hasClass(this.oLocToggle,selLocDrpdwnExpandedClassName)){dojo.removeClass(this.oLocToggle,selLocDrpdwnExpandedClassName);dojo.addClass(this.oLocToggle,selLocDrpdwnCollapsedClassName);}}});this.oSectionFooterNonSub=dojo.byId("sectionFooterNonSub");this.oSectionFooterSub=dojo.byId("sectionFooterSub");dj.util.User.isLoggedIn(function(isLoggedIn){if(isLoggedIn){}else{}});}}};}();dojo.provide("dj.module.header.login");dojo.require("dj.lang");dojo.require("dj.util.Config");dojo.require("dj.util.Cookie");dojo.require("dj.util.Date");dojo.require("dj.util.Region");dojo.require("dj.util.Element");dojo.require("dj.util.User");dojo.require("dj.module.facebook.connect");dj.module.header.login=function(){var DEFAULT_CONFIG={HEADER_CONTAINER_CLASS:".header",TIMESTAMP_CLASS:".date",WSJ_LOGO_ID:"wsjLogo",WSJ_LARGE_LOGO_CLASSNAME:"logo_large",WSJ_SMALL_LOGO_CLASSNAME:"logo_small",CURRENT_SUBSECTION_DISPLAY_CLASS:".currentSubSection",GLOBALNAV_SUBSECTION_ELEMENT_ID:"currentGlobalNavSubSection",SUBSCRIBER_LOGIN_CLASS:".login",HEADER_PROMO_CLASS:".promo",SUBSCRIBER_DETAILS_ELEMENT_ID:"subscribedUserDetailsId",COMMUNITY_FORUMS_LINK_CLASS:".communityForumsLink",TODAYS_PAPER_LINK_CLASS:".todaysPaperLink",MOJ_LINK_CLASS:".myOnlineJournalLink",MESSAGE_CENTER_LINK_CLASS:".messageCenterLink",MESSAGE_COUNT_CLASS:".messageCount",LOGIN_USERNAME_ELEMENT_ID:"login_username",LOGIN_PASSWORD_ELEMENT_ID:"login_password",LOGIN_FORM_ID:"login_form",PAGE_URL_ELEMENT_ID:"page_url",LOGOUT_LINK_ELEMENT_ID:"logoutLink",LOGIN_BUTTON_ELEMENT_ID:"login_button",USER_NAME_ELEMENT_ID:"userName",WSJ_LOGO_FADE_APPEAR_DURATION:"1.0",WSJ_LOGO_DELAY_DURATION:"2000",LOGGED_IN_COMMUNITY_URL:"/community",LOGGED_IN_TODAYS_PAPER_URL:"/itp?mod=WSJ_formfactor",LOGGED_IN_TODAYS_PAPER_URL_ASIA:"/itp/asia?mod=WSJ_formfactor",LOGGED_IN_TODAYS_PAPER_URL_EUROPE:"/itp/europe?mod=WSJ_formfactor",MESSAGE_CENTER_POST_URL:"/community/integration/userinfo.html",LOGOUT_URL:"/static_html_files/logout_confirmation.htm",SUBSCRIBER_HOMEPAGE_PID:"0_0_WH_0001",NONSUBSCRIBER_HOMEPAGE_PID:"0_0_WH_0001_public",ASIA_PAGE_PID:"0_0_WP_2103",EUROPE_PAGE_PID:"0_0_WP_2104",NONSUBSCRIBER_NEWSLETTERS_ALERTS_PAGE_PID:"5_6007",NONSUBSCRIBER_SEARCH_PAGE_PID:"3_0466",HOMEPAGE_SUBSCRIBER_URL:"/",SEARCH_PAGE_SUBSCRIBER_URL:"/search",TODAYS_PAPER_LINK_CONTAINER_CLASS:".todaysPaperLinkContainer",VIDEO_LINK_CONTAINER_CLASS:".videoLinkContainer",COLUMNS_LINK_CONTAINER_CLASS:".columnsLinkContainer",BLOGS_LINK_CONTAINER_CLASS:".blogsLinkContainer",INTERACTIVE_GRAPHICS_LINK_CONTAINER_CLASS:".interactiveGraphicsLinkContainer",TOPICS_LINK_CONTAINER_CLASS:".topicsLinkContainer",COMMUNITY_FORUMS_LINK_CONTAINER_CLASS:".communityForumsLinkContainer",TODAYS_PAPER_PID:"0_0_WP_40",TODAYS_PAPER_US_NONSUB_PID:"2_0433",TODAYS_PAPER_EUROPE_NONSUB_PID:"2_0434",TODAYS_PAPER_ASIA_NONSUB_PID:"2_0435",TODAYS_PAPER_US_PID:"2_0133",TODAYS_PAPER_EUROPE_PID:"2_0134",TODAYS_PAPER_ASIA_PID:"2_0135",TODAYS_PAPER_PAST_EDITIONS_PID:"2_0233",TODAYS_PAPER_INDEX_BIZ_PID:"2_0156",TODAYS_PAPER_INDEX_PEOPLE_PID:"2_0155",TODAYS_PAPER_CORRECTIONS_PID:"Corrections",VIDEO_PID:"0_0_WP_3000",BLOGS_PID:"8_0019",COLUMNS_PID:"2_0140",INTERACTIVE_GRAPHICS_PID:"0_0_WP_2003",TOPICS_PID:"0_0_WT_0001",NEWSLETTERS_ALERTS_SUB_PID:"5_6001",NEWSLETTERS_ALERTS_PUB_PID:"5_6003",MOJ_LINK_URL:"/page/my-journal-main.html",MDC_LINK_URL:"/mdc/page/marketsdata.html",MDC_PAGE_PID:"2_3000",COMMUNITY_HIGHLIGHT_COMPARE_URL:"/community",FORUMS_HIGHLIGHT_COMPARE_URL:"forums.wsj.com",FREE_REG_CLASS:".freereg",LOCATION_NAV_CLASS:".location_nav",LOCATION_NAV_COLLAPSED_CLASSNAME:"location_collapsed",LOCATION_NAV_EXPANDED_CLASSNAME:"location_expanded",US_EDITION_LINK_CLASS:".map_us",EU_EDITION_LINK_CLASS:".map_europe",ASIA_EDITION_LINK_CLASS:".map_asia",IN_EDITION_LINK_CLASS:".map_india",US_EDITION_MDC_URL:"/marketsdata",EU_EDITION_MDC_URL:"/mdc/public/page/marketsdata_europe.html",ASIA_EDITION_MDC_URL:"/mdc/public/page/marketsdata_asia.html",IN_EDITION_MDC_URL:"/mdc/public/page/marketsdata_asia.html",MDC_COMPARE_URL:"/mdc/",FOOTER_CONTAINER_CLASS:".pagefooter",GO_PRO_HOOK:"goprohook",GO_PRO_HOOK_REGION:["na,us"]};return{initialize:function(config){this.cfg=dj.lang.cloneMixin(DEFAULT_CONFIG,config);var headerContainerClass=this.cfg.HEADER_CONTAINER_CLASS;this.oHeader=dojo.query(headerContainerClass)[0];this.currRegion=dj.util.Region.getViewByRegion();this.concatURL='';this.subscriberLoginInit();this.displayGoPro();if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){this.concatURL="httpdisabled://"+gcDomain;}else{this.concatURL="httpdisabled://"+document.domain;}},subscriberLoginInit:function(){var that=this;dj.util.User.isLoggedIn(function(isLoggedIn){if(isLoggedIn){that.displaySubscriberDetails();that.setupLogout();}else{that.setupLogin();var subscriberLoginClass=that.cfg.SUBSCRIBER_LOGIN_CLASS;that.oSubscriberLogin=dojo.query(subscriberLoginClass,that.oHeader)[0];var loginModule=dojo.query(".login_module",that.oSubscriberLogin)[0];dojo.style(loginModule,{display:"block"});dojo.style(that.oSubscriberLogin,{display:"block"});var headerPromoClass=that.cfg.HEADER_PROMO_CLASS;that.oHeaderPromo=dojo.query(headerPromoClass,that.oHeader)[0];dojo.style(that.oHeaderPromo,{display:"block"});}});},displayGoPro:function(){var that=this;dj.util.User.isSubLoggedIn(function(subLoggedIn){if(subLoggedIn){var region_index=-1;dojo.forEach(that.cfg.GO_PRO_HOOK_REGION,function(element,index){if(element===that.currRegion){region_index=index;}});if(that.cfg.GO_PRO_HOOK_REGION==="all"||region_index!==-1){dojo.removeClass(that.cfg.GO_PRO_HOOK,"hidden");}}});},displaySubscriberDetails:function(){var userNameElementId=this.cfg.USER_NAME_ELEMENT_ID;dj.util.User.renderCallsign(userNameElementId);var messageCenterLinkClass=this.cfg.MESSAGE_CENTER_LINK_CLASS;this.oMessageCenterLink=dojo.query(messageCenterLinkClass,this.oHeader)[0];var that=this;dj.util.User.isSubLoggedIn(function(subLoggedIn){if(subLoggedIn){that.setupMessageCenter();}else{that.setUpMJLinksForReg();dojo.style(that.oMessageCenterLink,{"display":"none"});}});var subscriberDetailsElementId=this.cfg.SUBSCRIBER_DETAILS_ELEMENT_ID;this.oSubscriberDetails=dojo.byId(subscriberDetailsElementId);dojo.removeClass(this.oSubscriberDetails,"hidden");},setUpMJLinksForReg:function(){var footerContainerClass=this.cfg.FOOTER_CONTAINER_CLASS;this.oFooter=dojo.query(footerContainerClass)[0];var mojLinkUrl=this.cfg.MOJ_LINK_URL;var mojLinkClass=this.cfg.MOJ_LINK_CLASS;this.oMojLinkHeader=dojo.query(mojLinkClass,this.oHeader)[0];this.oMojLinkFooter=dojo.query(mojLinkClass,this.oFooter)[0];if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){this.oMojLinkHeader.href="httpdisabled://"+gcDomain+mojLinkUrl;this.oMojLinkFooter.href="httpdisabled://"+gcDomain+mojLinkUrl;}else{this.oMojLinkHeader.href=mojLinkUrl;this.oMojLinkFooter.href=mojLinkUrl;}},setupSubscriberLinks:function(){var todaysPaperLinkClass=this.cfg.TODAYS_PAPER_LINK_CLASS;this.oTodaysPaperLink=dojo.query(todaysPaperLinkClass,this.oHeader)[0];var loggedInTodaysPaperUrl=this.cfg.LOGGED_IN_TODAYS_PAPER_URL;var that=this;dj.util.User.isSubLoggedIn(function(subLoggedIn){if(subLoggedIn){if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){that.oTodaysPaperLink.href="httpdisabled://"+gcDomain+loggedInTodaysPaperUrl;}else{that.oTodaysPaperLink.href=loggedInTodaysPaperUrl;}}});},setupMessageCenter:function(){var messageCenterLinkClass=this.cfg.MESSAGE_CENTER_LINK_CLASS;this.oMessageCenterLink=dojo.query(messageCenterLinkClass,this.oHeader)[0];var messageCountClass=this.cfg.MESSAGE_COUNT_CLASS;this.oMessageCount=dojo.query(messageCountClass,this.oHeader)[0];var that=this;var setupMsgCenterLink=function(noOfMessages){if(noOfMessages=='-1'){dojo.style(that.oMessageCenterLink,{"display":"none"});}else{that.oMessageCount.innerHTML=noOfMessages;}};var noOfMessages=dj.util.Cookie.getCookie("msgCount");if(noOfMessages===null){var messageCenterPostUrl=this.cfg.MESSAGE_CENTER_POST_URL;var messageCountReq=dojo.xhrPost({url:messageCenterPostUrl,handleAs:"json",handle:function(data,ioargs){var jsonObj=data;noOfMessages=jsonObj.MessagesCount;var userStatus=jsonObj.Status;dj.util.Cookie.setCookie("msgCount",noOfMessages,(5/24/60));dj.util.Cookie.setCookie("userStatus",userStatus,(5/24/60));setupMsgCenterLink(noOfMessages);},error:function(transport,exception){console.error("Exception occured while posting posting Ajax Request: %s",exception);}});}else{setupMsgCenterLink(noOfMessages);}},setupLogin:function(){var loginUserElementId=this.cfg.LOGIN_USERNAME_ELEMENT_ID;this.oUserName=dojo.byId(loginUserElementId);var loginPasswordElementId=this.cfg.LOGIN_PASSWORD_ELEMENT_ID;this.oPassword=dojo.byId(loginPasswordElementId);var loginButtonImageId=this.cfg.LOGIN_BUTTON_ELEMENT_ID;this.oLoginImg=dojo.byId(loginButtonImageId);var loginFormId=this.cfg.LOGIN_FORM_ID;this.oLoginForm=dojo.byId(loginFormId);this.oLoginForm.reset();var pageUrlId=this.cfg.PAGE_URL_ELEMENT_ID;this.oPageUrl=dojo.byId(pageUrlId);var that=this;if(this.oPageUrl!==null){var nonSubscriberHomepagePid=this.cfg.NONSUBSCRIBER_HOMEPAGE_PID;var nonSubscriberSearchPagePid=this.cfg.NONSUBSCRIBER_SEARCH_PAGE_PID;var nonSubNewslettersAlertsPagePid=this.cfg.NONSUBSCRIBER_NEWSLETTERS_ALERTS_PAGE_PID;var mdcPagePid=this.cfg.MDC_PAGE_PID;var concatURL;if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){concatURL="httpdisabled://"+gcDomain;}else{concatURL="httpdisabled://"+document.domain;}
var oCurrentUrl;if(dojo.isIE){oCurrentUrl=window.location.href;}else{oCurrentUrl=document.location.href;}
var url_value=oCurrentUrl;if(typeof pID!=="undefined"){if(pID===nonSubscriberHomepagePid){url_value=concatURL+this.cfg.HOMEPAGE_SUBSCRIBER_URL;}else if(pID===nonSubNewslettersAlertsPagePid){url_value=concatURL+"/email";}else if(pID===nonSubscriberSearchPagePid){url_value=concatURL+this.cfg.SEARCH_PAGE_SUBSCRIBER_URL;}else if(pID===mdcPagePid){url_value=concatURL+this.cfg.MDC_LINK_URL;}else{url_value=oCurrentUrl;}
var cachebuster=(url_value.indexOf("?")!=-1)?"&":"?";if(typeof cachebuster!==undefined)
{cachebuster=cachebuster+"_nocache="+new Date().getTime();if(url_value.indexOf("#")!=-1){url_value=url_value.replace("#",cachebuster+"#");}else{url_value=url_value+cachebuster;}}
if(dojo.isIE){document.login_form.url.value=url_value;}else{this.oPageUrl.value=url_value;}}
if(this.oUserName!==null){dojo.connect(this.oUserName,"onfocus",this,function(event){dj.util.Form.clearValue(this.oUserName,"User Name");});dojo.connect(this.oUserName,"onclick",this,function(event){dj.util.Form.clearValue(this.oUserName,"User Name");});}
if(this.oPassword!==null){dojo.connect(this.oPassword,"onfocus",this,function(event){dj.util.Form.clearValue(that.oPassword,"Password");this.oPassword.type="password";});dojo.connect(this.oPassword,"onclick",this,function(event){dj.util.Form.clearValue(that.oPassword,"Password");});dojo.connect(this.oPassword,"onchange",this,function(event){dj.util.Form.clearValue(that.oPassword,"Password");});}
if(dojo.isIE){dojo.connect(this.oLoginImg,"onclick",this,function(e){document.login_form.url.value=oCurrentUrl;console.log("coming in to img onlick in IE"+oCurrentUrl);this.oLoginForm.submit();});}
dojo.connect(this.oPassword,"onkeypress",this,function(e){var cKeyCode=e.keyCode||e.which;if(dojo.isIE){if(cKeyCode==dojo.keys.ENTER){document.login_form.url.value=oCurrentUrl;this.oLoginForm.submit();}}});}},setupLogout:function(){var logoutLinkElementId=this.cfg.LOGOUT_LINK_ELEMENT_ID;this.oLogout=dojo.byId(logoutLinkElementId);if(this.oLogout!==null){dojo.connect(this.oLogout,"onclick",this,function(ev){dojo.stopEvent(ev);dj.util.Cookie.deleteCookie("msgCount");dj.util.Cookie.deleteCookie("HOMEPAGE",true);document.cookie="HOMEPAGE"+"="+";path=/"+";domain=.wsj.com"+";expires=Thu, 01-Jan-1970 00:00:01 GMT";if((typeof dj.module.facebook.connect.logout=="function")&&(FB.getSession())){dj.module.facebook.connect.logout(function(){if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){window.location="/logout?url=http://"+gcDomain;}else{window.location="/logout";}});}else{console.info("Facebook API is not available when executing Logout");if((typeof gcDomain!=="undefined")&&(gcDomain!==null)&&(gcDomain!=="")){window.location="/logout?url=http://"+gcDomain;}else{window.location="/logout";}}});}}};}();
dojo.provide("dj.module.iPadAppPromoLoader");dj.module.iPadAppPromoLoader={init:function(){if(!this._isIpad()){return;}
var d=dojo;d.require("djscript.require.dj_module_iPadAppPromo.version.1");d.addOnLoad(function(){dj.module.iPadAppPromo.init();});},_isIpad:function(){return(navigator.userAgent.match(/iPad/i)!==null);}};
dojo.provide("dj.util.doubleclick");dj.util.doubleclick={createTrackingPixel:function(userConf){var conf={container:"",source:"",type:"",category:"",url:"",trackingType:"iframe"};dojo.mixin(conf,userConf);var axel=Math.random()+"";var a=axel*10000000000000;if(conf.container===""){console.error("{dj.util.doubleclick} - container cannot be null or empty");}
try{if(conf.trackingType=="iframe"){dojo.create("iframe",{src:conf.url+";src="+conf.source+";type="+conf.type+";cat="+conf.category+";ord="+a+"?",width:"1",height:"1",frameborder:"0"},conf.container);}
else{dojo.create("img",{src:conf.url+";src="+conf.source+";type="+conf.type+";cat="+conf.category+";ord="+a+"?",width:"1",height:"1",border:"0",alt:""},conf.container);}}catch(e){console.error("{dj.util.doubleclick} - Could not create pixel");console.log(e);}}};
